const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./fcs-sru-aggregator-ui-query-builder-0.0.0.js","./vendor/react-ext.js","./vendor/react.js","./vendor/bootstrap.js","./vendor/antlr4.js","./vendor/prism.js","./fcs-sru-aggregator-ui-query-builder-0.0.0.css","./vendor/bootstrap.css"])))=>i.map(i=>d[i]);
import{u as Le,c as Dt,j as e,L as Ce,N as Xe,r as o,H as xe,R as Ht,a as Ft,b as ot,d as ct,e as fe,f as Ut,g as qt,h as zt,i as dt,m as Vt,s as ut,k as $t,l as Bt,n as we,Q as Qt,o as Gt,p as Kt,q as Wt,B as Yt}from"./vendor/react-ext.js";import{b as Xt}from"./vendor/react.js";/* empty css                            */import{C as X,R as G,a as E,N as me,b as ne,M as Q,F,B as z,c as Y,d as ht,e as ie,I as Jt,T as Zt,D as ae,S as mt,f as qe,O as de,g as oe,h as pe,L as ke,A as J,P as ye,i as Ie,j as es,k as Pe,l as Oe}from"./vendor/bootstrap.js";import{g as ts}from"./vendor/prism.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var Se={},Je;function ss(){if(Je)return Se;Je=1;var s=Xt();return Se.createRoot=s.createRoot,Se.hydrateRoot=s.hydrateRoot,Se}var ns=ss();const je="x-consortia";async function rs(s,t){const n=new URLSearchParams;(t==null?void 0:t.consortia)!==void 0&&(t==null?void 0:t.consortia)!==null&&n.set(je,t.consortia);const r="init"+(n.entries().next().done?"":`?${n}`);return(await s.get(r)).data}async function is(s,t){const n=new URLSearchParams;(t==null?void 0:t.consortia)!==void 0&&(t==null?void 0:t.consortia)!==null&&n.set(je,t.consortia);const r="statistics"+(n.entries().next().done?"":`?${n}`);return(await s.get(r)).data}async function as(s,t){return(await s.post("search",t,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data}async function ls(s,t,n){return(await s.post(`search/${t}`,n,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data}async function os(s,t){if(!t)throw new Error('Invalid "searchID" parameter!');return(await s.get(`search/${t}/metaonly`)).data}async function cs(s,t,n){if(!t)throw new Error('Invalid "searchID" parameter!');if(!n)throw new Error('Invalid "resourceID" parameter!');const i=(await s.get(`search/${t}/metaonly?resourceId=${encodeURIComponent(n)}`)).data.results.filter(a=>a.id===n);if(i.length===0)throw new Error(`Results (meta) for resource not found! (searchId: ${t}, resourceId: ${n})`);return i[0]}async function ds(s,t,n){if(!t)throw new Error('Invalid "searchID" parameter!');if(!n)throw new Error('Invalid "resourceID" parameter!');const i=(await s.get(`search/${t}?resourceId=${encodeURIComponent(n)}`)).data.results.filter(a=>a.resource.id===n);if(i.length===0)throw new Error(`Results for resource not found! (searchId: ${t}, resourceId: ${n})`);return i[0]}function us(s,t,n,r,i,a){const l=new URLSearchParams({resourceId:n,format:r});(a==="byGuess"||a==="byMetaAndGuess")&&l.set("filterLanguage",i);const c=`search/${t}/download?${l.toString()}`;return s.getUri({url:c})}function hs(s,t,n,r,i,a){const l=new URLSearchParams({resourceId:n});r?l.set("filterLanguage",r):(a==="byGuess"||a==="byMetaAndGuess")&&l.set("filterLanguage",i);const c=`search/${t}/toWeblicht?${l.toString()}`;return s.getUri({url:c})}const ms=[je];function Te(){const[s]=Le(),t=new URLSearchParams(Array.from(s.entries()).filter(([n])=>ms.includes(n)));if(!t.entries().next().done)return`?${t}`}const H=Dt(s=>({deployPath:"/",apiURL:"https://contentsearch.clarin.eu/rest/",validatorURL:"https://www.clarin.eu/fcsvalidator/",showSearchResultLink:!1,appTitle:"Content Search",appTitleHead:"FCS Aggregator – Content Search",termsAndDisclaimerUrl:"https://www.clarin.eu/content/terms-use-and-disclaimer",contactAddress:"mailto:fcs@clarin.eu",matomoTrackingEnabled:!0,matomoTrackingParams:null,authUsername:null,setDeployPath:t=>s(n=>({deployPath:typeof t=="function"?t(n.deployPath):t})),setApiURL:t=>s(n=>({apiURL:typeof t=="function"?t(n.apiURL):t})),setValidatorURL:t=>s(n=>({validatorURL:typeof t=="function"?t(n.validatorURL):t})),setShowSearchResultLink:t=>s(n=>({showSearchResultLink:typeof t=="function"?t(n.showSearchResultLink):t})),setAppTitle:t=>s(n=>({appTitle:typeof t=="function"?t(n.appTitle):t})),setAppTitleHead:t=>s(n=>({appTitleHead:typeof t=="function"?t(n.appTitleHead):t})),setTermsAndDisclaimerUrl:t=>s(n=>({termsAndDisclaimerUrl:typeof t=="function"?t(n.termsAndDisclaimerUrl):t})),setContactAddress:t=>s(n=>({contactAddress:typeof t=="function"?t(n.contactAddress):t})),setMatomoTrackingParams:t=>s(n=>({matomoTrackingParams:typeof t=="function"?t(n.matomoTrackingParams):t})),setAuthUsername:t=>s(n=>({authUsername:typeof t=="function"?t(n.authUsername):t}))}));function gs(){const s=H.getState().termsAndDisclaimerUrl,t=H.getState().contactAddress,n=Te();return e.jsx("footer",{className:"text-muted",children:e.jsx(X,{children:e.jsxs(G,{children:[e.jsxs(E,{className:"text-start d-flex flex-sm-row flex-column column-gap-3 row-gap-2",children:[e.jsxs("div",{children:[e.jsx(Ce,{to:{pathname:"/about",search:n},className:"hidden-xs",children:"About"}),e.jsxs("div",{className:"version-info text-muted text-center-xs",children:["v","0.0.0"]})]}),e.jsx(Ce,{to:{pathname:"/stats",search:n},children:"Statistics"})]}),e.jsxs(E,{className:"text-center",children:[e.jsxs("span",{className:"footer-fineprint",children:["Service provided by ",e.jsx("a",{href:"https://www.clarin.eu",children:"CLARIN"})]}),e.jsxs("span",{children:[e.jsx("br",{}),"Hosted by CLARIN ERIC"]})]}),e.jsxs(E,{className:"hidden-xs text-end d-flex flex-sm-row flex-column justify-content-sm-end column-gap-3 row-gap-2",children:[s&&e.jsx("a",{href:s,children:"Terms & Disclaimer"}),t&&e.jsx("a",{href:t,children:"Contact"})]})]})})})}const xs=""+new URL("assets/icon-services-fcs.png",import.meta.url).href,Ze=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16">
  <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"/>
</svg>`;function fs(){const s=H.getState().appTitle,t=H.getState().authUsername,n=t!==null&&t!=="anonymous",r=H.getState().deployPath??"",i=r+(r.endsWith("/")?"":"/")+"login",a=Te();return e.jsx("header",{children:e.jsx(me,{expand:"md",className:"bg-body-tertiary",children:e.jsxs(X,{children:[e.jsxs(me.Brand,{as:Ce,to:{pathname:"/",search:a},children:[e.jsx("img",{src:xs,width:"30",height:"30",className:"d-inline-block align-top",alt:`${s} logo`})," ",s]}),e.jsx(me.Toggle,{"aria-controls":"header-navbar-nav"}),e.jsx(me.Collapse,{id:"header-navbar-nav",children:e.jsxs(ne,{className:"w-100 d-flex",children:[e.jsx(ne.Link,{as:Xe,to:{pathname:"/",search:a},children:"Home"}),e.jsx(ne.Link,{as:Xe,to:{pathname:"/help",search:a},children:"Help"}),n?e.jsxs(me.Text,{className:"ms-auto",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ze}})," Signed in as"," ",e.jsx("span",{className:"fw-bold",children:t})]}):e.jsxs(ne.Link,{href:`${i}${a??""}`,className:"ms-auto",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ze}})," Login"]})]})})]})})})}/*!
 * Color mode switcher based on example from Bootstrap 5 docs.
 * @see https://getbootstrap.com/docs/5.3/customize/color-modes/#javascript
 */function ps(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function js(s){s==="auto"?document.documentElement.setAttribute("data-bs-theme",window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"):document.documentElement.setAttribute("data-bs-theme",s)}function bs(){o.useEffect(()=>{function s(){js(ps())}return s(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",s),()=>window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",s)},[])}function ws(){const s=H.getState().appTitleHead,t=Te();return e.jsxs(e.Fragment,{children:[e.jsx(xe,{children:e.jsxs("title",{children:[s," – About"]})}),e.jsxs(X,{children:[e.jsx("h1",{className:"h1",children:"About the Federated Content Search (FCS) Aggregator"}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:"People"}),e.jsx("p",{children:"The Aggregator was developed by:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Emanuel Dima"}),e.jsx("li",{children:"Erik Körner"}),e.jsx("li",{children:"Leif-Jöran Olsson"}),e.jsx("li",{children:"Yana Panchenko"}),e.jsx("li",{children:"Oliver Schonefeld"}),e.jsx("li",{children:"Dieter Van Uytvanck"})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:"Statistics"}),e.jsxs("p",{children:["View ",e.jsx(Ce,{to:{pathname:"/stats",search:t},children:"endpoint statistics"})," to see details about scanned resources, performed searches, warnings and errors."]})]}),e.jsx("div",{children:e.jsx("h2",{className:"h2",children:"Privacy Policy"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:"Source Code"}),e.jsxs("p",{children:["The Aggregator source code and documentation are published on"," ",e.jsx("a",{href:"https://github.com/clarin-eric/fcs-sru-aggregator",children:"GitHub"})," and are made available under the"," ",e.jsx("a",{href:"https://github.com/clarin-eric/fcs-sru-aggregator/blob/master/LICENSE",children:"GPL 3.0 license"}),"."]}),e.jsx("p",{children:"The full license can be found in the source code repository and in the packaged sources and binaries."})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:"Technology Used"}),e.jsx("p",{children:"The Aggregator uses the following software components:"}),e.jsx("ul",{children:e.jsxs("li",{children:[e.jsx("a",{href:"https://www.dropwizard.io/",children:"Dropwizard"})," (",e.jsx("a",{href:"https://github.com/dropwizard/dropwizard/blob/release/4.0.x/LICENSE",children:"Apache License 2.0"}),")"]})})]}),e.jsx("div",{children:e.jsx("h2",{className:"h2",children:"Funding"})})]})]})}function ys(){const s=H.getState().appTitleHead;return e.jsxs(e.Fragment,{children:[e.jsx(xe,{children:e.jsxs("title",{children:[s," – Help"]})}),e.jsxs(X,{children:[e.jsx("h1",{className:"h1",children:"Help"}),e.jsx("h2",{className:"h2",children:"Performing a Federated Content Search in resources"}),e.jsx("p",{}),e.jsx("h2",{className:"h2",children:"Adjusting search criteria"}),e.jsx("p",{}),e.jsx("h2",{children:"More help"}),e.jsxs("p",{children:["More detailed information on using FCS Aggregator is available at the"," ",e.jsx("a",{href:"https://www.clarin.eu/content/content-search-tutorial",children:"Content Search: Tutorial at CLARIN.eu"}),". If you still cannot find an answer to your question, or if want to send a feedback, you can write to the"," ",e.jsx("a",{title:"contact",href:"mailto:fcs@clarin.eu",children:"CLARIN FCS Helpdesk"}),"."]})]})]})}const ze=o.createContext({resources:[],languages:{},weblichtLanguages:[]});ze.displayName="AggregatorDataContext";function Ss({resources:s,languages:t,weblichtLanguages:n,children:r}){const i={resources:s,languages:t,weblichtLanguages:n};return e.jsx(ze.Provider,{value:i,children:r})}function Ve(){return o.useContext(ze)}const $e=o.createContext(void 0);$e.displayName="AxiosContext";function ue(){const s=o.useContext($e);if(!s)throw new Error('No "axios" instance set, use AxiosProvider to set one');return s}function vs({axios:s,children:t}){return e.jsx($e.Provider,{value:s,children:t})}const Be=o.createContext(void 0);Be.displayName="SearchParamsContext";function Qe(){const s=o.useContext(Be);if(!s)throw new Error('No "params" data set, use SearchParamsProvider to set one');return s}function Rs({language:s,languageFilter:t,queryType:n,query:r,resourceIDs:i,numberOfResults:a,children:l}){const c={language:s,languageFilter:t,queryType:n,query:r,resourceIDs:i,numberOfResults:a};return e.jsx(Be.Provider,{value:c,children:l})}function Ns(s,t=0){let n=3735928559^t,r=1103547991^t;for(let i=0,a;i<s.length;i++)a=s.charCodeAt(i),n=Math.imul(n^a,2654435761),r=Math.imul(r^a,1597334677);return n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507),r^=Math.imul(n^n>>>13,3266489909),4294967296*(2097151&r)+(n>>>0)}window._paq=window._paq||[];function Cs({siteId:s,trackerUrl:t,enableLinkTracking:n=!0,domains:r=[],userId:i=void 0}){window._paq.push(["setTrackerUrl",t]),window._paq.push(["setSiteId",s]),i&&window._paq.push(["setUserId",i]),Array.isArray(r)&&r.length>0&&window._paq.push(["setDomains",r]),n&&(window._paq.push(["enableLinkTracking"]),window._paq.push(["setLinkTrackingTimer",250]))}function Ls({srcUrl:s}){const t=document.createElement("script"),n=document.getElementsByTagName("script")[0];t.type="text/javascript",t.async=!0,t.defer=!0,t.src=s,n&&n.parentNode&&n.parentNode.insertBefore(t,n)}function Ts(s){var g;if(!s)return!1;let t=null;if(typeof s=="string")try{t=JSON.parse(s)}catch(f){return console.error("Error trying to parse tracking params!",f),!1}else typeof s=="object"&&(t=s);const n=t.siteId,r=t.trackerUrl,i=t.srcUrl,a=t.domains,l=(g=t.userId)==null?void 0:g.toString();if(i===void 0)return console.warn('No "srcUrl" configuration set for tracking!'),!1;if(r===void 0)return console.warn('No "trackerUrl" configuration set for tracking!'),!1;if(n===void 0||!Number.isInteger(n))return console.warn('No "siteId" configuration set for tracking!'),!1;const c={siteId:n,trackerUrl:r,domains:a};l&&(c.userId=Ns(l).toString());const h={srcUrl:i};return Cs(c),gt(document.location.href||window.location.href,document.title),Ls(h),!0}function gt(s,t,n){window._paq.push(["setDocumentTitle",t??document.title]),window._paq.push(["setCustomUrl",s]),n!==void 0&&window._paq.push(["setReferrerUrl",n]),window._paq.push(["trackPageView"])}function xt(s,t=!1,n=!1){window._paq.push(["trackSiteSearch",s,t,n])}const De="byMeta",As="all",ft="resource",Es="title-up",se="mul";function be(s,t=void 0){return s===se?"Any Language":(t==null?void 0:t[s])||"Unknown Language"}function Ms(s){const t=i=>({...i,subResources:i.subResources.map(t)}),n=s.map(t),r=function(i,a){const l=i.institution.localeCompare(a.institution);return l!==0?l:i.title.toLowerCase().localeCompare(a.title.toLowerCase())};return ce(n,i=>{i.subResources.sort(r)}),n.sort(r),n}function _s(s,t){const n=[],r=[],i=[];return Object.entries(t).forEach(([a,l])=>{l.forEach(c=>{let h=!1;ce(s,g=>{g.handle===c&&(h=!0,i.push(g))}),h||(console.warn("Handle not found in resources",c),r.push(c))})}),ce(i,a=>{n.push(a.id)}),{selected:n,unavailable:r}}function ce(s,t){const n=(r,i)=>{t(r,i)===!1||r.subResources.forEach(n)};s.forEach(n)}function re(s){const t=[];return ce(s,n=>{t.push(n.id)}),t}function ks(s,t,n){const r=[],i=a=>pt(a,i)||Ds(a,t,n);return ce(s,a=>{i(a)&&r.push(a.id)}),r}function Is(s,t){const n=new Set;return ce(s,r=>(t.includes(r.id)&&n.add(r.institution),!0)),Array.from(n)}function Ps(s,t){return!(t==="fcs"&&!s.endpoint.searchCapabilities.includes("ADVANCED_SEARCH")||t==="lex"&&!s.endpoint.searchCapabilities.includes("LEX_SEARCH"))}function Os(s,t){return!!(t===se||s.languages&&s.languages.length===1&&s.languages[0]===t||s.languages&&s.languages.indexOf(t)>=0)}function pt(s,t){if(!s.subResources||s.subResources.length===0)return!1;let n=!1;const r=i=>{if((t==null?void 0:t(i))===!0){n=!0;return}i.subResources.forEach(r)};return s.subResources.forEach(r),n}function Ds(s,t,n){return!(!Ps(s,t)||!Os(s,n))}const Hs={"title-up":(s,t)=>s.title.localeCompare(t.title),"title-down":(s,t)=>-s.title.localeCompare(t.title),"institution-up":(s,t)=>{const n=s.institution.localeCompare(t.institution);return n!==0?n:s.title.localeCompare(t.title)},"institution-down":(s,t)=>{const n=-s.institution.localeCompare(t.institution);return n!==0?n:s.title.localeCompare(t.title)}},Fs="modulepreload",Us=function(s,t){return new URL(s,t).href},et={},qs=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){let l=function(f){return Promise.all(f.map(j=>Promise.resolve(j).then(L=>({status:"fulfilled",value:L}),L=>({status:"rejected",reason:L}))))};const c=document.getElementsByTagName("link"),h=document.querySelector("meta[property=csp-nonce]"),g=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));i=l(n.map(f=>{if(f=Us(f,r),f in et)return;et[f]=!0;const j=f.endsWith(".css"),L=j?'[rel="stylesheet"]':"";if(!!r)for(let b=c.length-1;b>=0;b--){const R=c[b];if(R.href===f&&(!j||R.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${f}"]${L}`))return;const u=document.createElement("link");if(u.rel=j?"stylesheet":Fs,j||(u.as="script"),u.crossOrigin="",u.href=f,g&&u.setAttribute("nonce",g),document.head.appendChild(u),j)return new Promise((b,R)=>{u.addEventListener("load",b),u.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return i.then(l=>{for(const c of l||[])c.status==="rejected"&&a(c.reason);return t().catch(a)})};function jt(s,t){const[n,r]=o.useState(s);return o.useEffect(()=>{const i=setTimeout(()=>{r(s)},t);return()=>{clearTimeout(i)}},[s,t]),n}function He(s,t,n=0,r=t){var c,h,g,f;if(t===s&&t===r&&t.nodeType===Node.ELEMENT_NODE&&n===1)return t.nodeType,(c=t.textContent)==null||c.length,((h=t.textContent)==null?void 0:h.length)||0;if(t===s||s===null)return n;const i=t.parentNode;if(i===null)return n;let a=0;const l=i.childNodes;for(let j=0;j<l.length;j++){const L=l[j];if(L===t)break;L.nodeType===Node.TEXT_NODE?a+=((g=L.textContent)==null?void 0:g.length)||0:L.nodeType===Node.ELEMENT_NODE?a+=((f=L.textContent)==null?void 0:f.length)||0:console.warn("unknown node type",{container:s,node:t,offset:n,parent:i,i:j,child:L})}return He(s,i,a+n,r)}function bt(s,t){var a,l,c;const n=((a=s.textContent)==null?void 0:a.length)||0;if(n<t)return null;let r=0;const i=s.childNodes;for(let h=0;h<i.length;h++){const g=i[h];let f=0;if(g.nodeType===Node.TEXT_NODE?f=((l=g.textContent)==null?void 0:l.length)||0:g.nodeType===Node.ELEMENT_NODE?f=((c=g.textContent)==null?void 0:c.length)||0:console.warn("unknown node type, skip",{container:s,offset:t,child:g}),!(f===0&&i.length!==1)&&(r+=f,r>=t)){const j=t-(r-f);return g.nodeType===Node.ELEMENT_NODE?bt(g,j):{node:g,offset:j}}}return i.length,null}function Fe(s,t){if(!t)return null;const n=He(s,t.startContainer,t.startOffset);if(t.startContainer.nodeType===Node.TEXT_NODE&&t.endContainer===t.startContainer)return[n,n+(t.endOffset-t.startOffset)];const r=He(s,t.endContainer,t.endOffset);return[n,r]}function zs(s,t){if(!(document.activeElement===s))return null;const r=window.getSelection();if(!r)return null;const i=document.createRange(),a=bt(s,t);if(a)try{i.setStart(a.node,a.offset),i.collapse(!0),r.removeAllRanges(),r.addRange(i)}catch(l){console.error("Error trying to set cursor!",l,{container:s,offset:t,startRange:a})}}function tt(s){if(!(document.activeElement===s))return null;const n=window.getSelection();if(!n||n.rangeCount===0)return null;const r=n.getRangeAt(0),i=Fe(s,r);return i?i[0]:null}function Vs(s){return s==="cql"?"fcs-cql":s==="fcs"?"fcs-fcsql":s==="lex"?"fcs-lexcql":"plain"}function Ue(s,t){const n=Vs(t),r="match-braces rainbow-braces";let i=s;try{i=ts.highlight(s,n)}catch(l){console.warn("Error trying to highlight value",{value:s,error:l,language:n})}return`<pre><code class="language-${n} ${r}">${i}</code></pre>`}function ge(s){return s?(s=s.replace(/[\n\t]/g," "),s=s.replace(/&nbsp;|\u202F|\u00A0/g," "),s):""}const wt=Ht.forwardRef(({value:s,onChange:t,onCursorChange:n,disabled:r,placeholder:i,queryType:a,delay:l=200,...c},h)=>{const g=o.useRef(null),f=o.useRef(null);o.useImperativeHandle(h,()=>f.current);const[j,L]=o.useState(ge(s)),[k,u]=o.useState(null),b=jt(j,l),[R,p]=o.useState(b);o.useEffect(()=>{const x=Ue(b,a);if(p(x),f.current){const w=tt(f.current);u(w)}},[b,a]),o.useEffect(()=>{const x=ge(s);if(b!==x&&(L(x),p(Ue(x)),f.current)){const w=tt(f.current);u(w)}},[s,b]),o.useLayoutEffect(()=>{f.current&&k!==null&&zs(f.current,k)});function m(x){const w=x.target.innerText;g.current&&(g.current.value=w),L(w),t==null||t(w)}function q(x){x.stopPropagation(),x.preventDefault();const P=(x.clipboardData||window.clipboardData).getData("text");M(P)}function $(x){var w;x.key==="Enter"?(x.stopPropagation(),x.preventDefault(),g.current&&((w=g.current.form)==null||w.requestSubmit())):x.key==="Backspace"?(x.stopPropagation(),x.preventDefault(),U()):x.key==="Delete"?(x.stopPropagation(),x.preventDefault(),C()):x.ctrlKey&&x.key==="a"||u(null)}function N(x=!1){if(!f.current||!n)return;const w=f.current;if(!(document.activeElement===w))return;const T=window.getSelection();if(!T||T.rangeCount===0)return;const A=[];for(let d=0;d<T.rangeCount;d++){const y=T.getRangeAt(d),_=Fe(w,y);_&&A.push(_)}if(A.length===0)return;const[O,B]=A.pop();x?O===B&&(u(O),n==null||n(O)):n==null||n(O,O!==B?B:void 0)}function I(x){if(!f.current)return null;const w=f.current;if(!(document.activeElement===w))return null;const T=window.getSelection();if(!T||T.rangeCount===0)return null;const A=[];for(let y=0;y<T.rangeCount;y++){const _=T.getRangeAt(y),K=Fe(w,_);K&&A.push(K)}if(A.length===0)return null;A.sort();const O=A.map(([y,_])=>_-y).reduce((y,_)=>y+_,0),B=w.innerText,d=A.toReversed().reduce((y,[_,K])=>y.slice(0,_)+y.slice(K),B);if(x==="backspace"){if(O===0){const y=A.filter(([_,K])=>_===K).map(([,_])=>_).pop();if(y===0)return null;if(y!==void 0)return{value:d.slice(0,y-1)+d.slice(y),offset:y-1}}else{const y=A.map(([,_])=>_).pop();if(y!==void 0)return{value:d,offset:y-O}}return console.warn('invalid "backspace" process, abort',{container:w,selectionIndices:A,oldValue:B,newValueSpansRemoved:d,numDeleted:O}),null}else if(x==="delete"){if(O===0){const y=A.filter(([_,K])=>_===K).map(([,_])=>_).pop();if(y!==void 0)return{value:d.slice(0,y)+d.slice(y+1),offset:y}}else{const y=A.map(([,_])=>_).pop();if(y!==void 0)return{value:d,offset:y-O}}return console.warn('invalid "delete" process, abort',{container:w,selectionIndices:A,oldValue:B,newValueSpansRemoved:d,numDeleted:O}),null}else if(x==="paste"){if(O===0){const y=A.filter(([_,K])=>_===K).map(([_])=>_).shift();if(y!==void 0)return{value:d,offset:y}}else{const y=A.map(([_])=>_).shift();if(y!==void 0)return{value:d,offset:y}}return console.warn('invalid "paste" process, abort',{container:w,selectionIndices:A,oldValue:B,newValueSpansRemoved:d,numDeleted:O}),null}}function M(x){const w=I("paste");if(!w)return;const P=ge(x),{value:T,offset:A}=w,O=T.slice(0,A)+P+T.slice(A),B=A+x.length;L(O),u(B),g.current&&(g.current.value=O),t==null||t(O),n==null||n(B)}function U(){const x=I("backspace");if(!x)return;const{value:w,offset:P}=x,T=ge(w);L(T),u(P),g.current&&(g.current.value=T),t==null||t(T),n==null||n(P)}function C(){const x=I("delete");if(!x)return;const{value:w,offset:P}=x,T=ge(w);L(T),u(P),g.current&&(g.current.value=T),t==null||t(T),n==null||n(P)}return e.jsxs(e.Fragment,{children:[e.jsx("div",{role:"input",disabled:r,placeholder:i,spellCheck:!1,autoCapitalize:"off",autoCorrect:"off",...c,onInput:m,onPaste:q,onKeyDown:$,onKeyUp:()=>N(),onClick:()=>N(!0),tabIndex:r?-1:c.tabIndex,contentEditable:!0,dangerouslySetInnerHTML:{__html:R},ref:f}),i&&s===""&&e.jsx("span",{className:"input-placeholder-simulacrum",children:i}),e.jsx("input",{type:"hidden",ref:g})]})});wt.displayName="ContentEditable";var Z=Ft();function $s({show:s,languages:t,resources:n,searchLanguage:r,searchLanguageFilter:i,onModalClose:a}){const[l,c]=o.useState(r||se),[h,g]=o.useState(i||De),[f,j]=o.useState(""),[L,k]=o.useState(!1),u=o.useMemo(()=>{const N=new Map;return n&&(n.forEach(I=>I.languages.forEach(M=>N.set(M,(N.get(M)??0)+1))),N.set(se,n.length)),N},[n]),b=Z.useFuzzySearchList({list:Object.entries(t??{}).toSorted(),queryText:f,getText:N=>[N[0],N[1]],mapResultItem:({item:N,score:I,matches:M})=>({item:N,matches:M,score:I})});if(!t)return null;const R=Math.floor((b.length+2)/3);function p(N){a({language:l,filter:h,action:N})}function m(){c(r||se),g(i||De)}function q(){k(N=>!N)}function $(N,I,M,U){const C=l===N;let x="d-block py-0 my-1 border-0";return C&&(x+=" fw-semibold selected"),M===void 0&&(M=[null,null]),e.jsxs(z,{size:"sm",className:x,style:{color:`var(${C?"--bs-green":"--bs-body-colors"})`,backgroundColor:"var(--bs-body-bg)"},onClick:()=>c(N),"data-filter-score":U,children:[C&&e.jsx("span",{className:"selected-marker me-1",children:"✓"}),e.jsx(Z.Highlight,{ranges:M[1],text:I})," ",e.jsx("sup",{children:e.jsx(Z.Highlight,{ranges:M[0],text:N})}),L&&u.has(N)&&e.jsxs(e.Fragment,{children:[" (",u.get(N),")"]})]},N)}return e.jsxs(Q,{show:s,onHide:()=>p("close"),size:"xl",fullscreen:"lg-down",centered:!0,children:[e.jsx(Q.Header,{closeButton:!0,children:e.jsx(Q.Title,{children:"Languages"})}),e.jsxs(Q.Body,{className:"px-0",children:[e.jsxs(X,{className:"px-4 pb-3 border-bottom",children:[e.jsxs(G,{children:[e.jsx(E,{sm:!0}),e.jsx(E,{sm:!0,className:"mb-3 mb-sm-2 align-content-end",children:$(se,be(se))}),e.jsxs(E,{sm:!0,children:[e.jsx(F.Control,{size:"sm",placeholder:"Filter languages ...",name:"languages-filter",value:f,onChange:N=>j(N.target.value)}),n&&e.jsx(F.Check,{name:"languages-show-count",id:"languages-show-count",checked:L,onChange:q,type:"checkbox",label:"Show number of resources per language",className:"mt-1"})]})]}),e.jsxs(G,{children:[e.jsx(E,{sm:!0,children:b.slice(0,R).map(({item:[N,I],matches:M,score:U})=>$(N,I,M,U))}),e.jsx(E,{sm:!0,children:b.slice(R,2*R).map(({item:[N,I],matches:M,score:U})=>$(N,I,M,U))}),e.jsx(E,{sm:!0,children:b.slice(2*R).map(({item:[N,I],matches:M,score:U})=>$(N,I,M,U))})]})]}),e.jsx(F,{children:e.jsxs(X,{className:"px-4 pt-3",children:[e.jsx(F.Check,{type:"radio",name:"filterOpts",value:"byMeta",id:"filterOpts-byMeta",checked:h==="byMeta",onChange:()=>g("byMeta"),label:"Use the resources' specified language to filter results"}),e.jsx(F.Check,{type:"radio",name:"filterOpts",value:"byGuess",id:"filterOpts-byGuess",checked:h==="byGuess",onChange:()=>g("byGuess"),label:"Filter results by using a language detector"}),e.jsx(F.Check,{type:"radio",name:"filterOpts",value:"byMetaAndGuess",id:"filterOpts-byMetaAndGuess",checked:h==="byMetaAndGuess",onChange:()=>g("byMetaAndGuess"),label:"First use the resources' specified language then also use a language detector"})]})})]}),e.jsxs(Q.Footer,{children:[e.jsx(z,{variant:"secondary",onClick:m,children:"Revert Selection"}),e.jsx(z,{variant:"secondary",onClick:()=>p("abort"),children:"Abort"}),e.jsx(z,{variant:"primary",onClick:()=>p("confirm"),children:"Confirm and Close"})]})]})}const Ge=[{id:"cql",name:"Text layer Contextual Query Language (CQL)",searchLabel:"Full-text search",color:"#29a900",searchPlaceholder:"Elephant"},{id:"fcs",name:"Multi-layer Federated Content Search Query Language (FCS-QL)",searchLabel:"Multi-layer annotation search",color:"#00a8cc",searchPlaceholder:"[word = 'annotation'][word = 'focused']"},{id:"lex",name:"Lexical Resources Contextual Query Language (LexCQL)",searchLabel:"Lexical resource search",color:"#e77e00",searchPlaceholder:"banana"}],Ne=Object.fromEntries(["cql","fcs","lex"].map(s=>[s,Ge.find(t=>t.id===s)])),st=["fcs","lex"],Bs=[{id:"text",label:"Plain Text"},{id:"csv",label:"CSV"},{id:"tcf",label:"TCF"},{id:"ods",label:"ODS"},{id:"excel",label:"Excel"}],Qs="cql",ve=[10,20,50,100,200,250],le="info:srw/diagnostic/1/61",Gs=[{queryType:"cql",query:"Elephant",description:"Query with single term"},{queryType:"cql",query:"cat AND dog",description:"Query with boolean"},{queryType:"cql",query:'"exciting news"',description:"Query with phrase (quoting because of whitespaces)"},{queryType:"fcs",query:'[ word = "her.*" ] [ lemma = "Artznei" ] [ pos = "VERB" ]',description:'Phrase with three tokens: a word starting with "her", a lemmatized word, and a verb'},{queryType:"lex",query:"apple",description:"Search for plain string"}];function Ks({show:s,queryTypes:t,onModalClose:n}){const r=t&&t.length>0?t:["cql","fcs","lex"],i=Gs.filter(h=>r.includes(h.queryType));if(i.length===0)return a("abort"),null;function a(h){n({query:void 0,queryType:void 0,action:h})}function l(h,g){n({query:h,queryType:g,action:"confirm"})}function c(h,g,f,j){return e.jsxs(G,{children:[e.jsx(E,{md:"auto",className:"d-none d-md-block",children:j&&`${j}.`}),e.jsxs(E,{className:"d-flex flex-column",children:[f!==void 0&&e.jsx("div",{children:f}),e.jsx("div",{dangerouslySetInnerHTML:{__html:Ue(h,g)}})]}),e.jsx(E,{md:"auto",className:"d-flex justify-content-end align-items-baseline",children:e.jsx(z,{size:"sm",onClick:()=>l(h,g),children:"Use Query"})})]},h)}return e.jsxs(Q,{id:"search-query-suggestions-modal",show:s,onHide:()=>a("close"),size:"xl",fullscreen:"xl-down",centered:!0,children:[e.jsx(Q.Header,{closeButton:!0,children:e.jsx(Q.Title,{children:"Search Query Suggestions"})}),e.jsx(Q.Body,{className:"px-0",children:e.jsx(X,{fluid:!0,children:r.map(h=>{var f;const g=i.filter(j=>j.queryType===h);return g.length===0?null:e.jsxs(o.Fragment,{children:[e.jsx(G,{children:e.jsx(E,{children:e.jsx("h4",{className:"border-bottom pb-2",children:((f=Ne[h])==null?void 0:f.name)??h.toUpperCase()})})}),g.map((j,L)=>c(j.query,j.queryType,j.description,L+1))]},h)})})}),e.jsx(Q.Footer,{children:e.jsx(z,{variant:"primary",onClick:()=>a("close"),children:"Close"})})]})}function yt({disabled:s,value:t,onChange:n,delay:r=300}){const[i,a]=o.useState(t??""),l=jt(i,r);return o.useEffect(()=>{n(l)},[n,l]),e.jsx(F.Control,{type:"search",placeholder:"Search for ...",value:i,onChange:c=>a(c.target.value),disabled:s})}const Ae=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bank" viewBox="0 0 16 16">
  <path d="m8 0 6.61 3h.89a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5H15v7a.5.5 0 0 1 .485.38l.5 2a.498.498 0 0 1-.485.62H.5a.498.498 0 0 1-.485-.62l.5-2A.5.5 0 0 1 1 13V6H.5a.5.5 0 0 1-.5-.5v-2A.5.5 0 0 1 .5 3h.89zM3.777 3h8.447L8 1zM2 6v7h1V6zm2 0v7h2.5V6zm3.5 0v7h1V6zm2 0v7H12V6zM13 6v7h1V6zm2-1V4H1v1zm-.39 9H1.39l-.25 1h13.72z"/>
</svg>`,St=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house-door" viewBox="0 0 16 16">
  <path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4z"/>
</svg>`,Ee=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-translate" viewBox="0 0 16 16">
  <path d="M4.545 6.714 4.11 8H3l1.862-5h1.284L8 8H6.833l-.435-1.286zm1.634-.736L5.5 3.956h-.049l-.679 2.022z"/>
  <path d="M0 2a2 2 0 0 1 2-2h7a2 2 0 0 1 2 2v3h3a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-3H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zm7.138 9.995q.289.451.63.846c-.748.575-1.673 1.001-2.768 1.292.178.217.451.635.555.867 1.125-.359 2.08-.844 2.886-1.494.777.665 1.739 1.165 2.93 1.472.133-.254.414-.673.629-.89-1.125-.253-2.057-.694-2.82-1.284.681-.747 1.222-1.651 1.621-2.757H14V8h-3v1.047h.765c-.318.844-.74 1.546-1.272 2.13a6 6 0 0 1-.415-.492 2 2 0 0 1-.94.31"/>
</svg>`;function Ke({resource:s,selectedResourceIDs:t,highlighting:n,shouldBeShown:r,onSelectClick:i,languageCodeToName:a}){const[l,c]=o.useState(!1),[h,g]=o.useState(!1);n===void 0&&(n=[null,null,null]);const f=t.includes(s.id);if(typeof r=="function"&&!r(s))return null;if(r===!1)return null;function j(){var u;l&&((u=document.getSelection())==null?void 0:u.type)==="Range"||c(b=>!b)}function L(){i(s,!f)}function k(){g(u=>!u)}return e.jsxs(e.Fragment,{children:[e.jsxs(G,{className:`p-2 m-1 ${l&&"border-bottom"}`,children:[e.jsx(E,{md:"auto",sm:1,onClick:L,children:e.jsx(F.Check,{id:`resource-selection-${s.id}`,"aria-label":`Checkbox for resource: ${s.title}`,children:e.jsx(F.Check.Input,{checked:f,onChange:()=>{}})})}),e.jsxs(E,{md:8,sm:11,className:`mb-sm-2 ${l?"":"text-truncate"}`,onClick:j,children:[e.jsxs("h4",{className:`h5 ${l?"":"text-truncate"}`,children:[e.jsx(Z.Highlight,{text:s.title,ranges:n[0]})," ",s.landingPage&&e.jsx("small",{children:e.jsxs("a",{href:s.landingPage,className:"matomo_link",target:"_blank",children:["More information ",e.jsx("i",{dangerouslySetInnerHTML:{__html:St}})]})})]}),e.jsx("p",{className:`mb-0 ${l?"":"text-truncate"}`,children:s.description&&e.jsx(Z.Highlight,{text:s.description,ranges:n[2]})})]}),e.jsxs(E,{md:{span:3,offset:0},sm:{span:11,offset:1},className:`${l?"":" text-truncate"}`,onClick:j,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ae}})," ",e.jsx(Z.Highlight,{text:s.institution,ranges:n[1]}),e.jsx("br",{}),e.jsx("i",{dangerouslySetInnerHTML:{__html:Ee}})," ",s.languages.map(a).sort().join(", ")]}),s.subResources.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-100"}),e.jsx(E,{md:"auto",sm:1,style:{width:"2.8rem"}}),e.jsx(E,{md:{span:8,offset:0},sm:{span:11,offset:1},children:e.jsxs(z,{variant:"link",size:"sm",className:"ps-0",onClick:k,children:[h?"Collapse":"Expand"," (",s.subResources.length," ","subresources)"]})})]})]}),h&&e.jsx(Y,{className:"ms-md-5 ms-sm-2 border-end-0 border-top-0 rounded-end-0 rounded-top-0",children:s.subResources.map(u=>e.jsx(Ke,{resource:u,selectedResourceIDs:t,shouldBeShown:r,onSelectClick:i,languageCodeToName:a},u.id))})]})}function nt({title:s,resources:t,selectedResourceIDs:n,expanded:r,shouldBeShown:i,onSelectClick:a,onExpandToggleClick:l,onSelectAllClick:c,onDeselectAllClick:h,languageCodeToName:g}){const[f,j]=o.useState(r);o.useEffect(()=>{j(r)},[r]);function L(){j(u=>!u),l(!f)}function k(){const u=re(t).length,b=t.length,R=re(t).filter(p=>n.includes(p)).length;return e.jsxs(e.Fragment,{children:[b," ",u!==b&&e.jsxs(e.Fragment,{children:["(+ ",u-b," nested)"]})," ","Resource",u!==1?"s":"",R!==u&&e.jsxs(e.Fragment,{children:[", ",R," Resource",R!==1?"s":""," selected"]})]})}return e.jsxs(X,{className:"border-bottom pb-2 mb-4 px-0",children:[e.jsxs(G,{className:"px-3",children:[e.jsx(E,{md:9,sm:12,children:e.jsx("h3",{children:s})}),e.jsxs(E,{md:3,sm:12,className:"gap-1 d-inline-flex column-gap-2 justify-content-evenly",style:{height:"fit-content"},children:[e.jsxs(z,{size:"sm",variant:"secondary",onClick:L,"aria-expanded":f,children:[f?"Hide":"Show"," Resources"]}),e.jsx(z,{size:"sm",onClick:()=>c(t),children:"Select All"}),e.jsx(z,{size:"sm",onClick:()=>h(t),children:"Deselect All"})]})]}),e.jsx(G,{className:"px-3",children:e.jsx(E,{children:k()})}),e.jsx(ht,{in:f,children:e.jsx(X,{children:t.map(u=>e.jsx(Ke,{resource:u,selectedResourceIDs:n,shouldBeShown:i,onSelectClick:a,languageCodeToName:g},u.id))})})]})}function Ws({show:s,showGrouping:t,resources:n,languages:r,availableResources:i,selectedResources:a,onModalClose:l}){const[c,h]=o.useState(a||i),[g,f]=o.useState(As),[j,L]=o.useState(ft),[k,u]=o.useState(Es),[b,R]=o.useState(""),[p,m]=o.useState({}),[q,$]=o.useState({});o.useEffect(()=>{t&&L(t)},[s,t]),o.useEffect(()=>h(a),[a]);const N=n.filter(v=>i.includes(v.id)).toSorted(Hs[k]),I=Z.useFuzzySearchList({list:N,queryText:j==="resource"?b:"",getText:v=>[v.title,v.institution,v.description],mapResultItem:({item:v,score:V,matches:W})=>({item:v,matches:W,score:V})});if(o.useMemo(()=>{const v={},V={};n.forEach(W=>{const ee=W.institution;Object.getOwnPropertyNames(v).includes(ee)||(v[ee]={expanded:!0,resources:[]}),v[ee].resources.push(W),W.languages.forEach(he=>{Object.getOwnPropertyNames(V).includes(he)||(V[he]={expanded:!0,resources:[]}),V[he].resources.push(W)})}),m(v),$(V)},[n]),!n)return null;const M={total:re(n).length,totalRoot:n.length,available:i.length,selected:c.length,visible:re(I.map(v=>v.item)).length,visibleRoot:I.length};function U(v){return be(v,r)}function C(v,V){const W=c.filter(ee=>!v.includes(ee));h(V?[...W,...v]:W)}function x(v){l({resourceIDs:c,action:v})}function w(v){f(v.target.value)}function P(v){L(v.target.value)}function T(v){u(v.target.value)}function A(){h(i)}function O(){h([])}function B(){h(I.map(v=>v.item.id))}function d(v,V){C(re([v]),V)}function y(v){C(re(v),!0)}function _(v){C(re(v),!1)}function K(v){return!(!i.includes(v.id)||g==="selected"&&!c.includes(v.id)&&!pt(v,V=>c.includes(V.id)))}function _e(){return j==="institution"?Object.entries(p).toSorted().map(([v,{expanded:V,resources:W}])=>e.jsx(nt,{title:e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ae}})," ",v]}),resources:W,selectedResourceIDs:c,expanded:V,shouldBeShown:K,onSelectAllClick:y,onExpandToggleClick:ee=>{m({...p,[v]:{...p[v],expanded:ee}})},onDeselectAllClick:_,onSelectClick:d,languageCodeToName:U},v)):j==="language"?Object.entries(q).toSorted().map(([v,{expanded:V,resources:W}])=>e.jsx(nt,{title:e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ee}})," ",U(v)," [",v,"]"]}),resources:W,selectedResourceIDs:c,expanded:V,shouldBeShown:K,onSelectAllClick:y,onExpandToggleClick:ee=>q[v].expanded=ee,onDeselectAllClick:_,onSelectClick:d,languageCodeToName:U},v)):I.map(({item:v,matches:V})=>e.jsx(Ke,{resource:v,selectedResourceIDs:c,highlighting:V,shouldBeShown:K,onSelectClick:d,languageCodeToName:U},v.id))}return e.jsxs(Q,{id:"resource-selection-modal",show:s,onHide:()=>x("close"),size:"xl",fullscreen:"xl-down",centered:!0,children:[e.jsx(Q.Header,{closeButton:!0,children:e.jsx(Q.Title,{children:"Resources"})}),e.jsxs(Q.Body,{className:"px-0",children:[e.jsx(F,{className:"px-3 pb-3 border-bottom",onSubmit:v=>v.preventDefault(),children:e.jsx(X,{children:e.jsxs(G,{className:"d-sm-flex row-gap-2 justify-content-around",children:[e.jsx(E,{md:2,sm:6,children:e.jsx(ie,{label:"View",controlId:"resource-view-options-visibility",children:e.jsxs(F.Select,{value:g,onChange:w,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"selected",children:"Selected only"})]})})}),e.jsx(E,{md:2,sm:6,children:e.jsx(ie,{label:"Group by",controlId:"resource-view-options-grouping",children:e.jsxs(F.Select,{value:j,onChange:P,children:[e.jsx("option",{value:"resource",children:"(Resource)"}),e.jsx("option",{value:"institution",children:"Institution"}),e.jsx("option",{value:"language",children:"Language"})]})})}),e.jsx(E,{md:2,sm:6,children:e.jsx(ie,{label:"Sort by",controlId:"resource-view-options-sorting",children:e.jsxs(F.Select,{value:k,onChange:T,disabled:j!=="resource"||b.trim()!=="",children:[e.jsx("option",{value:"title-up",children:"Title (up)"}),e.jsx("option",{value:"title-down",children:"Title (down)"}),e.jsx("option",{value:"institution-up",children:"Institution (up)"}),e.jsx("option",{value:"institution-down",children:"Institution (down)"})]})})}),e.jsx(E,{md:3,sm:12,children:e.jsx(ie,{label:"Resource filter query",controlId:"resource-view-options-filter",children:e.jsx(yt,{disabled:j!=="resource",value:b,onChange:v=>R(v)})})}),e.jsxs(E,{md:3,sm:12,className:"gap-1 d-inline-flex column-gap-2 justify-content-evenly",children:[e.jsx(z,{onClick:A,children:"Select all"}),e.jsx(z,{onClick:B,disabled:g!=="all"||b.trim()==="",children:"Select visible"}),e.jsx(z,{onClick:O,children:"Deselect all"})]})]})})}),e.jsxs("p",{className:"m-4 mb-0",children:[M.selected," / ",M.visible," ",M.available!==M.visible&&e.jsxs(e.Fragment,{children:["(",M.available,")"]})," ","resources selected."]}),e.jsx(X,{className:"px-3 pt-3",children:_e()})]}),e.jsx(Q.Footer,{children:e.jsx(z,{variant:"primary",onClick:()=>x("confirm"),children:"Confirm and Close"})})]})}function Ys(){const[s,t]=o.useState(!1);return[s,()=>{s!==!0&&t(!0)}]}const Xs=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-balloon" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 9.984C10.403 9.506 12 7.48 12 5a4 4 0 0 0-8 0c0 2.48 1.597 4.506 4 4.984M13 5c0 2.837-1.789 5.227-4.52 5.901l.244.487a.25.25 0 1 1-.448.224l-.008-.017c.008.11.02.202.037.29.054.27.161.488.419 1.003.288.578.235 1.15.076 1.629-.157.469-.422.867-.588 1.115l-.004.007a.25.25 0 1 1-.416-.278c.168-.252.4-.6.533-1.003.133-.396.163-.824-.049-1.246l-.013-.028c-.24-.48-.38-.758-.448-1.102a3 3 0 0 1-.052-.45l-.04.08a.25.25 0 1 1-.447-.224l.244-.487C4.789 10.227 3 7.837 3 5a5 5 0 0 1 10 0m-6.938-.495a2 2 0 0 1 1.443-1.443C7.773 2.994 8 2.776 8 2.5s-.226-.504-.498-.459a3 3 0 0 0-2.46 2.461c-.046.272.182.498.458.498s.494-.227.562-.495"/>
</svg>`,Re=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear-fill" viewBox="0 0 16 16">
  <path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z"/>
</svg>`,Js=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-highlights" viewBox="0 0 16 16">
  <path d="M16 8A8 8 0 1 0 0 8a8 8 0 0 0 16 0m-8 5v1H4.5a.5.5 0 0 0-.093.009A7 7 0 0 1 3.1 13zm0-1H2.255a7 7 0 0 1-.581-1H8zm-6.71-2a7 7 0 0 1-.22-1H8v1zM1 8q0-.51.07-1H8v1zm.29-2q.155-.519.384-1H8v1zm.965-2q.377-.54.846-1H8v1zm2.137-2A6.97 6.97 0 0 1 8 1v1z"/>
</svg>`,Zs=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-magic" viewBox="0 0 16 16">
  <path d="M9.5 2.672a.5.5 0 1 0 1 0V.843a.5.5 0 0 0-1 0zm4.5.035A.5.5 0 0 0 13.293 2L12 3.293a.5.5 0 1 0 .707.707zM7.293 4A.5.5 0 1 0 8 3.293L6.707 2A.5.5 0 0 0 6 2.707zm-.621 2.5a.5.5 0 1 0 0-1H4.843a.5.5 0 1 0 0 1zm8.485 0a.5.5 0 1 0 0-1h-1.829a.5.5 0 0 0 0 1zM13.293 10A.5.5 0 1 0 14 9.293L12.707 8a.5.5 0 1 0-.707.707zM9.5 11.157a.5.5 0 0 0 1 0V9.328a.5.5 0 0 0-1 0zm1.854-5.097a.5.5 0 0 0 0-.706l-.708-.708a.5.5 0 0 0-.707 0L8.646 5.94a.5.5 0 0 0 0 .707l.708.708a.5.5 0 0 0 .707 0l1.293-1.293Zm-3 3a.5.5 0 0 0 0-.706l-.708-.708a.5.5 0 0 0-.707 0L.646 13.94a.5.5 0 0 0 0 .707l.708.708a.5.5 0 0 0 .707 0z"/>
</svg>`,en=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
  <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
</svg>`,tn=o.lazy(()=>qs(()=>import("./fcs-sru-aggregator-ui-query-builder-0.0.0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url));function rt(s,t=""){const n=s.get("query");return n||t}function it(s,t="cql"){const n=s.get("queryType");if(n){if(Ge.find(r=>r.id===n)!==void 0)return n;console.warn("Found unsupported queryType in search params",n)}return t}function sn({resources:s,languages:t,onSearch:n,availableResources:r=null,selectedResources:i=null,hasSearch:a=!1,disabled:l=!1}){var Ye;const[c,h]=Le(),[g,f]=o.useState(!1),[j,L]=o.useState(ft),[k,u]=o.useState(!1),[b,R]=o.useState(!1),[p,m]=o.useState(!1),[q,$]=Ys(),[N,I]=o.useState(se),[M,U]=o.useState(De),[C,x]=o.useState(it(c,Qs)),[w,P]=o.useState(r??[]),[T,A]=o.useState(i??[]),[O,B]=o.useState(ve[0]),[d,y]=o.useState(rt(c,"")),[_]=o.useState(null),[K,_e]=o.useState(!1);o.useEffect(()=>{A(i??[])},[i]);const v=o.useCallback(S=>{const D=ks(S,C,M==="byGuess"?se:N);return r&&r.length>0?D.filter(te=>r.includes(te)):D},[C,N,M,r]);o.useEffect(()=>{const S=v(s);P(S),A(D=>D.filter(te=>S.includes(te)))},[s,v]);const V=o.useCallback(()=>{const S={language:N,languageFilter:M,queryType:C,query:d,resourceIDs:T??[],numberOfResults:O};S.query!==""&&S.resourceIDs.length!==0&&n(S)},[N,M,O,n,d,C,T]);o.useEffect(()=>{if(c&&(y(D=>rt(c,D)),x(D=>it(c,D)),!c.get("x-aggregation-context"))){const D=c.get("mode");D&&(D==="search"&&V(),h(te=>(te.delete("mode"),te)))}},[c,h,V]),o.useEffect(()=>h(S=>(S.set("query",d),S)),[d,h]),o.useEffect(()=>h(S=>(S.set("queryType",C),S)),[C,h]);const W=Is(s,T??[]).length,ee=s.find(S=>S.searchCapabilitiesResolved.includes("ADVANCED_SEARCH"))!==void 0,he=s.find(S=>S.searchCapabilitiesResolved.includes("LEX_SEARCH"))!==void 0,Tt=st.includes(C);function At(S){S&&x(S)}function Et(S){let D=Number.parseInt(S.target.value);D<10&&(D=10),D>250&&(D=250),ve.includes(D)||console.warn("Invalid number of results?!",{valid:ve,value:D}),B(D)}function Mt({language:S,filter:D,action:te}){u(!1),te!=="abort"&&(I(S),U(D))}function _t({resourceIDs:S,action:D}){f(!1),D!=="abort"&&A(S)}function kt({query:S,queryType:D,action:te}){R(!1),te!=="abort"&&te!=="close"&&(!S||!D||(x(D),y(S)))}function It({query:S,action:D}){m(!1),D!=="abort"&&D!=="close"&&y(S)}function We(S){y(S)}function Pt(S){S.preventDefault(),V()}function Ot(){const S=(T??[]).length;return S===1?"1 selected resource":s.length===S||w.length===S?`All available resources (${S})`:`${S} selected resources`}return e.jsxs("search",{id:"fcs-query",children:[e.jsxs(F,{noValidate:!0,onSubmit:Pt,children:[e.jsxs(Jt,{size:a?void 0:"lg",hasValidation:!0,children:[e.jsx(z,{variant:"outline-secondary",type:"button",id:"fcs-search-query-suggestions-button","aria-label":"Open modal with suggestions for search queries",onClick:()=>R(!0),children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Xs},"aria-hidden":"true"})}),e.jsx(F.Control,{placeholder:"Elephant","aria-label":"search query input","aria-describedby":"fcs-search-input-button",className:"text-center search-query-input",disabled:l,"aria-disabled":l,value:d,isInvalid:!!_,...K?{as:wt,queryType:C,onChange:We}:{onChange:S=>We(S.target.value)}}),Tt&&e.jsx(z,{id:"fcs-search-input-query-builder-button",variant:"outline-secondary","aria-label":"Open modal to use the visual query builder to construct a search query",className:"border-end-0 d-none d-md-block",onClick:()=>{$(),m(!0)},children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Zs},"aria-hidden":"true"})}),e.jsx(Zt,{id:"fcs-search-input-enhanced-button",value:"enhance-query",type:"checkbox",checked:K,onChange:()=>_e(S=>!S),variant:"outline-secondary","aria-label":"Enable enhanced visual input support with syntax highlighting",className:"d-flex align-items-center border-end-0",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Js},"aria-hidden":"true"})}),e.jsxs(z,{variant:"outline-primary",type:"submit",id:"fcs-search-input-button",disabled:l||d.trim().length===0,"aria-disabled":l,"aria-label":"Start the search",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:en},"aria-hidden":"true",className:"d-inline d-md-none"}),e.jsx("span",{className:"d-none d-md-inline",children:"Search"})]}),e.jsx(F.Control.Feedback,{type:"invalid",children:_==null?void 0:_.msg})]}),e.jsxs("div",{id:"fcs-query-filters",className:"mt-2 mb-3 lh-lg text-center",children:["Perform a"," ",e.jsxs(ae,{className:"d-inline-block",onSelect:At,"aria-disabled":l,"aria-label":"Search query type",children:[e.jsxs(ae.Toggle,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2 no-arrow",disabled:l,"aria-disabled":l,style:Ne[C]?{"--color":Ne[C].color}:{},children:[((Ye=Ne[C])==null?void 0:Ye.searchLabel)||"???"," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:Re},"aria-hidden":"true"})]}),e.jsx(ae.Menu,{children:Ge.filter(S=>S.id==="cql"||S.id==="fcs"&&ee||S.id==="lex"&&he).map(S=>e.jsx(ae.Item,{as:"button",eventKey:S.id,onClick:D=>D.preventDefault(),style:{"--color":S.color,background:"color-mix(in srgb, var(--color) 50%, transparent)"},children:S.name},S.id))})]})," ","in"," ",e.jsxs(z,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2",disabled:l,"aria-disabled":l,onClick:()=>{L("resource"),f(!0)},children:[Ot()," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:Re},"aria-hidden":"true"})]})," ","from"," ",e.jsxs(z,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2",disabled:l,"aria-disabled":l,onClick:()=>{L("institution"),f(!0)},children:[W," Institution",W!==1?"s":""," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:Re},"aria-hidden":"true"})]})," ","in"," ",e.jsxs(z,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2",onClick:()=>u(!0),disabled:l,"aria-disabled":l,children:[be(N,t??{})," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:Re},"aria-hidden":"true"})]})," ","with up to"," ",e.jsx(F.Select,{size:"sm",className:"d-inline-block w-auto mx-1",onChange:Et,value:O,"aria-label":"Number of search results per endpoint",disabled:l,"aria-disabled":l,children:ve.map(S=>e.jsx("option",{value:S,children:S},S))})," ","results per endpoint."]})]}),e.jsx($s,{languages:t,resources:s,searchLanguage:N,show:k,onModalClose:Mt}),e.jsx(Ws,{resources:s,languages:t,availableResources:w,selectedResources:T??[],show:g,showGrouping:j,onModalClose:_t}),e.jsx(Ks,{queryTypes:[C],show:b,onModalClose:kt}),st.includes(C)&&q&&e.jsx(o.Suspense,{fallback:e.jsx(e.Fragment,{children:"Trying to load Query Builder extension ..."}),children:e.jsx(tn,{query:d,queryType:C,resources:s,selectedResources:T,show:p,onModalClose:It})})]})}const nn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots" viewBox="0 0 16 16">
  <path d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"/>
</svg>`;function rn({searchId:s,resourceId:t,numberOfResults:n,pollDelay:r=1500}){const i=ue(),a=ot(),[l,c]=o.useState(!1),{isPending:h,mutate:g,reset:f}=ct({mutationFn:ls.bind(null,i,s,{resourceId:t,numberOfResults:n}),mutationKey:["search-result-load-more",s,t],onSuccess:async m=>{m!==void 0&&s!==m&&console.warn("SearchIDs should be the same?!",{searchId:s,searchIdNewButSame:m,resourceId:t}),await a.invalidateQueries({queryKey:["search-results",s,t]}),c(!0)}});r??(r=1500);const{data:j,isLoading:L,isFetching:k}=fe({queryKey:["search-results",s,t],queryFn:cs.bind(null,i,s,t),enabled:l,refetchInterval(m){return m.state.data&&m.state.data.inProgress?r:!1}}),u=h||L||k,b=!!j&&!j.inProgress,R=u||l;l&&b&&(l&&c(!1),a.invalidateQueries({queryKey:["search-result-details",s,t]}));async function p(){f(),g()}return e.jsx(z,{className:"more-results-button",disabled:R,onClick:p,children:R?e.jsx(mt,{animation:"border",className:"d-block"}):e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:nn}})," Load more results"]})})}const Me=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link-45deg" viewBox="0 0 16 16">
  <path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1 1 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4 4 0 0 1-.128-1.287z"/>
  <path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243z"/>
</svg>`;function vt({data:s}){const t=o.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs(qe,{hover:!0,responsive:!0,className:"mb-0 results-kwic",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Left Context"}),e.jsx("th",{scope:"col",children:"Hit"}),e.jsx("th",{scope:"col",children:"Right Context"})]})}),e.jsx("tbody",{children:s.kwics.map((n,r)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"text-end text-muted d-none d-sm-table-cell",children:r+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[n.reference&&e.jsx("a",{href:n.reference,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Me}})})," ",n.pid&&e.jsx(de,{placement:"auto-start",container:t,delay:{show:250,hide:400},overlay:e.jsx(pe,{id:`ttip-${n.pid}-${r}`,children:n.pid}),children:e.jsx(oe,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:n.left}),e.jsx("td",{children:e.jsx("mark",{children:e.jsx("strong",{children:n.keyword})})}),e.jsx("td",{children:n.right})]},`${n.pid??n.reference??s.resource.id}-${r}`))})]}),e.jsx("div",{ref:t,className:"tooltip-mounting-point"})]})}function Rt({data:s}){const t=o.useRef(null);return e.jsxs("div",{className:"results-lexical-entry d-flex flex-column flex-wrap column-gap-2 row-gap-2",children:[s.lexEntries.map((n,r)=>e.jsx(Y,{className:"flex-grow-1",children:e.jsxs(Y.Body,{children:[e.jsx(Y.Title,{children:n.fields.filter(i=>i.type==="lemma").map(i=>i.values).flat(1).map(i=>e.jsx("span",{children:i.value}))}),e.jsxs(ke,{variant:"flush",children:[(n.lang||n.langUri)&&e.jsxs(ke.Item,{children:[e.jsx("strong",{children:"lang"}),": ",n.lang," ",n.langUri]}),n.fields.filter(i=>i.type!=="lemma").map(i=>e.jsxs(ke.Item,{children:[e.jsx("strong",{children:i.type}),":",i.values.map((a,l)=>e.jsx("span",{className:"ms-2 lex-value",children:a.value},l))]},i.type))]}),e.jsx(Y.Link,{children:n.reference&&e.jsxs("a",{href:n.reference,className:"matomo_link",target:"_blank",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Me}})," Original results ..."]})}),e.jsx(Y.Link,{children:n.pid&&e.jsx(de,{placement:"auto-start",container:t,delay:{show:250,hide:400},overlay:e.jsx(pe,{id:`ttip-${n.pid}-${r}`,children:n.pid}),children:e.jsx(oe,{bg:"secondary",className:"pid-badge",children:"PID"})})})]})},`${n.pid??n.reference??s.resource.id}-${r}`)),e.jsx("div",{ref:t,className:"tooltip-mounting-point"})]})}function Nt({data:s}){const t=o.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs(qe,{hover:!0,responsive:!0,className:"mb-0 results-lex-plain",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Result with Hit"})]})}),e.jsx("tbody",{children:s.kwics.map((n,r)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"text-end text-muted d-none d-sm-table-cell",children:r+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[n.reference&&e.jsx("a",{href:n.reference,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Me}})})," ",n.pid&&e.jsx(de,{placement:"auto-start",container:t,delay:{show:250,hide:400},overlay:e.jsx(pe,{id:`ttip-${n.pid}-${r}`,children:n.pid}),children:e.jsx(oe,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:n.fragments.map((i,a)=>i.hit&&!i.hitKind?e.jsx("mark",{children:e.jsx("strong",{children:i.text})},a):i.hit&&i.hitKind?e.jsx("span",{className:`lex-hitkind-${i.hitKind}`,title:`Annotated as "${i.hitKind.split("-").slice(1).join("-")}"`,children:i.text},a):e.jsx("span",{children:i.text},a))})]},`${n.pid??n.reference??s.resource.id}-${r}`))})]}),e.jsx("div",{ref:t,className:"tooltip-mounting-point"})]})}function Ct({data:s}){const t=o.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs(qe,{hover:!0,responsive:!0,className:"mb-0 results-plain",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Result with Hit"})]})}),e.jsx("tbody",{children:s.kwics.map((n,r)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"text-end text-muted d-none d-sm-table-cell",children:r+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[n.reference&&e.jsx("a",{href:n.reference,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Me}})})," ",n.pid&&e.jsx(de,{placement:"auto-start",container:t,delay:{show:250,hide:400},overlay:e.jsx(pe,{id:`ttip-${n.pid}-${r}`,children:n.pid}),children:e.jsx(oe,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:n.fragments.map((i,a)=>i.hit&&!i.hitKind?e.jsx("mark",{children:e.jsx("strong",{children:i.text})},a):e.jsx("span",{children:i.text},a))})]},`${n.pid??n.reference??s.resource.id}-${r}`))})]}),e.jsx("div",{ref:t,className:"tooltip-mounting-point"})]})}const an=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
  <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"/>
  <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"/>
</svg>`,ln=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-envelope-arrow-up" viewBox="0 0 16 16">
  <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4.5a.5.5 0 0 1-1 0V5.383l-7 4.2-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h5.5a.5.5 0 0 1 0 1H2a2 2 0 0 1-2-1.99zm1 7.105 4.708-2.897L1 5.383zM1 4v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1"/>
  <path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m.354-5.354 1.25 1.25a.5.5 0 0 1-.708.708L13 12.207V14a.5.5 0 0 1-1 0v-1.717l-.28.305a.5.5 0 0 1-.737-.676l1.149-1.25a.5.5 0 0 1 .722-.016"/>
</svg>`,Lt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
  <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/>
</svg>`;function on({show:s,searchId:t,resourceId:n,result:r,viewMode:i,showDiagnostics:a,onModalClose:l}){var C;const c=ue(),{languages:h,weblichtLanguages:g}=Ve(),{numberOfResults:f,queryType:j,language:L,languageFilter:k}=Qe(),[u,b]=o.useState(a);o.useEffect(()=>b(a),[a]);const[R,p]=o.useState(i);o.useEffect(()=>p(i),[i]);const m=r.exception||((C=r.diagnostics)==null?void 0:C.filter(x=>x.uri!==le).length)>0;function q(){return!r||r.nextRecordPosition===-1||r.numberOfRecords===-1?!1:(r.numberOfRecords===r.kwics.length,!0)}let $=null,N=!1;if(!g.includes(L)){if(L===se)if(r.resource.languages&&r.resource.languages.length===1)$=r.resource.languages[0];else{const x=[...new Set(r.kwics.map(w=>w.language).filter(w=>w!==null))];x.length===1&&($=x[0])}$||(console.warn("Cannot use WebLicht: unsupported language",{language:L,languageFilter:k}),N=!0)}function I(x){p(x.target.value)}function M(){return r?R==="kwic"&&(j!=="lex"||!r.isLexHits)?e.jsx(vt,{data:r}):R==="lexical-entry"?e.jsx(Rt,{data:r}):j==="lex"&&r.isLexHits?e.jsx(Nt,{data:r}):e.jsx(Ct,{data:r}):null}function U(){return e.jsxs(e.Fragment,{children:["Showing ",e.jsx("strong",{children:r.kwics.length}),q()?e.jsxs(e.Fragment,{children:[" / ",e.jsx("strong",{children:r.numberOfRecords})]}):""," ","results."]})}return e.jsxs(Q,{show:s,onHide:()=>l(),size:"xl",fullscreen:"lg-down",centered:!0,className:"resource-search-result-modal",children:[e.jsx(Q.Header,{closeButton:!0,children:e.jsx(Q.Title,{children:r.resource.title})}),e.jsxs(Q.Body,{className:"resource-info",children:[e.jsxs("dl",{className:"mb-0","aria-label":"Resource information",children:[e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ae}}),e.jsx("span",{children:" Institution"})]}),e.jsx("dd",{className:"mb-0",children:r.resource.institution}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Lt}}),e.jsx("span",{children:" Description"})]}),r.resource.description&&e.jsxs(e.Fragment,{children:[e.jsx("dd",{className:"mb-0",children:r.resource.description}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ee}}),e.jsx("span",{children:" Languages"})]})]}),e.jsx("dd",{className:"mb-0",children:r.resource.languages.map(h?x=>be(x,h):x=>x).toSorted().join(", ")}),e.jsx("dt",{children:"Persistent Identifier"}),e.jsx("dd",{children:r.resource.handle})]}),r.resource.landingPage&&e.jsxs("a",{href:r.resource.landingPage,className:"matomo_link",target:"_blank",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:St}})," More Information ..."]}),e.jsx("hr",{}),e.jsxs(G,{className:"row-gap-2",children:[e.jsx(E,{lg:"auto",md:3,sm:6,children:e.jsx(ie,{label:"View mode",controlId:"results-view-mode",children:e.jsxs(F.Select,{value:R,onChange:I,children:[e.jsx("option",{value:"plain",children:"Plain"}),(j!=="lex"||!r.isLexHits)&&e.jsx("option",{value:"kwic",children:"Keyword in Context"}),j==="fcs"&&e.jsx("option",{value:"annotation-layers",children:"Annotation Layers"}),j==="lex"&&e.jsx("option",{value:"lexical-entry",children:"Dictionary"})]})})}),e.jsx(E,{lg:3,md:3,sm:6,className:"align-content-center",children:e.jsx(F.Check,{disabled:!m,checked:u,onChange:()=>b(x=>!x),id:"results-modal-view-warnings-errors",label:"Show warning and error messages"})}),e.jsxs(E,{lg:"auto",md:6,sm:6,className:"d-flex flex-grow-1 column-gap-3 align-items-center justify-content-end",children:[e.jsxs(ae,{children:[e.jsxs(ae.Toggle,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:an}})," Download"]}),e.jsx(ae.Menu,{children:Bs.map(({id:x,label:w})=>e.jsxs(ae.Item,{href:us(c,t,n,x,L,k),className:"matomo_download",children:["As ",e.jsx("strong",{children:w})," file"]},x))})]}),e.jsxs(z,{disabled:N,"aria-disabled":N,href:hs(c,t,n,$,L,k),className:"matomo_link",target:"_blank",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:ln}})," Send to Weblicht"]})]})]}),e.jsx("hr",{}),e.jsx("p",{children:U()}),M()]}),u&&m&&e.jsxs(Q.Body,{className:"border-top",children:[r.exception&&e.jsxs(J,{variant:"danger","aria-label":"Error information",children:[e.jsxs(J.Heading,{style:{fontSize:"1rem"},children:[e.jsx("span",{className:"text-uppercase",children:"Exception:"})," ",e.jsx("span",{"aria-label":"Error message",children:r.exception.message})]}),r.exception.cause&&e.jsxs("p",{className:"mb-0 small",children:["Cause: ",r.exception.cause]}),r.exception.klass&&e.jsxs("p",{className:"mb-0 small",children:["Caused by: ",e.jsx("code",{children:r.exception.klass})]})]}),r.diagnostics.filter(x=>x.uri!==le).map(x=>e.jsxs(J,{variant:"warning",children:[e.jsx(J.Heading,{style:{fontSize:"1rem"},children:x.message}),x.diagnostic&&e.jsxs("p",{className:"mb-0 small",children:["Details: ",x.diagnostic]}),e.jsxs("p",{className:"mb-0 small",children:["Diagnostic type: ",e.jsx("code",{children:x.uri})]})]},`${x.uri}-${x.message}-${x.diagnostic}`))]}),q()&&e.jsx(Q.Footer,{className:"justify-content-center border-top py-2",children:e.jsx(rn,{searchId:t,resourceId:n,numberOfResults:f})})]})}const cn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
  <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"/>
  <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"/>
</svg>`;function dn({searchId:s,resourceId:t,resultInfo:n,viewMode:r,showResourceDetails:i,showDiagnostics:a}){var U;const l=ue(),{languages:c}=Ve(),{queryType:h}=Qe(),g=o.useId(),[f,j]=o.useState(!0),[L,k]=o.useState(!1),u=n.inProgress,b=n.numberOfRecordsLoaded>0,R=n.exception||((U=n.diagnostics)==null?void 0:U.filter(C=>C.uri!==le).length)>0,{data:p,isLoading:m,isError:q}=fe({queryKey:["search-result-details",s,t],queryFn:ds.bind(null,l,s,t),enabled:!u});if(u||!b&&(a&&!R||!a)||!p)return null;function $(){k(!0)}function N(){k(!1)}function I(){return p?p.numberOfRecords===-1?p.kwics.length:p.numberOfRecords===p.kwics.length&&p.nextRecordPosition===-1?`${p.kwics.length} / ${p.numberOfRecords}?`:`${p.kwics.length} / ${p.numberOfRecords}`:null}function M(){return p?r==="kwic"&&(h!=="lex"||!p.isLexHits)?e.jsx(vt,{data:p}):r==="lexical-entry"?e.jsx(Rt,{data:p}):h==="lex"&&p.isLexHits?e.jsx(Nt,{data:p}):e.jsx(Ct,{data:p}):null}return e.jsxs(e.Fragment,{children:[e.jsxs(Y,{className:"my-1 resource-search-result",role:"group","aria-label":`Results and details for resource ${p.resource.title}`,children:[e.jsxs(Y.Header,{className:"d-flex accordion",children:[e.jsxs("button",{type:"button",onClick:()=>j(C=>!C),"aria-controls":g,"aria-expanded":f,className:`me-3 w-auto flex-grow-1 d-block text-start collapse-toggle-btn ${f?"":"collapsed"}`,children:[e.jsx(oe,{bg:"",className:"text-bg-light border me-2","aria-label":"Number of results (total amount, or currently loaded amount with total available)",children:I()}),e.jsx("span",{"aria-label":"Resource title",children:p.resource.title}),e.jsx("small",{className:"text-muted","aria-label":"Institution name",children:p.resource.institution})]}),e.jsx("div",{className:"d-inline-block ms-auto",children:e.jsxs(z,{size:"sm",onClick:$,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:cn}})," View"]})})]}),e.jsx(ht,{in:f,children:e.jsxs("div",{id:g,children:[i&&e.jsx(Y.Body,{className:"border-bottom resource-info",children:e.jsxs("dl",{className:"mb-0","aria-label":"Resource information",children:[e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ae}}),e.jsx("span",{children:" Institution"})]}),e.jsx("dd",{className:"mb-0",children:p.resource.institution}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Lt}}),e.jsx("span",{children:" Description"})]}),p.resource.description&&e.jsxs(e.Fragment,{children:[e.jsx("dd",{className:"mb-0",children:p.resource.description}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ee}}),e.jsx("span",{children:" Languages"})]})]}),e.jsx("dd",{className:"mb-0",children:p.resource.languages.map(c?C=>be(C,c):C=>C).toSorted().join(", ")})]})}),b&&e.jsx(Y.Body,{children:M()}),a&&R&&e.jsxs(Y.Body,{className:b?"border-top":"",children:[p.exception&&e.jsxs(J,{variant:"danger","aria-label":"Error information",children:[e.jsxs(J.Heading,{style:{fontSize:"1rem"},children:[e.jsx("span",{className:"text-uppercase",children:"Exception:"})," ",e.jsx("span",{"aria-label":"Error message",children:p.exception.message})]}),p.exception.cause&&e.jsxs("p",{className:"mb-0 small",children:["Cause: ",p.exception.cause]}),p.exception.klass&&e.jsxs("p",{className:"mb-0 small",children:["Caused by: ",e.jsx("code",{children:p.exception.klass})]})]}),p.diagnostics.filter(C=>C.uri!==le).map(C=>e.jsxs(J,{variant:"warning",children:[e.jsx(J.Heading,{style:{fontSize:"1rem"},children:C.message}),C.diagnostic&&e.jsxs("p",{className:"mb-0 small",children:["Details: ",C.diagnostic]}),e.jsxs("p",{className:"mb-0 small",children:["Diagnostic type: ",e.jsx("code",{children:C.uri})]})]},`${C.uri}-${C.message}-${C.diagnostic}`))]})]})})]}),e.jsx(on,{show:L,searchId:s,resourceId:t,result:p,viewMode:r,showDiagnostics:a,onModalClose:N})]})}const un="plain",hn="lexical-entry",mn="default",gn={default:()=>()=>0,"title-up":s=>(t,n)=>{var a,l;const r=((a=s.get(t.id))==null?void 0:a.title)||"",i=((l=s.get(n.id))==null?void 0:l.title)||"";return r.localeCompare(i)},"title-down":s=>(t,n)=>{var a,l;const r=((a=s.get(t.id))==null?void 0:a.title)||"",i=((l=s.get(n.id))==null?void 0:l.title)||"";return-r.localeCompare(i)},"result-count-total-up":()=>(s,t)=>{const n=s.numberOfRecords!==-1?s.numberOfRecords:s.numberOfRecordsLoaded,r=t.numberOfRecords!==-1?t.numberOfRecords:t.numberOfRecordsLoaded;return n-r},"result-count-total-down":()=>(s,t)=>{const n=s.numberOfRecords!==-1?s.numberOfRecords:s.numberOfRecordsLoaded;return(t.numberOfRecords!==-1?t.numberOfRecords:t.numberOfRecordsLoaded)-n}},at=1500;function xn({searchId:s,pollDelay:t=at}){const n=ue(),{resources:r}=Ve(),{query:i,queryType:a,resourceIDs:l}=Qe(),[c,h]=o.useState(a==="lex"?hn:un),[g,f]=o.useState(mn),[j,L]=o.useState(""),[k,u]=o.useState(!1),[b,R]=o.useState(!1),p=o.useMemo(()=>{const d=new Map;return r==null||r.forEach(y=>{d.set(y.id,y)}),gn[g](d)},[g,r]);t??(t=at);const{data:m}=fe({queryKey:["search-results",s],queryFn:os.bind(null,n,s??""),enabled:!!s,refetchInterval(d){return d.state.data&&d.state.data.inProgress>0?t:!1}}),q=o.useMemo(()=>(m==null?void 0:m.results.toSorted(p))||[],[m,p]),$=a==="lex"&&(m==null?void 0:m.results.every(d=>d.numberOfRecords<=0||d.isLexHits===!0)),N=l.length,I=(m==null?void 0:m.inProgress)??N,M=o.useMemo(()=>(m==null?void 0:m.results.filter(d=>(d.numberOfRecords!==-1?d.numberOfRecords:d.numberOfRecordsLoaded)>0).length)??0,[m]),U=o.useMemo(()=>(m==null?void 0:m.results.filter(d=>!d.inProgress&&(d.numberOfRecords!==-1?d.numberOfRecords:d.numberOfRecordsLoaded)>0&&d.diagnostics.filter(y=>y.uri!==le).length>0).length)??0,[m]),C=o.useMemo(()=>(m==null?void 0:m.results.filter(d=>!d.inProgress&&(d.numberOfRecords!==-1?d.numberOfRecords:d.numberOfRecordsLoaded)<=0&&d.diagnostics.filter(y=>y.uri!==le).length===0&&d.exception===null).length)??0,[m]),x=o.useMemo(()=>(m==null?void 0:m.results.filter(d=>!d.inProgress&&(d.numberOfRecords!==-1?d.numberOfRecords:d.numberOfRecordsLoaded)<=0&&(d.diagnostics.filter(y=>y.uri!==le).length>0||d.exception!==null)).length)??0,[m]),w=o.useMemo(()=>(m==null?void 0:m.results.filter(d=>!d.inProgress&&d.numberOfRecords<=0&&d.exception!==null).length)??0,[m]),P=o.useMemo(()=>(m==null?void 0:m.results.filter(d=>!d.inProgress&&(d.numberOfRecords!==-1?d.numberOfRecords:d.numberOfRecordsLoaded)<=0&&d.diagnostics.filter(y=>y.uri!==le).length>0&&d.exception===null).length)??0,[m]),T=o.useMemo(()=>(m==null?void 0:m.results.map(d=>d.numberOfRecords!==-1?d.numberOfRecords:d.numberOfRecordsLoaded).reduce((d,y)=>d+y,0))??0,[m]),A=o.useMemo(()=>(m==null?void 0:m.results.map(d=>d.numberOfRecordsLoaded).reduce((d,y)=>d+y,0))??0,[m]);{const[d,y]=o.useState(!1);o.useEffect(()=>{m&&I===0&&(d||(y(!0),xt(i,a,A)))},[m,I,i,a,s,d,A])}function O(d){h(d.target.value)}function B(d){f(d.target.value)}return e.jsxs("div",{id:"search-results",className:"mt-2 mb-4",children:[e.jsx(de,{placement:"auto",overlay:e.jsxs(Ie,{id:"search-progress-information-popover",children:[e.jsx(Ie.Header,{children:"Search Progress Information"}),e.jsxs(Ie.Body,{style:{textIndent:"2rem hanging"},children:[e.jsxs("div",{children:[e.jsx("code",{children:N.toString().padStart(4," ")})," resources requested"]}),I>0&&e.jsxs("div",{children:[e.jsx("code",{children:I.toString().padStart(4," ")})," ↳ resources pending"]}),e.jsx("hr",{className:"mt-2 mb-1"}),e.jsxs("div",{children:[e.jsx("code",{children:(C+x).toString().padStart(4," ")})," ","resources without results"]}),e.jsxs("div",{children:[e.jsx("code",{children:C.toString().padStart(4," ")})," ↳ OK, without issues"]}),P>0&&e.jsxs("div",{children:[e.jsx("code",{children:P.toString().padStart(4," ")})," ↳ with warnings"]}),w>0&&e.jsxs("div",{children:[e.jsx("code",{children:w.toString().padStart(4," ")})," ↳ due to fatal errors"]}),e.jsx("hr",{className:"mt-2 mb-1"}),e.jsxs("div",{children:[e.jsx("code",{children:M.toString().padStart(4," ")})," resources with results"]}),U>0&&e.jsxs("div",{children:[e.jsx("code",{children:U.toString().padStart(4," ")})," ↳ with warnings"]}),e.jsx("hr",{className:"mt-2 mb-0"}),e.jsx("hr",{className:"mt-1 mb-1"}),e.jsxs("div",{children:[e.jsxs("code",{children:[" ",A," ","/"," ",T]})," ","total hits"]})]})]}),children:e.jsxs(ye,{className:"mb-3",children:[e.jsx(ye,{variant:"success",now:M,max:N,label:e.jsxs("span",{children:[M," resources with results"]}),"aria-label":"Resources with results"}),e.jsx(ye,{variant:"secondary",now:C+x,max:N,label:e.jsxs("span",{children:[C+x," resources without results"]}),"aria-label":"Resources without results (might be due to issues)"}),e.jsx(ye,{striped:!0,animated:!0,now:I,max:N,label:e.jsxs("span",{children:["Search through ",I," Resources"]}),"aria-label":"Resources with pending results"})]})}),e.jsx(Y,{className:"mb-2",role:"group","aria-label":"Result display and filter options",children:e.jsx(Y.Body,{children:e.jsxs(G,{className:"row-gap-2",children:[e.jsx(E,{lg:"auto",md:6,sm:6,children:e.jsx(ie,{label:"View mode",controlId:"results-view-mode",children:e.jsxs(F.Select,{value:c,onChange:O,children:[e.jsx("option",{value:"plain",children:"Plain"}),(a!=="lex"||!$)&&e.jsx("option",{value:"kwic",children:"Keyword in Context"}),a==="fcs"&&e.jsx("option",{value:"annotation-layers",children:"Annotation Layers"}),a==="lex"&&e.jsx("option",{value:"lexical-entry",children:"Dictionary"})]})})}),e.jsx(E,{lg:"auto",md:6,sm:6,children:e.jsx(ie,{label:"Sorting",controlId:"results-sorting",children:e.jsxs(F.Select,{value:g,onChange:B,children:[e.jsx("option",{value:"default",children:"(default)"}),e.jsx("option",{value:"title-up",children:"Title (up)"}),e.jsx("option",{value:"title-down",children:"Title (down)"}),e.jsx("option",{value:"result-count-total-up",children:"Total result count (up)"}),e.jsx("option",{value:"result-count-total-down",children:"Total result count (down)"})]})})}),e.jsx(E,{lg:"auto",md:12,sm:6,className:"flex-fill order-xl-4",children:e.jsx(ie,{label:"Result filter query",controlId:"result-filter",children:e.jsx(yt,{disabled:g!=="default"||!0,value:j,onChange:d=>L(d)})})}),e.jsxs(E,{lg:"auto",md:12,sm:12,className:"align-content-center order-xl-3",children:[e.jsx(F.Check,{checked:k,onChange:()=>u(d=>!d),id:"results-view-resource-details",label:"Show result details"}),e.jsx(F.Check,{checked:b,onChange:()=>R(d=>!d),id:"results-view-warnings-errors",label:"Show warning and error messages"})]})]})})}),s&&m&&q.map(d=>e.jsx(dn,{searchId:s,resourceId:d.id,resultInfo:d,viewMode:c,showResourceDetails:k,showDiagnostics:b},`${s}-${d.id}`))]})}const fn=""+new URL("assets/logo-fcs-dark.png",import.meta.url).href,lt=""+new URL("assets/logo-fcs.png",import.meta.url).href;function pn(){const s=ue(),[t,n]=Le(),[r,i]=o.useState([]),[a,l]=o.useState({}),[c,h]=o.useState([]),[g,f]=o.useState(null),[j,L]=o.useState(!1),[k,u]=o.useState(null),[b,R]=o.useState([]),p=H.getState().appTitleHead,m={consortia:t.get(je)},{data:q,isLoading:$,isError:N}=fe({queryKey:["init"],queryFn:rs.bind(null,s,m)});o.useEffect(()=>{if(!q)return;const w=Ms(q.resources);l(q.languages),h(q.weblichtLanguages),i(w),f(re(w))},[q]),o.useEffect(()=>{if(!r||r.length===0)return;const w=t.get("x-aggregation-context");if(w){try{const P=JSON.parse(w),{selected:T,unavailable:A}=_s(r,P);T.length>0&&(f(T),R(O=>[...O,{title:"Resource Selection",body:e.jsxs(e.Fragment,{children:["Preselected ",e.jsx("strong",{children:T.length})," resources:",e.jsx("br",{}),e.jsx("ul",{className:"ps-3",children:T.map(B=>e.jsx("li",{style:{wordBreak:"break-all",fontSize:"0.7rem"},children:B}))})]}),variant:"success"}])),A.length>0&&R(O=>[...O,{title:"Resource Selection",body:e.jsxs(e.Fragment,{children:["Unable to select ",e.jsx("strong",{children:A.length})," resources:",e.jsx("br",{}),e.jsx("ul",{className:"ps-3",children:A.map(B=>e.jsx("li",{style:{wordBreak:"break-all",fontSize:"0.7rem"},children:B}))})]}),variant:"warning"}])}catch(P){console.error('Error trying to parse "x-aggregation-context" search parameter!',{aggregationContext:w},P),P instanceof Error&&R(T=>[...T,{title:"Resource Selection",body:e.jsxs(e.Fragment,{children:["Unable to preselect resources: ",P.name,e.jsx("br",{}),e.jsx("small",{children:P.message})]}),variant:"error"}])}n(P=>(P.delete("x-aggregation-context"),P))}},[r,t,n]);const I=$||N,{mutate:M,data:U,isPending:C}=ct({mutationKey:["search"],mutationFn:({query:w,queryType:P,language:T,numberOfResults:A,resourceIDs:O})=>as(s,{query:w,queryType:P,language:T,numberOfResults:A.toString(),resourceIds:O})});function x(w){f(w.resourceIDs),u(w),L(!0),xt(w.query,w.queryType),M(w)}return e.jsxs(e.Fragment,{children:[e.jsx(xe,{children:e.jsx("title",{children:p})}),e.jsxs(X,{id:"search",children:[e.jsx("div",{"aria-live":"polite","aria-atomic":"true",className:"bg-dark position-relative",children:e.jsx(es,{position:"top-end",className:"mt-2",style:{zIndex:100},children:b.map((w,P)=>e.jsxs(Pe,{bg:w.variant,onClose:()=>R(T=>T.filter(A=>A!==w)),delay:5e3,autohide:!0,children:[e.jsx(Pe.Header,{closeButton:!0,children:e.jsx("strong",{className:"me-auto",children:w.title})}),e.jsx(Pe.Body,{children:w.body})]},P))})}),!j&&e.jsx(G,{children:e.jsx(E,{className:"text-center",children:e.jsxs("picture",{children:[e.jsx("source",{srcSet:lt,media:"(prefers-color-scheme: light)"}),e.jsx("source",{srcSet:fn,media:"(prefers-color-scheme: dark)"}),e.jsx("img",{src:lt,className:"logo",alt:"FCS logo"})]})})}),e.jsx(G,{className:"mt-3",children:e.jsx(E,{children:e.jsx(sn,{resources:r,languages:a,availableResources:null,selectedResources:g,onSearch:x,hasSearch:j,disabled:I})})}),!j&&e.jsx(G,{className:"mt-3",children:e.jsxs(E,{children:[e.jsxs("p",{children:["To enable researchers to search for specific patterns across collections of data, CLARIN offers a search engine that connects to the local data collections that are available in the centres. The data itself stays at the centre where it is hosted – which is why the underlying technique is called ",e.jsx("em",{children:"federated content search"}),"."]}),e.jsx("p",{children:"TODO: some more brief intro text and maybe links for further information ..."})]})}),j&&C&&e.jsx(G,{children:e.jsx(E,{className:"text-center my-5",children:e.jsx(mt,{animation:"border"})})}),k&&U&&e.jsx(Ss,{resources:r,languages:a,weblichtLanguages:c,children:e.jsx(Rs,{...k,children:e.jsx(xn,{searchId:U})})})]})]})}function jn(){const s=Ut(),t=Te();return o.useCallback((r,i,a)=>{const l=qt(r,i);s({pathname:l,search:t},a)},[s,t])}function bn(){const s=o.useContext(zt),t=dt(),n=s.matches.map(i=>i.route),r=Vt(n,t);return r!==null&&r.length>0?r[0]:null}const wn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-exclamation-triangle" viewBox="0 0 16 16">
  <path d="M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"/>
  <path d="M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"/>
</svg>`,yn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
  <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"/>
  <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7"/>
</svg>`;function Sn({url:s,statistics:t,validatorUrl:n,isScan:r}){var a;function i(l,c){var g;const h=e.jsx(Z.Highlight,{text:l.title,ranges:((g=t.matchResources)==null?void 0:g[c])??null});return l.valid&&l.notes.length===0?h:e.jsx(de,{placement:"auto-start",delay:{show:250,hide:400},overlay:e.jsxs(pe,{id:`resource-info-warning-${l.handle}`,children:[!l.valid&&"This resource is not available in the Aggregator!",!l.valid&&l.notes.length>=1&&e.jsx("hr",{className:"mt-2 mb-1"}),l.notes.length===1?l.notes[0]:l.notes.length>=1?e.jsx("ul",{className:"text-start m-0 my-1 ps-3",children:l.notes.map((f,j)=>e.jsx("li",{children:f},j))}):null]}),children:e.jsxs("span",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:wn},className:"align-baseline me-2"}),l.valid?h:e.jsx("s",{children:h})]})})}return e.jsxs("div",{className:"ps-sm-4 mt-sm-0 mt-2 pt-sm-0 pt-1",children:[e.jsxs("h4",{className:"h5",id:`${ut(s)}-${r?"scan":"search"}`,children:[e.jsx(Z.Highlight,{text:s,ranges:t.matchEndpoint}),n&&e.jsxs(e.Fragment,{children:[" ",e.jsx("a",{href:`${n}?url=${encodeURIComponent(s)}`,children:e.jsx("i",{dangerouslySetInnerHTML:{__html:yn},className:"align-baseline ms-2"})})]})]}),e.jsxs("dl",{className:"ps-sm-4",children:[e.jsx("dt",{children:"FCS Version"}),e.jsx("dd",{children:t.version}),e.jsx("dt",{children:"Search capabilities"}),e.jsx("dd",{children:t.searchCapabilities.join(", ")}),e.jsx("dt",{children:"Max concurrent scan requests"}),e.jsx("dd",{children:t.maxConcurrentRequests}),e.jsx("dt",{children:"Request statistics"}),e.jsxs("dd",{className:"mb-0",children:[t.numberOfRequests," request(s)"]}),t.avgQueueTime!==0&&e.jsxs("dd",{className:"mb-0",children:["Queue time (in seconds): average: ",t.avgQueueTime,", max:"," ",t.maxQueueTime]}),e.jsxs("dd",{children:["Execution time (in seconds): average: ",t.avgExecutionTime,", max:"," ",t.maxExecutionTime]}),((a=t.rootResources)==null?void 0:a.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx("dt",{children:"Resources"}),e.jsxs("dd",{children:[t.rootResources.length," root resources"]}),e.jsx("dd",{children:e.jsx("ul",{children:t.rootResources.map((l,c)=>{var h;return typeof l=="string"?e.jsx("li",{children:e.jsx(Z.Highlight,{text:l,ranges:((h=t.matchResources)==null?void 0:h[c])??null})},l):e.jsx("li",{children:i(l,c)},l.handle)})})})]}),e.jsxs(e.Fragment,{children:[Object.entries(t.diagnostics||{}).map(([l,c])=>e.jsxs(J,{variant:"warning",style:{fontSize:"0.85rem"},children:[e.jsxs(J.Heading,{style:{fontSize:"1rem"},children:[e.jsxs(oe,{bg:"warning",children:[c.counter,"x"]})," ",e.jsx("span",{className:"text-uppercase",children:"Diagnostic:"})," ",c.diagnostic.message,c.diagnostic.diagnostic&&e.jsxs(e.Fragment,{children:[" - ",e.jsx("small",{children:c.diagnostic.diagnostic})]})]}),e.jsxs("p",{className:"mb-0",children:["Context: ",e.jsx("a",{href:c.context,children:c.context})]})]},l)),Object.entries(t.errors||{}).map(([l,c])=>e.jsxs(J,{variant:"danger",style:{fontSize:"0.85rem"},children:[e.jsxs(J.Heading,{style:{fontSize:"1rem"},children:[e.jsxs(oe,{bg:"danger",children:[c.counter,"x"]})," ",e.jsx("span",{className:"text-uppercase",children:"Exception:"})," ",c.exception.message]}),e.jsxs("p",{className:"mb-0",children:["Context: ",e.jsx("a",{href:c.context,children:c.context})]}),c.exception.cause&&e.jsxs("p",{className:"mb-0",children:["Caused by: ",c.exception.cause]})]},l))]})]})]},s)}function vn({data:s,validatorUrl:t}){const[n,r]=o.useState(""),[i,a]=o.useState(["institution","endpoint","resources"]),[l,c]=o.useState(!1),h=`-${s.isScan?"scan":"search"}`,g=o.useMemo(()=>Object.entries(s.institutions).toSorted().map(([u,b])=>Object.entries(b).toSorted().map(([R,p])=>({institutionName:u,endpointUrl:R,endpointInfo:{...p,rootResources:p.rootResources.toSorted()}}))).flat(1).filter(l?u=>Object.keys(u.endpointInfo.diagnostics).length>0||Object.keys(u.endpointInfo.errors).length>0:()=>!0),[s,l]),f=g.filter(u=>Object.keys(u.endpointInfo.diagnostics).length>0||Object.keys(u.endpointInfo.errors).length>0),L=Z.useFuzzySearchList({list:g,queryText:n,getText:u=>{const b=[];return i.length===0?b.push(u.institutionName,u.endpointUrl,...u.endpointInfo.rootResources.map(R=>typeof R=="string"?R:R.title)):(i.includes("institution")&&b.push(u.institutionName),i.includes("endpoint")&&b.push(u.endpointUrl),i.includes("resources")&&b.push(...u.endpointInfo.rootResources.map(R=>typeof R=="string"?R:R.title))),b},mapResultItem:({item:u,score:b,matches:R})=>({item:u,matches:R,score:b})}).reduce((u,b)=>{const{institutionName:R,endpointUrl:p,endpointInfo:m}=b.item;return Object.getOwnPropertyNames(u).includes(R)||(u[R]={match:i.length===0||i.includes("institution")?b.matches[0]:null,endpoints:{}}),u[R].endpoints[p]={...m,matchEndpoint:i.length===0||i.includes("endpoint")?b.matches[i.length===0||i.includes("institution")?1:0]:null,matchResources:i.length===0||i.includes("resources")?b.matches.slice(0+(i.length===0||i.includes("institution")?1:0)+(i.length===0||i.includes("endpoint")?1:0)):[]},u},{});function k(u){i.includes(u)?a(i.filter(b=>b!==u)):a([...i,u])}return e.jsxs(X,{className:"d-grid gap-2 mt-3",children:[e.jsx(J,{variant:"info",className:"mb-0",children:e.jsxs("dl",{className:"mb-0",children:[e.jsx("dt",{children:"Start date"}),e.jsx("dd",{className:"mb-0",children:new Date(s.date).toLocaleString()}),e.jsx("dt",{children:"Timeout (in seconds)"}),e.jsx("dd",{className:"mb-0",children:s.timeout})]})}),e.jsx(F,{onSubmit:u=>u.preventDefault(),children:e.jsxs(G,{className:"gy-2",children:[e.jsx(E,{lg:6,md:12,children:e.jsx(F.Control,{placeholder:"Type to filter statistics ...",value:n,onChange:u=>r(u.target.value)})}),e.jsxs(E,{className:"filter-checkboxes",lg:6,md:12,children:[e.jsx(F.Text,{className:"me-2",children:"Apply filter to:"}),e.jsx(F.Check,{type:"checkbox",checked:i.includes("institution"),onChange:()=>k("institution"),id:`filter-institution-name${h}`,label:"Institution"}),e.jsx(F.Check,{type:"checkbox",checked:i.includes("endpoint"),onChange:()=>k("endpoint"),id:`filter-endpoint-url${h}`,label:"Endpoint"}),e.jsx(F.Check,{type:"checkbox",checked:i.includes("resources"),onChange:()=>k("resources"),id:`filter-resource-names${h}`,label:"Resources"})]})]})}),e.jsx(G,{children:e.jsx(E,{children:e.jsx(F.Check,{type:"checkbox",checked:l,onChange:()=>c(!l),id:`filter-show-issues-only${h}`,label:`Only show endpoints with issues (errors or warnings, currently affects ${f.length} endpoint${f.length!==1?"s":""})`})})}),Object.entries(L).map(([u,{match:b,endpoints:R}])=>e.jsxs(Y,{className:"p-2",children:[e.jsx("h3",{className:"h4 pb-1 border-bottom",id:`${ut(u)}${h}`,children:e.jsx(Z.Highlight,{text:u,ranges:b})}),Object.entries(R).toSorted().map(([p,m])=>e.jsx(Sn,{url:p,statistics:m,validatorUrl:t,isScan:s.isScan},p))]},u))]})}const Rn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"/>
  <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"/>
</svg>`,Nn=[{id:"last-scan",label:"Last Scan"},{id:"recent-searches",label:"Recent Searches"}],Cn=Object.fromEntries(Nn.map(s=>[s.id,s]));function Ln(){const s=ue(),t=ot(),[n]=Le(),{categoryId:r}=$t(),i=bn(),a=jn(),l={consortia:n.get(je)},{isPending:c,isError:h,data:g,error:f}=fe({queryKey:["statistics"],queryFn:is.bind(null,s,l)}),[j,L]=o.useState(H.getState().validatorURL);H.subscribe(m=>L(m.validatorURL));const k=H.getState().appTitleHead,u=g!==void 0?Object.keys(g).toSorted():[],b=r!=null&&u.includes(r)?r:u.length>0?u[0]:void 0;function R(){t.invalidateQueries({queryKey:["statistics"]})}function p(m){i==null||i.params.categoryId,i&&i.params.categoryId!==m&&i.route.path&&a(i.route.path,{categoryId:m})}return e.jsxs(e.Fragment,{children:[e.jsx(xe,{children:e.jsxs("title",{children:[k," – Statistics"]})}),e.jsxs(X,{id:"statistics",className:"my-3",children:[e.jsx("h1",{className:"h1",children:"Statistics"}),(c||h)&&e.jsx(G,{children:e.jsxs(E,{children:[c?"Loading ...":null,e.jsx("br",{}),h?f.message:null]})}),g&&e.jsxs(Oe.Container,{defaultActiveKey:b,onSelect:p,children:[e.jsxs(ne,{className:"nav-tabs",as:"ul",children:[Object.keys(g).map(m=>{var q;return e.jsx(ne.Item,{as:"li",role:"presentation",children:e.jsx(ne.Link,{as:"button",eventKey:m,children:((q=Cn[m])==null?void 0:q.label)??m})},m)}),e.jsx(ne.Item,{as:"li",role:"presentation",className:"ms-auto",children:e.jsxs(ne.Link,{as:"button",onClick:R,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Rn}})," Refresh"]})})]}),e.jsx(Oe.Content,{children:Object.entries(g).map(([m,q])=>e.jsx(Oe.Pane,{eventKey:m,children:e.jsx(vn,{data:q,validatorUrl:j})},m))})]})]})]})}function Tn(){const s=H.getState().appTitleHead;bs();{const t=dt(),[n,r]=o.useState(t.pathname);o.useEffect(()=>{const i=t.pathname;i!==n&&(r(i+t.search),gt(i,document.title,n))},[t,n])}return e.jsxs(e.Fragment,{children:[e.jsx(xe,{children:e.jsx("title",{children:s})}),e.jsx(fs,{}),e.jsx("main",{children:e.jsxs(Bt,{children:[e.jsx(we,{index:!0,element:e.jsx(pn,{})}),e.jsx(we,{path:"/about",element:e.jsx(ws,{})}),e.jsx(we,{path:"/help",element:e.jsx(ys,{})}),e.jsx(we,{path:"/stats/:categoryId?",element:e.jsx(Ln,{})})]})}),e.jsx(gs,{})]})}window.MyAggregator=window.MyAggregator||{};window._paq=window._paq||[];const An=["DEPLOY_PATH","API_URL","APP_TITLE","APP_TITLE_HEAD","TERMS_AND_DISCLAIMER_ADDRESS","CONTACT_ADDRESS","MATOMO_TRACKING_PARAMS"];function En(){window.MyAggregator.DEPLOY_PATH!==void 0&&H.getState().setDeployPath(window.MyAggregator.DEPLOY_PATH),window.MyAggregator.API_URL!==void 0&&H.getState().setApiURL(window.MyAggregator.API_URL),window.MyAggregator.VALIDATOR_URL!==void 0&&H.getState().setValidatorURL(window.MyAggregator.VALIDATOR_URL),window.MyAggregator.SHOW_SEARCH_RESULT_LINK!==void 0&&H.getState().setShowSearchResultLink(window.MyAggregator.SHOW_SEARCH_RESULT_LINK),window.MyAggregator.APP_TITLE!==void 0&&H.getState().setAppTitle(window.MyAggregator.APP_TITLE),window.MyAggregator.APP_TITLE_HEAD!==void 0&&H.getState().setAppTitleHead(window.MyAggregator.APP_TITLE_HEAD),window.MyAggregator.TERMS_AND_DISCLAIMER_ADDRESS!==void 0&&H.getState().setTermsAndDisclaimerUrl(window.MyAggregator.TERMS_AND_DISCLAIMER_ADDRESS),window.MyAggregator.CONTACT_ADDRESS!==void 0&&H.getState().setContactAddress(window.MyAggregator.CONTACT_ADDRESS),window.MyAggregator.MATOMO_TRACKING_PARAMS!==void 0&&H.getState().setMatomoTrackingParams(window.MyAggregator.MATOMO_TRACKING_PARAMS),window.MyAggregator.AUTH_USERNAME!==void 0&&H.getState().setAuthUsername(window.MyAggregator.AUTH_USERNAME),window.MyAggregator=new Proxy(window.MyAggregator,{get(s,t){return s[t]},set(s,t,n){return An.includes(t)?(console.error(`Configuration ${t} can only be set on initialization!`),!1):t==="VALIDATOR_URL"?n===null||typeof n=="string"?(H.getState().setValidatorURL(n),!0):!1:t==="SHOW_SEARCH_RESULT_LINK"?typeof n=="boolean"?(H.getState().setShowSearchResultLink(n),!0):!1:t==="AUTH_USERNAME"?n===null||typeof n=="string"?(H.getState().setAuthUsername(n),!0):!1:(s[t]=n,!0)}}),Object.assign(window.MyAggregator,{getAppStore:()=>H})}En();H.getInitialState(),H.getState();const Mn=H.getState().deployPath,_n=H.getState().apiURL,kn=new Qt({defaultOptions:{queries:{}}}),In=Gt.create({baseURL:_n,timeout:5e3,responseType:"json",transitional:{silentJSONParsing:!1}});{const s=H.getState().matomoTrackingParams;Ts(s)||console.warn("Unable to setup tracking ...")}const Pn="root",On=document.getElementById(Pn),Dn=ns.createRoot(On);Dn.render(e.jsx(o.StrictMode,{children:e.jsx(vs,{axios:In,children:e.jsx(Kt,{client:kn,children:e.jsx(Wt,{children:e.jsx(Yt,{basename:Mn,children:e.jsx(Tn,{})})})})})}));export{wt as C,Js as h,jt as u};
//# sourceMappingURL=fcs-sru-aggregator-ui-0.0.0.js.map
