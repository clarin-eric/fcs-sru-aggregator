const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./fcs-sru-aggregator-ui-query-builder-0.0.0.js","./vendor/react-ext.js","./vendor/react.js","./vendor/bootstrap.js","./vendor/antlr4.js","./vendor/prism.js","./fcs-sru-aggregator-ui-query-builder-0.0.0.css","./vendor/bootstrap.css"])))=>i.map(i=>d[i]);
import{c as kt,j as e,L as Re,N as Ke,r as o,H as ge,R as Ot,a as Pt,u as rt,b as it,d as at,e as fe,f as Dt,g as lt,m as Ht,h as Ft,i as Ut,s as ot,k as qt,l as zt,n as je,Q as Vt,o as Bt,p as $t,q as Qt,B as Gt}from"./vendor/react-ext.js";import{b as Kt}from"./vendor/react.js";/* empty css                            */import{C as X,R as $,a as T,N as he,b as ne,M as B,F,B as q,c as Y,d as ct,e as ie,I as Wt,T as Yt,D as ae,S as dt,f as He,O as xe,g as oe,h as Ne,L as Ee,A as J,P as be,i as Me,j as Xt,k as Ie,l as _e}from"./vendor/bootstrap.js";import{g as Jt}from"./vendor/prism.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var we={},We;function Zt(){if(We)return we;We=1;var s=Kt();return we.createRoot=s.createRoot,we.hydrateRoot=s.hydrateRoot,we}var es=Zt();const P=kt(s=>({deployPath:"/",apiURL:"https://contentsearch.clarin.eu/rest/",validatorURL:"https://www.clarin.eu/fcsvalidator/",showSearchResultLink:!1,appTitle:"Content Search",appTitleHead:"FCS Aggregator – Content Search",termsAndDisclaimerUrl:"https://www.clarin.eu/content/terms-use-and-disclaimer",contactAddress:"mailto:fcs@clarin.eu",matomoTrackingEnabled:!0,matomoTrackingParams:null,authUsername:null,setDeployPath:t=>s(n=>({deployPath:typeof t=="function"?t(n.deployPath):t})),setApiURL:t=>s(n=>({apiURL:typeof t=="function"?t(n.apiURL):t})),setValidatorURL:t=>s(n=>({validatorURL:typeof t=="function"?t(n.validatorURL):t})),setShowSearchResultLink:t=>s(n=>({showSearchResultLink:typeof t=="function"?t(n.showSearchResultLink):t})),setAppTitle:t=>s(n=>({appTitle:typeof t=="function"?t(n.appTitle):t})),setAppTitleHead:t=>s(n=>({appTitleHead:typeof t=="function"?t(n.appTitleHead):t})),setTermsAndDisclaimerUrl:t=>s(n=>({termsAndDisclaimerUrl:typeof t=="function"?t(n.termsAndDisclaimerUrl):t})),setContactAddress:t=>s(n=>({contactAddress:typeof t=="function"?t(n.contactAddress):t})),setMatomoTrackingParams:t=>s(n=>({matomoTrackingParams:typeof t=="function"?t(n.matomoTrackingParams):t})),setAuthUsername:t=>s(n=>({authUsername:typeof t=="function"?t(n.authUsername):t}))}));function ts(){const s=P.getState().termsAndDisclaimerUrl,t=P.getState().contactAddress;return e.jsx("footer",{className:"text-muted",children:e.jsx(X,{children:e.jsxs($,{children:[e.jsxs(T,{className:"text-start d-flex flex-sm-row flex-column column-gap-3 row-gap-2",children:[e.jsxs("div",{children:[e.jsx(Re,{to:"/about",className:"hidden-xs",children:"About"}),e.jsxs("div",{className:"version-info text-muted text-center-xs",children:["v","0.0.0"]})]}),e.jsx(Re,{to:"/stats",children:"Statistics"})]}),e.jsxs(T,{className:"text-center",children:[e.jsxs("span",{className:"footer-fineprint",children:["Service provided by ",e.jsx("a",{href:"https://www.clarin.eu",children:"CLARIN"})]}),e.jsxs("span",{children:[e.jsx("br",{}),"Hosted by CLARIN ERIC"]})]}),e.jsxs(T,{className:"hidden-xs text-end d-flex flex-sm-row flex-column justify-content-sm-end column-gap-3 row-gap-2",children:[s&&e.jsx("a",{href:s,children:"Terms & Disclaimer"}),t&&e.jsx("a",{href:t,children:"Contact"})]})]})})})}const ss=""+new URL("assets/icon-services-fcs.png",import.meta.url).href,Ye=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16">
  <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"/>
</svg>`;function ns(){const s=P.getState().appTitle,t=P.getState().authUsername,n=t!==null&&t!=="anonymous",r=P.getState().deployPath??"",i=r+(r.endsWith("/")?"":"/")+"login";return e.jsx("header",{children:e.jsx(he,{expand:"md",className:"bg-body-tertiary",children:e.jsxs(X,{children:[e.jsxs(he.Brand,{as:Re,to:"/",children:[e.jsx("img",{src:ss,width:"30",height:"30",className:"d-inline-block align-top",alt:`${s} logo`})," ",s]}),e.jsx(he.Toggle,{"aria-controls":"header-navbar-nav"}),e.jsx(he.Collapse,{id:"header-navbar-nav",children:e.jsxs(ne,{className:"w-100 d-flex",children:[e.jsx(ne.Link,{as:Ke,to:"/",children:"Home"}),e.jsx(ne.Link,{as:Ke,to:"/help",children:"Help"}),n?e.jsxs(he.Text,{className:"ms-auto",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ye}})," Signed in as"," ",e.jsx("span",{className:"fw-bold",children:t})]}):e.jsxs(ne.Link,{href:i,className:"ms-auto",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ye}})," Login"]})]})})]})})})}/*!
 * Color mode switcher based on example from Bootstrap 5 docs.
 * @see https://getbootstrap.com/docs/5.3/customize/color-modes/#javascript
 */function rs(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function is(s){s==="auto"?document.documentElement.setAttribute("data-bs-theme",window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"):document.documentElement.setAttribute("data-bs-theme",s)}function as(){o.useEffect(()=>{function s(){is(rs())}return s(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",s),()=>window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",s)},[])}function ls(){const s=P.getState().appTitleHead;return e.jsxs(e.Fragment,{children:[e.jsx(ge,{children:e.jsxs("title",{children:[s," – About"]})}),e.jsxs(X,{children:[e.jsx("h1",{className:"h1",children:"About the Federated Content Search (FCS) Aggregator"}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:"People"}),e.jsx("p",{children:"The Aggregator was developed by:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Emanuel Dima"}),e.jsx("li",{children:"Erik Körner"}),e.jsx("li",{children:"Leif-Jöran Olsson"}),e.jsx("li",{children:"Yana Panchenko"}),e.jsx("li",{children:"Oliver Schonefeld"}),e.jsx("li",{children:"Dieter Van Uytvanck"})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:"Statistics"}),e.jsxs("p",{children:["View ",e.jsx(Re,{to:"/stats",children:"endpoint statistics"})," to see details about scanned resources, performed searches, warnings and errors."]})]}),e.jsx("div",{children:e.jsx("h2",{className:"h2",children:"Privacy Policy"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:"Source Code"}),e.jsxs("p",{children:["The Aggregator source code and documentation are published on"," ",e.jsx("a",{href:"https://github.com/clarin-eric/fcs-sru-aggregator",children:"GitHub"})," and are made available under the"," ",e.jsx("a",{href:"https://github.com/clarin-eric/fcs-sru-aggregator/blob/master/LICENSE",children:"GPL 3.0 license"}),"."]}),e.jsx("p",{children:"The full license can be found in the source code repository and in the packaged sources and binaries."})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:"Technology Used"}),e.jsx("p",{children:"The Aggregator uses the following software components:"}),e.jsx("ul",{children:e.jsxs("li",{children:[e.jsx("a",{href:"https://www.dropwizard.io/",children:"Dropwizard"})," (",e.jsx("a",{href:"https://github.com/dropwizard/dropwizard/blob/release/4.0.x/LICENSE",children:"Apache License 2.0"}),")"]})})]}),e.jsx("div",{children:e.jsx("h2",{className:"h2",children:"Funding"})})]})]})}function os(){const s=P.getState().appTitleHead;return e.jsxs(e.Fragment,{children:[e.jsx(ge,{children:e.jsxs("title",{children:[s," – Help"]})}),e.jsxs(X,{children:[e.jsx("h1",{className:"h1",children:"Help"}),e.jsx("h2",{className:"h2",children:"Performing a Federated Content Search in resources"}),e.jsx("p",{}),e.jsx("h2",{className:"h2",children:"Adjusting search criteria"}),e.jsx("p",{}),e.jsx("h2",{children:"More help"}),e.jsxs("p",{children:["More detailed information on using FCS Aggregator is available at the"," ",e.jsx("a",{href:"https://www.clarin.eu/content/content-search-tutorial",children:"Content Search: Tutorial at CLARIN.eu"}),". If you still cannot find an answer to your question, or if want to send a feedback, you can write to the"," ",e.jsx("a",{title:"contact",href:"mailto:fcs@clarin.eu",children:"CLARIN FCS Helpdesk"}),"."]})]})]})}const Fe=o.createContext({resources:[],languages:{},weblichtLanguages:[]});Fe.displayName="AggregatorDataContext";function cs({resources:s,languages:t,weblichtLanguages:n,children:r}){const i={resources:s,languages:t,weblichtLanguages:n};return e.jsx(Fe.Provider,{value:i,children:r})}function Ue(){return o.useContext(Fe)}const qe=o.createContext(void 0);qe.displayName="AxiosContext";function de(){const s=o.useContext(qe);if(!s)throw new Error('No "axios" instance set, use AxiosProvider to set one');return s}function ds({axios:s,children:t}){return e.jsx(qe.Provider,{value:s,children:t})}const ze=o.createContext(void 0);ze.displayName="SearchParamsContext";function Ve(){const s=o.useContext(ze);if(!s)throw new Error('No "params" data set, use SearchParamsProvider to set one');return s}function us({language:s,languageFilter:t,queryType:n,query:r,resourceIDs:i,numberOfResults:a,children:l}){const h={language:s,languageFilter:t,queryType:n,query:r,resourceIDs:i,numberOfResults:a};return e.jsx(ze.Provider,{value:h,children:l})}async function hs(s){return(await s.get("init")).data}async function ms(s){return(await s.get("statistics")).data}async function gs(s,t){return(await s.post("search",t,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data}async function fs(s,t,n){return(await s.post(`search/${t}`,n,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data}async function xs(s,t){if(!t)throw new Error('Invalid "searchID" parameter!');return(await s.get(`search/${t}/metaonly`)).data}async function ps(s,t,n){if(!t)throw new Error('Invalid "searchID" parameter!');if(!n)throw new Error('Invalid "resourceID" parameter!');const i=(await s.get(`search/${t}/metaonly?resourceId=${encodeURIComponent(n)}`)).data.results.filter(a=>a.id===n);if(i.length===0)throw new Error(`Results (meta) for resource not found! (searchId: ${t}, resourceId: ${n})`);return i[0]}async function js(s,t,n){if(!t)throw new Error('Invalid "searchID" parameter!');if(!n)throw new Error('Invalid "resourceID" parameter!');const i=(await s.get(`search/${t}?resourceId=${encodeURIComponent(n)}`)).data.results.filter(a=>a.resource.id===n);if(i.length===0)throw new Error(`Results for resource not found! (searchId: ${t}, resourceId: ${n})`);return i[0]}function bs(s,t,n,r,i,a){const l=new URLSearchParams({resourceId:n,format:r});(a==="byGuess"||a==="byMetaAndGuess")&&l.set("filterLanguage",i);const h=`search/${t}/download?${l.toString()}`;return s.getUri({url:h})}function ws(s,t,n,r,i,a){const l=new URLSearchParams({resourceId:n});r?l.set("filterLanguage",r):(a==="byGuess"||a==="byMetaAndGuess")&&l.set("filterLanguage",i);const h=`search/${t}/toWeblicht?${l.toString()}`;return s.getUri({url:h})}function ys(s,t=0){let n=3735928559^t,r=1103547991^t;for(let i=0,a;i<s.length;i++)a=s.charCodeAt(i),n=Math.imul(n^a,2654435761),r=Math.imul(r^a,1597334677);return n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507),r^=Math.imul(n^n>>>13,3266489909),4294967296*(2097151&r)+(n>>>0)}window._paq=window._paq||[];function Ss({siteId:s,trackerUrl:t,enableLinkTracking:n=!0,domains:r=[],userId:i=void 0}){window._paq.push(["setTrackerUrl",t]),window._paq.push(["setSiteId",s]),i&&window._paq.push(["setUserId",i]),Array.isArray(r)&&r.length>0&&window._paq.push(["setDomains",r]),n&&(window._paq.push(["enableLinkTracking"]),window._paq.push(["setLinkTrackingTimer",250]))}function vs({srcUrl:s}){const t=document.createElement("script"),n=document.getElementsByTagName("script")[0];t.type="text/javascript",t.async=!0,t.defer=!0,t.src=s,n&&n.parentNode&&n.parentNode.insertBefore(t,n)}function Rs(s){var x;if(!s)return!1;let t=null;if(typeof s=="string")try{t=JSON.parse(s)}catch(g){return console.error("Error trying to parse tracking params!",g),!1}else typeof s=="object"&&(t=s);const n=t.siteId,r=t.trackerUrl,i=t.srcUrl,a=t.domains,l=(x=t.userId)==null?void 0:x.toString();if(i===void 0)return console.warn('No "srcUrl" configuration set for tracking!'),!1;if(r===void 0)return console.warn('No "trackerUrl" configuration set for tracking!'),!1;if(n===void 0||!Number.isInteger(n))return console.warn('No "siteId" configuration set for tracking!'),!1;const h={siteId:n,trackerUrl:r,domains:a};l&&(h.userId=ys(l).toString());const m={srcUrl:i};return Ss(h),ut(document.location.href||window.location.href,document.title),vs(m),!0}function ut(s,t,n){window._paq.push(["setDocumentTitle",t??document.title]),window._paq.push(["setCustomUrl",s]),n!==void 0&&window._paq.push(["setReferrerUrl",n]),window._paq.push(["trackPageView"])}function ht(s,t=!1,n=!1){window._paq.push(["trackSiteSearch",s,t,n])}const ke="byMeta",Ns="all",mt="resource",Cs="title-up",se="mul";function pe(s,t=void 0){return s===se?"Any Language":(t==null?void 0:t[s])||"Unknown Language"}function Ls(s){const t=i=>({...i,subResources:i.subResources.map(t)}),n=s.map(t),r=function(i,a){const l=i.institution.localeCompare(a.institution);return l!==0?l:i.title.toLowerCase().localeCompare(a.title.toLowerCase())};return ce(n,i=>{i.subResources.sort(r)}),n.sort(r),n}function Ts(s,t){const n=[],r=[],i=[];return Object.entries(t).forEach(([a,l])=>{l.forEach(h=>{let m=!1;ce(s,x=>{x.handle===h&&(m=!0,i.push(x))}),m||(console.warn("Handle not found in resources",h),r.push(h))})}),ce(i,a=>{n.push(a.id)}),{selected:n,unavailable:r}}function ce(s,t){const n=(r,i)=>{t(r,i)===!1||r.subResources.forEach(n)};s.forEach(n)}function re(s){const t=[];return ce(s,n=>{t.push(n.id)}),t}function As(s,t,n){const r=[],i=a=>gt(a,i)||_s(a,t,n);return ce(s,a=>{i(a)&&r.push(a.id)}),r}function Es(s,t){const n=new Set;return ce(s,r=>(t.includes(r.id)&&n.add(r.institution),!0)),Array.from(n)}function Ms(s,t){return!(t==="fcs"&&!s.endpoint.searchCapabilities.includes("ADVANCED_SEARCH")||t==="lex"&&!s.endpoint.searchCapabilities.includes("LEX_SEARCH"))}function Is(s,t){return!!(t===se||s.languages&&s.languages.length===1&&s.languages[0]===t||s.languages&&s.languages.indexOf(t)>=0)}function gt(s,t){if(!s.subResources||s.subResources.length===0)return!1;let n=!1;const r=i=>{if((t==null?void 0:t(i))===!0){n=!0;return}i.subResources.forEach(r)};return s.subResources.forEach(r),n}function _s(s,t,n){return!(!Ms(s,t)||!Is(s,n))}const ks={"title-up":(s,t)=>s.title.localeCompare(t.title),"title-down":(s,t)=>-s.title.localeCompare(t.title),"institution-up":(s,t)=>{const n=s.institution.localeCompare(t.institution);return n!==0?n:s.title.localeCompare(t.title)},"institution-down":(s,t)=>{const n=-s.institution.localeCompare(t.institution);return n!==0?n:s.title.localeCompare(t.title)}},Os="modulepreload",Ps=function(s,t){return new URL(s,t).href},Xe={},Ds=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){let l=function(g){return Promise.all(g.map(j=>Promise.resolve(j).then(C=>({status:"fulfilled",value:C}),C=>({status:"rejected",reason:C}))))};const h=document.getElementsByTagName("link"),m=document.querySelector("meta[property=csp-nonce]"),x=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));i=l(n.map(g=>{if(g=Ps(g,r),g in Xe)return;Xe[g]=!0;const j=g.endsWith(".css"),C=j?'[rel="stylesheet"]':"";if(!!r)for(let b=h.length-1;b>=0;b--){const w=h[b];if(w.href===g&&(!j||w.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${g}"]${C}`))return;const u=document.createElement("link");if(u.rel=j?"stylesheet":Os,j||(u.as="script"),u.crossOrigin="",u.href=g,x&&u.setAttribute("nonce",x),document.head.appendChild(u),j)return new Promise((b,w)=>{u.addEventListener("load",b),u.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${g}`)))})}))}function a(l){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=l,window.dispatchEvent(h),!h.defaultPrevented)throw l}return i.then(l=>{for(const h of l||[])h.status==="rejected"&&a(h.reason);return t().catch(a)})};function ft(s,t){const[n,r]=o.useState(s);return o.useEffect(()=>{const i=setTimeout(()=>{r(s)},t);return()=>{clearTimeout(i)}},[s,t]),n}function Oe(s,t,n=0,r=t){var h,m,x,g;if(t===s&&t===r&&t.nodeType===Node.ELEMENT_NODE&&n===1)return t.nodeType,(h=t.textContent)==null||h.length,((m=t.textContent)==null?void 0:m.length)||0;if(t===s||s===null)return n;const i=t.parentNode;if(i===null)return n;let a=0;const l=i.childNodes;for(let j=0;j<l.length;j++){const C=l[j];if(C===t)break;C.nodeType===Node.TEXT_NODE?a+=((x=C.textContent)==null?void 0:x.length)||0:C.nodeType===Node.ELEMENT_NODE?a+=((g=C.textContent)==null?void 0:g.length)||0:console.warn("unknown node type",{container:s,node:t,offset:n,parent:i,i:j,child:C})}return Oe(s,i,a+n,r)}function xt(s,t){var a,l,h;const n=((a=s.textContent)==null?void 0:a.length)||0;if(n<t)return null;let r=0;const i=s.childNodes;for(let m=0;m<i.length;m++){const x=i[m];let g=0;if(x.nodeType===Node.TEXT_NODE?g=((l=x.textContent)==null?void 0:l.length)||0:x.nodeType===Node.ELEMENT_NODE?g=((h=x.textContent)==null?void 0:h.length)||0:console.warn("unknown node type, skip",{container:s,offset:t,child:x}),!(g===0&&i.length!==1)&&(r+=g,r>=t)){const j=t-(r-g);return x.nodeType===Node.ELEMENT_NODE?xt(x,j):{node:x,offset:j}}}return i.length,null}function Pe(s,t){if(!t)return null;const n=Oe(s,t.startContainer,t.startOffset);if(t.startContainer.nodeType===Node.TEXT_NODE&&t.endContainer===t.startContainer)return[n,n+(t.endOffset-t.startOffset)];const r=Oe(s,t.endContainer,t.endOffset);return[n,r]}function Hs(s,t){if(!(document.activeElement===s))return null;const r=window.getSelection();if(!r)return null;const i=document.createRange(),a=xt(s,t);if(a)try{i.setStart(a.node,a.offset),i.collapse(!0),r.removeAllRanges(),r.addRange(i)}catch(l){console.error("Error trying to set cursor!",l,{container:s,offset:t,startRange:a})}}function Je(s){if(!(document.activeElement===s))return null;const n=window.getSelection();if(!n||n.rangeCount===0)return null;const r=n.getRangeAt(0),i=Pe(s,r);return i?i[0]:null}function Fs(s){return s==="cql"?"fcs-cql":s==="fcs"?"fcs-fcsql":s==="lex"?"fcs-lexcql":"plain"}function De(s,t){const n=Fs(t),r="match-braces rainbow-braces";let i=s;try{i=Jt.highlight(s,n)}catch(l){console.warn("Error trying to highlight value",{value:s,error:l,language:n})}return`<pre><code class="language-${n} ${r}">${i}</code></pre>`}function me(s){return s?(s=s.replace(/[\n\t]/g," "),s=s.replace(/&nbsp;|\u202F|\u00A0/g," "),s):""}const pt=Ot.forwardRef(({value:s,onChange:t,onCursorChange:n,disabled:r,placeholder:i,queryType:a,delay:l=200,...h},m)=>{const x=o.useRef(null),g=o.useRef(null);o.useImperativeHandle(m,()=>g.current);const[j,C]=o.useState(me(s)),[_,u]=o.useState(null),b=ft(j,l),[w,p]=o.useState(b);o.useEffect(()=>{const c=De(b,a);if(p(c),g.current){const R=Je(g.current);u(R)}},[b,a]),o.useEffect(()=>{const c=me(s);if(b!==c&&(C(c),p(De(c)),g.current)){const R=Je(g.current);u(R)}},[s,b]),o.useLayoutEffect(()=>{g.current&&_!==null&&Hs(g.current,_)});function f(c){const R=c.target.innerText;x.current&&(x.current.value=R),C(R),t==null||t(R)}function K(c){c.stopPropagation(),c.preventDefault();const D=(c.clipboardData||window.clipboardData).getData("text");E(D)}function V(c){var R;c.key==="Enter"?(c.stopPropagation(),c.preventDefault(),x.current&&((R=x.current.form)==null||R.requestSubmit())):c.key==="Backspace"?(c.stopPropagation(),c.preventDefault(),U()):c.key==="Delete"?(c.stopPropagation(),c.preventDefault(),L()):c.ctrlKey&&c.key==="a"||u(null)}function N(c=!1){if(!g.current||!n)return;const R=g.current;if(!(document.activeElement===R))return;const A=window.getSelection();if(!A||A.rangeCount===0)return;const M=[];for(let d=0;d<A.rangeCount;d++){const y=A.getRangeAt(d),I=Pe(R,y);I&&M.push(I)}if(M.length===0)return;const[H,Q]=M.pop();c?H===Q&&(u(H),n==null||n(H)):n==null||n(H,H!==Q?Q:void 0)}function k(c){if(!g.current)return null;const R=g.current;if(!(document.activeElement===R))return null;const A=window.getSelection();if(!A||A.rangeCount===0)return null;const M=[];for(let y=0;y<A.rangeCount;y++){const I=A.getRangeAt(y),G=Pe(R,I);G&&M.push(G)}if(M.length===0)return null;M.sort();const H=M.map(([y,I])=>I-y).reduce((y,I)=>y+I,0),Q=R.innerText,d=M.toReversed().reduce((y,[I,G])=>y.slice(0,I)+y.slice(G),Q);if(c==="backspace"){if(H===0){const y=M.filter(([I,G])=>I===G).map(([,I])=>I).pop();if(y===0)return null;if(y!==void 0)return{value:d.slice(0,y-1)+d.slice(y),offset:y-1}}else{const y=M.map(([,I])=>I).pop();if(y!==void 0)return{value:d,offset:y-H}}return console.warn('invalid "backspace" process, abort',{container:R,selectionIndices:M,oldValue:Q,newValueSpansRemoved:d,numDeleted:H}),null}else if(c==="delete"){if(H===0){const y=M.filter(([I,G])=>I===G).map(([,I])=>I).pop();if(y!==void 0)return{value:d.slice(0,y)+d.slice(y+1),offset:y}}else{const y=M.map(([,I])=>I).pop();if(y!==void 0)return{value:d,offset:y-H}}return console.warn('invalid "delete" process, abort',{container:R,selectionIndices:M,oldValue:Q,newValueSpansRemoved:d,numDeleted:H}),null}else if(c==="paste"){if(H===0){const y=M.filter(([I,G])=>I===G).map(([I])=>I).shift();if(y!==void 0)return{value:d,offset:y}}else{const y=M.map(([I])=>I).shift();if(y!==void 0)return{value:d,offset:y}}return console.warn('invalid "paste" process, abort',{container:R,selectionIndices:M,oldValue:Q,newValueSpansRemoved:d,numDeleted:H}),null}}function E(c){const R=k("paste");if(!R)return;const D=me(c),{value:A,offset:M}=R,H=A.slice(0,M)+D+A.slice(M),Q=M+c.length;C(H),u(Q),x.current&&(x.current.value=H),t==null||t(H),n==null||n(Q)}function U(){const c=k("backspace");if(!c)return;const{value:R,offset:D}=c,A=me(R);C(A),u(D),x.current&&(x.current.value=A),t==null||t(A),n==null||n(D)}function L(){const c=k("delete");if(!c)return;const{value:R,offset:D}=c,A=me(R);C(A),u(D),x.current&&(x.current.value=A),t==null||t(A),n==null||n(D)}return e.jsxs(e.Fragment,{children:[e.jsx("div",{role:"input",disabled:r,placeholder:i,spellCheck:!1,autoCapitalize:"off",autoCorrect:"off",...h,onInput:f,onPaste:K,onKeyDown:V,onKeyUp:()=>N(),onClick:()=>N(!0),tabIndex:r?-1:h.tabIndex,contentEditable:!0,dangerouslySetInnerHTML:{__html:w},ref:g}),i&&s===""&&e.jsx("span",{className:"input-placeholder-simulacrum",children:i}),e.jsx("input",{type:"hidden",ref:x})]})});pt.displayName="ContentEditable";var te=Pt();function Us({show:s,languages:t,resources:n,searchLanguage:r,searchLanguageFilter:i,onModalClose:a}){const[l,h]=o.useState(r||se),[m,x]=o.useState(i||ke),[g,j]=o.useState(""),[C,_]=o.useState(!1),u=o.useMemo(()=>{const N=new Map;return n&&(n.forEach(k=>k.languages.forEach(E=>N.set(E,(N.get(E)??0)+1))),N.set(se,n.length)),N},[n]),b=te.useFuzzySearchList({list:Object.entries(t??{}).toSorted(),queryText:g,getText:N=>[N[0],N[1]],mapResultItem:({item:N,score:k,matches:E})=>({item:N,matches:E,score:k})});if(!t)return null;const w=Math.floor((b.length+2)/3);function p(N){a({language:l,filter:m,action:N})}function f(){h(r||se),x(i||ke)}function K(){_(N=>!N)}function V(N,k,E,U){const L=l===N;let c="d-block py-0 my-1 border-0";return L&&(c+=" fw-semibold selected"),E===void 0&&(E=[null,null]),e.jsxs(q,{size:"sm",className:c,style:{color:`var(${L?"--bs-green":"--bs-body-colors"})`,backgroundColor:"var(--bs-body-bg)"},onClick:()=>h(N),"data-filter-score":U,children:[L&&e.jsx("span",{className:"selected-marker me-1",children:"✓"}),e.jsx(te.Highlight,{ranges:E[1],text:k})," ",e.jsx("sup",{children:e.jsx(te.Highlight,{ranges:E[0],text:N})}),C&&u.has(N)&&e.jsxs(e.Fragment,{children:[" (",u.get(N),")"]})]},N)}return e.jsxs(B,{show:s,onHide:()=>p("close"),size:"xl",fullscreen:"lg-down",centered:!0,children:[e.jsx(B.Header,{closeButton:!0,children:e.jsx(B.Title,{children:"Languages"})}),e.jsxs(B.Body,{className:"px-0",children:[e.jsxs(X,{className:"px-4 pb-3 border-bottom",children:[e.jsxs($,{children:[e.jsx(T,{sm:!0}),e.jsx(T,{sm:!0,className:"mb-3 mb-sm-2 align-content-end",children:V(se,pe(se))}),e.jsxs(T,{sm:!0,children:[e.jsx(F.Control,{size:"sm",placeholder:"Filter languages ...",name:"languages-filter",value:g,onChange:N=>j(N.target.value)}),n&&e.jsx(F.Check,{name:"languages-show-count",id:"languages-show-count",checked:C,onChange:K,type:"checkbox",label:"Show number of resources per language",className:"mt-1"})]})]}),e.jsxs($,{children:[e.jsx(T,{sm:!0,children:b.slice(0,w).map(({item:[N,k],matches:E,score:U})=>V(N,k,E,U))}),e.jsx(T,{sm:!0,children:b.slice(w,2*w).map(({item:[N,k],matches:E,score:U})=>V(N,k,E,U))}),e.jsx(T,{sm:!0,children:b.slice(2*w).map(({item:[N,k],matches:E,score:U})=>V(N,k,E,U))})]})]}),e.jsx(F,{children:e.jsxs(X,{className:"px-4 pt-3",children:[e.jsx(F.Check,{type:"radio",name:"filterOpts",value:"byMeta",id:"filterOpts-byMeta",checked:m==="byMeta",onChange:()=>x("byMeta"),label:"Use the resources' specified language to filter results"}),e.jsx(F.Check,{type:"radio",name:"filterOpts",value:"byGuess",id:"filterOpts-byGuess",checked:m==="byGuess",onChange:()=>x("byGuess"),label:"Filter results by using a language detector"}),e.jsx(F.Check,{type:"radio",name:"filterOpts",value:"byMetaAndGuess",id:"filterOpts-byMetaAndGuess",checked:m==="byMetaAndGuess",onChange:()=>x("byMetaAndGuess"),label:"First use the resources' specified language then also use a language detector"})]})})]}),e.jsxs(B.Footer,{children:[e.jsx(q,{variant:"secondary",onClick:f,children:"Revert Selection"}),e.jsx(q,{variant:"secondary",onClick:()=>p("abort"),children:"Abort"}),e.jsx(q,{variant:"primary",onClick:()=>p("confirm"),children:"Confirm and Close"})]})]})}const Be=[{id:"cql",name:"Text layer Contextual Query Language (CQL)",searchLabel:"Full-text search",color:"#29a900",searchPlaceholder:"Elephant"},{id:"fcs",name:"Multi-layer Federated Content Search Query Language (FCS-QL)",searchLabel:"Multi-layer annotation search",color:"#00a8cc",searchPlaceholder:"[word = 'annotation'][word = 'focused']"},{id:"lex",name:"Lexical Resources Contextual Query Language (LexCQL)",searchLabel:"Lexical resource search",color:"#e77e00",searchPlaceholder:"banana"}],ve=Object.fromEntries(["cql","fcs","lex"].map(s=>[s,Be.find(t=>t.id===s)])),Ze=["fcs","lex"],qs=[{id:"text",label:"Plain Text"},{id:"csv",label:"CSV"},{id:"tcf",label:"TCF"},{id:"ods",label:"ODS"},{id:"excel",label:"Excel"}],zs="cql",ye=[10,20,50,100,200,250],le="info:srw/diagnostic/1/61",Vs=[{queryType:"cql",query:"Elephant",description:"Query with single term"},{queryType:"cql",query:"cat AND dog",description:"Query with boolean"},{queryType:"cql",query:'"exciting news"',description:"Query with phrase (quoting because of whitespaces)"},{queryType:"fcs",query:'[ word = "her.*" ] [ lemma = "Artznei" ] [ pos = "VERB" ]',description:'Phrase with three tokens: a word starting with "her", a lemmatized word, and a verb'},{queryType:"lex",query:"apple",description:"Search for plain string"}];function Bs({show:s,queryTypes:t,onModalClose:n}){const r=t&&t.length>0?t:["cql","fcs","lex"],i=Vs.filter(m=>r.includes(m.queryType));if(i.length===0)return a("abort"),null;function a(m){n({query:void 0,queryType:void 0,action:m})}function l(m,x){n({query:m,queryType:x,action:"confirm"})}function h(m,x,g,j){return e.jsxs($,{children:[e.jsx(T,{md:"auto",className:"d-none d-md-block",children:j&&`${j}.`}),e.jsxs(T,{className:"d-flex flex-column",children:[g!==void 0&&e.jsx("div",{children:g}),e.jsx("div",{dangerouslySetInnerHTML:{__html:De(m,x)}})]}),e.jsx(T,{md:"auto",className:"d-flex justify-content-end align-items-baseline",children:e.jsx(q,{size:"sm",onClick:()=>l(m,x),children:"Use Query"})})]},m)}return e.jsxs(B,{id:"search-query-suggestions-modal",show:s,onHide:()=>a("close"),size:"xl",fullscreen:"xl-down",centered:!0,children:[e.jsx(B.Header,{closeButton:!0,children:e.jsx(B.Title,{children:"Search Query Suggestions"})}),e.jsx(B.Body,{className:"px-0",children:e.jsx(X,{fluid:!0,children:r.map(m=>{var g;const x=i.filter(j=>j.queryType===m);return x.length===0?null:e.jsxs(o.Fragment,{children:[e.jsx($,{children:e.jsx(T,{children:e.jsx("h4",{className:"border-bottom pb-2",children:((g=ve[m])==null?void 0:g.name)??m.toUpperCase()})})}),x.map((j,C)=>h(j.query,j.queryType,j.description,C+1))]},m)})})}),e.jsx(B.Footer,{children:e.jsx(q,{variant:"primary",onClick:()=>a("close"),children:"Close"})})]})}function jt({disabled:s,value:t,onChange:n,delay:r=300}){const[i,a]=o.useState(t??""),l=ft(i,r);return o.useEffect(()=>{n(l)},[n,l]),e.jsx(F.Control,{type:"search",placeholder:"Search for ...",value:i,onChange:h=>a(h.target.value),disabled:s})}const Ce=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bank" viewBox="0 0 16 16">
  <path d="m8 0 6.61 3h.89a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5H15v7a.5.5 0 0 1 .485.38l.5 2a.498.498 0 0 1-.485.62H.5a.498.498 0 0 1-.485-.62l.5-2A.5.5 0 0 1 1 13V6H.5a.5.5 0 0 1-.5-.5v-2A.5.5 0 0 1 .5 3h.89zM3.777 3h8.447L8 1zM2 6v7h1V6zm2 0v7h2.5V6zm3.5 0v7h1V6zm2 0v7H12V6zM13 6v7h1V6zm2-1V4H1v1zm-.39 9H1.39l-.25 1h13.72z"/>
</svg>`,bt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house-door" viewBox="0 0 16 16">
  <path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4z"/>
</svg>`,Le=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-translate" viewBox="0 0 16 16">
  <path d="M4.545 6.714 4.11 8H3l1.862-5h1.284L8 8H6.833l-.435-1.286zm1.634-.736L5.5 3.956h-.049l-.679 2.022z"/>
  <path d="M0 2a2 2 0 0 1 2-2h7a2 2 0 0 1 2 2v3h3a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-3H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zm7.138 9.995q.289.451.63.846c-.748.575-1.673 1.001-2.768 1.292.178.217.451.635.555.867 1.125-.359 2.08-.844 2.886-1.494.777.665 1.739 1.165 2.93 1.472.133-.254.414-.673.629-.89-1.125-.253-2.057-.694-2.82-1.284.681-.747 1.222-1.651 1.621-2.757H14V8h-3v1.047h.765c-.318.844-.74 1.546-1.272 2.13a6 6 0 0 1-.415-.492 2 2 0 0 1-.94.31"/>
</svg>`;function $e({resource:s,selectedResourceIDs:t,highlighting:n,shouldBeShown:r,onSelectClick:i,languageCodeToName:a}){const[l,h]=o.useState(!1),[m,x]=o.useState(!1);n===void 0&&(n=[null,null,null]);const g=t.includes(s.id);if(typeof r=="function"&&!r(s))return null;if(r===!1)return null;function j(){var u;l&&((u=document.getSelection())==null?void 0:u.type)==="Range"||h(b=>!b)}function C(){i(s,!g)}function _(){x(u=>!u)}return e.jsxs(e.Fragment,{children:[e.jsxs($,{className:`p-2 m-1 ${l&&"border-bottom"}`,children:[e.jsx(T,{md:"auto",sm:1,onClick:C,children:e.jsx(F.Check,{id:`resource-selection-${s.id}`,"aria-label":`Checkbox for resource: ${s.title}`,children:e.jsx(F.Check.Input,{checked:g,onChange:()=>{}})})}),e.jsxs(T,{md:8,sm:11,className:`mb-sm-2 ${l?"":"text-truncate"}`,onClick:j,children:[e.jsxs("h4",{className:`h5 ${l?"":"text-truncate"}`,children:[e.jsx(te.Highlight,{text:s.title,ranges:n[0]})," ",s.landingPage&&e.jsx("small",{children:e.jsxs("a",{href:s.landingPage,className:"matomo_link",target:"_blank",children:["More information ",e.jsx("i",{dangerouslySetInnerHTML:{__html:bt}})]})})]}),e.jsx("p",{className:`mb-0 ${l?"":"text-truncate"}`,children:s.description&&e.jsx(te.Highlight,{text:s.description,ranges:n[2]})})]}),e.jsxs(T,{md:{span:3,offset:0},sm:{span:11,offset:1},className:`${l?"":" text-truncate"}`,onClick:j,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ce}})," ",e.jsx(te.Highlight,{text:s.institution,ranges:n[1]}),e.jsx("br",{}),e.jsx("i",{dangerouslySetInnerHTML:{__html:Le}})," ",s.languages.map(a).sort().join(", ")]}),s.subResources.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-100"}),e.jsx(T,{md:"auto",sm:1,style:{width:"2.8rem"}}),e.jsx(T,{md:{span:8,offset:0},sm:{span:11,offset:1},children:e.jsxs(q,{variant:"link",size:"sm",className:"ps-0",onClick:_,children:[m?"Collapse":"Expand"," (",s.subResources.length," ","subresources)"]})})]})]}),m&&e.jsx(Y,{className:"ms-md-5 ms-sm-2 border-end-0 border-top-0 rounded-end-0 rounded-top-0",children:s.subResources.map(u=>e.jsx($e,{resource:u,selectedResourceIDs:t,shouldBeShown:r,onSelectClick:i,languageCodeToName:a},u.id))})]})}function et({title:s,resources:t,selectedResourceIDs:n,expanded:r,shouldBeShown:i,onSelectClick:a,onExpandToggleClick:l,onSelectAllClick:h,onDeselectAllClick:m,languageCodeToName:x}){const[g,j]=o.useState(r);o.useEffect(()=>{j(r)},[r]);function C(){j(u=>!u),l(!g)}function _(){const u=re(t).length,b=t.length,w=re(t).filter(p=>n.includes(p)).length;return e.jsxs(e.Fragment,{children:[b," ",u!==b&&e.jsxs(e.Fragment,{children:["(+ ",u-b," nested)"]})," ","Resource",u!==1?"s":"",w!==u&&e.jsxs(e.Fragment,{children:[", ",w," Resource",w!==1?"s":""," selected"]})]})}return e.jsxs(X,{className:"border-bottom pb-2 mb-4 px-0",children:[e.jsxs($,{className:"px-3",children:[e.jsx(T,{md:9,sm:12,children:e.jsx("h3",{children:s})}),e.jsxs(T,{md:3,sm:12,className:"gap-1 d-inline-flex column-gap-2 justify-content-evenly",style:{height:"fit-content"},children:[e.jsxs(q,{size:"sm",variant:"secondary",onClick:C,"aria-expanded":g,children:[g?"Hide":"Show"," Resources"]}),e.jsx(q,{size:"sm",onClick:()=>h(t),children:"Select All"}),e.jsx(q,{size:"sm",onClick:()=>m(t),children:"Deselect All"})]})]}),e.jsx($,{className:"px-3",children:e.jsx(T,{children:_()})}),e.jsx(ct,{in:g,children:e.jsx(X,{children:t.map(u=>e.jsx($e,{resource:u,selectedResourceIDs:n,shouldBeShown:i,onSelectClick:a,languageCodeToName:x},u.id))})})]})}function $s({show:s,showGrouping:t,resources:n,languages:r,availableResources:i,selectedResources:a,onModalClose:l}){const[h,m]=o.useState(a||i),[x,g]=o.useState(Ns),[j,C]=o.useState(mt),[_,u]=o.useState(Cs),[b,w]=o.useState(""),[p,f]=o.useState({}),[K,V]=o.useState({});o.useEffect(()=>{t&&C(t)},[s,t]),o.useEffect(()=>m(a),[a]);const N=n.filter(v=>i.includes(v.id)).toSorted(ks[_]),k=te.useFuzzySearchList({list:N,queryText:j==="resource"?b:"",getText:v=>[v.title,v.institution,v.description],mapResultItem:({item:v,score:z,matches:W})=>({item:v,matches:W,score:z})});if(o.useMemo(()=>{const v={},z={};n.forEach(W=>{const Z=W.institution;Object.getOwnPropertyNames(v).includes(Z)||(v[Z]={expanded:!0,resources:[]}),v[Z].resources.push(W),W.languages.forEach(ue=>{Object.getOwnPropertyNames(z).includes(ue)||(z[ue]={expanded:!0,resources:[]}),z[ue].resources.push(W)})}),f(v),V(z)},[n]),!n)return null;const E={total:re(n).length,totalRoot:n.length,available:i.length,selected:h.length,visible:re(k.map(v=>v.item)).length,visibleRoot:k.length};function U(v){return pe(v,r)}function L(v,z){const W=h.filter(Z=>!v.includes(Z));m(z?[...W,...v]:W)}function c(v){l({resourceIDs:h,action:v})}function R(v){g(v.target.value)}function D(v){C(v.target.value)}function A(v){u(v.target.value)}function M(){m(i)}function H(){m([])}function Q(){m(k.map(v=>v.item.id))}function d(v,z){L(re([v]),z)}function y(v){L(re(v),!0)}function I(v){L(re(v),!1)}function G(v){return!(!i.includes(v.id)||x==="selected"&&!h.includes(v.id)&&!gt(v,z=>h.includes(z.id)))}function Ae(){return j==="institution"?Object.entries(p).toSorted().map(([v,{expanded:z,resources:W}])=>e.jsx(et,{title:e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ce}})," ",v]}),resources:W,selectedResourceIDs:h,expanded:z,shouldBeShown:G,onSelectAllClick:y,onExpandToggleClick:Z=>{f({...p,[v]:{...p[v],expanded:Z}})},onDeselectAllClick:I,onSelectClick:d,languageCodeToName:U},v)):j==="language"?Object.entries(K).toSorted().map(([v,{expanded:z,resources:W}])=>e.jsx(et,{title:e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Le}})," ",U(v)," [",v,"]"]}),resources:W,selectedResourceIDs:h,expanded:z,shouldBeShown:G,onSelectAllClick:y,onExpandToggleClick:Z=>K[v].expanded=Z,onDeselectAllClick:I,onSelectClick:d,languageCodeToName:U},v)):k.map(({item:v,matches:z})=>e.jsx($e,{resource:v,selectedResourceIDs:h,highlighting:z,shouldBeShown:G,onSelectClick:d,languageCodeToName:U},v.id))}return e.jsxs(B,{id:"resource-selection-modal",show:s,onHide:()=>c("close"),size:"xl",fullscreen:"xl-down",centered:!0,children:[e.jsx(B.Header,{closeButton:!0,children:e.jsx(B.Title,{children:"Resources"})}),e.jsxs(B.Body,{className:"px-0",children:[e.jsx(F,{className:"px-3 pb-3 border-bottom",onSubmit:v=>v.preventDefault(),children:e.jsx(X,{children:e.jsxs($,{className:"d-sm-flex row-gap-2 justify-content-around",children:[e.jsx(T,{md:2,sm:6,children:e.jsx(ie,{label:"View",controlId:"resource-view-options-visibility",children:e.jsxs(F.Select,{value:x,onChange:R,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"selected",children:"Selected only"})]})})}),e.jsx(T,{md:2,sm:6,children:e.jsx(ie,{label:"Group by",controlId:"resource-view-options-grouping",children:e.jsxs(F.Select,{value:j,onChange:D,children:[e.jsx("option",{value:"resource",children:"(Resource)"}),e.jsx("option",{value:"institution",children:"Institution"}),e.jsx("option",{value:"language",children:"Language"})]})})}),e.jsx(T,{md:2,sm:6,children:e.jsx(ie,{label:"Sort by",controlId:"resource-view-options-sorting",children:e.jsxs(F.Select,{value:_,onChange:A,disabled:j!=="resource"||b.trim()!=="",children:[e.jsx("option",{value:"title-up",children:"Title (up)"}),e.jsx("option",{value:"title-down",children:"Title (down)"}),e.jsx("option",{value:"institution-up",children:"Institution (up)"}),e.jsx("option",{value:"institution-down",children:"Institution (down)"})]})})}),e.jsx(T,{md:3,sm:12,children:e.jsx(ie,{label:"Resource filter query",controlId:"resource-view-options-filter",children:e.jsx(jt,{disabled:j!=="resource",value:b,onChange:v=>w(v)})})}),e.jsxs(T,{md:3,sm:12,className:"gap-1 d-inline-flex column-gap-2 justify-content-evenly",children:[e.jsx(q,{onClick:M,children:"Select all"}),e.jsx(q,{onClick:Q,disabled:x!=="all"||b.trim()==="",children:"Select visible"}),e.jsx(q,{onClick:H,children:"Deselect all"})]})]})})}),e.jsxs("p",{className:"m-4 mb-0",children:[E.selected," / ",E.visible," ",E.available!==E.visible&&e.jsxs(e.Fragment,{children:["(",E.available,")"]})," ","resources selected."]}),e.jsx(X,{className:"px-3 pt-3",children:Ae()})]}),e.jsx(B.Footer,{children:e.jsx(q,{variant:"primary",onClick:()=>c("confirm"),children:"Confirm and Close"})})]})}function Qs(){const[s,t]=o.useState(!1);return[s,()=>{s!==!0&&t(!0)}]}const Gs=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-balloon" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 9.984C10.403 9.506 12 7.48 12 5a4 4 0 0 0-8 0c0 2.48 1.597 4.506 4 4.984M13 5c0 2.837-1.789 5.227-4.52 5.901l.244.487a.25.25 0 1 1-.448.224l-.008-.017c.008.11.02.202.037.29.054.27.161.488.419 1.003.288.578.235 1.15.076 1.629-.157.469-.422.867-.588 1.115l-.004.007a.25.25 0 1 1-.416-.278c.168-.252.4-.6.533-1.003.133-.396.163-.824-.049-1.246l-.013-.028c-.24-.48-.38-.758-.448-1.102a3 3 0 0 1-.052-.45l-.04.08a.25.25 0 1 1-.447-.224l.244-.487C4.789 10.227 3 7.837 3 5a5 5 0 0 1 10 0m-6.938-.495a2 2 0 0 1 1.443-1.443C7.773 2.994 8 2.776 8 2.5s-.226-.504-.498-.459a3 3 0 0 0-2.46 2.461c-.046.272.182.498.458.498s.494-.227.562-.495"/>
</svg>`,Se=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear-fill" viewBox="0 0 16 16">
  <path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z"/>
</svg>`,Ks=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-highlights" viewBox="0 0 16 16">
  <path d="M16 8A8 8 0 1 0 0 8a8 8 0 0 0 16 0m-8 5v1H4.5a.5.5 0 0 0-.093.009A7 7 0 0 1 3.1 13zm0-1H2.255a7 7 0 0 1-.581-1H8zm-6.71-2a7 7 0 0 1-.22-1H8v1zM1 8q0-.51.07-1H8v1zm.29-2q.155-.519.384-1H8v1zm.965-2q.377-.54.846-1H8v1zm2.137-2A6.97 6.97 0 0 1 8 1v1z"/>
</svg>`,Ws=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-magic" viewBox="0 0 16 16">
  <path d="M9.5 2.672a.5.5 0 1 0 1 0V.843a.5.5 0 0 0-1 0zm4.5.035A.5.5 0 0 0 13.293 2L12 3.293a.5.5 0 1 0 .707.707zM7.293 4A.5.5 0 1 0 8 3.293L6.707 2A.5.5 0 0 0 6 2.707zm-.621 2.5a.5.5 0 1 0 0-1H4.843a.5.5 0 1 0 0 1zm8.485 0a.5.5 0 1 0 0-1h-1.829a.5.5 0 0 0 0 1zM13.293 10A.5.5 0 1 0 14 9.293L12.707 8a.5.5 0 1 0-.707.707zM9.5 11.157a.5.5 0 0 0 1 0V9.328a.5.5 0 0 0-1 0zm1.854-5.097a.5.5 0 0 0 0-.706l-.708-.708a.5.5 0 0 0-.707 0L8.646 5.94a.5.5 0 0 0 0 .707l.708.708a.5.5 0 0 0 .707 0l1.293-1.293Zm-3 3a.5.5 0 0 0 0-.706l-.708-.708a.5.5 0 0 0-.707 0L.646 13.94a.5.5 0 0 0 0 .707l.708.708a.5.5 0 0 0 .707 0z"/>
</svg>`,Ys=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
  <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
</svg>`,Xs=o.lazy(()=>Ds(()=>import("./fcs-sru-aggregator-ui-query-builder-0.0.0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url));function tt(s,t=""){const n=s.get("query");return n||t}function st(s,t="cql"){const n=s.get("queryType");if(n){if(Be.find(r=>r.id===n)!==void 0)return n;console.warn("Found unsupported queryType in search params",n)}return t}function Js({resources:s,languages:t,onSearch:n,availableResources:r=null,selectedResources:i=null,hasSearch:a=!1,disabled:l=!1}){var Ge;const[h,m]=rt(),[x,g]=o.useState(!1),[j,C]=o.useState(mt),[_,u]=o.useState(!1),[b,w]=o.useState(!1),[p,f]=o.useState(!1),[K,V]=Qs(),[N,k]=o.useState(se),[E,U]=o.useState(ke),[L,c]=o.useState(st(h,zs)),[R,D]=o.useState(r??[]),[A,M]=o.useState(i??[]),[H,Q]=o.useState(ye[0]),[d,y]=o.useState(tt(h,"")),[I]=o.useState(null),[G,Ae]=o.useState(!1);o.useEffect(()=>{M(i??[])},[i]);const v=o.useCallback(S=>{const O=As(S,L,E==="byGuess"?se:N);return r&&r.length>0?O.filter(ee=>r.includes(ee)):O},[L,N,E,r]);o.useEffect(()=>{const S=v(s);D(S),M(O=>O.filter(ee=>S.includes(ee)))},[s,v]);const z=o.useCallback(()=>{const S={language:N,languageFilter:E,queryType:L,query:d,resourceIDs:A??[],numberOfResults:H};S.query!==""&&S.resourceIDs.length!==0&&n(S)},[N,E,H,n,d,L,A]);o.useEffect(()=>{if(h&&(y(O=>tt(h,O)),c(O=>st(h,O)),!h.get("x-aggregation-context"))){const O=h.get("mode");O&&(O==="search"&&z(),m(ee=>(ee.delete("mode"),ee)))}},[h,m,z]),o.useEffect(()=>m(S=>(S.set("query",d),S)),[d,m]),o.useEffect(()=>m(S=>(S.set("queryType",L),S)),[L,m]);const W=Es(s,A??[]).length,Z=s.find(S=>S.searchCapabilitiesResolved.includes("ADVANCED_SEARCH"))!==void 0,ue=s.find(S=>S.searchCapabilitiesResolved.includes("LEX_SEARCH"))!==void 0,Nt=Ze.includes(L);function Ct(S){S&&c(S)}function Lt(S){let O=Number.parseInt(S.target.value);O<10&&(O=10),O>250&&(O=250),ye.includes(O)||console.warn("Invalid number of results?!",{valid:ye,value:O}),Q(O)}function Tt({language:S,filter:O,action:ee}){u(!1),ee!=="abort"&&(k(S),U(O))}function At({resourceIDs:S,action:O}){g(!1),O!=="abort"&&M(S)}function Et({query:S,queryType:O,action:ee}){w(!1),ee!=="abort"&&ee!=="close"&&(!S||!O||(c(O),y(S)))}function Mt({query:S,action:O}){f(!1),O!=="abort"&&O!=="close"&&y(S)}function Qe(S){y(S)}function It(S){S.preventDefault(),z()}function _t(){const S=(A??[]).length;return S===1?"1 selected resource":s.length===S||R.length===S?`All available resources (${S})`:`${S} selected resources`}return e.jsxs("search",{id:"fcs-query",children:[e.jsxs(F,{noValidate:!0,onSubmit:It,children:[e.jsxs(Wt,{size:a?void 0:"lg",hasValidation:!0,children:[e.jsx(q,{variant:"outline-secondary",type:"button",id:"fcs-search-query-suggestions-button","aria-label":"Open modal with suggestions for search queries",onClick:()=>w(!0),children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Gs},"aria-hidden":"true"})}),e.jsx(F.Control,{placeholder:"Elephant","aria-label":"search query input","aria-describedby":"fcs-search-input-button",className:"text-center search-query-input",disabled:l,"aria-disabled":l,value:d,isInvalid:!!I,...G?{as:pt,queryType:L,onChange:Qe}:{onChange:S=>Qe(S.target.value)}}),Nt&&e.jsx(q,{id:"fcs-search-input-query-builder-button",variant:"outline-secondary","aria-label":"Open modal to use the visual query builder to construct a search query",className:"border-end-0 d-none d-md-block",onClick:()=>{V(),f(!0)},children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ws},"aria-hidden":"true"})}),e.jsx(Yt,{id:"fcs-search-input-enhanced-button",value:"enhance-query",type:"checkbox",checked:G,onChange:()=>Ae(S=>!S),variant:"outline-secondary","aria-label":"Enable enhanced visual input support with syntax highlighting",className:"d-flex align-items-center border-end-0",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ks},"aria-hidden":"true"})}),e.jsxs(q,{variant:"outline-primary",type:"submit",id:"fcs-search-input-button",disabled:l||d.trim().length===0,"aria-disabled":l,"aria-label":"Start the search",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ys},"aria-hidden":"true",className:"d-inline d-md-none"}),e.jsx("span",{className:"d-none d-md-inline",children:"Search"})]}),e.jsx(F.Control.Feedback,{type:"invalid",children:I==null?void 0:I.msg})]}),e.jsxs("div",{id:"fcs-query-filters",className:"mt-2 mb-3 lh-lg text-center",children:["Perform a"," ",e.jsxs(ae,{className:"d-inline-block",onSelect:Ct,"aria-disabled":l,"aria-label":"Search query type",children:[e.jsxs(ae.Toggle,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2 no-arrow",disabled:l,"aria-disabled":l,style:ve[L]?{"--color":ve[L].color}:{},children:[((Ge=ve[L])==null?void 0:Ge.searchLabel)||"???"," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:Se},"aria-hidden":"true"})]}),e.jsx(ae.Menu,{children:Be.filter(S=>S.id==="cql"||S.id==="fcs"&&Z||S.id==="lex"&&ue).map(S=>e.jsx(ae.Item,{as:"button",eventKey:S.id,onClick:O=>O.preventDefault(),style:{"--color":S.color,background:"color-mix(in srgb, var(--color) 50%, transparent)"},children:S.name},S.id))})]})," ","in"," ",e.jsxs(q,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2",disabled:l,"aria-disabled":l,onClick:()=>{C("resource"),g(!0)},children:[_t()," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:Se},"aria-hidden":"true"})]})," ","from"," ",e.jsxs(q,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2",disabled:l,"aria-disabled":l,onClick:()=>{C("institution"),g(!0)},children:[W," Institution",W!==1?"s":""," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:Se},"aria-hidden":"true"})]})," ","in"," ",e.jsxs(q,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2",onClick:()=>u(!0),disabled:l,"aria-disabled":l,children:[pe(N,t??{})," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:Se},"aria-hidden":"true"})]})," ","with up to"," ",e.jsx(F.Select,{size:"sm",className:"d-inline-block w-auto mx-1",onChange:Lt,value:H,"aria-label":"Number of search results per endpoint",disabled:l,"aria-disabled":l,children:ye.map(S=>e.jsx("option",{value:S,children:S},S))})," ","results per endpoint."]})]}),e.jsx(Us,{languages:t,resources:s,searchLanguage:N,show:_,onModalClose:Tt}),e.jsx($s,{resources:s,languages:t,availableResources:R,selectedResources:A??[],show:x,showGrouping:j,onModalClose:At}),e.jsx(Bs,{queryTypes:[L],show:b,onModalClose:Et}),Ze.includes(L)&&K&&e.jsx(o.Suspense,{fallback:e.jsx(e.Fragment,{children:"Trying to load Query Builder extension ..."}),children:e.jsx(Xs,{query:d,queryType:L,resources:s,selectedResources:A,show:p,onModalClose:Mt})})]})}const Zs=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots" viewBox="0 0 16 16">
  <path d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"/>
</svg>`;function en({searchId:s,resourceId:t,numberOfResults:n,pollDelay:r=1500}){const i=de(),a=it(),[l,h]=o.useState(!1),{isPending:m,mutate:x,reset:g}=at({mutationFn:fs.bind(null,i,s,{resourceId:t,numberOfResults:n}),mutationKey:["search-result-load-more",s,t],onSuccess:async f=>{f!==void 0&&s!==f&&console.warn("SearchIDs should be the same?!",{searchId:s,searchIdNewButSame:f,resourceId:t}),await a.invalidateQueries({queryKey:["search-results",s,t]}),h(!0)}});r??(r=1500);const{data:j,isLoading:C,isFetching:_}=fe({queryKey:["search-results",s,t],queryFn:ps.bind(null,i,s,t),enabled:l,refetchInterval(f){return f.state.data&&f.state.data.inProgress?r:!1}}),u=m||C||_,b=!!j&&!j.inProgress,w=u||l;l&&b&&(l&&h(!1),a.invalidateQueries({queryKey:["search-result-details",s,t]}));async function p(){g(),x()}return e.jsx(q,{className:"more-results-button",disabled:w,onClick:p,children:w?e.jsx(dt,{animation:"border",className:"d-block"}):e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Zs}})," Load more results"]})})}const Te=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link-45deg" viewBox="0 0 16 16">
  <path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1 1 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4 4 0 0 1-.128-1.287z"/>
  <path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243z"/>
</svg>`;function wt({data:s}){const t=o.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs(He,{hover:!0,responsive:!0,className:"mb-0 results-kwic",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Left Context"}),e.jsx("th",{scope:"col",children:"Hit"}),e.jsx("th",{scope:"col",children:"Right Context"})]})}),e.jsx("tbody",{children:s.kwics.map((n,r)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"text-end text-muted d-none d-sm-table-cell",children:r+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[n.reference&&e.jsx("a",{href:n.reference,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Te}})})," ",n.pid&&e.jsx(xe,{placement:"auto-start",container:t,delay:{show:250,hide:400},overlay:e.jsx(Ne,{id:`ttip-${n.pid}-${r}`,children:n.pid}),children:e.jsx(oe,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:n.left}),e.jsx("td",{children:e.jsx("mark",{children:e.jsx("strong",{children:n.keyword})})}),e.jsx("td",{children:n.right})]},`${n.pid??n.reference??s.resource.id}-${r}`))})]}),e.jsx("div",{ref:t,className:"tooltip-mounting-point"})]})}function yt({data:s}){const t=o.useRef(null);return e.jsxs("div",{className:"results-lexical-entry d-flex flex-column flex-wrap column-gap-2 row-gap-2",children:[s.lexEntries.map((n,r)=>e.jsx(Y,{className:"flex-grow-1",children:e.jsxs(Y.Body,{children:[e.jsx(Y.Title,{children:n.fields.filter(i=>i.type==="lemma").map(i=>i.values).flat(1).map(i=>e.jsx("span",{children:i.value}))}),e.jsxs(Ee,{variant:"flush",children:[(n.lang||n.langUri)&&e.jsxs(Ee.Item,{children:[e.jsx("strong",{children:"lang"}),": ",n.lang," ",n.langUri]}),n.fields.filter(i=>i.type!=="lemma").map(i=>e.jsxs(Ee.Item,{children:[e.jsx("strong",{children:i.type}),":",i.values.map((a,l)=>e.jsx("span",{className:"ms-2 lex-value",children:a.value},l))]},i.type))]}),e.jsx(Y.Link,{children:n.reference&&e.jsxs("a",{href:n.reference,className:"matomo_link",target:"_blank",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Te}})," Original results ..."]})}),e.jsx(Y.Link,{children:n.pid&&e.jsx(xe,{placement:"auto-start",container:t,delay:{show:250,hide:400},overlay:e.jsx(Ne,{id:`ttip-${n.pid}-${r}`,children:n.pid}),children:e.jsx(oe,{bg:"secondary",className:"pid-badge",children:"PID"})})})]})},`${n.pid??n.reference??s.resource.id}-${r}`)),e.jsx("div",{ref:t,className:"tooltip-mounting-point"})]})}function St({data:s}){const t=o.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs(He,{hover:!0,responsive:!0,className:"mb-0 results-lex-plain",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Result with Hit"})]})}),e.jsx("tbody",{children:s.kwics.map((n,r)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"text-end text-muted d-none d-sm-table-cell",children:r+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[n.reference&&e.jsx("a",{href:n.reference,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Te}})})," ",n.pid&&e.jsx(xe,{placement:"auto-start",container:t,delay:{show:250,hide:400},overlay:e.jsx(Ne,{id:`ttip-${n.pid}-${r}`,children:n.pid}),children:e.jsx(oe,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:n.fragments.map((i,a)=>i.hit&&!i.hitKind?e.jsx("mark",{children:e.jsx("strong",{children:i.text})},a):i.hit&&i.hitKind?e.jsx("span",{className:`lex-hitkind-${i.hitKind}`,title:`Annotated as "${i.hitKind.split("-").slice(1).join("-")}"`,children:i.text},a):e.jsx("span",{children:i.text},a))})]},`${n.pid??n.reference??s.resource.id}-${r}`))})]}),e.jsx("div",{ref:t,className:"tooltip-mounting-point"})]})}function vt({data:s}){const t=o.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs(He,{hover:!0,responsive:!0,className:"mb-0 results-plain",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Result with Hit"})]})}),e.jsx("tbody",{children:s.kwics.map((n,r)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"text-end text-muted d-none d-sm-table-cell",children:r+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[n.reference&&e.jsx("a",{href:n.reference,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Te}})})," ",n.pid&&e.jsx(xe,{placement:"auto-start",container:t,delay:{show:250,hide:400},overlay:e.jsx(Ne,{id:`ttip-${n.pid}-${r}`,children:n.pid}),children:e.jsx(oe,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:n.fragments.map((i,a)=>i.hit&&!i.hitKind?e.jsx("mark",{children:e.jsx("strong",{children:i.text})},a):e.jsx("span",{children:i.text},a))})]},`${n.pid??n.reference??s.resource.id}-${r}`))})]}),e.jsx("div",{ref:t,className:"tooltip-mounting-point"})]})}const tn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
  <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"/>
  <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"/>
</svg>`,sn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-envelope-arrow-up" viewBox="0 0 16 16">
  <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4.5a.5.5 0 0 1-1 0V5.383l-7 4.2-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h5.5a.5.5 0 0 1 0 1H2a2 2 0 0 1-2-1.99zm1 7.105 4.708-2.897L1 5.383zM1 4v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1"/>
  <path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m.354-5.354 1.25 1.25a.5.5 0 0 1-.708.708L13 12.207V14a.5.5 0 0 1-1 0v-1.717l-.28.305a.5.5 0 0 1-.737-.676l1.149-1.25a.5.5 0 0 1 .722-.016"/>
</svg>`,Rt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
  <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/>
</svg>`;function nn({show:s,searchId:t,resourceId:n,result:r,viewMode:i,showDiagnostics:a,onModalClose:l}){var L;const h=de(),{languages:m,weblichtLanguages:x}=Ue(),{numberOfResults:g,queryType:j,language:C,languageFilter:_}=Ve(),[u,b]=o.useState(a);o.useEffect(()=>b(a),[a]);const[w,p]=o.useState(i);o.useEffect(()=>p(i),[i]);const f=r.exception||((L=r.diagnostics)==null?void 0:L.filter(c=>c.uri!==le).length)>0;function K(){return!r||r.nextRecordPosition===-1||r.numberOfRecords===-1?!1:(r.numberOfRecords===r.kwics.length,!0)}let V=null,N=!1;if(!x.includes(C)){if(C===se)if(r.resource.languages&&r.resource.languages.length===1)V=r.resource.languages[0];else{const c=[...new Set(r.kwics.map(R=>R.language).filter(R=>R!==null))];c.length===1&&(V=c[0])}V||(console.warn("Cannot use WebLicht: unsupported language",{language:C,languageFilter:_}),N=!0)}function k(c){p(c.target.value)}function E(){return r?w==="kwic"&&(j!=="lex"||!r.isLexHits)?e.jsx(wt,{data:r}):w==="lexical-entry"?e.jsx(yt,{data:r}):j==="lex"&&r.isLexHits?e.jsx(St,{data:r}):e.jsx(vt,{data:r}):null}function U(){return e.jsxs(e.Fragment,{children:["Showing ",e.jsx("strong",{children:r.kwics.length}),K()?e.jsxs(e.Fragment,{children:[" / ",e.jsx("strong",{children:r.numberOfRecords})]}):""," ","results."]})}return e.jsxs(B,{show:s,onHide:()=>l(),size:"xl",fullscreen:"lg-down",centered:!0,className:"resource-search-result-modal",children:[e.jsx(B.Header,{closeButton:!0,children:e.jsx(B.Title,{children:r.resource.title})}),e.jsxs(B.Body,{className:"resource-info",children:[e.jsxs("dl",{className:"mb-0","aria-label":"Resource information",children:[e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ce}}),e.jsx("span",{children:" Institution"})]}),e.jsx("dd",{className:"mb-0",children:r.resource.institution}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Rt}}),e.jsx("span",{children:" Description"})]}),r.resource.description&&e.jsxs(e.Fragment,{children:[e.jsx("dd",{className:"mb-0",children:r.resource.description}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Le}}),e.jsx("span",{children:" Languages"})]})]}),e.jsx("dd",{className:"mb-0",children:r.resource.languages.map(m?c=>pe(c,m):c=>c).toSorted().join(", ")}),e.jsx("dt",{children:"Persistent Identifier"}),e.jsx("dd",{children:r.resource.handle})]}),r.resource.landingPage&&e.jsxs("a",{href:r.resource.landingPage,className:"matomo_link",target:"_blank",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:bt}})," More Information ..."]}),e.jsx("hr",{}),e.jsxs($,{className:"row-gap-2",children:[e.jsx(T,{lg:"auto",md:3,sm:6,children:e.jsx(ie,{label:"View mode",controlId:"results-view-mode",children:e.jsxs(F.Select,{value:w,onChange:k,children:[e.jsx("option",{value:"plain",children:"Plain"}),(j!=="lex"||!r.isLexHits)&&e.jsx("option",{value:"kwic",children:"Keyword in Context"}),j==="fcs"&&e.jsx("option",{value:"annotation-layers",children:"Annotation Layers"}),j==="lex"&&e.jsx("option",{value:"lexical-entry",children:"Dictionary"})]})})}),e.jsx(T,{lg:3,md:3,sm:6,className:"align-content-center",children:e.jsx(F.Check,{disabled:!f,checked:u,onChange:()=>b(c=>!c),id:"results-modal-view-warnings-errors",label:"Show warning and error messages"})}),e.jsxs(T,{lg:"auto",md:6,sm:6,className:"d-flex flex-grow-1 column-gap-3 align-items-center justify-content-end",children:[e.jsxs(ae,{children:[e.jsxs(ae.Toggle,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:tn}})," Download"]}),e.jsx(ae.Menu,{children:qs.map(({id:c,label:R})=>e.jsxs(ae.Item,{href:bs(h,t,n,c,C,_),className:"matomo_download",children:["As ",e.jsx("strong",{children:R})," file"]},c))})]}),e.jsxs(q,{disabled:N,"aria-disabled":N,href:ws(h,t,n,V,C,_),className:"matomo_link",target:"_blank",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:sn}})," Send to Weblicht"]})]})]}),e.jsx("hr",{}),e.jsx("p",{children:U()}),E()]}),u&&f&&e.jsxs(B.Body,{className:"border-top",children:[r.exception&&e.jsxs(J,{variant:"danger","aria-label":"Error information",children:[e.jsxs(J.Heading,{style:{fontSize:"1rem"},children:[e.jsx("span",{className:"text-uppercase",children:"Exception:"})," ",e.jsx("span",{"aria-label":"Error message",children:r.exception.message})]}),r.exception.cause&&e.jsxs("p",{className:"mb-0 small",children:["Cause: ",r.exception.cause]}),r.exception.klass&&e.jsxs("p",{className:"mb-0 small",children:["Caused by: ",e.jsx("code",{children:r.exception.klass})]})]}),r.diagnostics.filter(c=>c.uri!==le).map(c=>e.jsxs(J,{variant:"warning",children:[e.jsx(J.Heading,{style:{fontSize:"1rem"},children:c.message}),c.diagnostic&&e.jsxs("p",{className:"mb-0 small",children:["Details: ",c.diagnostic]}),e.jsxs("p",{className:"mb-0 small",children:["Diagnostic type: ",e.jsx("code",{children:c.uri})]})]},`${c.uri}-${c.message}-${c.diagnostic}`))]}),K()&&e.jsx(B.Footer,{className:"justify-content-center border-top py-2",children:e.jsx(en,{searchId:t,resourceId:n,numberOfResults:g})})]})}const rn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
  <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"/>
  <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"/>
</svg>`;function an({searchId:s,resourceId:t,resultInfo:n,viewMode:r,showResourceDetails:i,showDiagnostics:a}){var U;const l=de(),{languages:h}=Ue(),{queryType:m}=Ve(),x=o.useId(),[g,j]=o.useState(!0),[C,_]=o.useState(!1),u=n.inProgress,b=n.numberOfRecordsLoaded>0,w=n.exception||((U=n.diagnostics)==null?void 0:U.filter(L=>L.uri!==le).length)>0,{data:p,isLoading:f,isError:K}=fe({queryKey:["search-result-details",s,t],queryFn:js.bind(null,l,s,t),enabled:!u});if(u||!b&&(a&&!w||!a)||!p)return null;function V(){_(!0)}function N(){_(!1)}function k(){return p?p.numberOfRecords===-1?p.kwics.length:p.numberOfRecords===p.kwics.length&&p.nextRecordPosition===-1?`${p.kwics.length} / ${p.numberOfRecords}?`:`${p.kwics.length} / ${p.numberOfRecords}`:null}function E(){return p?r==="kwic"&&(m!=="lex"||!p.isLexHits)?e.jsx(wt,{data:p}):r==="lexical-entry"?e.jsx(yt,{data:p}):m==="lex"&&p.isLexHits?e.jsx(St,{data:p}):e.jsx(vt,{data:p}):null}return e.jsxs(e.Fragment,{children:[e.jsxs(Y,{className:"my-1 resource-search-result",role:"group","aria-label":`Results and details for resource ${p.resource.title}`,children:[e.jsxs(Y.Header,{className:"d-flex accordion",children:[e.jsxs("button",{type:"button",onClick:()=>j(L=>!L),"aria-controls":x,"aria-expanded":g,className:`me-3 w-auto flex-grow-1 d-block text-start collapse-toggle-btn ${g?"":"collapsed"}`,children:[e.jsx(oe,{bg:"",className:"text-bg-light border me-2","aria-label":"Number of results (total amount, or currently loaded amount with total available)",children:k()}),e.jsx("span",{"aria-label":"Resource title",children:p.resource.title}),e.jsx("small",{className:"text-muted","aria-label":"Institution name",children:p.resource.institution})]}),e.jsx("div",{className:"d-inline-block ms-auto",children:e.jsxs(q,{size:"sm",onClick:V,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:rn}})," View"]})})]}),e.jsx(ct,{in:g,children:e.jsxs("div",{id:x,children:[i&&e.jsx(Y.Body,{className:"border-bottom resource-info",children:e.jsxs("dl",{className:"mb-0","aria-label":"Resource information",children:[e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ce}}),e.jsx("span",{children:" Institution"})]}),e.jsx("dd",{className:"mb-0",children:p.resource.institution}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Rt}}),e.jsx("span",{children:" Description"})]}),p.resource.description&&e.jsxs(e.Fragment,{children:[e.jsx("dd",{className:"mb-0",children:p.resource.description}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Le}}),e.jsx("span",{children:" Languages"})]})]}),e.jsx("dd",{className:"mb-0",children:p.resource.languages.map(h?L=>pe(L,h):L=>L).toSorted().join(", ")})]})}),b&&e.jsx(Y.Body,{children:E()}),a&&w&&e.jsxs(Y.Body,{className:b?"border-top":"",children:[p.exception&&e.jsxs(J,{variant:"danger","aria-label":"Error information",children:[e.jsxs(J.Heading,{style:{fontSize:"1rem"},children:[e.jsx("span",{className:"text-uppercase",children:"Exception:"})," ",e.jsx("span",{"aria-label":"Error message",children:p.exception.message})]}),p.exception.cause&&e.jsxs("p",{className:"mb-0 small",children:["Cause: ",p.exception.cause]}),p.exception.klass&&e.jsxs("p",{className:"mb-0 small",children:["Caused by: ",e.jsx("code",{children:p.exception.klass})]})]}),p.diagnostics.filter(L=>L.uri!==le).map(L=>e.jsxs(J,{variant:"warning",children:[e.jsx(J.Heading,{style:{fontSize:"1rem"},children:L.message}),L.diagnostic&&e.jsxs("p",{className:"mb-0 small",children:["Details: ",L.diagnostic]}),e.jsxs("p",{className:"mb-0 small",children:["Diagnostic type: ",e.jsx("code",{children:L.uri})]})]},`${L.uri}-${L.message}-${L.diagnostic}`))]})]})})]}),e.jsx(nn,{show:C,searchId:s,resourceId:t,result:p,viewMode:r,showDiagnostics:a,onModalClose:N})]})}const ln="plain",on="lexical-entry",cn="default",dn={default:()=>()=>0,"title-up":s=>(t,n)=>{var a,l;const r=((a=s.get(t.id))==null?void 0:a.title)||"",i=((l=s.get(n.id))==null?void 0:l.title)||"";return r.localeCompare(i)},"title-down":s=>(t,n)=>{var a,l;const r=((a=s.get(t.id))==null?void 0:a.title)||"",i=((l=s.get(n.id))==null?void 0:l.title)||"";return-r.localeCompare(i)},"result-count-total-up":()=>(s,t)=>{const n=s.numberOfRecords!==-1?s.numberOfRecords:s.numberOfRecordsLoaded,r=t.numberOfRecords!==-1?t.numberOfRecords:t.numberOfRecordsLoaded;return n-r},"result-count-total-down":()=>(s,t)=>{const n=s.numberOfRecords!==-1?s.numberOfRecords:s.numberOfRecordsLoaded;return(t.numberOfRecords!==-1?t.numberOfRecords:t.numberOfRecordsLoaded)-n}};function un({searchId:s,pollDelay:t=1500}){const n=de(),{resources:r}=Ue(),{query:i,queryType:a,resourceIDs:l}=Ve(),[h,m]=o.useState(a==="lex"?on:ln),[x,g]=o.useState(cn),[j,C]=o.useState(""),[_,u]=o.useState(!1),[b,w]=o.useState(!1),p=o.useMemo(()=>{const d=new Map;return r==null||r.forEach(y=>{d.set(y.id,y)}),dn[x](d)},[x,r]);t??(t=1500);const{data:f}=fe({queryKey:["search-results",s],queryFn:xs.bind(null,n,s??""),enabled:!!s,refetchInterval(d){return d.state.data&&d.state.data.inProgress>0?t:!1}}),K=o.useMemo(()=>(f==null?void 0:f.results.toSorted(p))||[],[f,p]),V=a==="lex"&&(f==null?void 0:f.results.every(d=>d.numberOfRecords<=0||d.isLexHits===!0)),N=l.length,k=(f==null?void 0:f.inProgress)??N,E=o.useMemo(()=>(f==null?void 0:f.results.filter(d=>(d.numberOfRecords!==-1?d.numberOfRecords:d.numberOfRecordsLoaded)>0).length)??0,[f]),U=o.useMemo(()=>(f==null?void 0:f.results.filter(d=>!d.inProgress&&(d.numberOfRecords!==-1?d.numberOfRecords:d.numberOfRecordsLoaded)>0&&d.diagnostics.filter(y=>y.uri!==le).length>0).length)??0,[f]),L=o.useMemo(()=>(f==null?void 0:f.results.filter(d=>!d.inProgress&&(d.numberOfRecords!==-1?d.numberOfRecords:d.numberOfRecordsLoaded)<=0&&d.diagnostics.filter(y=>y.uri!==le).length===0&&d.exception===null).length)??0,[f]),c=o.useMemo(()=>(f==null?void 0:f.results.filter(d=>!d.inProgress&&(d.numberOfRecords!==-1?d.numberOfRecords:d.numberOfRecordsLoaded)<=0&&(d.diagnostics.filter(y=>y.uri!==le).length>0||d.exception!==null)).length)??0,[f]),R=o.useMemo(()=>(f==null?void 0:f.results.filter(d=>!d.inProgress&&d.numberOfRecords<=0&&d.exception!==null).length)??0,[f]),D=o.useMemo(()=>(f==null?void 0:f.results.filter(d=>!d.inProgress&&(d.numberOfRecords!==-1?d.numberOfRecords:d.numberOfRecordsLoaded)<=0&&d.diagnostics.filter(y=>y.uri!==le).length>0&&d.exception===null).length)??0,[f]),A=o.useMemo(()=>(f==null?void 0:f.results.map(d=>d.numberOfRecords!==-1?d.numberOfRecords:d.numberOfRecordsLoaded).reduce((d,y)=>d+y,0))??0,[f]),M=o.useMemo(()=>(f==null?void 0:f.results.map(d=>d.numberOfRecordsLoaded).reduce((d,y)=>d+y,0))??0,[f]);{const[d,y]=o.useState(!1);o.useEffect(()=>{f&&k===0&&(d||(y(!0),ht(i,a,M)))},[f,k,i,a,s,d,M])}function H(d){m(d.target.value)}function Q(d){g(d.target.value)}return e.jsxs("div",{id:"search-results",className:"mt-2 mb-4",children:[e.jsx(xe,{placement:"auto",overlay:e.jsxs(Me,{id:"search-progress-information-popover",children:[e.jsx(Me.Header,{children:"Search Progress Information"}),e.jsxs(Me.Body,{style:{textIndent:"2rem hanging"},children:[e.jsxs("div",{children:[e.jsx("code",{children:N.toString().padStart(4," ")})," resources requested"]}),k>0&&e.jsxs("div",{children:[e.jsx("code",{children:k.toString().padStart(4," ")})," ↳ resources pending"]}),e.jsx("hr",{className:"mt-2 mb-1"}),e.jsxs("div",{children:[e.jsx("code",{children:(L+c).toString().padStart(4," ")})," ","resources without results"]}),e.jsxs("div",{children:[e.jsx("code",{children:L.toString().padStart(4," ")})," ↳ OK, without issues"]}),D>0&&e.jsxs("div",{children:[e.jsx("code",{children:D.toString().padStart(4," ")})," ↳ with warnings"]}),R>0&&e.jsxs("div",{children:[e.jsx("code",{children:R.toString().padStart(4," ")})," ↳ due to fatal errors"]}),e.jsx("hr",{className:"mt-2 mb-1"}),e.jsxs("div",{children:[e.jsx("code",{children:E.toString().padStart(4," ")})," resources with results"]}),U>0&&e.jsxs("div",{children:[e.jsx("code",{children:U.toString().padStart(4," ")})," ↳ with warnings"]}),e.jsx("hr",{className:"mt-2 mb-0"}),e.jsx("hr",{className:"mt-1 mb-1"}),e.jsxs("div",{children:[e.jsxs("code",{children:[" ",M," ","/"," ",A]})," ","total hits"]})]})]}),children:e.jsxs(be,{className:"mb-3",children:[e.jsx(be,{variant:"success",now:E,max:N,label:e.jsxs("span",{children:[E," resources with results"]}),"aria-label":"Resources with results"}),e.jsx(be,{variant:"secondary",now:L+c,max:N,label:e.jsxs("span",{children:[L+c," resources without results"]}),"aria-label":"Resources without results (might be due to issues)"}),e.jsx(be,{striped:!0,animated:!0,now:k,max:N,label:e.jsxs("span",{children:["Search through ",k," Resources"]}),"aria-label":"Resources with pending results"})]})}),e.jsx(Y,{className:"mb-2",role:"group","aria-label":"Result display and filter options",children:e.jsx(Y.Body,{children:e.jsxs($,{className:"row-gap-2",children:[e.jsx(T,{lg:"auto",md:6,sm:6,children:e.jsx(ie,{label:"View mode",controlId:"results-view-mode",children:e.jsxs(F.Select,{value:h,onChange:H,children:[e.jsx("option",{value:"plain",children:"Plain"}),(a!=="lex"||!V)&&e.jsx("option",{value:"kwic",children:"Keyword in Context"}),a==="fcs"&&e.jsx("option",{value:"annotation-layers",children:"Annotation Layers"}),a==="lex"&&e.jsx("option",{value:"lexical-entry",children:"Dictionary"})]})})}),e.jsx(T,{lg:"auto",md:6,sm:6,children:e.jsx(ie,{label:"Sorting",controlId:"results-sorting",children:e.jsxs(F.Select,{value:x,onChange:Q,children:[e.jsx("option",{value:"default",children:"(default)"}),e.jsx("option",{value:"title-up",children:"Title (up)"}),e.jsx("option",{value:"title-down",children:"Title (down)"}),e.jsx("option",{value:"result-count-total-up",children:"Total result count (up)"}),e.jsx("option",{value:"result-count-total-down",children:"Total result count (down)"})]})})}),e.jsx(T,{lg:"auto",md:12,sm:6,className:"flex-fill order-xl-4",children:e.jsx(ie,{label:"Result filter query",controlId:"result-filter",children:e.jsx(jt,{disabled:x!=="default"||!0,value:j,onChange:d=>C(d)})})}),e.jsxs(T,{lg:"auto",md:12,sm:12,className:"align-content-center order-xl-3",children:[e.jsx(F.Check,{checked:_,onChange:()=>u(d=>!d),id:"results-view-resource-details",label:"Show result details"}),e.jsx(F.Check,{checked:b,onChange:()=>w(d=>!d),id:"results-view-warnings-errors",label:"Show warning and error messages"})]})]})})}),s&&f&&K.map(d=>e.jsx(an,{searchId:s,resourceId:d.id,resultInfo:d,viewMode:h,showResourceDetails:_,showDiagnostics:b},`${s}-${d.id}`))]})}const hn=""+new URL("assets/logo-fcs-dark.png",import.meta.url).href,nt=""+new URL("assets/logo-fcs.png",import.meta.url).href;function mn(){const s=de(),[t,n]=rt(),[r,i]=o.useState([]),[a,l]=o.useState({}),[h,m]=o.useState([]),[x,g]=o.useState(null),[j,C]=o.useState(!1),[_,u]=o.useState(null),[b,w]=o.useState([]),p=P.getState().appTitleHead,{data:f,isLoading:K,isError:V}=fe({queryKey:["init"],queryFn:hs.bind(null,s)});o.useEffect(()=>{if(!f)return;const c=Ls(f.resources);l(f.languages),m(f.weblichtLanguages),i(c),g(re(c))},[f]),o.useEffect(()=>{if(!r||r.length===0)return;const c=t.get("x-aggregation-context");if(c){try{const R=JSON.parse(c),{selected:D,unavailable:A}=Ts(r,R);D.length>0&&(g(D),w(M=>[...M,{title:"Resource Selection",body:e.jsxs(e.Fragment,{children:["Preselected ",e.jsx("strong",{children:D.length})," resources:",e.jsx("br",{}),e.jsx("ul",{className:"ps-3",children:D.map(H=>e.jsx("li",{style:{wordBreak:"break-all",fontSize:"0.7rem"},children:H}))})]}),variant:"success"}])),A.length>0&&w(M=>[...M,{title:"Resource Selection",body:e.jsxs(e.Fragment,{children:["Unable to select ",e.jsx("strong",{children:A.length})," resources:",e.jsx("br",{}),e.jsx("ul",{className:"ps-3",children:A.map(H=>e.jsx("li",{style:{wordBreak:"break-all",fontSize:"0.7rem"},children:H}))})]}),variant:"warning"}])}catch(R){console.error('Error trying to parse "x-aggregation-context" search parameter!',{aggregationContext:c},R),R instanceof Error&&w(D=>[...D,{title:"Resource Selection",body:e.jsxs(e.Fragment,{children:["Unable to preselect resources: ",R.name,e.jsx("br",{}),e.jsx("small",{children:R.message})]}),variant:"error"}])}n(R=>(R.delete("x-aggregation-context"),R))}},[r,t,n]);const N=K||V,{mutate:k,data:E,isPending:U}=at({mutationKey:["search"],mutationFn:({query:c,queryType:R,language:D,numberOfResults:A,resourceIDs:M})=>gs(s,{query:c,queryType:R,language:D,numberOfResults:A.toString(),resourceIds:M})});function L(c){g(c.resourceIDs),u(c),C(!0),ht(c.query,c.queryType),k(c)}return e.jsxs(e.Fragment,{children:[e.jsx(ge,{children:e.jsx("title",{children:p})}),e.jsxs(X,{id:"search",children:[e.jsx("div",{"aria-live":"polite","aria-atomic":"true",className:"bg-dark position-relative",children:e.jsx(Xt,{position:"top-end",className:"mt-2",style:{zIndex:100},children:b.map((c,R)=>e.jsxs(Ie,{bg:c.variant,onClose:()=>w(D=>D.filter(A=>A!==c)),delay:5e3,autohide:!0,children:[e.jsx(Ie.Header,{closeButton:!0,children:e.jsx("strong",{className:"me-auto",children:c.title})}),e.jsx(Ie.Body,{children:c.body})]},R))})}),!j&&e.jsx($,{children:e.jsx(T,{className:"text-center",children:e.jsxs("picture",{children:[e.jsx("source",{srcSet:nt,media:"(prefers-color-scheme: light)"}),e.jsx("source",{srcSet:hn,media:"(prefers-color-scheme: dark)"}),e.jsx("img",{src:nt,className:"logo",alt:"FCS logo"})]})})}),e.jsx($,{className:"mt-3",children:e.jsx(T,{children:e.jsx(Js,{resources:r,languages:a,availableResources:null,selectedResources:x,onSearch:L,hasSearch:j,disabled:N})})}),!j&&e.jsx($,{className:"mt-3",children:e.jsxs(T,{children:[e.jsxs("p",{children:["To enable researchers to search for specific patterns across collections of data, CLARIN offers a search engine that connects to the local data collections that are available in the centres. The data itself stays at the centre where it is hosted – which is why the underlying technique is called ",e.jsx("em",{children:"federated content search"}),"."]}),e.jsx("p",{children:"TODO: some more brief intro text and maybe links for further information ..."})]})}),j&&U&&e.jsx($,{children:e.jsx(T,{className:"text-center my-5",children:e.jsx(dt,{animation:"border"})})}),_&&E&&e.jsx(cs,{resources:r,languages:a,weblichtLanguages:h,children:e.jsx(us,{..._,children:e.jsx(un,{searchId:E})})})]})]})}function gn(){const s=o.useContext(Dt),t=lt(),n=s.matches.map(i=>i.route),r=Ht(n,t);return r!==null&&r.length>0?r[0]:null}function fn(){const{navigator:s}=o.useContext(Ft);return o.useCallback((n,r)=>{if(!s.encodeLocation)return;const i=Ut(n,r),a=s.encodeLocation(i);s.push(a)},[s])}const xn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
  <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"/>
  <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7"/>
</svg>`;function pn({url:s,statistics:t,validatorUrl:n,isScan:r}){var i;return e.jsxs("div",{className:"ps-sm-4 mt-sm-0 mt-2 pt-sm-0 pt-1",children:[e.jsxs("h4",{className:"h5",id:`${ot(s)}-${r?"scan":"search"}`,children:[e.jsx(te.Highlight,{text:s,ranges:t.matchEndpoint}),n&&e.jsxs(e.Fragment,{children:[" ",e.jsx("a",{href:`${n}?url=${encodeURIComponent(s)}`,children:e.jsx("i",{dangerouslySetInnerHTML:{__html:xn},className:"align-baseline ms-2"})})]})]}),e.jsxs("dl",{className:"ps-sm-4",children:[e.jsx("dt",{children:"FCS Version"}),e.jsx("dd",{children:t.version}),e.jsx("dt",{children:"Search capabilities"}),e.jsx("dd",{children:t.searchCapabilities.join(", ")}),e.jsx("dt",{children:"Max concurrent scan requests"}),e.jsx("dd",{children:t.maxConcurrentRequests}),e.jsx("dt",{children:"Request statistics"}),e.jsxs("dd",{className:"mb-0",children:[t.numberOfRequests," request(s)"]}),t.avgQueueTime!==0&&e.jsxs("dd",{className:"mb-0",children:["Queue time (in seconds): average: ",t.avgQueueTime,", max:"," ",t.maxQueueTime]}),e.jsxs("dd",{children:["Execution time (in seconds): average: ",t.avgExecutionTime,", max:"," ",t.maxExecutionTime]}),((i=t.rootResources)==null?void 0:i.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx("dt",{children:"Resources"}),e.jsxs("dd",{children:[t.rootResources.length," root resources"]}),e.jsx("dd",{children:e.jsx("ul",{children:t.rootResources.map((a,l)=>{var h;return e.jsx("li",{children:e.jsx(te.Highlight,{text:a,ranges:((h=t.matchResources)==null?void 0:h[l])??null})},a)})})})]}),e.jsxs(e.Fragment,{children:[Object.entries(t.diagnostics||{}).map(([a,l])=>e.jsxs(J,{variant:"warning",style:{fontSize:"0.85rem"},children:[e.jsxs(J.Heading,{style:{fontSize:"1rem"},children:[e.jsxs(oe,{bg:"warning",children:[l.counter,"x"]})," ",e.jsx("span",{className:"text-uppercase",children:"Diagnostic:"})," ",l.diagnostic.message,l.diagnostic.diagnostic&&e.jsxs(e.Fragment,{children:[" - ",e.jsx("small",{children:l.diagnostic.diagnostic})]})]}),e.jsxs("p",{className:"mb-0",children:["Context: ",e.jsx("a",{href:l.context,children:l.context})]})]},a)),Object.entries(t.errors||{}).map(([a,l])=>e.jsxs(J,{variant:"danger",style:{fontSize:"0.85rem"},children:[e.jsxs(J.Heading,{style:{fontSize:"1rem"},children:[e.jsxs(oe,{bg:"danger",children:[l.counter,"x"]})," ",e.jsx("span",{className:"text-uppercase",children:"Exception:"})," ",l.exception.message]}),e.jsxs("p",{className:"mb-0",children:["Context: ",e.jsx("a",{href:l.context,children:l.context})]}),l.exception.cause&&e.jsxs("p",{className:"mb-0",children:["Caused by: ",l.exception.cause]})]},a))]})]})]},s)}function jn({data:s,validatorUrl:t}){const[n,r]=o.useState(""),[i,a]=o.useState(["institution","endpoint","resources"]),[l,h]=o.useState(!1),m=`-${s.isScan?"scan":"search"}`,x=o.useMemo(()=>Object.entries(s.institutions).toSorted().map(([u,b])=>Object.entries(b).toSorted().map(([w,p])=>({institutionName:u,endpointUrl:w,endpointInfo:{...p,rootResources:p.rootResources.toSorted()}}))).flat(1).filter(l?u=>Object.keys(u.endpointInfo.diagnostics).length>0||Object.keys(u.endpointInfo.errors).length>0:()=>!0),[s,l]),g=x.filter(u=>Object.keys(u.endpointInfo.diagnostics).length>0||Object.keys(u.endpointInfo.errors).length>0),C=te.useFuzzySearchList({list:x,queryText:n,getText:u=>{const b=[];return i.length===0?b.push(u.institutionName,u.endpointUrl,...u.endpointInfo.rootResources):(i.includes("institution")&&b.push(u.institutionName),i.includes("endpoint")&&b.push(u.endpointUrl),i.includes("resources")&&b.push(...u.endpointInfo.rootResources)),b},mapResultItem:({item:u,score:b,matches:w})=>({item:u,matches:w,score:b})}).reduce((u,b)=>{const{institutionName:w,endpointUrl:p,endpointInfo:f}=b.item;return Object.getOwnPropertyNames(u).includes(w)||(u[w]={match:i.length===0||i.includes("institution")?b.matches[0]:null,endpoints:{}}),u[w].endpoints[p]={...f,matchEndpoint:i.length===0||i.includes("endpoint")?b.matches[i.length===0||i.includes("institution")?1:0]:null,matchResources:i.length===0||i.includes("resources")?b.matches.slice(0+(i.length===0||i.includes("institution")?1:0)+(i.length===0||i.includes("endpoint")?1:0)):[]},u},{});function _(u){i.includes(u)?a(i.filter(b=>b!==u)):a([...i,u])}return e.jsxs(X,{className:"d-grid gap-2 mt-3",children:[e.jsx(J,{variant:"info",className:"mb-0",children:e.jsxs("dl",{className:"mb-0",children:[e.jsx("dt",{children:"Start date"}),e.jsx("dd",{className:"mb-0",children:new Date(s.date).toLocaleString()}),e.jsx("dt",{children:"Timeout (in seconds)"}),e.jsx("dd",{className:"mb-0",children:s.timeout})]})}),e.jsx(F,{onSubmit:u=>u.preventDefault(),children:e.jsxs($,{className:"gy-2",children:[e.jsx(T,{lg:6,md:12,children:e.jsx(F.Control,{placeholder:"Type to filter statistics ...",value:n,onChange:u=>r(u.target.value)})}),e.jsxs(T,{className:"filter-checkboxes",lg:6,md:12,children:[e.jsx(F.Text,{className:"me-2",children:"Apply filter to:"}),e.jsx(F.Check,{type:"checkbox",checked:i.includes("institution"),onChange:()=>_("institution"),id:`filter-institution-name${m}`,label:"Institution"}),e.jsx(F.Check,{type:"checkbox",checked:i.includes("endpoint"),onChange:()=>_("endpoint"),id:`filter-endpoint-url${m}`,label:"Endpoint"}),e.jsx(F.Check,{type:"checkbox",checked:i.includes("resources"),onChange:()=>_("resources"),id:`filter-resource-names${m}`,label:"Resources"})]})]})}),e.jsx($,{children:e.jsx(T,{children:e.jsx(F.Check,{type:"checkbox",checked:l,onChange:()=>h(!l),id:`filter-show-issues-only${m}`,label:`Only show endpoints with issues (errors or warnings, currently affects ${g.length} endpoint${g.length!==1?"s":""})`})})}),Object.entries(C).map(([u,{match:b,endpoints:w}])=>e.jsxs(Y,{className:"p-2",children:[e.jsx("h3",{className:"h4 pb-1 border-bottom",id:`${ot(u)}${m}`,children:e.jsx(te.Highlight,{text:u,ranges:b})}),Object.entries(w).toSorted().map(([p,f])=>e.jsx(pn,{url:p,statistics:f,validatorUrl:t,isScan:s.isScan},p))]},u))]})}const bn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"/>
  <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"/>
</svg>`,wn=[{id:"last-scan",label:"Last Scan"},{id:"recent-searches",label:"Recent Searches"}],yn=Object.fromEntries(wn.map(s=>[s.id,s]));function Sn(){const s=de(),t=it(),{categoryId:n}=qt(),r=gn(),i=fn(),{isPending:a,isError:l,data:h,error:m}=fe({queryKey:["statistics"],queryFn:ms.bind(null,s)}),[x,g]=o.useState(P.getState().validatorURL);P.subscribe(w=>g(w.validatorURL));const j=P.getState().appTitleHead,C=h!==void 0?Object.keys(h):[],_=n!=null&&C.includes(n)?n:C.length>0?C[0]:void 0;function u(){t.invalidateQueries({queryKey:["statistics"]})}function b(w){r==null||r.params.categoryId,r&&r.params.categoryId!==w&&r.route.path&&i(r.route.path,{categoryId:w})}return e.jsxs(e.Fragment,{children:[e.jsx(ge,{children:e.jsxs("title",{children:[j," – Statistics"]})}),e.jsxs(X,{id:"statistics",className:"my-3",children:[e.jsx("h1",{className:"h1",children:"Statistics"}),(a||l)&&e.jsx($,{children:e.jsxs(T,{children:[a?"Loading ...":null,e.jsx("br",{}),l?m.message:null]})}),h&&e.jsxs(_e.Container,{defaultActiveKey:_,onSelect:b,children:[e.jsxs(ne,{className:"nav-tabs",as:"ul",children:[Object.keys(h).map(w=>{var p;return e.jsx(ne.Item,{as:"li",role:"presentation",children:e.jsx(ne.Link,{as:"button",eventKey:w,children:((p=yn[w])==null?void 0:p.label)??w})},w)}),e.jsx(ne.Item,{as:"li",role:"presentation",className:"ms-auto",children:e.jsxs(ne.Link,{as:"button",onClick:u,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:bn}})," Refresh"]})})]}),e.jsx(_e.Content,{children:Object.entries(h).map(([w,p])=>e.jsx(_e.Pane,{eventKey:w,children:e.jsx(jn,{data:p,validatorUrl:x})},w))})]})]})]})}function vn(){const s=P.getState().appTitleHead;as();{const t=lt(),[n,r]=o.useState(t.pathname);o.useEffect(()=>{const i=t.pathname;i!==n&&(r(i+t.search),ut(i,document.title,n))},[t,n])}return e.jsxs(e.Fragment,{children:[e.jsx(ge,{children:e.jsx("title",{children:s})}),e.jsx(ns,{}),e.jsx("main",{children:e.jsxs(zt,{children:[e.jsx(je,{index:!0,element:e.jsx(mn,{})}),e.jsx(je,{path:"about",element:e.jsx(ls,{})}),e.jsx(je,{path:"help",element:e.jsx(os,{})}),e.jsx(je,{path:"stats/:categoryId?",element:e.jsx(Sn,{})})]})}),e.jsx(ts,{})]})}window.MyAggregator=window.MyAggregator||{};window._paq=window._paq||[];const Rn=["DEPLOY_PATH","API_URL","APP_TITLE","APP_TITLE_HEAD","TERMS_AND_DISCLAIMER_ADDRESS","CONTACT_ADDRESS","MATOMO_TRACKING_PARAMS"];function Nn(){window.MyAggregator.DEPLOY_PATH!==void 0&&P.getState().setDeployPath(window.MyAggregator.DEPLOY_PATH),window.MyAggregator.API_URL!==void 0&&P.getState().setApiURL(window.MyAggregator.API_URL),window.MyAggregator.VALIDATOR_URL!==void 0&&P.getState().setValidatorURL(window.MyAggregator.VALIDATOR_URL),window.MyAggregator.SHOW_SEARCH_RESULT_LINK!==void 0&&P.getState().setShowSearchResultLink(window.MyAggregator.SHOW_SEARCH_RESULT_LINK),window.MyAggregator.APP_TITLE!==void 0&&P.getState().setAppTitle(window.MyAggregator.APP_TITLE),window.MyAggregator.APP_TITLE_HEAD!==void 0&&P.getState().setAppTitleHead(window.MyAggregator.APP_TITLE_HEAD),window.MyAggregator.TERMS_AND_DISCLAIMER_ADDRESS!==void 0&&P.getState().setTermsAndDisclaimerUrl(window.MyAggregator.TERMS_AND_DISCLAIMER_ADDRESS),window.MyAggregator.CONTACT_ADDRESS!==void 0&&P.getState().setContactAddress(window.MyAggregator.CONTACT_ADDRESS),window.MyAggregator.MATOMO_TRACKING_PARAMS!==void 0&&P.getState().setMatomoTrackingParams(window.MyAggregator.MATOMO_TRACKING_PARAMS),window.MyAggregator.AUTH_USERNAME!==void 0&&P.getState().setAuthUsername(window.MyAggregator.AUTH_USERNAME),window.MyAggregator=new Proxy(window.MyAggregator,{get(s,t){return s[t]},set(s,t,n){return Rn.includes(t)?(console.error(`Configuration ${t} can only be set on initialization!`),!1):t==="VALIDATOR_URL"?n===null||typeof n=="string"?(P.getState().setValidatorURL(n),!0):!1:t==="SHOW_SEARCH_RESULT_LINK"?typeof n=="boolean"?(P.getState().setShowSearchResultLink(n),!0):!1:t==="AUTH_USERNAME"?n===null||typeof n=="string"?(P.getState().setAuthUsername(n),!0):!1:(s[t]=n,!0)}}),Object.assign(window.MyAggregator,{getAppStore:()=>P})}Nn();P.getInitialState(),P.getState();const Cn=P.getState().deployPath,Ln=P.getState().apiURL,Tn=new Vt({defaultOptions:{queries:{}}}),An=Bt.create({baseURL:Ln,timeout:5e3,responseType:"json",transitional:{silentJSONParsing:!1}});{const s=P.getState().matomoTrackingParams;Rs(s)||console.warn("Unable to setup tracking ...")}const En="root",Mn=document.getElementById(En),In=es.createRoot(Mn);In.render(e.jsx(o.StrictMode,{children:e.jsx(ds,{axios:An,children:e.jsx($t,{client:Tn,children:e.jsx(Qt,{children:e.jsx(Gt,{basename:Cn,children:e.jsx(vn,{})})})})})}));export{pt as C,Ks as h,ft as u};
//# sourceMappingURL=fcs-sru-aggregator-ui-0.0.0.js.map
