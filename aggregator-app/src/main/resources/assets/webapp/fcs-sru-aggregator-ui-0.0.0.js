const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./fcs-sru-aggregator-ui-query-builder-0.0.0.js","./vendor/react-ext.js","./vendor/react.js","./vendor/bootstrap.js","./vendor/antlr4.js","./locales/en/default.js","./vendor/prism.js","./fcs-sru-aggregator-ui-query-builder-0.0.0.css","./vendor/bootstrap.css"])))=>i.map(i=>d[i]);
import{r as d,u as Ae,c as zs,b as ne,j as e,L as Te,T as G,d as $s,e as _t,N as As,f as xe,g as At,h as kt,H as $e,R as Mt,k as Pt,l as Ks,m as ws,n as Ws,o as Qs,p as Re,q as Ot,s as Ut,t as Dt,v as Gs,w as Ht,x as Ft,y as Je,Q as Bt,z as Vt,A as qt,B as zt,C as $t}from"./vendor/react-ext.js";import{b as Kt}from"./vendor/react.js";/* empty css                            */import{C as ie,R as se,a as D,N as Ie,b as ue,c as Ze,d as E,B as fe,M as te,F as q,e as ee,T as Ke,f as ke,g as Ys,h as ve,I as Wt,D as oe,S as Xs,i as ae,O as Ce,j as Me,L as qe,A as de,P as es,k as us,l as Qt,m as ds,n as He}from"./vendor/bootstrap.js";import{_ as Js,a as Zs,b as Gt,c as Yt,d as Xt}from"./locales/en/default.js";import{g as Jt}from"./vendor/prism.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();var ss={},ks;function Zt(){if(ks)return ss;ks=1;var n=Kt();return ss.createRoot=n.createRoot,ss.hydrateRoot=n.hydrateRoot,ss}var en=Zt();const ye="x-consortia";async function sn(n,s){const t=new URLSearchParams;s?.consortia!==void 0&&s?.consortia!==null&&t.set(ye,s.consortia);const r="init"+(t.entries().next().done?"":`?${t}`);return(await n.get(r)).data}async function et(n,s){const t=new URLSearchParams;s?.consortia!==void 0&&s?.consortia!==null&&t.set(ye,s.consortia);const r="resources"+(t.entries().next().done?"":`?${t}`);return(await n.get(r)).data}async function tn(n,s){const t=new URLSearchParams;s?.consortia!==void 0&&s?.consortia!==null&&t.set(ye,s.consortia);const r="languages"+(t.entries().next().done?"":`?${t}`);return(await n.get(r)).data}async function nn(n,s){const t=new URLSearchParams;s?.consortia!==void 0&&s?.consortia!==null&&t.set(ye,s.consortia);const r="statistics"+(t.entries().next().done?"":`?${t}`);return(await n.get(r)).data}async function rn(n,s){return(await n.post("search",s,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data}async function an(n,s,t){return(await n.post(`search/${s}`,t,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data}async function on(n,s){if(!s)throw new Error('Invalid "searchID" parameter!');return(await n.get(`search/${s}/metaonly`)).data}async function ln(n,s,t){if(!s)throw new Error('Invalid "searchID" parameter!');if(!t)throw new Error('Invalid "resourceID" parameter!');const i=(await n.get(`search/${s}/metaonly?resourceId=${encodeURIComponent(t)}`)).data.results.filter(a=>a.id===t);if(i.length===0)throw new Error(`Results (meta) for resource not found! (searchId: ${s}, resourceId: ${t})`);return i[0]}async function cn(n,s,t){if(!s)throw new Error('Invalid "searchID" parameter!');if(!t)throw new Error('Invalid "resourceID" parameter!');const i=(await n.get(`search/${s}?resourceId=${encodeURIComponent(t)}`)).data.results.filter(a=>a.resource.id===t);if(i.length===0)throw new Error(`Results for resource not found! (searchId: ${s}, resourceId: ${t})`);return i[0].records===void 0&&console.warn("Using legacy FCS SRU Aggregator API with Search Results not in '.records'!",{searchID:s},i),i[0]}function un(n,s,t,r,i,a){const c=new URLSearchParams({resourceId:t,format:r});(a==="byGuess"||a==="byMetaAndGuess")&&c.set("filterLanguage",i);const o=`search/${s}/download?${c.toString()}`;return n.getUri({url:o})}function dn(n,s,t,r,i,a){const c=new URLSearchParams({resourceId:t});r?c.set("filterLanguage",r):(a==="byGuess"||a==="byMetaAndGuess")&&c.set("filterLanguage",i);const o=`search/${s}/toWeblicht?${c.toString()}`;return n.getUri({url:o})}const hn=[ye];function Ms(n){return n.entries().next().done?void 0:`?${n}`}function mn(){const[n]=Ae(),s=d.useMemo(()=>new URLSearchParams(Array.from(n.entries()).filter(([r])=>hn.includes(r))),[n]),t=d.useCallback(r=>{const i=new URLSearchParams(s);return zs(r).forEach((a,c)=>i.append(c,a)),i},[s]);return[s,t]}function Pe(){const[n,s]=mn(),t=Ms(n),r=d.useCallback(i=>Ms(s(i)),[s]);return[t,r]}function gn(){const{t:n}=ne(),s="urls.termsUseAndDisclaimer",t=n(s,{ns:"common"}),r=t!==s,i="urls.contact",a=n(i,{ns:"common"}),c=a!==i,o="footer.serviceInfo.text",u=n(o)!==o,[j]=Pe();return e.jsx("footer",{className:"text-muted",children:e.jsx(ie,{children:e.jsxs(se,{children:[e.jsxs(D,{className:"text-start d-flex flex-sm-row flex-column column-gap-3 row-gap-2",children:[e.jsxs("div",{children:[e.jsx(Te,{to:{pathname:"/about",search:j},className:"hidden-xs",children:n("footer.links.about")}),e.jsxs("div",{className:"version-info text-muted text-center-xs",children:["v","0.0.0"]})]}),e.jsx(Te,{to:{pathname:"/stats",search:j},children:n("footer.links.statistics")})]}),e.jsx(D,{className:"text-center",children:u&&e.jsx(G,{i18nKey:o,components:{serviceBy:e.jsx("a",{href:n("footer.serviceInfo.urlServiceBy")}),hostedBy:e.jsx("a",{href:n("footer.serviceInfo.urlHostedBy")})}})}),e.jsxs(D,{className:"hidden-xs text-end d-flex flex-sm-row flex-column justify-content-sm-end column-gap-3 row-gap-2",children:[r&&e.jsx("a",{href:t,children:n("footer.links.termsUseAndDisclaimer")}),c&&e.jsx("a",{href:a,children:n("footer.links.contact")})]})]})})})}const J=$s(n=>({deployPath:"/",apiURL:"https://contentsearch.clarin.eu/rest/",validatorURL:"https://www.clarin.eu/fcsvalidator/",showSearchResultLink:!1,appTitle:"Content Search",appTitleHead:"FCS Aggregator – Content Search",matomoTrackingEnabled:!0,matomoTrackingParams:null,authUsername:null,setDeployPath:s=>n(t=>({deployPath:typeof s=="function"?s(t.deployPath):s})),setApiURL:s=>n(t=>({apiURL:typeof s=="function"?s(t.apiURL):s})),setValidatorURL:s=>n(t=>({validatorURL:typeof s=="function"?s(t.validatorURL):s})),setShowSearchResultLink:s=>n(t=>({showSearchResultLink:typeof s=="function"?s(t.showSearchResultLink):s})),setAppTitle:s=>n(t=>({appTitle:typeof s=="function"?s(t.appTitle):s})),setAppTitleHead:s=>n(t=>({appTitleHead:typeof s=="function"?s(t.appTitleHead):s})),setMatomoTrackingParams:s=>n(t=>({matomoTrackingParams:typeof s=="function"?s(t.matomoTrackingParams):s})),setAuthUsername:s=>n(t=>({authUsername:typeof s=="function"?s(t.authUsername):s}))}));var pn=["en","de"];const re=$s(n=>({locale:"en",locales:pn??["en"],setLocale:s=>n(t=>({locale:typeof s=="function"?s(t.locale):s})),setLocales:s=>n(t=>({locales:typeof s=="function"?s(t.locales):s}))})),pe=n=>{const s=_t(re,n);return Object.assign(s,re),s},xn=""+new URL("assets/clarin-logo-wide.png",import.meta.url).href,fn=""+new URL("assets/icon-services-fcs.png",import.meta.url).href,ms=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16">
  <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"/>
</svg>`,Oe=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-translate" viewBox="0 0 16 16">
  <path d="M4.545 6.714 4.11 8H3l1.862-5h1.284L8 8H6.833l-.435-1.286zm1.634-.736L5.5 3.956h-.049l-.679 2.022z"/>
  <path d="M0 2a2 2 0 0 1 2-2h7a2 2 0 0 1 2 2v3h3a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-3H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zm7.138 9.995q.289.451.63.846c-.748.575-1.673 1.001-2.768 1.292.178.217.451.635.555.867 1.125-.359 2.08-.844 2.886-1.494.777.665 1.739 1.165 2.93 1.472.133-.254.414-.673.629-.89-1.125-.253-2.057-.694-2.82-1.284.681-.747 1.222-1.651 1.621-2.757H14V8h-3v1.047h.765c-.318.844-.74 1.546-1.272 2.13a6 6 0 0 1-.415-.492 2 2 0 0 1-.94.31"/>
</svg>`;function jn(){const{t:n}=ne(),s=pe(m=>m.locale),t=pe(m=>m.locales),r=pe(m=>m.setLocale),i=J.getState().authUsername,a=i!==null&&i!=="anonymous",c=J.getState().deployPath??"",o=c+(c.endsWith("/")?"":"/")+"login",[l]=Pe(),u="urls.helpWithTranslations",j=n(u,{ns:"common"}),L=j!==u;function x(m){m!==null&&r(m)}function N(){return a?e.jsxs(Ie.Text,{className:"ms-auto",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:ms}})," Signed in as"," ",e.jsx("span",{className:"fw-bold",children:i})]}):e.jsxs(ue.Link,{href:`${o}${l??""}`,className:"ms-auto",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:ms}})," ",n("header.login.login")]})}function S(){if(!t||t.length===1)return null;const m=new Intl.DisplayNames([s,"en"],{type:"language"}),A=e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Oe}})," ",s.toUpperCase()," "]});return e.jsxs(Ze,{title:A,align:"end",className:"ms-2",onSelect:x,children:[t.map(C=>{const b=new Intl.DisplayNames([C,"en"],{type:"language"});return e.jsxs(Ze.Item,{disabled:C===s,"aria-disabled":C===s,eventKey:C,title:n("header.localeOptionTitle",{code:C,name:b.of(C),context:C!==s?"translated":null,translated:m.of(C)}),children:[C.toUpperCase()," – ",b.of(C)]},C)}),L&&e.jsxs(e.Fragment,{children:[e.jsx(Ze.Divider,{}),e.jsx(Ze.Item,{className:"matomo_link text-wrap",target:"_blank",href:j,onClick:C=>C.stopPropagation(),children:n("header.localeHelpWithTranslations")})]})]})}function _(){return e.jsx(Ie.Brand,{className:"ms-4",children:e.jsx("img",{src:xn,alt:"Service operator logo",height:30,className:"d-inline-block align-top",onError:({currentTarget:m})=>{console.warn("Logo not found!"),m.onerror=null,m.parentElement.style.display="none"}})})}return e.jsx("header",{children:e.jsx(Ie,{expand:"md",className:"bg-body-tertiary",children:e.jsxs(ie,{children:[e.jsxs(Ie.Brand,{as:Te,to:{pathname:"/",search:l},children:[e.jsx("img",{src:fn,width:"30",height:"30",className:"d-inline-block align-top",alt:`${n("header.title")} logo`})," ",n("header.title")]}),e.jsx(Ie.Toggle,{"aria-controls":"header-navbar-nav"}),e.jsx(Ie.Collapse,{id:"header-navbar-nav",children:e.jsxs(ue,{className:"w-100 d-flex",children:[e.jsx(ue.Link,{as:As,to:{pathname:"/",search:l},children:n("header.menu.home")}),e.jsx(ue.Link,{as:As,to:{pathname:"/help",search:l},children:n("header.menu.help")}),N(),S(),_()]})})]})})})}/*!
 * Color mode switcher based on example from Bootstrap 5 docs.
 * @see https://getbootstrap.com/docs/5.3/customize/color-modes/#javascript
 */function bn(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function yn(n){n==="auto"?document.documentElement.setAttribute("data-bs-theme",window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"):document.documentElement.setAttribute("data-bs-theme",n)}function wn(){d.useEffect(()=>{function n(){yn(bn())}return n(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",n),()=>window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",n)},[])}const vn="modulepreload",Sn=function(n,s){return new URL(n,s).href},Ps={},ce=function(s,t,r){let i=Promise.resolve();if(t&&t.length>0){let u=function(j){return Promise.all(j.map(L=>Promise.resolve(L).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const c=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");i=u(t.map(j=>{if(j=Sn(j,r),j in Ps)return;Ps[j]=!0;const L=j.endsWith(".css"),x=L?'[rel="stylesheet"]':"";if(!!r)for(let _=c.length-1;_>=0;_--){const m=c[_];if(m.href===j&&(!L||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${j}"]${x}`))return;const S=document.createElement("link");if(S.rel=L?"stylesheet":vn,L||(S.as="script"),S.crossOrigin="",S.href=j,l&&S.setAttribute("nonce",l),document.head.appendChild(S),L)return new Promise((_,m)=>{S.addEventListener("load",_),S.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${j}`)))})}))}function a(c){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=c,window.dispatchEvent(o),!o.defaultPrevented)throw c}return i.then(c=>{for(const o of c||[])o.status==="rejected"&&a(o.reason);return s().catch(a)})},Rn=(n,s,t)=>{const r=n[s];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((i,a)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+s+(s.split("/").length!==t?". Note that variables only represent file names one level deep.":""))))})},Ln={en:{app:Zs,common:Js}},gs="clarin",Nn=re.getInitialState().locale,Cn=re.getInitialState().locales;function In(n,s){if(!n)return s;const t=typeof n=="string"?[n]:n;return[...t.map(i=>`${gs}.${i}`),...t]}const ps=["app","common"],Tn=In(ps);function ts(n){return typeof n=="string"||!Array.isArray(n)?[String(n)]:n}function En(n,s,t,r){if(t?.postProcessTryPrefixedNamespacesFirst!==void 0)return n;const i=ts(s),a=ts(t.ns||r.options.defaultNS||[]),c=r.resolve(i,t),l=(c?.res!==void 0?[...ts(t.ns||[]),c.usedNS]:[...ts(t.ns||[]),...a]).map(j=>j.startsWith(gs)?j:`${gs}.${j}`),u=r.translate(i,{...t,ns:l,postProcessTryPrefixedNamespacesFirst:!0});return i.includes(u)?n:u}xe.use(At).use({type:"postProcessor",name:"try-prefixed-namespaces-first",process:En}).use(kt((n,s)=>Rn(Object.assign({"../locales/de/app.json":()=>ce(()=>import("./locales/de/default.js").then(r=>r.a),[],import.meta.url),"../locales/de/clarin.app.json":()=>ce(()=>import("./locales/de/default.js").then(r=>r.c),[],import.meta.url),"../locales/de/common.json":()=>ce(()=>import("./locales/de/default.js").then(r=>r.b),[],import.meta.url),"../locales/de/textplus.app.json":()=>ce(()=>import("./locales/de/textplus.app.js"),[],import.meta.url),"../locales/en/app.json":()=>ce(()=>import("./locales/en/default.js").then(r=>r.e),[],import.meta.url),"../locales/en/clarin.app.json":()=>ce(()=>import("./locales/en/default.js").then(r=>r.g),[],import.meta.url),"../locales/en/clarin.common.json":()=>ce(()=>import("./locales/en/default.js").then(r=>r.h),[],import.meta.url),"../locales/en/common.json":()=>ce(()=>import("./locales/en/default.js").then(r=>r.f),[],import.meta.url),"../locales/en/querybuilder.json":()=>ce(()=>import("./locales/en/querybuilder.js"),[],import.meta.url),"../locales/en/querysuggestions.json":()=>ce(()=>import("./locales/en/default.js").then(r=>r.q),[],import.meta.url),"../locales/en/textplus.app.json":()=>ce(()=>import("./locales/en/textplus.app.js"),[],import.meta.url),"../locales/en/textplus.common.json":()=>ce(()=>import("./locales/en/textplus.common.js"),[],import.meta.url)}),`../locales/${n}/${s}.json`,4))).init({lng:Nn,fallbackLng:"en",supportedLngs:Cn,ns:Tn,defaultNS:ps,fallbackNS:ps,debug:!1,interpolation:{escapeValue:!1},postProcess:["try-prefixed-namespaces-first"],resources:Ln,partialBundledLanguages:!0,react:{nsMode:"fallback",transKeepBasicHtmlNodesFor:["br","strong","i","p","em","kbd","code"]}});xe.addResourceBundle("en","clarin.app",Gt);xe.addResourceBundle("en","clarin.common",Yt);xe.addResourceBundle("en","app",Zs);xe.addResourceBundle("en","querysuggestions",Xt);xe.addResourceBundle("en","common",Js);Object.assign(window,{i18n:xe});const _n=["Emanuel Dima","Erik Körner","Leif-Jöran Olsson","Yana Panchenko","Oliver Schonefeld","Dieter Van Uytvanck"],An=[{id:"dropwizard",name:"Dropwizard",url:"https://www.dropwizard.io/",license:"Apache License 2.0",licenseUrl:"https://github.com/dropwizard/dropwizard/blob/release/3.0.x/LICENSE",usage:"web server"},{id:"de.mpg.mpgaai:mpgaai-shhaa",name:"MPG-AAI - simple http header authn/z",url:"https://github.com/clarin-eric/mpgaai",license:"Apache License 2.0",licenseUrl:"http://www.apache.org/licenses/LICENSE-2.0.txt",usage:"AAI / Shibboleth support"},{id:"io.swagger.core.v3",name:"Swagger Core",url:"https://github.com/swagger-api/swagger-core",license:"Apache License 2.0",licenseUrl:"https://github.com/swagger-api/swagger-core/blob/master/LICENSE",usage:"REST API documentation"},{id:"org.glassfish.jersey",name:"Eclipse Jersey",url:"https://eclipse-ee4j.github.io/jersey/",license:"Eclipse Public License 2.0",licenseUrl:"https://github.com/eclipse-ee4j/jersey/blob/2.x/LICENSE.md",usage:"RESTful web services"},{id:"org.slf4j",name:"Simple Logging Facade for Java (SLF4J)",url:"https://www.slf4j.org/",license:"MIT License",licenseUrl:"https://www.slf4j.org/license.html",usage:"logging"},{id:"org.junit",name:"JUnit 5",url:"https://junit.org/",license:"Eclipse Public License 2.0",licenseUrl:"https://github.com/junit-team/junit-framework/blob/main/LICENSE.md",usage:"testing"},{id:"optimaize/language-detector",name:"Optimaize Language Detector",url:"https://github.com/optimaize/language-detector",license:"Apache License 2.0",licenseUrl:"https://github.com/optimaize/language-detector/blob/master/LICENSE",usage:"language detection of results"},{id:"org.apache.commons:commons-text",name:"Apache Commons Text",url:"https://commons.apache.org/proper/commons-text/",license:"Apache License 2.0",licenseUrl:"https://github.com/apache/commons-text/blob/master/LICENSE.txt",usage:"export format"},{id:"com.sun.xml.bind",name:"JAXB Reference Implementation",url:"https://eclipse-ee4j.github.io/jaxb-ri/",license:"Common Development and Distribution License (CCDL) 1.1",licenseUrl:"https://github.com/javaee/jaxb-v2/blob/2.3.0.1/jaxb-ri/License.txt",usage:"XML support",hide:!0},{id:"eu.clarin.weblicht:wlfxb",name:"Weblicht wlfxb",url:"https://weblicht.sfs.uni-tuebingen.de",license:"GNU Lesser General Public License v3.0",licenseUrl:"https://github.com/weblicht/wlfxb/blob/master/LICENSE.txt",usage:"export format"},{id:"org.apache.poi:poi-ooxml",name:"Apache POI",url:"https://poi.apache.org/",license:"Apache License 2.0",licenseUrl:"https://github.com/apache/poi/blob/trunk/legal/LICENSE",usage:"export format"},{id:"org.jopendocument:jOpenDocument",name:"jOpenDocument",url:"https://www.jopendocument.org/",license:"GNU Lesser General Public License v3.0",licenseUrl:"https://www.jopendocument.org/support.html",usage:"export format"},{id:"eu.clarin.sru:sru-client",name:"CLARIN SRU/CQL Client",license:"GNU General Public License v3.0",licenseUrl:"https://github.com/clarin-eric/fcs-sru-client/blob/main/LICENSE.txt",usage:"SRU / CQL client framework",hide:!0},{id:"eu.clarin.sru.fcs:fcs-simple-client",name:"CLARIN-FCS Client",license:"GNU General Public License v3.0",licenseUrl:"https://github.com/clarin-eric/fcs-simple-client/blob/main/LICENSE.txt",usage:"FCS client framework",hide:!0}],kn=[{id:"react",name:"React",url:"https://react.dev/",license:"MIT License",licenseUrl:"https://github.com/facebook/react/blob/main/LICENSE"},{id:"react-dom",name:"ReactDOM",url:"https://react.dev/reference/react-dom",license:"MIT License",licenseUrl:"https://github.com/facebook/react/blob/main/LICENSE",hide:!0},{id:"react-router",name:"React Router",url:"https://reactrouter.com/",license:"MIT License",licenseUrl:"https://github.com/remix-run/react-router/blob/main/LICENSE.md",usage:"single page application routing"},{id:"react-bootstrap",name:"React Bootstrap",url:"https://react-bootstrap.netlify.app/",license:"MIT License",licenseUrl:"https://github.com/react-bootstrap/react-bootstrap/blob/master/LICENSE",usage:"react bindings for bootstrap"},{id:"bootstrap",name:"Bootstrap",url:"https://getbootstrap.com/",license:"MIT License",licenseUrl:"https://github.com/twbs/bootstrap/blob/main/LICENSE",usage:"UI framework"},{id:"bootstrap-icons",name:"Bootstrap Icons",url:"https://icons.getbootstrap.com/",license:"MIT License",licenseUrl:"https://github.com/twbs/icons/blob/main/LICENSE"},{id:"@tanstack/react-query",name:"TanStack Query",url:"https://tanstack.com/query",license:"MIT License",licenseUrl:"https://github.com/TanStack/query/blob/main/LICENSE",usage:"data loading via REST APIs"},{id:"axios",name:"Axios",url:"https://axios-http.com/",license:"MIT License",licenseUrl:"https://github.com/axios/axios/blob/v1.x/LICENSE",usage:"cross-browser support for REST API requests"},{id:"antlr4ng",name:"Next Generation TypeScript runtime for ANTLR4",url:"https://github.com/mike-lischke/antlr4ng",license:'The "BSD license"',licenseUrl:"https://github.com/mike-lischke/antlr4ng/blob/main/LICENSE.txt",usage:"query parser"},{id:"i18next",name:"i18next",url:"https://www.i18next.com/",license:"MIT License",licenseUrl:"https://github.com/i18next/i18next/blob/master/LICENSE",usage:"translations"},{id:"react-i18next",name:"react-i18next",url:"https://react.i18next.com/",license:"MIT License",licenseUrl:"https://github.com/i18next/react-i18next/blob/master/LICENSE",usage:"translations",hide:!0},{id:"i18next-resources-to-backend",name:"i18next-resources-to-backend",url:"https://github.com/i18next/i18next-resources-to-backend",license:"MIT License",licenseUrl:"https://github.com/i18next/i18next-resources-to-backend/blob/main/licence",usage:"translation resource loading",hide:!0},{id:"zustand",name:"Zustand",url:"https://zustand-demo.pmnd.rs/",license:"MIT License",licenseUrl:"https://github.com/pmndrs/zustand/blob/main/LICENSE",usage:"state management"},{id:"@nozbe/microfuzz",name:"microfuzz",url:"https://github.com/Nozbe/microfuzz",license:"MIT License",licenseUrl:"https://github.com/Nozbe/microfuzz/blob/main/LICENSE",usage:"fuzzy search"},{id:"react-helmet-async",name:"React Helmet (async fork)",url:"https://github.com/staylor/react-helmet-async",license:"Apache License 2.0",licenseUrl:"https://github.com/staylor/react-helmet-async/blob/main/LICENSE",usage:"HTML head modifications"},{id:"react-slugify",name:"react-slugify",url:"https://github.com/martpie/react-slugify",license:"MIT License",licenseUrl:"https://github.com/martpie/react-slugify/blob/master/LICENSE",usage:"jump id fragment generation"}];function Mn(){const{t:n}=ne(),s="urls.termsUseAndDisclaimer",t=n(s,{ns:"common"}),r=t!==s,i=J.getState().matomoTrackingEnabled,a=J.getState().appTitleHead,[c]=Pe();function o(l){return e.jsx("ul",{children:l.filter(u=>u.hide!==!0).map(u=>e.jsxs("li",{children:[u.url?e.jsx("a",{href:u.url,children:u.name}):e.jsx("span",{children:u.name}),u.license&&e.jsxs(e.Fragment,{children:[" ","(",u.licenseUrl?e.jsx("a",{href:u.licenseUrl,children:u.license}):e.jsx("span",{children:u.license}),")"]})]},u.id))})}return e.jsxs(e.Fragment,{children:[e.jsx($e,{children:e.jsxs("title",{children:[a," – About"]})}),e.jsxs(ie,{className:"py-4",children:[e.jsx("h1",{className:"h1 mb-4",children:n("about.title")}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:n("about.people.title")}),e.jsx("p",{children:n("about.people.developedBy")}),e.jsx("ul",{children:_n.map(l=>e.jsx("li",{children:l},l))})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:n("about.statistics.title")}),e.jsx("p",{children:e.jsx(G,{i18nKey:"about.statistics.text",components:[e.jsx(Te,{to:{pathname:"/stats",search:c},children:"endpoint statistics"})]})})]}),(r||i)&&e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:n("about.privacyPolicy.title")}),r&&e.jsx("p",{children:e.jsx(G,{i18nKey:"about.privacyPolicy.termsInfo",components:[e.jsx("a",{href:t,children:"clarin.eu"})]})}),i&&e.jsx("p",{children:e.jsx(G,{i18nKey:"about.privacyPolicy.matomoInfo",components:[e.jsx("a",{href:"https://matomo.org/",children:"Matomo"})]})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:n("about.sourceCode.title")}),e.jsx("p",{children:e.jsx(G,{i18nKey:"about.sourceCode.sourceInfo.text",components:[e.jsx("a",{href:n("about.sourceCode.sourceInfo.repoUrl"),children:"GitHub"}),e.jsx("a",{href:n("about.sourceCode.sourceInfo.licenseUrl"),children:"GPL 3.0 license"})]})}),e.jsx("p",{children:n("about.sourceCode.licenseInfo")})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:n("about.technology.title")}),e.jsx("p",{children:n("about.technology.backendUses")}),o(An),e.jsx("p",{children:n("about.technology.frontendUses")}),o(kn),e.jsx("p",{children:e.jsx(G,{i18nKey:"about.technology.iconLicenseInfo",components:[e.jsx("a",{href:"http://www.freepik.com/",children:"Freepik"}),e.jsx("a",{href:"www.flaticon.com",children:"www.flaticon.com"}),e.jsx("a",{href:"http://creativecommons.org/licenses/by/3.0/",children:"CC BY 3.0"})]})})]})]})]})}const Ee=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
  <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"/>
  <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7"/>
</svg>`,ze=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-magic" viewBox="0 0 16 16">
  <path d="M9.5 2.672a.5.5 0 1 0 1 0V.843a.5.5 0 0 0-1 0zm4.5.035A.5.5 0 0 0 13.293 2L12 3.293a.5.5 0 1 0 .707.707zM7.293 4A.5.5 0 1 0 8 3.293L6.707 2A.5.5 0 0 0 6 2.707zm-.621 2.5a.5.5 0 1 0 0-1H4.843a.5.5 0 1 0 0 1zm8.485 0a.5.5 0 1 0 0-1h-1.829a.5.5 0 0 0 0 1zM13.293 10A.5.5 0 1 0 14 9.293L12.707 8a.5.5 0 1 0-.707.707zM9.5 11.157a.5.5 0 0 0 1 0V9.328a.5.5 0 0 0-1 0zm1.854-5.097a.5.5 0 0 0 0-.706l-.708-.708a.5.5 0 0 0-.707 0L8.646 5.94a.5.5 0 0 0 0 .707l.708.708a.5.5 0 0 0 .707 0l1.293-1.293Zm-3 3a.5.5 0 0 0 0-.706l-.708-.708a.5.5 0 0 0-.707 0L.646 13.94a.5.5 0 0 0 0 .707l.708.708a.5.5 0 0 0 .707 0z"/>
</svg>`,st=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"/>
  <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"/>
</svg>`,tt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-balloon" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 9.984C10.403 9.506 12 7.48 12 5a4 4 0 0 0-8 0c0 2.48 1.597 4.506 4 4.984M13 5c0 2.837-1.789 5.227-4.52 5.901l.244.487a.25.25 0 1 1-.448.224l-.008-.017c.008.11.02.202.037.29.054.27.161.488.419 1.003.288.578.235 1.15.076 1.629-.157.469-.422.867-.588 1.115l-.004.007a.25.25 0 1 1-.416-.278c.168-.252.4-.6.533-1.003.133-.396.163-.824-.049-1.246l-.013-.028c-.24-.48-.38-.758-.448-1.102a3 3 0 0 1-.052-.45l-.04.08a.25.25 0 1 1-.447-.224l.244-.487C4.789 10.227 3 7.837 3 5a5 5 0 0 1 10 0m-6.938-.495a2 2 0 0 1 1.443-1.443C7.773 2.994 8 2.776 8 2.5s-.226-.504-.498-.459a3 3 0 0 0-2.46 2.461c-.046.272.182.498.458.498s.494-.227.562-.495"/>
</svg>`,We=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bank" viewBox="0 0 16 16">
  <path d="m8 0 6.61 3h.89a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5H15v7a.5.5 0 0 1 .485.38l.5 2a.498.498 0 0 1-.485.62H.5a.498.498 0 0 1-.485-.62l.5-2A.5.5 0 0 1 1 13V6H.5a.5.5 0 0 1-.5-.5v-2A.5.5 0 0 1 .5 3h.89zM3.777 3h8.447L8 1zM2 6v7h1V6zm2 0v7h2.5V6zm3.5 0v7h1V6zm2 0v7H12V6zM13 6v7h1V6zm2-1V4H1v1zm-.39 9H1.39l-.25 1h13.72z"/>
</svg>`,Pn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-braces" viewBox="0 0 16 16">
  <path d="M2.114 8.063V7.9c1.005-.102 1.497-.615 1.497-1.6V4.503c0-1.094.39-1.538 1.354-1.538h.273V2h-.376C3.25 2 2.49 2.759 2.49 4.352v1.524c0 1.094-.376 1.456-1.49 1.456v1.299c1.114 0 1.49.362 1.49 1.456v1.524c0 1.593.759 2.352 2.372 2.352h.376v-.964h-.273c-.964 0-1.354-.444-1.354-1.538V9.663c0-.984-.492-1.497-1.497-1.6M13.886 7.9v.163c-1.005.103-1.497.616-1.497 1.6v1.798c0 1.094-.39 1.538-1.354 1.538h-.273v.964h.376c1.613 0 2.372-.759 2.372-2.352v-1.524c0-1.094.376-1.456 1.49-1.456V7.332c-1.114 0-1.49-.362-1.49-1.456V4.352C13.51 2.759 12.75 2 11.138 2h-.376v.964h.273c.964 0 1.354.444 1.354 1.538V6.3c0 .984.492 1.497 1.497 1.6"/>
</svg>`,nt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
  <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"/>
  <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"/>
</svg>`,rt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-envelope-arrow-up" viewBox="0 0 16 16">
  <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4.5a.5.5 0 0 1-1 0V5.383l-7 4.2-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h5.5a.5.5 0 0 1 0 1H2a2 2 0 0 1-2-1.99zm1 7.105 4.708-2.897L1 5.383zM1 4v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1"/>
  <path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m.354-5.354 1.25 1.25a.5.5 0 0 1-.708.708L13 12.207V14a.5.5 0 0 1-1 0v-1.717l-.28.305a.5.5 0 0 1-.737-.676l1.149-1.25a.5.5 0 0 1 .722-.016"/>
</svg>`,it=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-exclamation-triangle" viewBox="0 0 16 16">
  <path d="M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"/>
  <path d="M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"/>
</svg>`,at=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
  <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"/>
  <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"/>
</svg>`,Be=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear-fill" viewBox="0 0 16 16">
  <path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z"/>
</svg>`,ot=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-highlights" viewBox="0 0 16 16">
  <path d="M16 8A8 8 0 1 0 0 8a8 8 0 0 0 16 0m-8 5v1H4.5a.5.5 0 0 0-.093.009A7 7 0 0 1 3.1 13zm0-1H2.255a7 7 0 0 1-.581-1H8zm-6.71-2a7 7 0 0 1-.22-1H8v1zM1 8q0-.51.07-1H8v1zm.29-2q.155-.519.384-1H8v1zm.965-2q.377-.54.846-1H8v1zm2.137-2A6.97 6.97 0 0 1 8 1v1z"/>
</svg>`,as=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house-door" viewBox="0 0 16 16">
  <path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4z"/>
</svg>`,vs=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
  <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/>
</svg>`,Ue=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link-45deg" viewBox="0 0 16 16">
  <path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1 1 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4 4 0 0 1-.128-1.287z"/>
  <path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243z"/>
</svg>`,On=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-circle" viewBox="0 0 16 16">
  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
  <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"/>
</svg>`,Un=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-repeat" viewBox="0 0 16 16">
  <path d="M11 5.466V4H5a4 4 0 0 0-3.584 5.777.5.5 0 1 1-.896.446A5 5 0 0 1 5 3h6V1.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192m3.81.086a.5.5 0 0 1 .67.225A5 5 0 0 1 11 13H5v1.466a.25.25 0 0 1-.41.192l-2.36-1.966a.25.25 0 0 1 0-.384l2.36-1.966a.25.25 0 0 1 .41.192V12h6a4 4 0 0 0 3.585-5.777.5.5 0 0 1 .225-.67Z"/>
</svg>`,lt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
  <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
</svg>`,ct=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots" viewBox="0 0 16 16">
  <path d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"/>
</svg>`,Dn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle" viewBox="0 0 16 16">
  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
  <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"/>
</svg>`,xs={"arrow-clockwise":st,"envelope-arrow-up":rt,"exclamation-triangle":it,"eye-fill":Ee,"gear-fill":Be,"house-door":as,"info-circle":vs,"link-45deg":Ue,"three-dots":ct,balloon:tt,bank:We,download:nt,eye:at,highlights:ot,magic:ze,person:ms,search:lt,translate:Oe};Object.assign(xs,{"plus-circle":On,"x-circle":Dn,braces:Pn,magic:ze,repeat:Un});function Hn(){const{t:n}=ne(),s=J.getState().appTitleHead;function t(){const r=n("icons",{ns:"common",returnObjects:!0}),i=Object.getOwnPropertyNames(r).filter(a=>Object.getOwnPropertyNames(xs).includes(a)).toSorted((a,c)=>{const o=r[a],l=r[c];return!o.context||o.context.length===0?-1:!l.context||l.context.length===0||o.context.includes("statistics")?1:l.context.includes("statistics")?-1:o.context.includes("querybuilder")?1:l.context.includes("querybuilder")?-1:o.context[0].localeCompare(l.context[0])});return e.jsx(se,{xs:1,md:2,xl:3,children:i.map(a=>{const c=n(`icons.${a}.context`,{ns:"common",returnObjects:!0,defaultValue:[]});return e.jsx(D,{children:e.jsx(E,{className:"border-0",children:e.jsxs(E.Body,{children:[e.jsxs(E.Title,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:xs[a]},"aria-hidden":"true",className:"rounded border px-2 pb-1"})," ",n(`icons.${a}.label`,{ns:"common"})]}),e.jsx(E.Text,{className:"mb-0",children:n(`icons.${a}.description`,{ns:"common"})}),c.length>0&&e.jsx(E.Text,{className:"mt-1",children:c.map(o=>e.jsx(fe,{children:o},o))})]})})},a)})})}return e.jsxs(e.Fragment,{children:[e.jsx($e,{children:e.jsxs("title",{children:[s," – Help"]})}),e.jsxs(ie,{className:"my-4",children:[e.jsx("h1",{className:"h1",children:n("help.title")}),e.jsx("h2",{className:"h2",id:"performing-a-fcs-search-in-resources",children:n("help.performSearch.title")}),e.jsx("p",{children:e.jsx(G,{i18nKey:"help.performSearch.textBasicSearch"})}),e.jsx("p",{children:e.jsx(G,{i18nKey:"help.performSearch.textAdvancedSearch",components:{iconMagicWand:e.jsx("i",{dangerouslySetInnerHTML:{__html:ze},"aria-hidden":"true"})}})}),e.jsx("p",{children:e.jsx(G,{i18nKey:"help.performSearch.textLexicalSearch",components:{iconMagicWand:e.jsx("i",{dangerouslySetInnerHTML:{__html:ze},"aria-hidden":"true"})}})}),e.jsx("p",{children:e.jsx(G,{i18nKey:"help.performSearch.textSearchProgress"})}),e.jsx("p",{children:e.jsx(G,{i18nKey:"help.performSearch.textViewResource",components:{iconEye:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ee},"aria-hidden":"true"})}})}),e.jsx("h2",{className:"h2",id:"adjusting-search-criteria",children:n("help.adjustSearchCriteria.title")}),e.jsx("p",{children:e.jsx(G,{i18nKey:"help.adjustSearchCriteria.text"})}),e.jsx("p",{children:e.jsx(G,{i18nKey:"help.adjustSearchCriteria.textOtherSearchTypes"})}),e.jsx("h2",{className:"h2",id:"more-help",children:n("help.moreHelp.title")}),e.jsx("p",{children:e.jsx(G,{i18nKey:"help.moreHelp.text",components:[e.jsx("a",{href:"https://www.clarin.eu/content/content-search-tutorial",children:"Content Search: Tutorial at CLARIN.eu"}),e.jsx("a",{title:n("help.contactTitle"),href:n("urls.contact",{ns:"common"}),children:"CLARIN FCS Helpdesk"})]})}),e.jsx("h2",{className:"h2",id:"more-help",children:n("help.icons.title")}),t()]})]})}const Ss=d.createContext({resources:[],languages:{},weblichtLanguages:[]});Ss.displayName="AggregatorDataContext";function Fn({resources:n,languages:s,weblichtLanguages:t,children:r}){const i={resources:n,languages:s,weblichtLanguages:t};return e.jsx(Ss.Provider,{value:i,children:r})}function Rs(){return d.useContext(Ss)}const Ls=d.createContext(void 0);Ls.displayName="AxiosContext";function Le(){const n=d.useContext(Ls);if(!n)throw new Error('No "axios" instance set, use AxiosProvider to set one');return n}function Bn({axios:n,children:s}){return e.jsx(Ls.Provider,{value:n,children:s})}const Ns=d.createContext(void 0);Ns.displayName="SearchParamsContext";function Cs(){const n=d.useContext(Ns);if(!n)throw new Error('No "params" data set, use SearchParamsProvider to set one');return n}function Vn({language:n,languageFilter:s,queryType:t,query:r,resourceIDs:i,numberOfResults:a,children:c}){const o={language:n,languageFilter:s,queryType:t,query:r,resourceIDs:i,numberOfResults:a};return e.jsx(Ns.Provider,{value:o,children:c})}function qn(n,s=0){let t=3735928559^s,r=1103547991^s;for(let i=0,a;i<n.length;i++)a=n.charCodeAt(i),t=Math.imul(t^a,2654435761),r=Math.imul(r^a,1597334677);return t=Math.imul(t^t>>>16,2246822507),t^=Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507),r^=Math.imul(t^t>>>13,3266489909),4294967296*(2097151&r)+(t>>>0)}window._paq=window._paq||[];function zn({siteId:n,trackerUrl:s,enableLinkTracking:t=!0,domains:r=[],userId:i=void 0}){window._paq.push(["setTrackerUrl",s]),window._paq.push(["setSiteId",n]),i&&window._paq.push(["setUserId",i]),Array.isArray(r)&&r.length>0&&window._paq.push(["setDomains",r]),t&&(window._paq.push(["enableLinkTracking"]),window._paq.push(["setLinkTrackingTimer",250]))}function $n({srcUrl:n}){const s=document.createElement("script"),t=document.getElementsByTagName("script")[0];s.type="text/javascript",s.async=!0,s.defer=!0,s.src=n,t&&t.parentNode&&t.parentNode.insertBefore(s,t)}function Kn(n){if(!n)return!1;let s=null;if(typeof n=="string")try{s=JSON.parse(n)}catch(u){return console.error("Error trying to parse tracking params!",u),!1}else typeof n=="object"&&(s=n);const t=s.siteId,r=s.trackerUrl,i=s.srcUrl,a=s.domains,c=s.userId?.toString();if(i===void 0)return console.warn('No "srcUrl" configuration set for tracking!'),!1;if(r===void 0)return console.warn('No "trackerUrl" configuration set for tracking!'),!1;if(t===void 0||!Number.isInteger(t))return console.warn('No "siteId" configuration set for tracking!'),!1;const o={siteId:t,trackerUrl:r,domains:a};c&&(o.userId=qn(c).toString());const l={srcUrl:i};return zn(o),ut(document.location.href||window.location.href,document.title),$n(l),!0}function ut(n,s,t){window._paq.push(["setDocumentTitle",s??document.title]),window._paq.push(["setCustomUrl",n]),t!==void 0&&window._paq.push(["setReferrerUrl",t]),window._paq.push(["trackPageView"])}function dt(n,s=!1,t=!1){window._paq.push(["trackSiteSearch",n,s,t])}const fs="byMeta",Wn="all",ht="resource",Qn="title-up",be="mul";function os(n,s=void 0,t={}){return n===be?t?.defaultAnyLanguage??"Any Language":s?.[n]||(t?.defaultUnknownLanguage??"Unknown Language")}function Is(n){const s=re.getState().locale,t=(a,c=null)=>({...a,subResources:a.subResources.map(o=>t(o,c??a)),rootResourceId:c?.id??null}),r=n.map(a=>t(a,null)),i=function(a,c){const o=B(a.institution,s)??"",l=B(c.institution,s)??"",u=o.localeCompare(l);if(u!==0)return u;const j=B(a.title,s)??"",L=B(c.title,s)??"";return j.toLowerCase().localeCompare(L.toLowerCase())};return _e(r,a=>{a.subResources.sort(i)}),r.sort(i),r}function Gn(n,s){const t=[],r=[],i=[];return Object.entries(s).forEach(([a,c])=>{c.forEach(o=>{let l=!1;_e(n,u=>{u.handle===o&&(l=!0,i.push(u))}),l||(console.warn("Handle not found in resources",o),r.push(o))})}),_e(i,a=>{t.push(a.id)}),{selected:t,unavailable:r}}function _e(n,s){const t=(r,i)=>{s(r,i)===!1||r.subResources.forEach(t)};n.forEach(t)}function is(n,s){let t;const r=i=>t!==void 0?!0:s(i)?(t=i,!0):i.subResources.find(r)!==void 0;return n.find(r),t}function we(n){const s=[];return _e(n,t=>{s.push(t.id)}),s}function Yn(n,s,t){const r=[],i=a=>pt(a,i)||nr(a,s,t);return _e(n,a=>{i(a)&&r.push(a.id)}),r}function Xn(n,s){const t=re.getState().locale,r=new Set;return _e(n,i=>{if(s.includes(i.id)){const a=B(i.institution,t)??"";r.add(a)}return!0}),Array.from(r)}function mt(n){const s=t=>[t,...t.subResources.map(s).flat()];return n.map(s).flat()}const gt=["en","eng","de","deu"];function Jn(n){if(n===null)return null;if(typeof n=="string")return n;for(const t of gt)if(Object.hasOwn(n,t))return n[t];const s=Object.getOwnPropertyNames(n);return s.length>0?n[s[0]]:null}function Zn(n,s){return n===null?null:typeof n=="string"?n:s&&Object.hasOwn(n,s)?n[s]:null}function B(n,s){s===void 0&&(s=re.getState().locale);const t=Zn(n,s);return t!==null?t:Jn(n)}function er(n,s){if(n===null||typeof n=="string")return;if(s===void 0&&(s=re.getState().locale),s&&Object.hasOwn(n,s))return s;for(const r of gt)if(Object.hasOwn(n,r))return r;const t=Object.getOwnPropertyNames(n);if(t.length>0)return t[0]}function Qe(n,s="en"){const t=typeof n.title=="string"||n.title===null?[s]:Object.getOwnPropertyNames(n.title),r=typeof n.description=="string"||n.description===null?[s]:Object.getOwnPropertyNames(n.description),i=typeof n.institution=="string"||n.institution===null?[s]:Object.getOwnPropertyNames(n.institution),a=[...t,...r,...i];return Array.from(new Set(a))}function sr(n,s){return!(s==="fcs"&&!n.endpoint.searchCapabilities.includes("ADVANCED_SEARCH")||s==="lex"&&!n.endpoint.searchCapabilities.includes("LEX_SEARCH"))}function tr(n,s){return!!(s===be||n.languages&&n.languages.length===1&&n.languages[0]===s||n.languages&&n.languages.indexOf(s)>=0)}function pt(n,s){if(!n.subResources||n.subResources.length===0)return!1;let t=!1;const r=i=>{if(s?.(i)===!0){t=!0;return}i.subResources.forEach(r)};return n.subResources.forEach(r),t}function nr(n,s,t){return!(!sr(n,s)||!tr(n,t))}const xt={"title-up":(n,s)=>{const t=re.getState().locale,r=B(n.title,t)??"",i=B(s.title,t)??"";return r.localeCompare(i)},"title-down":(n,s)=>{const t=re.getState().locale,r=B(n.title,t)??"",i=B(s.title,t)??"";return-r.localeCompare(i)},"institution-up":(n,s)=>{const t=re.getState().locale,r=B(n.institution,t)??"",i=B(s.institution,t)??"",a=B(n.title,t)??"",c=B(s.title,t)??"",o=r.localeCompare(i);return o!==0?o:a.localeCompare(c)},"institution-down":(n,s)=>{const t=re.getState().locale,r=B(n.institution,t)??"",i=B(s.institution,t)??"",a=B(n.title,t)??"",c=B(s.title,t)??"",o=-r.localeCompare(i);return o!==0?o:a.localeCompare(c)}};function ft(n,s){const[t,r]=d.useState(n);return d.useEffect(()=>{const i=setTimeout(()=>{r(n)},s);return()=>{clearTimeout(i)}},[n,s]),t}function js(n,s,t=0,r=s){if(s===n&&s===r&&s.nodeType===Node.ELEMENT_NODE&&t===1)return s.nodeType,s.textContent?.length,s.textContent?.length||0;if(s===n||n===null)return t;const i=s.parentNode;if(i===null)return t;let a=0;const c=i.childNodes;for(let o=0;o<c.length;o++){const l=c[o];if(l===s)break;l.nodeType===Node.TEXT_NODE||l.nodeType===Node.ELEMENT_NODE?a+=l.textContent?.length||0:console.warn("unknown node type",{container:n,node:s,offset:t,parent:i,i:o,child:l})}return js(n,i,a+t,r)}function jt(n,s){const t=n.textContent?.length||0;if(t<s)return null;let r=0;const i=n.childNodes;for(let a=0;a<i.length;a++){const c=i[a];let o=0;if(c.nodeType===Node.TEXT_NODE||c.nodeType===Node.ELEMENT_NODE?o=c.textContent?.length||0:console.warn("unknown node type, skip",{container:n,offset:s,child:c}),!(o===0&&i.length!==1)&&(r+=o,r>=s)){const l=s-(r-o);return c.nodeType===Node.ELEMENT_NODE?jt(c,l):{node:c,offset:l}}}return i.length,null}function bs(n,s){if(!s)return null;const t=js(n,s.startContainer,s.startOffset);if(s.startContainer.nodeType===Node.TEXT_NODE&&s.endContainer===s.startContainer)return[t,t+(s.endOffset-s.startOffset)];const r=js(n,s.endContainer,s.endOffset);return[t,r]}function rr(n,s){if(!(document.activeElement===n))return null;const r=window.getSelection();if(!r)return null;const i=document.createRange(),a=jt(n,s);if(a)try{i.setStart(a.node,a.offset),i.collapse(!0),r.removeAllRanges(),r.addRange(i)}catch(c){console.error("Error trying to set cursor!",c,{container:n,offset:s,startRange:a})}}function Os(n){if(!(document.activeElement===n))return null;const t=window.getSelection();if(!t||t.rangeCount===0)return null;const r=t.getRangeAt(0),i=bs(n,r);return i?i[0]:null}function ir(n){return n==="cql"?"fcs-cql":n==="fcs"?"fcs-fcsql":n==="lex"?"fcs-lexcql":"plain"}function ys(n,s){const t=ir(s),r="match-braces rainbow-braces";let i=n;try{i=Jt.highlight(n,t)}catch(c){console.warn("Error trying to highlight value",{value:n,error:c,language:t})}return`<pre><code class="language-${t} ${r}">${i}</code></pre>`}function Fe(n){return n?(n=n.replace(/[\n\t]/g," "),n=n.replace(/&nbsp;|\u202F|\u00A0/g," "),n):""}const bt=Mt.forwardRef(({value:n,onChange:s,onCursorChange:t,disabled:r,placeholder:i,queryType:a,delay:c=200,...o},l)=>{const u=d.useRef(null),j=d.useRef(null);d.useImperativeHandle(l,()=>j.current);const[L,x]=d.useState(Fe(n)),[N,S]=d.useState(null),_=ft(L,c),[m,A]=d.useState(_);d.useEffect(()=>{const v=ys(_,a);if(A(v),j.current){const M=Os(j.current);S(M)}},[_,a]),d.useEffect(()=>{const v=Fe(n);if(_!==v&&(x(v),A(ys(v)),j.current)){const M=Os(j.current);S(M)}},[n,_]),d.useLayoutEffect(()=>{j.current&&N!==null&&rr(j.current,N)});function C(v){const M=v.target.innerText;u.current&&(u.current.value=M),x(M),s?.(M)}function b(v){v.stopPropagation(),v.preventDefault();const $=(v.clipboardData||window.clipboardData).getData("text");R($)}function H(v){v.key==="Enter"?(v.stopPropagation(),v.preventDefault(),u.current&&u.current.form?.requestSubmit()):v.key==="Backspace"?(v.stopPropagation(),v.preventDefault(),I()):v.key==="Delete"?(v.stopPropagation(),v.preventDefault(),V()):v.ctrlKey&&v.key==="a"||S(null)}function K(v=!1){if(!j.current||!t)return;const M=j.current;if(!(document.activeElement===M))return;const y=window.getSelection();if(!y||y.rangeCount===0)return;const P=[];for(let p=0;p<y.rangeCount;p++){const h=y.getRangeAt(p),T=bs(M,h);T&&P.push(T)}if(P.length===0)return;const[g,F]=P.pop();v?g===F&&(S(g),t?.(g)):t?.(g,g!==F?F:void 0)}function k(v){if(!j.current)return null;const M=j.current;if(!(document.activeElement===M))return null;const y=window.getSelection();if(!y||y.rangeCount===0)return null;const P=[];for(let h=0;h<y.rangeCount;h++){const T=y.getRangeAt(h),Q=bs(M,T);Q&&P.push(Q)}if(P.length===0)return null;P.sort();const g=P.map(([h,T])=>T-h).reduce((h,T)=>h+T,0),F=M.innerText,p=P.toReversed().reduce((h,[T,Q])=>h.slice(0,T)+h.slice(Q),F);if(v==="backspace"){if(g===0){const h=P.filter(([T,Q])=>T===Q).map(([,T])=>T).pop();if(h===0)return null;if(h!==void 0)return{value:p.slice(0,h-1)+p.slice(h),offset:h-1}}else{const h=P.map(([,T])=>T).pop();if(h!==void 0)return{value:p,offset:h-g}}return console.warn('invalid "backspace" process, abort',{container:M,selectionIndices:P,oldValue:F,newValueSpansRemoved:p,numDeleted:g}),null}else if(v==="delete"){if(g===0){const h=P.filter(([T,Q])=>T===Q).map(([,T])=>T).pop();if(h!==void 0)return{value:p.slice(0,h)+p.slice(h+1),offset:h}}else{const h=P.map(([,T])=>T).pop();if(h!==void 0)return{value:p,offset:h-g}}return console.warn('invalid "delete" process, abort',{container:M,selectionIndices:P,oldValue:F,newValueSpansRemoved:p,numDeleted:g}),null}else if(v==="paste"){if(g===0){const h=P.filter(([T,Q])=>T===Q).map(([T])=>T).shift();if(h!==void 0)return{value:p,offset:h}}else{const h=P.map(([T])=>T).shift();if(h!==void 0)return{value:p,offset:h}}return console.warn('invalid "paste" process, abort',{container:M,selectionIndices:P,oldValue:F,newValueSpansRemoved:p,numDeleted:g}),null}}function R(v){const M=k("paste");if(!M)return;const $=Fe(v),{value:y,offset:P}=M,g=y.slice(0,P)+$+y.slice(P),F=P+v.length;x(g),S(F),u.current&&(u.current.value=g),s?.(g),t?.(F)}function I(){const v=k("backspace");if(!v)return;const{value:M,offset:$}=v,y=Fe(M);x(y),S($),u.current&&(u.current.value=y),s?.(y),t?.($)}function V(){const v=k("delete");if(!v)return;const{value:M,offset:$}=v,y=Fe(M);x(y),S($),u.current&&(u.current.value=y),s?.(y),t?.($)}return e.jsxs(e.Fragment,{children:[e.jsx("div",{role:"input",disabled:r,placeholder:i,spellCheck:!1,autoCapitalize:"off",autoCorrect:"off",...o,onInput:C,onPaste:b,onKeyDown:H,onKeyUp:()=>K(),onClick:()=>K(!0),tabIndex:r?-1:o.tabIndex,contentEditable:!0,dangerouslySetInnerHTML:{__html:m},ref:j}),i&&n===""&&e.jsx("span",{className:"input-placeholder-simulacrum",children:i}),e.jsx("input",{type:"hidden",ref:u})]})});bt.displayName="ContentEditable";var he=Pt();function yt({show:n,languages:s,resources:t,searchLanguage:r,searchLanguageFilter:i,showResourceCounts:a,showLanguageFilterOptions:c=!0,onModalClose:o}){const{t:l}=ne(),[u,j]=d.useState(r||be),[L,x]=d.useState(i||fs),[N,S]=d.useState(""),[_,m]=d.useState(a??!1),A=d.useMemo(()=>{const I=new Map;return t&&(t.forEach(V=>V.languages.forEach(v=>I.set(v,(I.get(v)??0)+1))),I.set(be,t.length)),I},[t]),C=he.useFuzzySearchList({list:Object.entries(s??{}).toSorted(),queryText:N,getText:I=>[I[0],I[1]],mapResultItem:({item:I,score:V,matches:v})=>({item:I,matches:v,score:V})});if(!s)return null;const b=Math.floor((C.length+2)/3);function H(I){o({language:u,filter:L,action:I})}function K(){j(r||be),x(i||fs)}function k(){m(I=>!I)}function R(I,V,v,M){const $=u===I;let y="d-block py-0 my-1 border-0";return $&&(y+=" fw-semibold selected"),v===void 0&&(v=[null,null]),e.jsxs(ee,{size:"sm",className:y,style:{color:`var(${$?"--bs-green":"--bs-body-colors"})`,backgroundColor:"var(--bs-body-bg)"},onClick:()=>j(I),"data-filter-score":M,children:[$&&e.jsx("span",{className:"selected-marker me-1",children:"✓"}),e.jsx(he.Highlight,{ranges:v[1],text:V})," ",e.jsx("sup",{children:e.jsx(he.Highlight,{ranges:v[0],text:I})}),_&&A.has(I)&&e.jsxs(e.Fragment,{children:[" (",A.get(I),")"]})]},I)}return e.jsxs(te,{show:n,onHide:()=>H("close"),size:"xl",fullscreen:"lg-down",centered:!0,children:[e.jsx(te.Header,{closeButton:!0,children:e.jsx(te.Title,{children:l("search.languagesModal.title")})}),e.jsxs(te.Body,{className:"px-0",children:[e.jsxs(ie,{className:["px-4"].concat(c?["pb-3 border-bottom"]:[]).join(" "),children:[e.jsxs(se,{children:[e.jsx(D,{sm:!0}),e.jsx(D,{sm:!0,className:"mb-3 mb-sm-2 align-content-end",children:R(be,l("languageCodeToName.any",{ns:"common"}))}),e.jsxs(D,{sm:!0,children:[e.jsx(q.Control,{size:"sm",placeholder:l("search.languagesModal.filterInputPlaceholder"),name:"languages-filter",value:N,onChange:I=>S(I.target.value)}),t&&e.jsx(q.Check,{name:"languages-show-count",id:"languages-show-count",checked:_,onChange:k,type:"checkbox",label:l("search.languagesModal.checkboxShowNumberOfResources"),className:"mt-1"})]})]}),e.jsxs(se,{children:[e.jsx(D,{sm:!0,children:C.slice(0,b).map(({item:[I,V],matches:v,score:M})=>R(I,V,v,M))}),e.jsx(D,{sm:!0,children:C.slice(b,2*b).map(({item:[I,V],matches:v,score:M})=>R(I,V,v,M))}),e.jsx(D,{sm:!0,children:C.slice(2*b).map(({item:[I,V],matches:v,score:M})=>R(I,V,v,M))})]})]}),c&&e.jsx(q,{children:e.jsx(ie,{className:"px-4 pt-3",children:["byMeta","byGuess","byMetaAndGuess"].map(I=>e.jsx(q.Check,{type:"radio",name:"filterOpts",value:I,id:`filterOpts-${I}`,checked:L===I,onChange:()=>x(I),label:l(`search.languagesModal.optionLanguage${I}`)},I))})})]}),e.jsxs(te.Footer,{children:[e.jsx(ee,{variant:"secondary",onClick:K,children:l("search.languagesModal.buttonReset")}),e.jsx(ee,{variant:"secondary",onClick:()=>H("abort"),children:l("search.languagesModal.buttonAbort")}),e.jsx(ee,{variant:"primary",onClick:()=>H("confirm"),children:l("search.languagesModal.buttonConfirm")})]})]})}const Ts=[{id:"cql",name:"Text layer Contextual Query Language (CQL)",searchLabel:"Full-text search",color:"#29a900",searchPlaceholder:"Elephant"},{id:"fcs",name:"Multi-layer Federated Content Search Query Language (FCS-QL)",searchLabel:"Multi-layer annotation search",color:"#00a8cc",searchPlaceholder:"[word = 'annotation'][word = 'focused']"},{id:"lex",name:"Lexical Resources Contextual Query Language (LexCQL)",searchLabel:"Lexical resource search",color:"#e77e00",searchPlaceholder:"banana"}],rs=Object.fromEntries(["cql","fcs","lex"].map(n=>[n,Ts.find(s=>s.id===n)])),Us=["fcs","lex"],ar=[{id:"text",label:"Plain Text"},{id:"csv",label:"CSV"},{id:"tcf",label:"TCF"},{id:"ods",label:"ODS"},{id:"excel",label:"Excel"}],or="cql",ns=[10,20,50,100,200,250],Se="info:srw/diagnostic/1/61",lr=[{id:"cql-single-term",queryType:"cql",query:"Elephant",description:"Query with single term"},{id:"cql-with-boolean",queryType:"cql",query:"cat AND dog",description:"Query with boolean"},{id:"cql-with-phrase",queryType:"cql",query:'"exciting news"',description:"Query with phrase (quoting because of whitespaces)"},{id:"fcs-three-tokens-artznei",queryType:"fcs",query:'[ word = "her.*" ] [ lemma = "Artznei" ] [ pos = "VERB" ]',description:'Phrase with three tokens: a word starting with "her", a lemmatized word, and a verb'},{id:"lex-plain-string",queryType:"lex",query:"apple",description:"Search for plain string"},{id:"lex-lemma-with-language",queryType:"lex",query:'lemma =/lang=deu "Apfel"',description:'Search for German lemma "Apfel"'}];function cr({show:n,queryTypes:s,onModalClose:t}){const{t:r}=ne(),i=s&&s.length>0?s:["cql","fcs","lex"],a=lr.filter(u=>i.includes(u.queryType));if(a.length===0)return c("abort"),null;function c(u){t({query:void 0,queryType:void 0,action:u})}function o(u,j){t({query:u,queryType:j,action:"confirm"})}function l(u,j,L,x){return e.jsxs(se,{children:[e.jsx(D,{md:"auto",className:"d-none d-md-block",children:x&&`${x}.`}),e.jsxs(D,{className:"d-flex flex-column",children:[L!==void 0&&e.jsx("div",{children:L}),e.jsx("div",{dangerouslySetInnerHTML:{__html:ys(u,j)}})]}),e.jsx(D,{md:"auto",className:"d-flex justify-content-end align-items-baseline",children:e.jsx(ee,{size:"sm",onClick:()=>o(u,j),children:r("search.suggestionsModal.buttonUseQuery")})})]},u)}return e.jsxs(te,{id:"search-query-suggestions-modal",show:n,onHide:()=>c("close"),size:"xl",fullscreen:"xl-down",centered:!0,children:[e.jsx(te.Header,{closeButton:!0,children:e.jsx(te.Title,{children:r("search.suggestionsModal.title")})}),e.jsx(te.Body,{className:"px-0",children:e.jsx(ie,{fluid:!0,children:i.map(u=>{const j=a.filter(L=>L.queryType===u);return j.length===0?null:e.jsxs(d.Fragment,{children:[e.jsx(se,{children:e.jsx(D,{children:e.jsx("h4",{className:"border-bottom pb-2",children:r(`queryTypes.${u}.nameLong`,{ns:"common",defaultValue:rs[u]?.name??u.toUpperCase()})})})}),j.map((L,x)=>l(L.query,L.queryType,L.description,x+1))]},u)})})}),e.jsx(te.Footer,{children:e.jsx(ee,{variant:"primary",onClick:()=>c("close"),children:r("search.suggestionsModal.buttonClose")})})]})}function wt({disabled:n,value:s,onChange:t,delay:r=300}){const[i,a]=d.useState(s??""),c=ft(i,r);return d.useEffect(()=>{t(c)},[t,c]),e.jsx(q.Control,{type:"search",placeholder:"Search for ...",value:i,onChange:o=>a(o.target.value),disabled:n})}function vt(n,s,t,r){const i=mt(s);r??=["title","institution","description"];const a=he.useFuzzySearchList({list:i,queryText:n,getText:x=>{const N=[];return r.includes("title")&&N.push(B(x.title,t)),r.includes("institution")&&N.push(B(x.institution,t)),r.includes("description")&&N.push(B(x.description,t)),N},mapResultItem:({item:x,score:N,matches:S})=>{const _=new Map;let m=0;return r.includes("title")&&_.set("title",S[m++]),r.includes("institution")&&_.set("institution",S[m++]),r.includes("description")&&_.set("description",S[m++]),{resource:x,matches:_,score:N}}}),c=a.reduce((x,{resource:N,matches:S})=>(x.set(N.id,S),x),new Map),o=a.reduce((x,{resource:N,score:S})=>x.set(N.id,S),new Map),l=new Set;a.filter(({resource:x})=>x.rootResourceId!==null).forEach(({resource:x,score:N})=>{const S=o.get(x.rootResourceId);S===void 0?(l.add(x.rootResourceId),o.set(x.rootResourceId,N)):N<S&&o.set(x.rootResourceId,N)});const u=s.filter(x=>l.has(x.id)).map(x=>({resource:x,score:o.get(x.id)}));return{resources:[...a.filter(({resource:x})=>!x.rootResourceId),...u].toSorted(({score:x},{score:N})=>x===N?0:x===void 0?1:N===void 0?-1:x-N).map(({resource:x})=>x),matches:c,scores:o}}function Es({resource:n,selectedResourceIDs:s,highlighting:t,highlightings:r,shouldBeShown:i,localeForInfos:a,onSelectClick:c,languageCodeToName:o}){const{t:l}=ne(),[u,j]=d.useState(!1),[L,x]=d.useState(!1);t??=r?.get(n.id)??new Map;const N=s.includes(n.id),S=Qe(n),_=pe(k=>k.locale),[m,A]=d.useState(_);if(d.useEffect(()=>{_&&A(_)},[_]),d.useEffect(()=>{a&&A(a)},[a]),typeof i=="function"&&!i(n))return null;if(i===!1)return null;const C=typeof i=="function"?n.subResources.some(k=>i(k)):!0;function b(){u&&document.getSelection()?.type==="Range"||j(k=>!k)}function H(){c(n,!N)}function K(){x(k=>!k)}return e.jsxs(e.Fragment,{children:[e.jsxs(se,{className:`p-2 m-1 ${u&&"border-bottom"}`,children:[e.jsx(D,{md:"auto",sm:1,onClick:H,children:e.jsx(q.Check,{id:`resource-selection-${n.id}`,"aria-label":l("search.results.resourceInfo.checkboxResourceAriaLabel",{title:n.title}),children:e.jsx(q.Check.Input,{checked:N,onChange:()=>{}})})}),e.jsxs(D,{md:8,sm:11,className:`mb-sm-2 ${u?"":"text-truncate"}`,onClick:b,children:[e.jsxs("h4",{className:`h5 ${u?"":"text-truncate"}`,children:[e.jsx(he.Highlight,{text:B(n.title,m)??"",ranges:t.get("title")??null})," ",n.landingPage&&e.jsx("small",{children:e.jsxs("a",{href:n.landingPage,className:"matomo_link",target:"_blank",children:[l("search.resourcesModal.resource.moreInformation")," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:as}})]})})]}),e.jsx("p",{className:`mb-0 ${u?"":"text-truncate"}`,children:B(n.description,m)&&e.jsx(he.Highlight,{text:B(n.description,m)??"",ranges:t.get("description")??null})})]}),e.jsxs(D,{md:{span:3,offset:0},sm:{span:11,offset:1},className:`${u?"":" text-truncate"}`,onClick:b,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:We}})," ",e.jsx(he.Highlight,{text:B(n.institution,m)??"",ranges:t.get("institution")??null}),e.jsx("br",{}),e.jsx("i",{dangerouslySetInnerHTML:{__html:Oe}})," ",n.languages.map(o).sort().join(", "),u&&S.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx(Ke,{type:"radio",name:`resources-${n.id}-info-languages`,defaultValue:m,onChange:k=>A(k),onClick:k=>k.stopPropagation(),className:"mt-2",children:S.toSorted().map(k=>e.jsx(ke,{variant:"outline-secondary",size:"sm",id:`resources-${n.id}-info-languages-${k}`,value:k,type:"radio",children:k},k))})]})]}),C&&n.subResources.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-100"}),e.jsx(D,{md:"auto",sm:1,style:{width:"2.8rem"}}),e.jsx(D,{md:{span:8,offset:0},sm:{span:11,offset:1},children:e.jsx(ee,{variant:"link",size:"sm",className:"ps-0",onClick:K,children:l("search.resourcesModal.resource.toggleExpand",{context:L?"collapse":"expand",count:n.subResources.length})})})]})]}),C&&L&&e.jsx(E,{className:"ms-md-5 ms-sm-2 border-end-0 border-top-0 rounded-end-0 rounded-top-0",children:n.subResources.map(k=>e.jsx(Es,{resource:k,highlightings:r,selectedResourceIDs:s,shouldBeShown:i,onSelectClick:c,languageCodeToName:o},k.id))})]})}function Ds({title:n,resources:s,selectedResourceIDs:t,resourceScores:r,highlightings:i,expanded:a,shouldBeShown:c,localeForInfos:o,onSelectClick:l,onExpandToggleClick:u,onSelectAllClick:j,onDeselectAllClick:L,languageCodeToName:x}){const{t:N}=ne(),[S,_]=d.useState(a);d.useEffect(()=>{_(a)},[a]);const m=r!==void 0?s.filter(b=>r.has(b.id)).toSorted((b,H)=>{const K=r.get(b.id),k=r.get(H.id);return K===k?0:K===void 0?1:k===void 0?-1:K-k}):s;if(m.length===0)return null;function A(){_(b=>!b),u(!S)}function C(){const b=s.filter(R=>!R.rootResourceId),H=we(b).length,K=b.length,k=we(b).filter(R=>t.includes(R)).length;return N("search.resourcesModal.grouped.msgResources",{count:K,nested:H-K,context:H-K?"nested":null})+(k!==H?N("search.resourcesModal.grouped.msgResourcesSelected",{count:k}):"")}return e.jsxs(ie,{className:"border-bottom pb-2 mb-4 px-0",children:[e.jsxs(se,{className:"px-3",children:[e.jsx(D,{md:9,sm:12,children:e.jsx("h3",{children:n})}),e.jsxs(D,{md:3,sm:12,className:"gap-1 d-inline-flex column-gap-2 justify-content-evenly",style:{height:"fit-content"},children:[e.jsx(ee,{size:"sm",variant:"secondary",onClick:A,"aria-expanded":S,children:N("search.resourcesModal.grouped.buttonExpand",{context:S?"hide":"show"})}),e.jsx(ee,{size:"sm",onClick:()=>j(s),children:N("search.resourcesModal.grouped.buttonSelectAll")}),e.jsx(ee,{size:"sm",onClick:()=>L(s),children:N("search.resourcesModal.grouped.buttonDeselectAll")})]})]}),e.jsx(se,{className:"px-3",children:e.jsx(D,{children:C()})}),e.jsx(Ys,{in:S,children:e.jsx(ie,{children:m.map(b=>e.jsx(Es,{resource:b,highlightings:i,selectedResourceIDs:t,shouldBeShown:c,onSelectClick:l,languageCodeToName:x,localeForInfos:o},b.id))})})]})}function ur({show:n,showGrouping:s,resources:t,languages:r,availableResources:i,selectedResources:a,onModalClose:c}){const{t:o}=ne(),l=pe(w=>w.locale),[u,j]=d.useState(l);d.useEffect(()=>{l&&j(l)},[l]);const L=new Intl.DisplayNames([l,"en"],{type:"language"}),[x,N]=d.useState(a||i),[S,_]=d.useState(Wn),[m,A]=d.useState(ht),[C,b]=d.useState(Qn),[H,K]=d.useState(""),[k,R]=d.useState({}),[I,V]=d.useState({});d.useEffect(()=>{s&&A(s)},[n,s]),d.useEffect(()=>N(a),[a]);const v=t.filter(w=>i.includes(w.id)).toSorted(xt[C]),$=v.map(w=>Qe(w)).flat().reduce((w,Y)=>w.set(Y,(w.get(Y)??0)+1),new Map),{resources:y,matches:P,scores:g}=vt(H,v,u),F=d.useMemo(()=>{const w=new Map;return m==="institution"?Object.entries(k).forEach(([Y,Z])=>{w.set(Y,Z.resources.reduce((X,je)=>{const me=g.get(je.id);return me===void 0?X:X===void 0?me:X<me?X:me},void 0))}):m==="language"&&Object.entries(I).forEach(([Y,Z])=>{w.set(Y,Z.resources.reduce((X,je)=>{const me=g.get(je.id);return me===void 0?X:X===void 0?me:X<me?X:me},void 0))}),w},[m,g,k,I]);if(d.useMemo(()=>{const w={},Y={};t.forEach(Z=>{const X=B(Z.institution,u)??"";Object.getOwnPropertyNames(w).includes(X)||(w[X]={expanded:!0,resources:[]}),w[X].resources.push(Z),Z.languages.forEach(je=>{Object.getOwnPropertyNames(Y).includes(je)||(Y[je]={expanded:!0,resources:[]}),Y[je].resources.push(Z)})}),R(w),V(Y)},[t,u]),!t)return null;const p={total:we(t).length,totalRoot:t.length,available:i.length,selected:x.length,visible:we(y.map(w=>w)).length,visibleRoot:y.length};function h(w){return os(w,r,{defaultAnyLanguage:o("languageCodeToName.any",{ns:"common"}),defaultUnknownLanguage:o("languageCodeToName.unknown",{ns:"common"})})}function T(w,Y){const Z=x.filter(X=>!w.includes(X));N(Y?[...Z,...w]:Z)}function Q(w){c({resourceIDs:x,action:w})}function f(w){_(w.target.value)}function U(w){A(w.target.value)}function z(w){b(w.target.value)}function le(){N(i)}function ls(){N([])}function Ge(){N(y.map(w=>w.id))}function Ne(w,Y){T(we([w]),Y)}function Ye(w){T(we(w),!0)}function Xe(w){T(we(w),!1)}function De(w){return!(!i.includes(w.id)||S==="selected"&&!x.includes(w.id)&&!pt(w,Y=>x.includes(Y.id)))}function cs(){return m==="institution"?Object.entries(k).toSorted(([w],[Y])=>{const Z=F.get(w),X=F.get(Y);return Z===X?0:Z===void 0?1:X===void 0?-1:Z-X}).map(([w,{expanded:Y,resources:Z}])=>e.jsx(Ds,{title:e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:We}})," ",w]}),resources:Z,selectedResourceIDs:x,resourceScores:g,highlightings:P,expanded:Y,shouldBeShown:De,onSelectAllClick:Ye,onExpandToggleClick:X=>{R({...k,[w]:{...k[w],expanded:X}})},onDeselectAllClick:Xe,onSelectClick:Ne,languageCodeToName:h,localeForInfos:u},w)):m==="language"?Object.entries(I).toSorted(([w],[Y])=>{const Z=F.get(w),X=F.get(Y);return Z===X?0:Z===void 0?1:X===void 0?-1:Z-X}).map(([w,{expanded:Y,resources:Z}])=>e.jsx(Ds,{title:e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Oe}})," ",h(w)," [",w,"]"]}),resources:Z,selectedResourceIDs:x,resourceScores:g,highlightings:P,expanded:Y,shouldBeShown:De,onSelectAllClick:Ye,onExpandToggleClick:X=>I[w].expanded=X,onDeselectAllClick:Xe,onSelectClick:Ne,languageCodeToName:h,localeForInfos:u},w)):y.filter(w=>!w.rootResourceId).map(w=>e.jsx(Es,{resource:w,selectedResourceIDs:x,highlighting:P.get(w.id),highlightings:P,shouldBeShown:De,onSelectClick:Ne,languageCodeToName:h,localeForInfos:u},w.id))}return e.jsxs(te,{id:"resource-selection-modal",show:n,onHide:()=>Q("close"),size:"xl",fullscreen:"xl-down",centered:!0,children:[e.jsx(te.Header,{closeButton:!0,children:e.jsx(te.Title,{children:o("search.resourcesModal.title")})}),e.jsxs(te.Body,{className:"px-0",children:[e.jsx(q,{className:"px-3 pb-3 border-bottom",onSubmit:w=>w.preventDefault(),children:e.jsxs(ie,{children:[e.jsxs(se,{className:"d-sm-flex row-gap-2 justify-content-around",children:[e.jsx(D,{md:2,sm:6,children:e.jsx(ve,{label:"View",controlId:"resource-view-options-visibility",children:e.jsxs(q.Select,{value:S,onChange:f,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"selected",children:"Selected only"})]})})}),e.jsx(D,{md:2,sm:6,children:e.jsx(ve,{label:"Group by",controlId:"resource-view-options-grouping",children:e.jsxs(q.Select,{value:m,onChange:U,children:[e.jsx("option",{value:"resource",children:"(Resource)"}),e.jsx("option",{value:"institution",children:"Institution"}),e.jsx("option",{value:"language",children:"Language"})]})})}),e.jsx(D,{md:2,sm:6,children:e.jsx(ve,{label:"Sort by",controlId:"resource-view-options-sorting",children:e.jsxs(q.Select,{value:C,onChange:z,disabled:m!=="resource"||H.trim()!=="",children:[e.jsx("option",{value:"title-up",children:"Title (up)"}),e.jsx("option",{value:"title-down",children:"Title (down)"}),e.jsx("option",{value:"institution-up",children:"Institution (up)"}),e.jsx("option",{value:"institution-down",children:"Institution (down)"})]})})}),e.jsx(D,{md:3,sm:12,children:e.jsx(ve,{label:"Resource filter query",controlId:"resource-view-options-filter",children:e.jsx(wt,{value:H,onChange:w=>K(w)})})}),e.jsxs(D,{md:3,sm:12,className:"gap-1 d-inline-flex column-gap-2 justify-content-evenly",children:[e.jsx(ee,{onClick:le,children:"Select all"}),e.jsx(ee,{onClick:Ge,disabled:S!=="all"||H.trim()==="",children:"Select visible"}),e.jsx(ee,{onClick:ls,children:"Deselect all"})]})]}),$.size>1&&e.jsxs(q.Group,{as:se,controlId:"resource-info-language",className:"mt-2",children:[e.jsx(q.Label,{column:!0,sm:"auto",style:{fontSize:"0.875rem"},children:o("search.resourcesModal.labelChangeResourceInfoLanguage")}),e.jsx(D,{sm:"auto",children:e.jsx(Ke,{type:"radio",name:"resource-info-languages",defaultValue:u,onChange:w=>j(w),children:Array.from($.entries()).toSorted().map(([w,Y])=>e.jsxs(ke,{size:"sm",id:`resource-info-languages-${w}`,value:w,variant:"secondary",title:o("search.resourcesModal.buttonChangeResourceInfoLanguageTitle",{count:Y,language:w,languageName:L.of(w)}),children:[L.of(w)," ",e.jsx("sup",{children:w})]},w))})})]})]})}),e.jsx("p",{className:"m-4 mb-0",children:o("search.resourcesModal.msgResourcesSelected",{count:p.selected,total:p.visible,available:p.available,context:p.available!==p.visible?"available":null})}),e.jsx(ie,{className:"px-3 pt-3",children:cs()})]}),e.jsx(te.Footer,{children:e.jsx(ee,{variant:"primary",onClick:()=>Q("confirm"),children:o("search.resourcesModal.buttonConfirm")})})]})}function dr(){const[n,s]=d.useState(!1);return[n,()=>{n!==!0&&s(!0)}]}function hr(){const n=Ks(),{hash:s}=ws(),t=d.useMemo(()=>new URLSearchParams(s.substring(1)),[s]),r=d.useCallback(i=>{const a=zs(typeof i=="function"?i(new URLSearchParams(t)):i),c=a.entries().next().done?"":`#${a}`;s!==c&&n({hash:c})},[t,s,n]);return[t,r]}const mr=d.lazy(()=>ce(()=>import("./fcs-sru-aggregator-ui-query-builder-0.0.0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]),import.meta.url));function Hs(n,s=""){const t=n.get("query");return t||s}function Fs(n,s="cql"){const t=n.get("queryType");if(t){if(Ts.find(r=>r.id===t)!==void 0)return t;console.warn("Found unsupported queryType in search params",t)}return s}function gr({resources:n,languages:s,onSearch:t,onShowToast:r,availableResources:i=null,selectedResources:a=null,hasSearch:c=!1,disabled:o=!1}){const{t:l}=ne(),[u,j]=Ae(),[L,x]=hr(),[N,S]=d.useState(!1),[_,m]=d.useState(ht),[A,C]=d.useState(!1),[b,H]=d.useState(!1),[K,k]=d.useState(!1),[R,I]=dr(),[V,v]=d.useState(be),[M,$]=d.useState(fs),[y,P]=d.useState(Fs(u,or)),[g,F]=d.useState(i??[]),[p,h]=d.useState(a??[]),[T,Q]=d.useState(ns[0]),[f,U]=d.useState(Hs(u,"")),[z]=d.useState(null),[le,ls]=d.useState(!1);d.useEffect(()=>{h(a??[])},[a]);const Ge=d.useCallback(O=>{const W=Yn(O,y,M==="byGuess"?be:V);return i&&i.length>0?W.filter(ge=>i.includes(ge)):W},[y,V,M,i]);d.useEffect(()=>{const O=Ge(n);F(O),h(W=>W.filter(ge=>O.includes(ge)))},[n,Ge]);const Ne=d.useCallback(()=>{const O={language:V,languageFilter:M,queryType:y,query:f,resourceIDs:p??[],numberOfResults:T};O.query!==""&&O.resourceIDs.length!==0&&t(O)},[V,M,T,t,f,y,p]);d.useEffect(()=>{if(u&&(U(W=>Hs(u,W)),P(W=>Fs(u,W)),!u.get("x-aggregation-context"))){const W=u.get("mode");W&&(W==="search"&&Ne(),u.delete("mode"),j(u))}},[u,j,Ne]),d.useEffect(()=>{u.get("query")!==f&&(u.set("query",f),j(u))},[f,u,j]),d.useEffect(()=>{u.get("queryType")!==y&&(u.set("queryType",y),j(u))},[y,u,j]),d.useEffect(()=>{L.has("openQueryBuilder")&&(I(),k(!0),L.delete("openQueryBuilder"),x(L))},[L,x,I]);const Ye=Xn(n,p??[]).length,Xe=n.find(O=>O.searchCapabilitiesResolved.includes("ADVANCED_SEARCH"))!==void 0,De=n.find(O=>O.searchCapabilitiesResolved.includes("LEX_SEARCH"))!==void 0,cs=Us.includes(y);function w(O){O&&P(O)}function Y(O){let W=Number.parseInt(O.target.value);W<10&&(W=10),W>250&&(W=250),ns.includes(W)||console.warn("Invalid number of results?!",{valid:ns,value:W}),Q(W)}function Z({language:O,filter:W,action:ge}){C(!1),ge!=="abort"&&(v(O),$(W))}function X({resourceIDs:O,action:W}){S(!1),W!=="abort"&&h(O)}function je({query:O,queryType:W,action:ge}){H(!1),ge!=="abort"&&ge!=="close"&&(!O||!W||(P(W),U(O)))}function me({query:O,validResources:W,action:ge}){k(!1),ge!=="abort"&&ge!=="close"&&(U(O),p.length!==W.length&&r?.({title:l("search.toasts.searchInput.title"),body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:l("search.toasts.searchInput.msgResourcesChangedDueToQuery")}),e.jsx("p",{children:l("search.toasts.searchInput.msgResourcesAmountChanged",{before:p.length,after:W.length})}),e.jsx("hr",{}),e.jsx(ee,{onClick:()=>h(p),children:l("search.toasts.searchInput.buttonRevertSelection")})]}),variant:"info",delay:7e3}),h(W))}function _s(O){U(O)}function Tt(O){O.preventDefault(),Ne()}function Et(){const O=(p??[]).length,W=n.length===O||g.length===O?"all":null;return l("search.searchInput.buttonSelectedResources",{count:O,context:W})}return e.jsxs("search",{id:"fcs-query",children:[e.jsxs(q,{noValidate:!0,onSubmit:Tt,children:[e.jsxs(Wt,{size:c?void 0:"lg",hasValidation:!0,children:[e.jsx(ee,{variant:"outline-secondary",type:"button",id:"fcs-search-query-suggestions-button","aria-label":l("search.searchInput.buttonOpenQuerySuggestions"),onClick:()=>H(!0),children:e.jsx("i",{dangerouslySetInnerHTML:{__html:tt},"aria-hidden":"true"})}),e.jsx(q.Control,{placeholder:"Elephant","aria-label":l("search.searchInput.inputQueryAriaLabel"),"aria-describedby":"fcs-search-input-button",className:"text-center search-query-input",disabled:o,"aria-disabled":o,value:f,isInvalid:!!z,...le?{as:bt,queryType:y,onChange:_s}:{onChange:O=>_s(O.target.value)}}),cs&&e.jsx(ee,{id:"fcs-search-input-query-builder-button",variant:"outline-secondary","aria-label":l("search.searchInput.buttonOpenQueryBuilderAriaLabel"),className:"border-end-0 d-none d-md-block",onClick:()=>{I(),k(!0)},children:e.jsx("i",{dangerouslySetInnerHTML:{__html:ze},"aria-hidden":"true"})}),e.jsx(ke,{id:"fcs-search-input-enhanced-button",value:"enhance-query",type:"checkbox",checked:le,onChange:()=>ls(O=>!O),variant:"outline-secondary","aria-label":l("search.searchInput.buttonEnhanceQueryAriaLabel",{context:le?"enabled":"disabled"}),className:"d-flex align-items-center border-end-0",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:ot},"aria-hidden":"true"})}),e.jsxs(ee,{variant:"outline-primary",type:"submit",id:"fcs-search-input-button",disabled:o||f.trim().length===0,"aria-disabled":o,"aria-label":l("search.searchInput.buttonSearchAriaLabel"),children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:lt},"aria-hidden":"true",className:"d-inline d-md-none"}),e.jsx("span",{className:"d-none d-md-inline",children:l("search.searchInput.buttonSearch")})]}),e.jsx(q.Control.Feedback,{type:"invalid",children:z?.msg})]}),e.jsx("div",{id:"fcs-query-filters",className:"mt-2 mb-3 lh-lg text-center",children:e.jsx(G,{i18nKey:"search.searchInput.filtersSummary",components:[e.jsxs(oe,{className:"d-inline-block",onSelect:w,"aria-disabled":o,"aria-label":l("search.searchInput.dropdownQueryTypeAriaLabel"),children:[e.jsxs(oe.Toggle,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2 no-arrow",disabled:o,"aria-disabled":o,style:rs[y]?{"--color":rs[y].color}:{},children:[l(`queryTypes.${y}.nameShort`,{ns:"common",defaultValue:rs[y]?.searchLabel??y.toUpperCase()})," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:Be},"aria-hidden":"true"})]}),e.jsx(oe.Menu,{children:Ts.filter(O=>O.id==="cql"||O.id==="fcs"&&Xe||O.id==="lex"&&De).map(O=>e.jsx(oe.Item,{as:"button",eventKey:O.id,onClick:W=>W.preventDefault(),style:{"--color":O.color,background:"color-mix(in srgb, var(--color) 50%, transparent)"},children:l(`queryTypes.${O.id}.nameLong`,{ns:"common",defaultValue:O.name})},O.id))})]}),e.jsxs(ee,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2",disabled:o,"aria-disabled":o,onClick:()=>{m("resource"),S(!0)},children:[Et()," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:Be},"aria-hidden":"true"})]}),e.jsxs(ee,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2",disabled:o,"aria-disabled":o,onClick:()=>{m("institution"),S(!0)},children:[l("search.searchInput.buttonSelectedInstitutions",{count:Ye})," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:Be},"aria-hidden":"true"})]}),e.jsxs(ee,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2",onClick:()=>C(!0),disabled:o,"aria-disabled":o,children:[os(V,s??{},{defaultAnyLanguage:l("languageCodeToName.any",{ns:"common"}),defaultUnknownLanguage:l("languageCodeToName.unknown",{ns:"common"})})," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:Be},"aria-hidden":"true"})]}),e.jsx(q.Select,{size:"sm",className:"d-inline-block w-auto mx-1",onChange:Y,value:T,"aria-label":l("search.searchInput.selectNumberOfSearchResultsAriaLabel"),disabled:o,"aria-disabled":o,children:ns.map(O=>e.jsx("option",{value:O,children:O},O))})]})})]}),e.jsx(yt,{languages:s,resources:n,searchLanguage:V,show:A,onModalClose:Z}),e.jsx(ur,{resources:n,languages:s,availableResources:g,selectedResources:p??[],show:N,showGrouping:_,onModalClose:X}),e.jsx(cr,{queryTypes:[y],show:b,onModalClose:je}),Us.includes(y)&&R&&e.jsx(d.Suspense,{fallback:e.jsx(e.Fragment,{children:l("loading",{ns:"querybuilder",defaultValue:l("generic.loadingComponent",{ns:"common"})})}),children:e.jsx(mr,{query:f,queryType:y,resources:n,selectedResources:p,show:K,onModalClose:me})})]})}function pr({searchId:n,resourceId:s,numberOfResults:t,pollDelay:r=1500}){const{t:i}=ne(),a=Le(),c=Ws(),[o,l]=d.useState(!1),{isPending:u,mutate:j,reset:L}=Qs({mutationFn:an.bind(null,a,n,{resourceId:s,numberOfResults:t}),mutationKey:["search-result-load-more",n,s],onSuccess:async b=>{b!==void 0&&n!==b&&console.warn("SearchIDs should be the same?!",{searchId:n,searchIdNewButSame:b,resourceId:s}),await c.invalidateQueries({queryKey:["search-results",n,s]}),l(!0)}});r??=1500;const{data:x,isLoading:N,isFetching:S}=Re({queryKey:["search-results",n,s],queryFn:ln.bind(null,a,n,s),enabled:o,refetchInterval(b){return b.state.data&&b.state.data.inProgress?r:!1}}),_=u||N||S,m=!!x&&!x.inProgress,A=_||o;o&&m&&(o&&l(!1),c.invalidateQueries({queryKey:["search-result-details",n,s]}));async function C(){L(),j()}return e.jsx(ee,{className:"more-results-button",disabled:A,onClick:C,children:A?e.jsx(Xs,{animation:"border",className:"d-block"}):e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:ct}})," ",i("search.results.buttonLoadMore")]})})}function xr(n,s=".."){const t=n.map(o=>o.split("/")),r=Math.max(...t.map(o=>o.length)),a=Array.from(Array(r).keys()).map(o=>new Set(t.map(l=>l.length>o?l[o]:!1)).size===1).reduce((o,l,u,j,L=s??"..")=>l?o&&o[o.length-1]!==L?o.concat([L]):o:o.concat([u]),[]);return n.map(o=>[o,o.split("/")]).map(([o,l])=>[o,a.map(u=>typeof u=="number"?l[u]:u).join("/").replace(/\/+$/,"")]).reduce((o,[l,u])=>o.set(l,u),new Map)}function fr(n,s){const t=n.filter(i=>i.spans.every(a=>a.text&&a.text.length===(a.range?.[1]??0)-(a.range?.[0]??0))||i.spans.every(a=>a.text&&a.text.length===(a.range?.[1]??0)-(a.range?.[0]??0)+1));return s?t.filter(i=>{const a=s.get(i.id);return a?!!["text","word"].includes(a.layerType.toLowerCase()):!0}).toSorted((i,a)=>{const c=s.get(i.id),o=s.get(a.id);if(c===void 0||o===void 0){if(c===o)return 0;if(c===void 0)return 1;if(o===void 0)return-1}const l=c.layerType.toLowerCase(),u=o.layerType.toLowerCase();if(l==="word"||u==="word"){if(l===u)return 0;if(l==="word")return-1;if(u==="word")return 1}if(c.qualifier!==null&&c.qualifier!==void 0||o.qualifier!==null&&o.qualifier!==void 0){if(c.qualifier!==null&&c.qualifier!==void 0&&o.qualifier!==null&&o.qualifier!==void 0)return 0;if(c.qualifier!==null&&c.qualifier!==void 0)return 1;if(o.qualifier!==null&&o.qualifier!==void 0)return-1}return 0}):t}function St({data:n,resource:s}){const t=d.useRef(null),r=s?.availableLayers?.reduce((a,c)=>a.set(c.resultId,c),new Map);function i(a){const c=a.map(x=>x.id),o=xr(c),l=Math.max(...a.map(x=>x.spans.length)),j=fr(a,r)?.[0]?.id;a.sort((x,N)=>j===void 0?0:x.id===j?-1:N.id===j?1:0);const L=c.length>1;return e.jsxs(ae,{hover:!0,responsive:!0,className:"mb-0 results-plain",style:{width:"unset"},children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[r!==void 0&&L&&e.jsx("th",{scope:"col",children:"Layer Type"}),L&&e.jsx("th",{scope:"col",children:"Layer Identifier"}),Array(l).fill(null).map((x,N)=>e.jsx("th",{scope:"col",children:"Token"},N))]})}),e.jsx("tbody",{children:a.map(x=>e.jsxs("tr",{className:["text-nowrap"].concat([x.id===j&&a.length>1?"table-primary":null]).filter(Boolean).join(" "),children:[r!==void 0&&L&&e.jsx("td",{scope:"row",className:"text-uppercase",children:r.get(x.id)?.layerType}),L&&e.jsx("td",{scope:"row",title:x.id,className:"border-end",children:o.get(x.id)}),x.spans.map((N,S)=>e.jsx("td",{children:N.hit?e.jsx("mark",{children:e.jsx("strong",{children:N.text})},S):N.text},N.range?.join("-")??S))]},x.id))})]})}return e.jsxs(e.Fragment,{children:[e.jsxs(ae,{responsive:!0,striped:!0,className:"mb-0 results-plain",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Result with Annotation Layers"})]})}),e.jsx("tbody",{children:n.records.map((a,c)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"result-idx text-end text-muted d-none d-sm-table-cell",children:c+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[a.ref&&e.jsx("a",{href:a.ref,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ue}})})," ",a.pid&&e.jsx(Ce,{placement:"auto-start",container:t,delay:{show:250,hide:400},overlay:e.jsx(Me,{id:`ttip-${a.pid}-${c}`,children:a.pid}),children:e.jsx(fe,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:i(a.adv)})]},`${a.pid??a.ref??n.resource.id}-${c}`))})]}),e.jsx("div",{ref:t,className:"tooltip-mounting-point"})]})}function Rt({data:n}){const s=d.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs(ae,{hover:!0,responsive:!0,className:"mb-0 results-kwic",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Left Context"}),e.jsx("th",{scope:"col",children:"Hit"}),e.jsx("th",{scope:"col",children:"Right Context"})]})}),e.jsx("tbody",{children:n.records.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"result-idx text-end text-muted d-none d-sm-table-cell",children:r+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[t.ref&&e.jsx("a",{href:t.ref,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ue}})})," ",t.pid&&e.jsx(Ce,{placement:"auto-start",container:s,delay:{show:250,hide:400},overlay:e.jsx(Me,{id:`ttip-${t.pid}-${r}`,children:t.pid}),children:e.jsx(fe,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:t.hits.left}),e.jsx("td",{children:t.hits.keyword&&e.jsx("mark",{children:e.jsx("strong",{children:t.hits.keyword})})}),e.jsx("td",{children:t.hits.right})]},`${t.pid??t.ref??n.resource.id}-${r}`))})]}),e.jsx("div",{ref:s,className:"tooltip-mounting-point"})]})}function Lt({data:n}){const s=d.useRef(null);return e.jsxs("div",{className:"results-lexical-entry d-flex flex-column flex-wrap column-gap-2 row-gap-2",children:[n.records.map((t,r)=>e.jsx(E,{className:"flex-grow-1",children:e.jsxs(E.Body,{children:[e.jsx(E.Title,{children:t.lex.fields.filter(i=>i.type==="lemma").map(i=>i.values).flat(1).map(i=>e.jsx("span",{children:i.value}))}),e.jsxs(qe,{variant:"flush",children:[(t.lex.lang||t.lex.langUri)&&e.jsxs(qe.Item,{children:[e.jsx("strong",{children:"lang"}),": ",t.lex.lang," ",t.lex.langUri]}),t.lex.fields.filter(i=>i.type!=="lemma").map(i=>e.jsxs(qe.Item,{children:[e.jsx("strong",{children:i.type}),":",i.values.map((a,c)=>e.jsx("span",{className:"ms-2 lex-value",children:a.value},c))]},i.type))]}),e.jsx(E.Link,{children:t.ref&&e.jsxs("a",{href:t.ref,className:"matomo_link",target:"_blank",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ue}})," Original results ..."]})}),e.jsx(E.Link,{children:t.pid&&e.jsx(Ce,{placement:"auto-start",container:s,delay:{show:250,hide:400},overlay:e.jsx(Me,{id:`ttip-${t.pid}-${r}`,children:t.pid}),children:e.jsx(fe,{bg:"secondary",className:"pid-badge",children:"PID"})})})]})},`${t.pid??t.ref??n.resource.id}-${r}`)),e.jsx("div",{ref:s,className:"tooltip-mounting-point"})]})}function Nt({data:n}){const s=d.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs(ae,{hover:!0,responsive:!0,className:"mb-0 results-lex-plain",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Result with Hit"})]})}),e.jsx("tbody",{children:n.records.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"result-idx text-end text-muted d-none d-sm-table-cell",children:r+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[t.ref&&e.jsx("a",{href:t.ref,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ue}})})," ",t.pid&&e.jsx(Ce,{placement:"auto-start",container:s,delay:{show:250,hide:400},overlay:e.jsx(Me,{id:`ttip-${t.pid}-${r}`,children:t.pid}),children:e.jsx(fe,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:t.hits.fragments.map((i,a)=>i.hit&&!i.hitKind?e.jsx("mark",{children:e.jsx("strong",{children:i.text})},a):i.hit&&i.hitKind?e.jsx("span",{className:`lex-hitkind-${i.hitKind}`,title:`Annotated as "${i.hitKind.split("-").slice(1).join("-")}"`,children:i.text},a):e.jsx("span",{children:i.text},a))})]},`${t.pid??t.ref??n.resource.id}-${r}`))})]}),e.jsx("div",{ref:s,className:"tooltip-mounting-point"})]})}function Ct({data:n}){const s=d.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs(ae,{hover:!0,responsive:!0,className:"mb-0 results-plain",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Result with Hit"})]})}),e.jsx("tbody",{children:n.records.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"result-idx text-end text-muted d-none d-sm-table-cell",children:r+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[t.ref&&e.jsx("a",{href:t.ref,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ue}})})," ",t.pid&&e.jsx(Ce,{placement:"auto-start",container:s,delay:{show:250,hide:400},overlay:e.jsx(Me,{id:`ttip-${t.pid}-${r}`,children:t.pid}),children:e.jsx(fe,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:t.hits.fragments.map((i,a)=>i.hit&&!i.hitKind?e.jsx("mark",{children:e.jsx("strong",{children:i.text})},a):e.jsx("span",{children:i.text},a))})]},`${t.pid??t.ref??n.resource.id}-${r}`))})]}),e.jsx("div",{ref:s,className:"tooltip-mounting-point"})]})}function jr({show:n,searchId:s,resourceId:t,result:r,viewMode:i,showDiagnostics:a,onModalClose:c}){const o=Le(),{t:l}=ne(),u=pe(g=>g.locale),{languages:j,resources:L,weblichtLanguages:x}=Rs(),{numberOfResults:N,queryType:S,language:_,languageFilter:m}=Cs(),[A,C]=d.useState(u);d.useEffect(()=>{u&&C(u)},[u]);const b=new Intl.DisplayNames([u,"en"],{type:"language"}),[H,K]=d.useState(a);d.useEffect(()=>K(a),[a]);const[k,R]=d.useState(i);d.useEffect(()=>R(i),[i]);const I=Qe(r.resource),V=r.exception||r.diagnostics?.filter(g=>g.uri!==Se).length>0;function v(){return!r||r.nextRecordPosition===-1||r.numberOfRecords===-1?!1:(r.numberOfRecords===r.records.length,!0)}let M=null,$=!1;if(!x.includes(_)){if(_===be)if(r.resource.languages&&r.resource.languages.length===1)M=r.resource.languages[0];else{const g=[...new Set(r.records.map(F=>F.lang).filter(F=>F!==null))];g.length===1&&(M=g[0])}M||(console.warn("Cannot use WebLicht: unsupported language",{language:_,languageFilter:m}),$=!0)}function y(g){R(g.target.value)}function P(){if(!r)return null;if(k==="annotation-layers"&&r.hasAdvResults){const g=is(L,F=>F.id===r.id);return e.jsx(St,{data:r,resource:g})}return k==="kwic"&&(S!=="lex"||!r.isLexHits)?e.jsx(Rt,{data:r}):k==="lexical-entry"&&r.hasLexResults?e.jsx(Lt,{data:r}):S==="lex"&&r.isLexHits?e.jsx(Nt,{data:r}):e.jsx(Ct,{data:r})}return e.jsxs(te,{show:n,onHide:()=>c(),size:"xl",fullscreen:"lg-down",centered:!0,className:"resource-search-result-modal",children:[e.jsx(te.Header,{closeButton:!0,children:e.jsx(te.Title,{children:B(r.resource.title,A)})}),e.jsxs(te.Body,{className:"resource-info",children:[e.jsxs("dl",{className:"mb-0","aria-label":l("search.results.resourceInfo.infoTableAriaLabel"),children:[e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:We}})," ",l("search.results.resourceInfo.labelInstitution")]}),e.jsx("dd",{className:"mb-0",children:B(r.resource.institution,A)}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:vs}})," ",l("search.results.resourceInfo.labelDescription")]}),B(r.resource.description,A)&&e.jsxs(e.Fragment,{children:[e.jsx("dd",{className:"mb-0",children:B(r.resource.description,A)}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Oe}})," ",l("search.results.resourceInfo.labelLanguages")]})]}),e.jsx("dd",{className:"mb-0",children:r.resource.languages.map(j?g=>os(g,j,{defaultAnyLanguage:l("languageCodeToName.any",{ns:"common"}),defaultUnknownLanguage:l("languageCodeToName.unknown",{ns:"common"})}):g=>g).toSorted().join(", ")}),I&&I.length>1&&e.jsx(Ke,{type:"radio",name:`${r.resource.id}-result-modal-info-languages`,defaultValue:A,onChange:g=>C(g),className:"mt-2 mb-3",children:I.toSorted().map(g=>e.jsxs(ke,{variant:"outline-secondary",size:"sm",id:`${r.resource.id}-result-modal-info-languages-${g}`,value:g,children:[b.of(g)," ",e.jsx("sup",{children:g})]},g))}),e.jsx("dt",{children:l("search.results.resourceInfo.labelPID")}),e.jsx("dd",{children:r.resource.handle})]}),r.resource.landingPage&&e.jsxs("a",{href:r.resource.landingPage,className:"matomo_link",target:"_blank",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:as}})," ",l("search.results.resourceInfo.moreInformation")]}),e.jsx("hr",{}),e.jsxs(se,{className:"row-gap-2",children:[e.jsx(D,{lg:"auto",md:3,sm:6,children:e.jsx(ve,{label:l("search.results.displayOptions.viewModeLabel"),controlId:"results-view-mode",children:e.jsxs(q.Select,{value:k,onChange:y,children:[e.jsx("option",{value:"plain",children:l("search.results.displayOptions.viewModeOptions.plain")}),(S!=="lex"||!r.isLexHits)&&e.jsx("option",{value:"kwic",children:l("search.results.displayOptions.viewModeOptions.kwic")}),S==="fcs"&&e.jsx("option",{value:"annotation-layers",children:l("search.results.displayOptions.viewModeOptions.annotation-layers")}),S==="lex"&&e.jsx("option",{value:"lexical-entry",children:l("search.results.displayOptions.viewModeOptions.lexical-entry")})]})})}),e.jsx(D,{lg:3,md:3,sm:6,className:"align-content-center",children:e.jsx(q.Check,{disabled:!V,checked:H,onChange:()=>K(g=>!g),id:"results-modal-view-warnings-errors",label:l("search.results.displayOptions.optionShowWarningsErrors")})}),e.jsxs(D,{lg:"auto",md:6,sm:6,className:"d-flex flex-grow-1 column-gap-3 align-items-center justify-content-end",children:[e.jsxs(oe,{children:[e.jsxs(oe.Toggle,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:nt}})," ",l("search.results.buttonDownload")]}),e.jsx(oe.Menu,{children:ar.map(({id:g,label:F})=>e.jsx(oe.Item,{href:un(o,s,t,g,_,m),className:"matomo_download",children:e.jsx(G,{i18nKey:"search.results.msgButtonDownloadOption",values:{label:l(`downloadFormats.${g}.name`,{ns:"common",defaultValue:F})}})},g))})]}),e.jsxs(ee,{disabled:$,"aria-disabled":$,href:dn(o,s,t,M,_,m),className:"matomo_link",target:"_blank",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:rt}})," ",l("search.results.buttonSendToWeblicht")]})]})]}),e.jsx("hr",{}),e.jsx("p",{children:e.jsx(G,{i18nKey:"search.results.msgShowingXresults",values:{count:r.records.length,context:v()?"hasmore":null,total:r.numberOfRecords}})}),P()]}),H&&V&&e.jsxs(te.Body,{className:"border-top",children:[r.exception&&e.jsxs(de,{variant:"danger","aria-label":l("search.results.diagnostics.alertAriaLabel"),children:[e.jsxs(de.Heading,{style:{fontSize:"1rem"},children:[e.jsx("span",{className:"text-uppercase",children:l("search.results.diagnostics.titleException")})," ",e.jsx("span",{"aria-label":l("search.results.diagnostics.msgAriaLabel"),children:r.exception.message})]}),r.exception.cause&&e.jsx("p",{className:"mb-0 small",children:l("search.results.diagnostics.msgCause",{cause:r.exception.cause})}),r.exception.klass&&e.jsx("p",{className:"mb-0 small",children:e.jsx(G,{i18nKey:"search.results.diagnostics.msgCausedBy",values:{class:r.exception.klass}})})]}),r.diagnostics.filter(g=>g.uri!==Se).map(g=>e.jsxs(de,{variant:"warning",children:[e.jsx(de.Heading,{style:{fontSize:"1rem"},children:g.message}),g.diagnostic&&e.jsx("p",{className:"mb-0 small",children:l("search.results.diagnostics.msgDiagnosticDetails",{details:g.diagnostic})}),e.jsx("p",{className:"mb-0 small",children:e.jsx(G,{i18nKey:"search.results.diagnostics.msgDiagnosticType",values:{uri:g.uri}})})]},`${g.uri}-${g.message}-${g.diagnostic}`))]}),v()&&e.jsx(te.Footer,{className:"justify-content-center border-top py-2",children:e.jsx(pr,{searchId:s,resourceId:t,numberOfResults:N})})]})}function br({searchId:n,resourceId:s,resultInfo:t,viewMode:r,showResourceDetails:i,showDiagnostics:a}){const c=Le(),{t:o}=ne(),l=pe(g=>g.locale),{languages:u,resources:j}=Rs(),{queryType:L}=Cs(),[x,N]=d.useState(l);d.useEffect(()=>{l&&N(l)},[l]);const S=new Intl.DisplayNames([l,"en"],{type:"language"}),_=d.useId(),[m,A]=d.useState(!0),[C,b]=d.useState(!1),H=t.inProgress,K=t.numberOfRecordsLoaded>0,k=t.exception||t.diagnostics?.filter(g=>g.uri!==Se).length>0,{data:R,isLoading:I,isError:V}=Re({queryKey:["search-result-details",n,s],queryFn:cn.bind(null,c,n,s),enabled:!H}),v=R?Qe(R.resource):[];if(H||!K&&(a&&!k||!a)||!R)return null;function M(){b(!0)}function $(){b(!1)}function y(){return R?R.numberOfRecords===-1?R.records.length:R.numberOfRecords===R.records.length&&R.nextRecordPosition===-1?`${R.records.length} / ${R.numberOfRecords}?`:`${R.records.length} / ${R.numberOfRecords}`:null}function P(){if(!R)return null;if(r==="annotation-layers"&&R.hasAdvResults){const g=is(j,F=>F.id===R.id);return e.jsx(St,{data:R,resource:g})}return r==="kwic"&&(L!=="lex"||!R.isLexHits)?e.jsx(Rt,{data:R}):r==="lexical-entry"&&R.hasLexResults?e.jsx(Lt,{data:R}):L==="lex"&&R.isLexHits?e.jsx(Nt,{data:R}):e.jsx(Ct,{data:R})}return e.jsxs(e.Fragment,{children:[e.jsxs(E,{className:"my-1 resource-search-result",role:"group","aria-label":o("search.results.resultResourceAriaLabel",{title:R.resource.title}),children:[e.jsxs(E.Header,{className:"d-flex accordion",children:[e.jsxs("button",{type:"button",onClick:()=>A(g=>!g),"aria-controls":_,"aria-expanded":m,className:`me-3 w-auto flex-grow-1 d-block text-start collapse-toggle-btn ${m?"":"collapsed"}`,children:[e.jsx(fe,{bg:"",className:"text-bg-light border me-2 user-select-text","aria-label":o("search.results.resultCountAriaLabel"),children:y()}),e.jsx("span",{"aria-label":o("search.results.resultResourceTitleAriaLabel"),className:"user-select-text",children:B(R.resource.title,x)}),e.jsx("small",{className:"text-muted user-select-text","aria-label":o("search.results.resultResourceInstitutionAriaLabel"),children:B(R.resource.institution,x)})]}),e.jsx("div",{className:"d-inline-block ms-auto",children:e.jsxs(ee,{size:"sm",onClick:M,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:at}})," View"]})})]}),e.jsx(Ys,{in:m,children:e.jsxs("div",{id:_,children:[i&&e.jsxs(E.Body,{className:"border-bottom resource-info",children:[e.jsxs("dl",{className:"mb-0","aria-label":o("search.results.resourceInfo.infoTableAriaLabel"),children:[e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:We}})," ",o("search.results.resourceInfo.labelInstitution")]}),e.jsx("dd",{className:"mb-0",children:B(R.resource.institution,x)}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:vs}})," ",o("search.results.resourceInfo.labelDescription")]}),B(R.resource.description,x)&&e.jsxs(e.Fragment,{children:[e.jsx("dd",{className:"mb-0",children:B(R.resource.description,x)}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Oe}})," ",o("search.results.resourceInfo.labelLanguages")]})]}),e.jsx("dd",{className:"mb-0",children:R.resource.languages.map(u?g=>os(g,u,{defaultAnyLanguage:o("languageCodeToName.any",{ns:"common"}),defaultUnknownLanguage:o("languageCodeToName.unknown",{ns:"common"})}):g=>g).toSorted().join(", ")})]}),v&&v.length>1&&e.jsx(Ke,{type:"radio",name:`${R.resource.id}-result-info-languages`,defaultValue:x,onChange:g=>N(g),className:"mt-2",children:v.toSorted().map(g=>e.jsxs(ke,{variant:"outline-secondary",size:"sm",id:`${R.resource.id}-result-info-languages-${g}`,value:g,children:[S.of(g)," ",e.jsx("sup",{children:g})]},g))})]}),K&&e.jsx(E.Body,{children:P()}),a&&k&&e.jsxs(E.Body,{className:K?"border-top":"",children:[R.exception&&e.jsxs(de,{variant:"danger","aria-label":o("search.results.diagnostics.alertAriaLabel"),children:[e.jsxs(de.Heading,{style:{fontSize:"1rem"},children:[e.jsx("span",{className:"text-uppercase",children:o("search.results.diagnostics.titleException")})," ",e.jsx("span",{"aria-label":o("search.results.diagnostics.msgAriaLabel"),children:R.exception.message})]}),R.exception.cause&&e.jsx("p",{className:"mb-0 small",children:o("search.results.diagnostics.msgCause",{cause:R.exception.cause})}),R.exception.klass&&e.jsx("p",{className:"mb-0 small",children:e.jsx(G,{i18nKey:"search.results.diagnostics.msgCausedBy",values:{class:R.exception.klass}})})]}),R.diagnostics.filter(g=>g.uri!==Se).map(g=>e.jsxs(de,{variant:"warning",children:[e.jsx(de.Heading,{style:{fontSize:"1rem"},children:g.message}),g.diagnostic&&e.jsx("p",{className:"mb-0 small",children:o("search.results.diagnostics.msgDiagnosticDetails",{details:g.diagnostic})}),e.jsx("p",{className:"mb-0 small",children:e.jsx(G,{i18nKey:"search.results.diagnostics.msgDiagnosticType",values:{uri:g.uri}})})]},`${g.uri}-${g.message}-${g.diagnostic}`))]})]})})]}),e.jsx(jr,{show:C,searchId:n,resourceId:s,result:R,viewMode:r,showDiagnostics:a,onModalClose:$})]})}const yr="plain",wr="lexical-entry",vr="plain",Sr="default",Rr={default:()=>()=>0,"title-up":n=>(s,t)=>{const r=re.getState().locale,i=B(n.get(s.id)?.title??null,r)??"",a=B(n.get(t.id)?.title??null,r)??"";return i.localeCompare(a)},"title-down":n=>(s,t)=>{const r=re.getState().locale,i=B(n.get(s.id)?.title??null,r)??"",a=B(n.get(t.id)?.title??null,r)??"";return-i.localeCompare(a)},"result-count-total-up":()=>(n,s)=>{const t=n.numberOfRecords!==-1?n.numberOfRecords:n.numberOfRecordsLoaded,r=s.numberOfRecords!==-1?s.numberOfRecords:s.numberOfRecordsLoaded;return t-r},"result-count-total-down":()=>(n,s)=>{const t=n.numberOfRecords!==-1?n.numberOfRecords:n.numberOfRecordsLoaded;return(s.numberOfRecords!==-1?s.numberOfRecords:s.numberOfRecordsLoaded)-t}},Bs=1500;function Lr({searchId:n,pollDelay:s=Bs}){const{t}=ne(),r=Le(),{resources:i}=Rs(),{query:a,queryType:c,resourceIDs:o}=Cs(),[l,u]=d.useState(c==="lex"?wr:c==="fcs"?vr:yr),[j,L]=d.useState(Sr),[x,N]=d.useState(""),[S,_]=d.useState(!1),[m,A]=d.useState(!1),C=d.useMemo(()=>{const h=new Map;return i?.forEach(T=>{h.set(T.id,T)}),Rr[j](h)},[j,i]);s??=Bs;const{data:b}=Re({queryKey:["search-results",n],queryFn:on.bind(null,r,n??""),enabled:!!n,refetchInterval(h){return h.state.data&&h.state.data.inProgress>0?s:!1}}),H=d.useMemo(()=>b?.results.toSorted(C)||[],[b,C]),K=c==="lex"&&b?.results.every(h=>h.numberOfRecords<=0||h.isLexHits===!0),k=o.length,R=b?.inProgress??k,I=d.useMemo(()=>b?.results.filter(h=>(h.numberOfRecords!==-1?h.numberOfRecords:h.numberOfRecordsLoaded)>0).length??0,[b]),V=d.useMemo(()=>b?.results.filter(h=>!h.inProgress&&(h.numberOfRecords!==-1?h.numberOfRecords:h.numberOfRecordsLoaded)>0&&h.diagnostics.filter(T=>T.uri!==Se).length>0).length??0,[b]),v=d.useMemo(()=>b?.results.filter(h=>!h.inProgress&&(h.numberOfRecords!==-1?h.numberOfRecords:h.numberOfRecordsLoaded)<=0&&h.diagnostics.filter(T=>T.uri!==Se).length===0&&h.exception===null).length??0,[b]),M=d.useMemo(()=>b?.results.filter(h=>!h.inProgress&&(h.numberOfRecords!==-1?h.numberOfRecords:h.numberOfRecordsLoaded)<=0&&(h.diagnostics.filter(T=>T.uri!==Se).length>0||h.exception!==null)).length??0,[b]),$=d.useMemo(()=>b?.results.filter(h=>!h.inProgress&&h.numberOfRecords<=0&&h.exception!==null).length??0,[b]),y=d.useMemo(()=>b?.results.filter(h=>!h.inProgress&&(h.numberOfRecords!==-1?h.numberOfRecords:h.numberOfRecordsLoaded)<=0&&h.diagnostics.filter(T=>T.uri!==Se).length>0&&h.exception===null).length??0,[b]),P=d.useMemo(()=>b?.results.map(h=>h.numberOfRecords!==-1?h.numberOfRecords:h.numberOfRecordsLoaded).reduce((h,T)=>h+T,0)??0,[b]),g=d.useMemo(()=>b?.results.map(h=>h.numberOfRecordsLoaded).reduce((h,T)=>h+T,0)??0,[b]);{const[h,T]=d.useState(!1);d.useEffect(()=>{b&&R===0&&(h||(T(!0),dt(a,c,g)))},[b,R,a,c,n,h,g])}function F(h){u(h.target.value)}function p(h){L(h.target.value)}return e.jsxs("div",{id:"search-results",className:"mt-2 mb-4",children:[e.jsx(Ce,{placement:"auto",overlay:e.jsxs(us,{id:"search-progress-information-popover",children:[e.jsx(us.Header,{children:t("search.results.progressPopover.title")}),e.jsxs(us.Body,{style:{textIndent:"2rem hanging"},children:[e.jsx("div",{children:e.jsx(G,{i18nKey:"search.results.progressPopover.numResourcesRequested",count:k})}),R>0&&e.jsx("div",{children:e.jsx(G,{i18nKey:"search.results.progressPopover.numResourcesRequestedPending",count:R})}),e.jsx("hr",{className:"mt-2 mb-1"}),e.jsx("div",{children:e.jsx(G,{i18nKey:"search.results.progressPopover.numResourcesWithoutResults",count:v+M})}),e.jsx("div",{children:e.jsx(G,{i18nKey:"search.results.progressPopover.numResourcesWithoutResultsOK",count:v})}),y>0&&e.jsx("div",{children:e.jsx(G,{i18nKey:"search.results.progressPopover.numResourcesWithoutResultsWarnings",count:y})}),$>0&&e.jsx("div",{children:e.jsx(G,{i18nKey:"search.results.progressPopover.numResourcesWithoutResultsErrors",count:$})}),e.jsx("hr",{className:"mt-2 mb-1"}),e.jsx("div",{children:e.jsx(G,{i18nKey:"search.results.progressPopover.numResourcesWithResults",count:I})}),V>0&&e.jsx("div",{children:e.jsx(G,{i18nKey:"search.results.progressPopover.numResourcesWithResultsWarnings",count:V})}),e.jsx("hr",{className:"mt-2 mb-0"}),e.jsx("hr",{className:"mt-1 mb-1"}),e.jsx("div",{children:e.jsx(G,{i18nKey:"search.results.progressPopover.numResourcesWithResultsTotal",count:g,values:{available:P}})})]})]}),children:e.jsxs(es,{className:"mb-3",children:[e.jsx(es,{variant:"success",now:I,max:k,label:e.jsx("span",{children:t("search.results.progressBar.numWithResults",{count:I})}),"aria-label":t("search.results.progressBar.numWithResultsAriaLabel")}),e.jsx(es,{variant:"secondary",now:v+M,max:k,label:e.jsx("span",{children:t("search.results.progressBar.numWithResults",{count:v+M})}),"aria-label":t("search.results.progressBar.numWithoutResultsAriaLabel")}),e.jsx(es,{striped:!0,animated:!0,now:R,max:k,label:e.jsx("span",{children:t("search.results.progressBar.numResultsPending",{count:R})}),"aria-label":t("search.results.progressBar.numResultsPendingAriaLabel")})]})}),e.jsx(E,{className:"mb-2",role:"group","aria-label":t("search.results.displayOptions.cardAriaLabel"),children:e.jsx(E.Body,{children:e.jsxs(se,{className:"row-gap-2",children:[e.jsx(D,{lg:"auto",md:6,sm:6,children:e.jsx(ve,{label:t("search.results.displayOptions.viewModeLabel"),controlId:"results-view-mode",children:e.jsxs(q.Select,{value:l,onChange:F,children:[e.jsx("option",{value:"plain",children:t("search.results.displayOptions.viewModeOptions.plain")}),(c!=="lex"||!K)&&e.jsx("option",{value:"kwic",children:t("search.results.displayOptions.viewModeOptions.kwic")}),c==="fcs"&&e.jsx("option",{value:"annotation-layers",children:t("search.results.displayOptions.viewModeOptions.annotation-layers")}),c==="lex"&&e.jsx("option",{value:"lexical-entry",children:t("search.results.displayOptions.viewModeOptions.lexical-entry")})]})})}),e.jsx(D,{lg:"auto",md:6,sm:6,children:e.jsx(ve,{label:t("search.results.displayOptions.sortingLabel"),controlId:"results-sorting",children:e.jsxs(q.Select,{value:j,onChange:p,children:[e.jsx("option",{value:"default",children:t("search.results.displayOptions.sortingOptions.default")}),e.jsx("option",{value:"title-up",children:t("search.results.displayOptions.sortingOptions.title-up")}),e.jsx("option",{value:"title-down",children:t("search.results.displayOptions.sortingOptions.title-down")}),e.jsx("option",{value:"result-count-total-up",children:t("search.results.displayOptions.sortingOptions.result-count-total-up")}),e.jsx("option",{value:"result-count-total-down",children:t("search.results.displayOptions.sortingOptions.result-count-total-down")})]})})}),e.jsx(D,{lg:"auto",md:12,sm:6,className:"flex-fill order-xl-4",children:e.jsx(ve,{label:t("search.results.displayOptions.resultFilterQueryLabel"),controlId:"result-filter",children:e.jsx(wt,{disabled:j!=="default"||!0,value:x,onChange:h=>N(h)})})}),e.jsxs(D,{lg:"auto",md:12,sm:12,className:"align-content-center order-xl-3",children:[e.jsx(q.Check,{checked:S,onChange:()=>_(h=>!h),id:"results-view-resource-details",label:t("search.results.displayOptions.optionShowResultDetails")}),e.jsx(q.Check,{checked:m,onChange:()=>A(h=>!h),id:"results-view-warnings-errors",label:t("search.results.displayOptions.optionShowWarningsErrors")})]})]})})}),n&&b&&H.map(h=>e.jsx(br,{searchId:n,resourceId:h.id,resultInfo:h,viewMode:l,showResourceDetails:S,showDiagnostics:m},`${n}-${h.id}`))]})}const Nr=""+new URL("assets/logo-fcs-dark.png",import.meta.url).href,Vs=""+new URL("assets/logo-fcs.png",import.meta.url).href;function Cr(){const n=Le(),{t:s}=ne(),[t,r]=Ae(),[i,a]=d.useState([]),[c,o]=d.useState({}),[l,u]=d.useState([]),[j,L]=d.useState(null),[x,N]=d.useState(!1),[S,_]=d.useState(null),[m,A]=d.useState([]),C=J.getState().appTitleHead,b={consortia:t.get(ye)},{data:H,isLoading:K,isError:k}=Re({queryKey:["init"],queryFn:sn.bind(null,n,b)});d.useEffect(()=>{if(!H)return;const y=Is(H.resources);o(H.languages),u(H.weblichtLanguages),a(y),L(we(y))},[H]),d.useEffect(()=>{if(!i||i.length===0)return;const y=t.get("x-aggregation-context");if(y){try{const P=JSON.parse(y),{selected:g,unavailable:F}=Gn(i,P);g.length>0&&(L(g),A(p=>[...p,{title:s("search.toasts.resourceSelection.title"),body:e.jsxs(e.Fragment,{children:[s("search.toasts.resourceSelection.msgPreselectedResources",{count:g.length}),e.jsx("br",{}),e.jsx("ul",{className:"ps-3",children:g.map(h=>e.jsx("li",{style:{wordBreak:"break-all",fontSize:"0.7rem"},children:h}))})]}),variant:"success"}])),F.length>0&&A(p=>[...p,{title:s("search.toasts.resourceSelection.title"),body:e.jsxs(e.Fragment,{children:[s("search.toasts.resourceSelection.msgUnableToSelectResources",{count:F.length}),e.jsx("br",{}),e.jsx("ul",{className:"ps-3",children:F.map(h=>e.jsx("li",{style:{wordBreak:"break-all",fontSize:"0.7rem"},children:h}))})]}),variant:"warning"}])}catch(P){console.error('Error trying to parse "x-aggregation-context" search parameter!',{aggregationContext:y},P),P instanceof Error&&A(g=>[...g,{title:s("search.toasts.resourceSelection.title"),body:e.jsxs(e.Fragment,{children:[s("search.toasts.resourceSelection.msgErrorUnableToSelectResources",{error:P.name}),e.jsx("br",{}),e.jsx("small",{children:P.message})]}),variant:"error"}])}t.delete("x-aggregation-context"),r(t)}},[i,t,r,s]);const R=K||k,{mutate:I,data:V,isPending:v}=Qs({mutationKey:["search"],mutationFn:({query:y,queryType:P,language:g,numberOfResults:F,resourceIDs:p})=>rn(n,{query:y,queryType:P,language:g,numberOfResults:F.toString(),resourceIds:p})});function M(y){L(y.resourceIDs),_(y),N(!0),dt(y.query,y.queryType),I(y)}function $(y){A(P=>[...P,y])}return e.jsxs(e.Fragment,{children:[e.jsx($e,{children:e.jsx("title",{children:C})}),e.jsxs(ie,{id:"search",children:[e.jsx("div",{"aria-live":"polite","aria-atomic":"true",className:"bg-dark position-relative",children:e.jsx(Qt,{position:"top-end",className:"mt-2",style:{zIndex:100},children:m.map((y,P)=>e.jsxs(ds,{bg:y.variant,onClose:()=>A(g=>g.filter(F=>F!==y)),delay:y.delay??5e3,autohide:!0,children:[e.jsx(ds.Header,{closeButton:!0,children:e.jsx("strong",{className:"me-auto",children:y.title})}),e.jsx(ds.Body,{children:y.body})]},P))})}),!x&&e.jsx(se,{children:e.jsx(D,{className:"text-center",children:e.jsxs("picture",{children:[e.jsx("source",{srcSet:Vs,media:"(prefers-color-scheme: light)"}),e.jsx("source",{srcSet:Nr,media:"(prefers-color-scheme: dark)"}),e.jsx("img",{src:Vs,className:"logo",alt:"FCS logo"})]})})}),e.jsx(se,{className:"mt-3",children:e.jsx(D,{children:e.jsx(gr,{resources:i,languages:c,availableResources:null,selectedResources:j,onSearch:M,onShowToast:$,hasSearch:x,disabled:R})})}),!x&&e.jsx(se,{className:"mt-3",children:e.jsxs(D,{children:[e.jsx("p",{children:e.jsx(G,{i18nKey:"search.intro.textGeneral"})}),e.jsx("p",{children:e.jsx(G,{i18nKey:"search.intro.textLearnMore",components:[e.jsxs("a",{href:s("search.intro.url"),children:["page ",e.jsx("em",{children:"Content Search"})," at CLARIN.eu"]})]})})]})}),x&&v&&e.jsx(se,{children:e.jsx(D,{className:"text-center my-5",children:e.jsx(Xs,{animation:"border"})})}),S&&V&&e.jsx(Fn,{resources:i,languages:c,weblichtLanguages:l,children:e.jsx(Vn,{...S,children:e.jsx(Lr,{searchId:V})})})]})]})}function Ir(){const n=Ks(),[s]=Pe();return d.useCallback((r,i,a)=>{const c=Ot(r,i);n({pathname:c,search:s},a)},[n,s])}function Tr(){const n=d.useContext(Ut),s=ws(),t=n.matches.map(i=>i.route),r=Dt(t,s);return r!==null&&r.length>0?r[0]:null}const Ve="resource",Er="institution",_r="url";function It(n){const s=new URL(n).hostname,t=s.split(".");if(t.length<=1)return s;const r=t.at(-1);if(t.length===2)return r;const i=t.at(-2);return r.length===2&&i.length===2||r.length===3&&i.length===2?`${i}.${r}`:r}function Ar(n){const s=It(n),t=new URL(n),o=`${t.hostname.slice(0,-(s.length+1)).split(".").slice(-1)}.${s}`;return t.port?`${o}:${t.port}`:o}function qs(n){const s=new URL(n),r=s.hostname.split(".").toReversed(),i=n.substring(n.indexOf("/",s.protocol.length+2+s.hostname.length));return[...r,s.port,i]}function hs(n,s){const t=qs(n),r=qs(s),i=Math.min(t.length,r.length);for(let a=0;a<i;a++){const c=t[a],o=r[a],l=c.localeCompare(o);if(l!==0)return l}return 0}function kr(){const n=Le(),{t:s}=ne(),t=pe(f=>f.locale),[,r]=Pe(),[i]=Ae(),[a,c]=d.useState([]),[o,l]=d.useState({}),[u,j]=d.useState(Er),[L,x]=d.useState(_r),[N,S]=d.useState(!1),_={consortia:i.get(ye)},{data:m,isPending:A,isError:C,error:b}=Re({queryKey:["resources"],queryFn:et.bind(null,n,_)}),{data:H,isPending:K,isError:k,error:R}=Re({queryKey:["languages"],queryFn:tn.bind(null,n,_)});d.useEffect(()=>{if(!m)return;const f=Is(m);c(f)},[m]),d.useEffect(()=>{H&&l(H)},[H]);const I=mt(a),V=I.reduce((f,U)=>{const z=U.endpoint.url;return f.has(z)||f.set(z,[]),f.get(z).push(U),f},new Map),v=Array.from(V.keys()).reduce((f,U)=>{const z=Ar(U);return f.has(z)||f.set(z,[]),f.get(z).push(U),f},new Map),M=Array.from(V.keys()).reduce((f,U)=>{const z=It(U);return f.has(z)||f.set(z,[]),f.get(z).push(U),f},new Map),$=I.reduce((f,U)=>{const z=B(U.institution,t)??U.endpointInstitution.name;return f.has(z)||f.set(z,[]),f.get(z).push(U),f},new Map),y=I.reduce((f,U)=>{const z=U.endpointInstitution.name;return f.has(z)||f.set(z,[]),f.get(z).push(U),f},new Map),P=I.reduce((f,U)=>{const z=U.searchCapabilitiesResolved;for(const le of z)f.has(le)||f.set(le,[]),f.get(le).push(U);return f},new Map),g=I.reduce((f,U)=>{const z=U.availabilityRestriction;return f.has(z)||f.set(z,[]),f.get(z).push(U),f},new Map),F=a&&a.length>0,p=o&&Object.getOwnPropertyNames(o).length>0,h=F&&p,T=Array.from(g.keys()).filter(f=>f!=="NONE").length>0;function Q(){return L==="tld"?e.jsxs(ae,{hover:!0,responsive:!0,className:"mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:s("statistics.fcs.thEndpointDomain")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thCountURLsForDomain")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thCountResourcesFromEndpoint")})]})}),e.jsx("tbody",{children:Array.from(M.entries()).toSorted(([f],[U])=>hs(`http://${f}`,`http://${U}`)).map(([f,U])=>{const z=U.map(le=>V.get(le)).flat();return e.jsxs("tr",{children:[e.jsx("td",{children:f}),e.jsx("td",{children:U.length}),e.jsx("td",{children:z.length})]},f)})})]}):L==="domain"?e.jsxs(ae,{hover:!0,responsive:!0,className:"mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:s("statistics.fcs.thEndpointDomain")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thCountURLsForDomain")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thCountResourcesFromEndpoint")})]})}),e.jsx("tbody",{children:Array.from(v.entries()).toSorted(([f],[U])=>hs(`http://${f}`,`http://${U}`)).map(([f,U])=>{const z=U.map(le=>V.get(le)).flat();return e.jsxs("tr",{children:[e.jsx("td",{children:f}),e.jsx("td",{children:U.length}),e.jsx("td",{children:z.length})]},f)})})]}):e.jsxs(ae,{hover:!0,responsive:!0,className:"mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:s("statistics.fcs.thEndpointUrl")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thCountResourcesFromEndpoint")})]})}),e.jsx("tbody",{children:Array.from(V.entries()).toSorted(([f],[U])=>hs(f,U)).map(([f,U])=>e.jsxs("tr",{children:[e.jsx("td",{children:f}),e.jsx("td",{children:U.length})]},f))})]})}return e.jsxs(ie,{className:"d-grid gap-2 mt-3",children:[(A||C)&&e.jsx(se,{children:e.jsxs(D,{children:[A?s("statistics.loading"):null,e.jsx("br",{}),C?b.message:null]})}),(K||k)&&e.jsx(se,{children:e.jsxs(D,{children:[K?s("statistics.loading"):null,e.jsx("br",{}),k?R.message:null]})}),e.jsxs(E,{className:"p-3",children:[e.jsx("h3",{className:"h4 pb-1 mb-3 border-bottom",children:s("statistics.fcs.title")}),e.jsx("h4",{className:"h5 pb-1 mb-3 border-bottom",id:"overview",children:s("statistics.fcs.titleOverall")}),e.jsxs(ae,{hover:!0,responsive:!0,children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:s("statistics.fcs.thStatsKey")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thStatsValue")})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{scope:"row",children:s("statistics.fcs.tdLabelResourceCount")}),e.jsx("td",{children:I.length})]}),e.jsxs("tr",{children:[e.jsx("td",{scope:"row",children:s("statistics.fcs.tdLabelEndpointCount")}),e.jsx("td",{children:V.size})]}),e.jsxs("tr",{children:[e.jsx("td",{scope:"row",children:s("statistics.fcs.tdLabelInstitutionCount")}),e.jsx("td",{children:y.size})]})]})]}),e.jsx("h4",{className:"h5 pb-1 mb-3 border-bottom",id:"institutions",children:s("statistics.fcs.titleInstitutions")}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.fcs.cardHeaderInstitutionStats")}),e.jsx(E.Body,{children:e.jsxs("dl",{className:"mb-0",children:[e.jsx("dt",{children:s("statistics.fcs.tdLabelInstitutionCount")}),e.jsx("dd",{children:$.size}),e.jsx("dt",{children:s("statistics.fcs.tdLabelInstitutionHosterCount")}),e.jsx("dd",{children:y.size})]})})]}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.fcs.cardHeaderInstitutions")}),e.jsxs(E.Body,{children:[e.jsx(q,{onSubmit:f=>f.preventDefault(),children:e.jsxs(D,{className:"filter-checkboxes",lg:12,md:12,children:[e.jsx(q.Text,{className:"me-2",children:s("statistics.fcs.labelForResourceInstitutionVariants")}),["institution","hoster"].map(f=>e.jsx(q.Check,{type:"radio",name:"resourceInstitutionVariant",value:f,id:`resourceInstitutionVariant-${f}`,checked:u===f,onChange:()=>j(f),label:s(`statistics.fcs.resourceInstitutionVariant${f}`)},f))]})}),e.jsxs(ae,{hover:!0,responsive:!0,className:"mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:s("statistics.fcs.thInstitutionName")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thCountResourcesFromInstitution")})]})}),e.jsx("tbody",{children:Array.from((u==="hoster"?y:$).entries()).map(([f,U])=>e.jsxs("tr",{children:[e.jsx("td",{children:f}),e.jsx("td",{children:U.length})]},f))})]})]})]}),e.jsx("h4",{className:"h5 pb-1 mt-4 mb-3 border-bottom",id:"endpoints",children:s("statistics.fcs.titleEndpoints")}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.fcs.cardHeaderEndpointStats")}),e.jsx(E.Body,{children:e.jsxs("dl",{className:"mb-0",children:[e.jsx("dt",{children:s("statistics.fcs.tdLabelEndpointCount")}),e.jsx("dd",{children:V.size}),e.jsx("dt",{children:s("statistics.fcs.tdLabelEndpointDomainCount")}),e.jsx("dd",{children:v.size})]})})]}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.fcs.cardHeaderEndpoints")}),e.jsxs(E.Body,{children:[e.jsx(q,{onSubmit:f=>f.preventDefault(),children:e.jsxs(D,{className:"filter-checkboxes",lg:12,md:12,children:[e.jsx(q.Text,{className:"me-2",children:s("statistics.fcs.labelForResourceInstitutionVariants")}),["url","domain","tld"].map(f=>e.jsx(q.Check,{type:"radio",name:"endpointURLVariant",value:f,id:`endpointURLVariant-${f}`,checked:L===f,onChange:()=>x(f),label:s(`statistics.fcs.endpointURLVariant${f}`)},f))]})}),Q()]})]}),e.jsx("h4",{className:"h5 pb-1 mb-3 border-bottom",id:"resources",children:s("statistics.fcs.titleResources")}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.fcs.cardHeaderResourceStats")}),e.jsx(E.Body,{children:e.jsxs("dl",{className:"mb-0",children:[e.jsx("dt",{children:s("statistics.fcs.tdLabelResourceCount")}),e.jsx("dd",{children:I.length}),e.jsx("dt",{children:s("statistics.fcs.tdLabelRootResourceCount")}),e.jsx("dd",{children:a.length}),e.jsx("dt",{children:s("statistics.fcs.tdLabelResourceWithAvailabilityRestrictionCount")}),e.jsx("dd",{children:Array.from(g.entries()).filter(([f])=>f!=="NONE").map(([,f])=>f).flat().length})]})}),h&&e.jsx(E.Footer,{className:"d-flex gap-2",children:e.jsx(ee,{variant:"primary",onClick:()=>S(!0),children:s("statistics.fcs.btnOpenResourceLanguageSelectionModal")})})]}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.fcs.cardHeaderSearchCapabilities")}),e.jsx(E.Body,{children:e.jsxs(ae,{hover:!0,responsive:!0,className:"mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:s("statistics.fcs.thSearchCapability")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thCountResourcesForSearchCapability")})]})}),e.jsx("tbody",{children:Array.from(P.entries()).map(([f,U])=>e.jsxs("tr",{children:[e.jsx("td",{children:f}),e.jsx("td",{children:U.length})]},f))})]})})]}),T&&e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.fcs.cardHeaderResourcesWithAvailabilityRestrictions")}),e.jsx(E.Body,{children:e.jsxs(ae,{hover:!0,responsive:!0,className:"mt-2",children:[e.jsx("caption",{children:s("statistics.fcs.tblAvailabilityRestrictionCaption")}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:s("statistics.fcs.thAvailabilityRestriction")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thResourceTitle")})]})}),e.jsx("tbody",{children:Array.from(g.entries()).filter(([f])=>f!=="NONE").map(([f,U])=>U.map(z=>e.jsxs("tr",{children:[e.jsx("td",{children:f}),e.jsxs("td",{children:[B(z.title,t)," ",e.jsx(Te,{to:{pathname:"/stats/resources",search:r({[Ve]:z.id})},children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ee},className:"align-baseline ms-2"})})]})]},z.id)))})]})})]})]}),e.jsx(yt,{languages:o,resources:a,showResourceCounts:!0,showLanguageFilterOptions:!1,show:N,onModalClose:()=>S(!1)})]})}function Mr({validatorUrl:n}){const s=Le(),{t}=ne(),r=pe(p=>p.locale),[i,a]=d.useState(r),c=new Intl.DisplayNames([r,"en"],{type:"language"}),[,o]=Pe(),[l,u]=Ae(),[j,L]=d.useState([]),[x,N]=d.useState(""),[S,_]=d.useState(l.get(Ve)),m=S?is(j,p=>p.id===S):void 0,A={consortia:l.get(ye)},{data:C,isPending:b,isError:H,error:K}=Re({queryKey:["resources"],queryFn:et.bind(null,s,A)});d.useEffect(()=>{if(!C)return;const p=Is(C);L(p)},[C]),d.useEffect(()=>{const p=l.get(Ve);p&&p!==S&&_(p)},[l,S]);const R=j.map(p=>Qe(p)).flat().reduce((p,h)=>p.set(h,(p.get(h)??0)+1),new Map),I=j.toSorted(xt["title-up"]),{resources:V,matches:v}=vt(x,I,i,["title","institution"]);function M(p){if(!p)return;const h=p;_(h),l.set(Ve,h),u(l)}function $(p,h,T=0){const Q=h?.get(p.id)??new Map,f=e.jsx(oe.Item,{eventKey:p.id,style:{paddingInlineStart:`${1+T*1}em`},children:e.jsx(he.Highlight,{text:B(p.title,i)??"",ranges:Q.get("title")??null})},p.id);return p.subResources&&p.subResources.length>0?e.jsxs(d.Fragment,{children:[f,p.subResources.map(U=>$(U,v,T+1))]},p.id):f}function y(p,h,T="–"){if(h===null)return null;const Q=er(h,r);return e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:t(`statistics.resources.cardHeader${p[0].toUpperCase()}${p.slice(1)}`)}),typeof h=="string"?e.jsx(E.Body,{children:h||T}):e.jsx(qe,{className:"list-group-flush",children:Object.entries(h).map(([f,U])=>e.jsxs(qe.Item,{children:[e.jsxs(fe,{bg:Q===f?"primary":"secondary",className:"me-2",children:[c.of(f)," ",e.jsx("sup",{children:f})]})," ",U||T]},f))})]})}function P(p){if(!j||!p)return null;const h=p.rootResourceId===null?p:is(j,Q=>Q.id===p.rootResourceId);if(!h)return null;function T(Q){return e.jsxs("li",{children:[Q.id===p.id?e.jsx("strong",{children:Q.handle}):e.jsxs(e.Fragment,{children:[Q.handle,e.jsx(Te,{to:{search:o({[Ve]:Q.id})},onClick:f=>{f.preventDefault(),M(Q.id)},children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ee},className:"align-baseline ms-2 me-1"})})]})," ","– ",B(Q.title,r),Q.subResources.length>0&&e.jsx("ul",{children:Q.subResources.map(f=>T(f))})]},Q.id)}return e.jsx("ul",{children:T(h)})}const g=m&&(m.availableDataViews?.find(p=>p.mimeType==="application/x-clarin-fcs-lex+xml")||m.availableLexFields&&m.availableLexFields.length>0),F=m&&(m.availableDataViews?.find(p=>p.mimeType==="application/x-clarin-fcs-adv+xml")||m.availableLayers&&m.availableLayers.length>0);return e.jsxs(ie,{className:"d-grid gap-2 mt-3",children:[(b||H)&&e.jsx(se,{children:e.jsxs(D,{children:[b?t("statistics.loading"):null,e.jsx("br",{}),H?K.message:null]})}),e.jsx(q,{onSubmit:p=>p.preventDefault(),children:e.jsxs(oe,{onSelect:M,children:[e.jsxs(oe.Toggle,{className:"resource-selector",variant:"outline-dark",children:[t("statistics.resources.dropdownLabel",{count:j.length})," "]}),e.jsxs(oe.Menu,{children:[e.jsxs(oe.ItemText,{children:[e.jsx(q.Control,{value:x,onChange:p=>N(p.target.value)}),R.size>1&&e.jsxs(q.Group,{as:se,controlId:"resource-info-language",className:"mt-2",children:[e.jsx(q.Label,{column:!0,sm:"auto",style:{fontSize:"0.875rem"},children:t("search.resourcesModal.labelChangeResourceInfoLanguage")}),e.jsx(D,{sm:"auto",children:e.jsx(Ke,{type:"radio",name:"resource-info-languages",defaultValue:i,onChange:p=>a(p),children:Array.from(R.entries()).toSorted().map(([p,h])=>e.jsxs(ke,{size:"sm",id:`resource-info-languages-${p}`,value:p,variant:"secondary",title:t("search.resourcesModal.buttonChangeResourceInfoLanguageTitle",{count:h,language:p,languageName:c.of(p)}),children:[c.of(p)," ",e.jsx("sup",{children:p})]},p))})})]})]}),e.jsx(oe.Divider,{}),V.map(p=>$(p,v))]})]})}),m&&e.jsxs(E,{className:"p-3 mt-3",children:[e.jsx("h3",{className:"h4 pb-1 mb-3 border-bottom",children:B(m.title,r)}),e.jsx("h4",{className:"h5 pb-1 mb-3 border-bottom",children:t("statistics.resources.titleBasicMetadata")}),y("title",m.title),y("description",m.description),y("institution",m.institution),m.landingPage&&e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:t("statistics.resources.cardHeaderLandingPage")}),e.jsx(E.Body,{children:e.jsx("a",{href:m.landingPage,className:"matomo_link",target:"_blank",children:m.landingPage})})]}),e.jsx("h4",{className:"h5 pb-1 mt-4 mb-3 border-bottom",children:t("statistics.resources.titleTechnicalMetadata")}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:t("statistics.resources.cardHeaderResource")}),e.jsx(E.Body,{children:e.jsxs("dl",{className:"mb-0",children:[e.jsx("dt",{children:t("statistics.labels.resourcePid")}),e.jsx("dd",{children:m.handle}),e.jsx("dt",{children:t("statistics.labels.resourceHierarchy")}),e.jsx("dd",{children:P(m)})]})})]}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:t("statistics.resources.cardHeaderEndpoint")}),e.jsx(E.Body,{children:e.jsxs("dl",{className:"mb-0",children:[e.jsx("dt",{children:t("statistics.labels.endpointUrl")}),e.jsxs("dd",{children:[m.endpoint.url," ",n&&e.jsxs(e.Fragment,{children:[" ",e.jsx("a",{href:`${n}?url=${encodeURIComponent(m.endpoint.url)}`,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ee},className:"align-baseline ms-2"})})]})]}),e.jsx("dt",{children:t("statistics.labels.fcsVersion")}),e.jsx("dd",{children:m.endpoint.protocol}),e.jsx("dt",{children:t("statistics.labels.searchCapabilitiesOfEndpoint")}),e.jsx("dd",{children:m.endpoint.searchCapabilities.join(", ")}),e.jsx("dt",{children:t("statistics.labels.searchCapabilitiesOfResource")}),e.jsx("dd",{children:m.searchCapabilitiesResolved.join(", ")}),e.jsx("dt",{children:t("statistics.labels.availabilityRestriction")}),e.jsx("dd",{children:m.availabilityRestriction}),e.jsx("dt",{children:t("statistics.labels.endpointInstitution")}),e.jsxs("dd",{children:[m.endpointInstitution.name,m.endpointInstitution.link&&e.jsxs(e.Fragment,{children:[" – ",e.jsxs("a",{href:m.endpointInstitution.link,className:"matomo_link",target:"_blank",children:[t("statistics.labels.moreInformation")," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:as}})]})]})]})]})})]}),e.jsx("h4",{className:"h5 pb-1 mt-4 mb-3 border-bottom",children:t("statistics.resources.titleSeachInformation")}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:t("statistics.resources.cardHeaderDataViews")}),e.jsx(E.Body,{children:m.availableDataViews&&e.jsxs(ae,{hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:t("statistics.resources.thDataViewIdentifier")}),e.jsx("th",{scope:"col",children:t("statistics.resources.thDataViewMimeType")}),e.jsx("th",{scope:"col",children:t("statistics.resources.thDataViewDeliveryPolicy")})]})}),e.jsx("tbody",{children:m.availableDataViews.map(p=>e.jsxs("tr",{children:[e.jsx("td",{children:p.identifier}),e.jsx("td",{children:p.mimeType}),e.jsx("td",{children:p.deliveryPolicy})]},p.identifier))})]})})]}),F&&e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:t("statistics.resources.cardHeaderAdvancedDataView")}),e.jsx(E.Body,{children:m.availableLayers&&e.jsxs(ae,{hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:t("statistics.resources.thLayerType")}),e.jsx("th",{scope:"col",children:t("statistics.resources.thQualifier")}),e.jsx("th",{scope:"col",children:t("statistics.resources.thResultId")}),e.jsx("th",{scope:"col",children:t("statistics.resources.thIdentifier")}),e.jsx("th",{scope:"col",children:t("statistics.resources.thEncoding")}),e.jsx("th",{scope:"col",children:t("statistics.resources.thAltValueInfo")}),e.jsx("th",{scope:"col",children:t("statistics.resources.thAltValueInfoURI")})]})}),e.jsx("tbody",{children:m.availableLayers.map(p=>e.jsxs("tr",{children:[e.jsx("td",{children:p.layerType}),e.jsx("td",{children:p.qualifier}),e.jsx("td",{children:p.resultId}),e.jsx("td",{children:p.identifier}),e.jsx("td",{children:p.encoding}),e.jsx("td",{children:p.altValueInfo}),e.jsx("td",{children:p.altValueInfoURI})]},p.identifier))})]})})]}),g&&e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:t("statistics.resources.cardHeaderLexDataView")}),e.jsx(E.Body,{children:m.availableLexFields&&e.jsxs(ae,{hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:t("statistics.resources.thLexFieldType")}),e.jsx("th",{scope:"col",children:t("statistics.resources.thLexIdentifier")})]})}),e.jsx("tbody",{children:m.availableLexFields.map(p=>e.jsxs("tr",{children:[e.jsx("td",{children:p.type}),e.jsx("td",{children:p.id})]},p.id))})]})})]})]})]})}function Pr({url:n,statistics:s,validatorUrl:t,isScan:r}){const{t:i,i18n:a}=ne(),c=new Intl.NumberFormat(a.language,{style:"unit",unit:"second",unitDisplay:"short"});function o(l,u){const j=e.jsx(he.Highlight,{text:l.title,ranges:s.matchResources?.[u]??null});return l.valid&&l.notes.length===0?j:e.jsx(Ce,{placement:"auto-start",delay:{show:250,hide:400},overlay:e.jsxs(Me,{id:`resource-info-warning-${l.handle}`,children:[!l.valid&&i("statistics.errors.notAvailableInAggregator"),!l.valid&&l.notes.length>=1&&e.jsx("hr",{className:"mt-2 mb-1"}),l.notes.length===1?l.notes[0]:l.notes.length>=1?e.jsx("ul",{className:"text-start m-0 my-1 ps-3",children:l.notes.map((L,x)=>e.jsx("li",{children:L},x))}):null]}),children:e.jsxs("span",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:it},className:"align-baseline me-2"}),l.valid?j:e.jsx("s",{children:j})]})})}return e.jsxs("div",{className:"ps-sm-4 mt-sm-0 mt-2 pt-sm-0 pt-1",children:[e.jsxs("h4",{className:"h5",id:`${Gs(n)}-${r?"scan":"search"}`,children:[e.jsx(he.Highlight,{text:n,ranges:s.matchEndpoint}),t&&e.jsxs(e.Fragment,{children:[" ",e.jsx("a",{href:`${t}?url=${encodeURIComponent(n)}`,children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ee},className:"align-baseline ms-2"})})]})]}),e.jsxs("dl",{className:"ps-sm-4",children:[e.jsx("dt",{children:i("statistics.labels.fcsVersion")}),e.jsx("dd",{children:s.version}),e.jsx("dt",{children:i("statistics.labels.searchCapabilities")}),e.jsx("dd",{children:s.searchCapabilities.join(", ")}),e.jsx("dt",{children:i("statistics.labels.maxConcurrentScanRequests")}),e.jsx("dd",{children:s.maxConcurrentRequests}),e.jsx("dt",{children:i("statistics.labels.requestStatistics")}),e.jsx("dd",{className:"mb-0",children:i("statistics.labels.numberOfRequests",{count:s.numberOfRequests})}),s.avgQueueTime!==0&&e.jsx("dd",{className:"mb-0",children:i("statistics.labels.queueTime",{avg:c.format(s.avgQueueTime),max:c.format(s.maxQueueTime)})}),e.jsx("dd",{children:i("statistics.labels.executionTime",{avg:c.format(s.avgExecutionTime),max:c.format(s.maxExecutionTime)})}),s.rootResources?.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("dt",{children:i("statistics.labels.resources")}),e.jsx("dd",{children:i("statistics.labels.numberOfRootResources",{count:s.rootResources.length})}),e.jsx("dd",{children:e.jsx("ul",{children:s.rootResources.map((l,u)=>typeof l=="string"?e.jsx("li",{children:e.jsx(he.Highlight,{text:l,ranges:s.matchResources?.[u]??null})},l):e.jsx("li",{children:o(l,u)},l.handle))})})]}),e.jsxs(e.Fragment,{children:[Object.entries(s.diagnostics||{}).map(([l,u])=>e.jsxs(de,{variant:"warning",style:{fontSize:"0.85rem"},children:[e.jsxs(de.Heading,{style:{fontSize:"1rem"},children:[e.jsxs(fe,{bg:"warning",children:[u.counter,"x"]})," ",e.jsx("span",{className:"text-uppercase",children:i("statistics.diagnostic.diagnostic")})," ",u.diagnostic.message,u.diagnostic.diagnostic&&e.jsxs(e.Fragment,{children:[" - ",e.jsx("small",{children:u.diagnostic.diagnostic})]})]}),e.jsxs("p",{className:"mb-0",children:[i("statistics.diagnostic.context")," ",e.jsx("a",{href:u.context,children:u.context})]})]},l)),Object.entries(s.errors||{}).map(([l,u])=>e.jsxs(de,{variant:"danger",style:{fontSize:"0.85rem"},children:[e.jsxs(de.Heading,{style:{fontSize:"1rem"},children:[e.jsxs(fe,{bg:"danger",children:[u.counter,"x"]})," ",e.jsx("span",{className:"text-uppercase",children:i("statistics.diagnostic.exception")})," ",u.exception.message]}),e.jsxs("p",{className:"mb-0",children:[i("statistics.diagnostic.context")," ",e.jsx("a",{href:u.context,children:u.context})]}),u.exception.cause&&e.jsxs("p",{className:"mb-0",children:[i("statistics.diagnostic.causedBy")," ",u.exception.cause]})]},l))]})]})]},n)}function Or({data:n,validatorUrl:s}){const{t,i18n:r}=ne(),[i,a]=d.useState(""),[c,o]=d.useState(["institution","endpoint","resources"]),[l,u]=d.useState(!1),j=`-${n.isScan?"scan":"search"}`,L=d.useMemo(()=>Object.entries(n.institutions).toSorted().map(([m,A])=>Object.entries(A).toSorted().map(([C,b])=>({institutionName:m,endpointUrl:C,endpointInfo:{...b,rootResources:b.rootResources.toSorted()}}))).flat(1).filter(l?m=>Object.keys(m.endpointInfo.diagnostics).length>0||Object.keys(m.endpointInfo.errors).length>0:()=>!0),[n,l]),x=L.filter(m=>Object.keys(m.endpointInfo.diagnostics).length>0||Object.keys(m.endpointInfo.errors).length>0),S=he.useFuzzySearchList({list:L,queryText:i,getText:m=>{const A=[];return c.length===0?A.push(m.institutionName,m.endpointUrl,...m.endpointInfo.rootResources.map(C=>typeof C=="string"?C:C.title)):(c.includes("institution")&&A.push(m.institutionName),c.includes("endpoint")&&A.push(m.endpointUrl),c.includes("resources")&&A.push(...m.endpointInfo.rootResources.map(C=>typeof C=="string"?C:C.title))),A},mapResultItem:({item:m,score:A,matches:C})=>({item:m,matches:C,score:A})}).reduce((m,A)=>{const{institutionName:C,endpointUrl:b,endpointInfo:H}=A.item;return Object.getOwnPropertyNames(m).includes(C)||(m[C]={match:c.length===0||c.includes("institution")?A.matches[0]:null,endpoints:{}}),m[C].endpoints[b]={...H,matchEndpoint:c.length===0||c.includes("endpoint")?A.matches[c.length===0||c.includes("institution")?1:0]:null,matchResources:c.length===0||c.includes("resources")?A.matches.slice(0+(c.length===0||c.includes("institution")?1:0)+(c.length===0||c.includes("endpoint")?1:0)):[]},m},{});function _(m){c.includes(m)?o(c.filter(A=>A!==m)):o([...c,m])}return e.jsxs(ie,{className:"d-grid gap-2 mt-3",children:[e.jsx(de,{variant:"info",className:"mb-0",children:e.jsxs("dl",{className:"mb-0",children:[e.jsx("dt",{children:t("statistics.labels.startDate")}),e.jsx("dd",{className:"mb-0",children:new Date(n.date).toLocaleString(r.language)}),e.jsx("dt",{children:t("statistics.labels.timeout")}),e.jsx("dd",{className:"mb-0",children:new Intl.NumberFormat(r.language,{style:"unit",unit:"second",unitDisplay:"short"}).format(n.timeout)})]})}),e.jsx(q,{onSubmit:m=>m.preventDefault(),children:e.jsxs(se,{className:"gy-2",children:[e.jsx(D,{lg:6,md:12,children:e.jsx(q.Control,{placeholder:t("statistics.filter.inputPlaceholder"),value:i,onChange:m=>a(m.target.value)})}),e.jsxs(D,{className:"filter-checkboxes",lg:6,md:12,children:[e.jsx(q.Text,{className:"me-2",children:t("statistics.filter.labelForCheckboxes")}),e.jsx(q.Check,{type:"checkbox",checked:c.includes("institution"),onChange:()=>_("institution"),id:`filter-institution-name${j}`,label:t("statistics.filter.checkboxInstitution")}),e.jsx(q.Check,{type:"checkbox",checked:c.includes("endpoint"),onChange:()=>_("endpoint"),id:`filter-endpoint-url${j}`,label:t("statistics.filter.checkboxEndpoint")}),e.jsx(q.Check,{type:"checkbox",checked:c.includes("resources"),onChange:()=>_("resources"),id:`filter-resource-names${j}`,label:t("statistics.filter.checkboxResources")})]})]})}),e.jsx(se,{children:e.jsx(D,{children:e.jsx(q.Check,{type:"checkbox",checked:l,onChange:()=>u(!l),id:`filter-show-issues-only${j}`,label:t("statistics.filter.checkboxShowWithIssues",{count:x.length})})})}),Object.entries(S).map(([m,{match:A,endpoints:C}])=>e.jsxs(E,{className:"p-2",children:[e.jsx("h3",{className:"h4 pb-1 border-bottom",id:`${Gs(m)}${j}`,children:e.jsx(he.Highlight,{text:m,ranges:A})}),Object.entries(C).toSorted().map(([b,H])=>e.jsx(Pr,{url:b,statistics:H,validatorUrl:s,isScan:n.isScan},b))]},m))]})}const Ur=[{id:"last-scan",label:"Last Scan"},{id:"recent-searches",label:"Recent Searches"}],Dr=Object.fromEntries(Ur.map(n=>[n.id,n])),Hr=["resources","fcs"];function Fr(){const n=Le(),s=Ws(),[t]=Ae(),{t:r}=ne(),{categoryId:i}=Ht(),a=Tr(),c=Ir(),o={consortia:t.get(ye)},{isPending:l,isError:u,data:j,error:L}=Re({queryKey:["statistics"],queryFn:nn.bind(null,n,o)}),[x,N]=d.useState(J.getState().validatorURL);J.subscribe(b=>N(b.validatorURL));const S=J.getState().appTitleHead,_=[...j!==void 0?Object.keys(j).toSorted():[],...Hr],m=i!=null&&_.includes(i)?i:_.length>0?_[0]:void 0;function A(){s.invalidateQueries({queryKey:["statistics"]}),s.invalidateQueries({queryKey:["resources"]}),s.invalidateQueries({queryKey:["languages"]})}function C(b){a?.params.categoryId,a&&a.params.categoryId!==b&&a.route.path&&c(a.route.path,{categoryId:b})}return e.jsxs(e.Fragment,{children:[e.jsx($e,{children:e.jsxs("title",{children:[S," – Statistics"]})}),e.jsxs(ie,{id:"statistics",className:"my-4",children:[e.jsx("h1",{className:"h1",children:r("statistics.title")}),(l||u)&&e.jsx(se,{children:e.jsxs(D,{children:[l?r("statistics.loading"):null,e.jsx("br",{}),u?L.message:null]})}),j&&e.jsxs(He.Container,{activeKey:i&&_.includes(i)?i:m,onSelect:C,children:[e.jsxs(ue,{className:"nav-tabs",as:"ul",children:[Object.keys(j).map(b=>e.jsx(ue.Item,{as:"li",role:"presentation",children:e.jsx(ue.Link,{as:"button",eventKey:b,children:r(`statistics.tabs.${b}`,{defaultValue:Dr[b]?.label??b})})},b)),e.jsx(ue.Item,{as:"li",role:"presentation",children:e.jsx(ue.Link,{as:"button",eventKey:"resources",children:r("statistics.tabs.resources")})},"resources"),e.jsx(ue.Item,{as:"li",role:"presentation",children:e.jsx(ue.Link,{as:"button",eventKey:"fcs",children:r("statistics.tabs.fcs")})},"fcs"),e.jsx(ue.Item,{as:"li",role:"presentation",className:"ms-auto",children:e.jsxs(ue.Link,{as:"button",onClick:A,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:st}})," ",r("statistics.tabs.btnRefresh")]})})]}),e.jsxs(He.Content,{children:[Object.entries(j).map(([b,H])=>e.jsx(He.Pane,{eventKey:b,children:e.jsx(Or,{data:H,validatorUrl:x})},b)),e.jsx(He.Pane,{eventKey:"resources",children:e.jsx(Mr,{validatorUrl:x})},"resources"),e.jsx(He.Pane,{eventKey:"fcs",children:e.jsx(kr,{})},"fcs")]})]})]})]})}function Br(){const n=J.getState().appTitleHead;wn();const s=pe(t=>t.locale);d.useEffect(()=>{xe.language!==s&&xe.changeLanguage(s)},[s]);{const t=ws(),[r,i]=d.useState(t.pathname);d.useEffect(()=>{const a=t.pathname;a!==r&&(i(a+t.search),ut(a,document.title,r))},[t,r])}return e.jsxs(e.Fragment,{children:[e.jsx($e,{children:e.jsx("title",{children:n})}),e.jsx(jn,{}),e.jsx("main",{children:e.jsxs(Ft,{children:[e.jsx(Je,{index:!0,element:e.jsx(Cr,{})}),e.jsx(Je,{path:"/about",element:e.jsx(Mn,{})}),e.jsx(Je,{path:"/help",element:e.jsx(Hn,{})}),e.jsx(Je,{path:"/stats/:categoryId?",element:e.jsx(Fr,{})})]})}),e.jsx(gn,{})]})}window.MyAggregator=window.MyAggregator||{};window._paq=window._paq||[];const Vr=["DEPLOY_PATH","API_URL","APP_TITLE","APP_TITLE_HEAD","MATOMO_TRACKING_PARAMS"];function qr(){window.MyAggregator.DEPLOY_PATH!==void 0&&J.getState().setDeployPath(window.MyAggregator.DEPLOY_PATH),window.MyAggregator.API_URL!==void 0&&J.getState().setApiURL(window.MyAggregator.API_URL),window.MyAggregator.VALIDATOR_URL!==void 0&&J.getState().setValidatorURL(window.MyAggregator.VALIDATOR_URL),window.MyAggregator.SHOW_SEARCH_RESULT_LINK!==void 0&&J.getState().setShowSearchResultLink(window.MyAggregator.SHOW_SEARCH_RESULT_LINK),window.MyAggregator.APP_TITLE!==void 0&&J.getState().setAppTitle(window.MyAggregator.APP_TITLE),window.MyAggregator.APP_TITLE_HEAD!==void 0&&J.getState().setAppTitleHead(window.MyAggregator.APP_TITLE_HEAD),window.MyAggregator.MATOMO_TRACKING_PARAMS!==void 0&&J.getState().setMatomoTrackingParams(window.MyAggregator.MATOMO_TRACKING_PARAMS),window.MyAggregator.AUTH_USERNAME!==void 0&&J.getState().setAuthUsername(window.MyAggregator.AUTH_USERNAME),window.MyAggregator=new Proxy(window.MyAggregator,{get(n,s){return n[s]},set(n,s,t){return Vr.includes(s)?(console.error(`Configuration ${s} can only be set on initialization!`),!1):s==="VALIDATOR_URL"?t===null||typeof t=="string"?(J.getState().setValidatorURL(t),!0):!1:s==="SHOW_SEARCH_RESULT_LINK"?typeof t=="boolean"?(J.getState().setShowSearchResultLink(t),!0):!1:s==="AUTH_USERNAME"?t===null||typeof t=="string"?(J.getState().setAuthUsername(t),!0):!1:(n[s]=t,!0)}}),Object.assign(window.MyAggregator,{getAppStore:()=>J})}function zr(){const n=re.getState(),s=[navigator.language,...navigator.languages];let t=!1;for(const r of s){if(r===n.locale){t=!0;break}if(n.locales.includes(r)){n.setLocale(r),t=!0;break}}t||console.warn("User locale",s,"was not found in available languages",n.locales),Object.assign(window.MyAggregator,{getLocaleStore:()=>re})}qr();zr();J.getInitialState(),J.getState();re.getInitialState(),re.getState();const $r=J.getState().deployPath,Kr=J.getState().apiURL,Wr=re.getState().locale;xe.changeLanguage(Wr);const Qr=new Bt({defaultOptions:{queries:{}}}),Gr=Vt.create({baseURL:Kr,timeout:5e3,responseType:"json",transitional:{silentJSONParsing:!1}});{const n=J.getState().matomoTrackingParams;Kn(n)||console.warn("Unable to setup tracking ...")}const Yr="root",Xr=document.getElementById(Yr),Jr=en.createRoot(Xr);Jr.render(e.jsx(d.StrictMode,{children:e.jsx(Bn,{axios:Gr,children:e.jsx(qt,{client:Qr,children:e.jsx(zt,{children:e.jsx($t,{basename:$r,children:e.jsx(Br,{})})})})})}));export{bt as C,Pn as b,mt as f,ot as h,On as p,Un as r,ft as u,Dn as x};
//# sourceMappingURL=fcs-sru-aggregator-ui-0.0.0.js.map
