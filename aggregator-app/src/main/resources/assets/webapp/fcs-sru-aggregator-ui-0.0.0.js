const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./fcs-sru-aggregator-ui-query-builder-0.0.0.js","./vendor/react-ext.js","./vendor/react.js","./vendor/bootstrap.js","./vendor/antlr4.js","./locales/en/default.js","./vendor/prism.js","./fcs-sru-aggregator-ui-query-builder-0.0.0.css","./vendor/bootstrap.css"])))=>i.map(i=>d[i]);
import{u as Me,b as te,j as e,L as Ze,T as z,c as Dt,d as gs,N as Nt,r as d,e as de,f as ps,g as fs,H as Pe,R as xs,h as js,k as Ht,l as ft,m as bs,n as Ft,o as qt,p as Ne,q as ys,s as ws,t as Ss,v as Bt,w as vs,x as Rs,y as Ve,Q as Ls,z as Ns,A as Cs,B as Is,C as Ts}from"./vendor/react-ext.js";import{b as _s}from"./vendor/react.js";/* empty css                            */import{C as se,R as Z,a as P,N as Ee,b as ue,c as Ct,M as J,F as q,B as X,T as Oe,d as Ce,e as H,f as zt,g as xe,I as Es,D as re,S as Vt,h as be,O as we,i as pe,j as Ie,L as ke,A as ie,P as $e,k as it,l as As,m as ot,n as Ke}from"./vendor/bootstrap.js";import{_ as $t,a as Kt,b as ks,c as Ms,d as Ps}from"./locales/en/default.js";import{g as Os}from"./vendor/prism.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();var Qe={},It;function Us(){if(It)return Qe;It=1;var s=_s();return Qe.createRoot=s.createRoot,Qe.hydrateRoot=s.hydrateRoot,Qe}var Ds=Us();const Se="x-consortia";async function Hs(s,n){const t=new URLSearchParams;n?.consortia!==void 0&&n?.consortia!==null&&t.set(Se,n.consortia);const r="init"+(t.entries().next().done?"":`?${t}`);return(await s.get(r)).data}async function Fs(s,n){const t=new URLSearchParams;n?.consortia!==void 0&&n?.consortia!==null&&t.set(Se,n.consortia);const r="resources"+(t.entries().next().done?"":`?${t}`);return(await s.get(r)).data}async function qs(s,n){const t=new URLSearchParams;n?.consortia!==void 0&&n?.consortia!==null&&t.set(Se,n.consortia);const r="statistics"+(t.entries().next().done?"":`?${t}`);return(await s.get(r)).data}async function Bs(s,n){return(await s.post("search",n,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data}async function zs(s,n,t){return(await s.post(`search/${n}`,t,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data}async function Vs(s,n){if(!n)throw new Error('Invalid "searchID" parameter!');return(await s.get(`search/${n}/metaonly`)).data}async function $s(s,n,t){if(!n)throw new Error('Invalid "searchID" parameter!');if(!t)throw new Error('Invalid "resourceID" parameter!');const a=(await s.get(`search/${n}/metaonly?resourceId=${encodeURIComponent(t)}`)).data.results.filter(i=>i.id===t);if(a.length===0)throw new Error(`Results (meta) for resource not found! (searchId: ${n}, resourceId: ${t})`);return a[0]}async function Ks(s,n,t){if(!n)throw new Error('Invalid "searchID" parameter!');if(!t)throw new Error('Invalid "resourceID" parameter!');const a=(await s.get(`search/${n}?resourceId=${encodeURIComponent(t)}`)).data.results.filter(i=>i.resource.id===t);if(a.length===0)throw new Error(`Results for resource not found! (searchId: ${n}, resourceId: ${t})`);return a[0].records===void 0&&console.warn("Using legacy FCS SRU Aggregator API with Search Results not in '.records'!",{searchID:n},a),a[0]}function Qs(s,n,t,r,a,i){const l=new URLSearchParams({resourceId:t,format:r});(i==="byGuess"||i==="byMetaAndGuess")&&l.set("filterLanguage",a);const o=`search/${n}/download?${l.toString()}`;return s.getUri({url:o})}function Gs(s,n,t,r,a,i){const l=new URLSearchParams({resourceId:t});r?l.set("filterLanguage",r):(i==="byGuess"||i==="byMetaAndGuess")&&l.set("filterLanguage",a);const o=`search/${n}/toWeblicht?${l.toString()}`;return s.getUri({url:o})}const Ws=[Se];function tt(){const[s]=Me(),n=new URLSearchParams(Array.from(s.entries()).filter(([t])=>Ws.includes(t)));if(!n.entries().next().done)return`?${n}`}function Ys(){const{t:s}=te(),n="urls.termsUseAndDisclaimer",t=s(n,{ns:"common"}),r=t!==n,a="urls.contact",i=s(a,{ns:"common"}),l=i!==a,o="footer.serviceInfo.text",u=s(o)!==o,f=tt();return e.jsx("footer",{className:"text-muted",children:e.jsx(se,{children:e.jsxs(Z,{children:[e.jsxs(P,{className:"text-start d-flex flex-sm-row flex-column column-gap-3 row-gap-2",children:[e.jsxs("div",{children:[e.jsx(Ze,{to:{pathname:"/about",search:f},className:"hidden-xs",children:s("footer.links.about")}),e.jsxs("div",{className:"version-info text-muted text-center-xs",children:["v","0.0.0"]})]}),e.jsx(Ze,{to:{pathname:"/stats",search:f},children:s("footer.links.statistics")})]}),e.jsx(P,{className:"text-center",children:u&&e.jsxs(z,{i18nKey:o,children:[e.jsxs("span",{className:"footer-fineprint",children:["Service provided by ",e.jsx("a",{href:s("footer.serviceInfo.url"),children:"CLARIN"})]}),e.jsxs("span",{children:[e.jsx("br",{}),"Hosted by CLARIN ERIC"]})]})}),e.jsxs(P,{className:"hidden-xs text-end d-flex flex-sm-row flex-column justify-content-sm-end column-gap-3 row-gap-2",children:[r&&e.jsx("a",{href:t,children:s("footer.links.termsUseAndDisclaimer")}),l&&e.jsx("a",{href:i,children:s("footer.links.contact")})]})]})})})}const W=Dt(s=>({deployPath:"/",apiURL:"https://contentsearch.clarin.eu/rest/",validatorURL:"https://www.clarin.eu/fcsvalidator/",showSearchResultLink:!1,appTitle:"Content Search",appTitleHead:"FCS Aggregator – Content Search",matomoTrackingEnabled:!0,matomoTrackingParams:null,authUsername:null,setDeployPath:n=>s(t=>({deployPath:typeof n=="function"?n(t.deployPath):n})),setApiURL:n=>s(t=>({apiURL:typeof n=="function"?n(t.apiURL):n})),setValidatorURL:n=>s(t=>({validatorURL:typeof n=="function"?n(t.validatorURL):n})),setShowSearchResultLink:n=>s(t=>({showSearchResultLink:typeof n=="function"?n(t.showSearchResultLink):n})),setAppTitle:n=>s(t=>({appTitle:typeof n=="function"?n(t.appTitle):n})),setAppTitleHead:n=>s(t=>({appTitleHead:typeof n=="function"?n(t.appTitleHead):n})),setMatomoTrackingParams:n=>s(t=>({matomoTrackingParams:typeof n=="function"?n(t.matomoTrackingParams):n})),setAuthUsername:n=>s(t=>({authUsername:typeof n=="function"?n(t.authUsername):n}))}));var Xs=["en","de"];const ee=Dt(s=>({locale:"en",locales:Xs??["en"],setLocale:n=>s(t=>({locale:typeof n=="function"?n(t.locale):n})),setLocales:n=>s(t=>({locales:typeof n=="function"?n(t.locales):n}))})),ge=s=>{const n=gs(ee,s);return Object.assign(n,ee),n},Js=""+new URL("assets/icon-services-fcs.png",import.meta.url).href,Tt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16">
  <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"/>
</svg>`,Ue=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-translate" viewBox="0 0 16 16">
  <path d="M4.545 6.714 4.11 8H3l1.862-5h1.284L8 8H6.833l-.435-1.286zm1.634-.736L5.5 3.956h-.049l-.679 2.022z"/>
  <path d="M0 2a2 2 0 0 1 2-2h7a2 2 0 0 1 2 2v3h3a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-3H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zm7.138 9.995q.289.451.63.846c-.748.575-1.673 1.001-2.768 1.292.178.217.451.635.555.867 1.125-.359 2.08-.844 2.886-1.494.777.665 1.739 1.165 2.93 1.472.133-.254.414-.673.629-.89-1.125-.253-2.057-.694-2.82-1.284.681-.747 1.222-1.651 1.621-2.757H14V8h-3v1.047h.765c-.318.844-.74 1.546-1.272 2.13a6 6 0 0 1-.415-.492 2 2 0 0 1-.94.31"/>
</svg>`;function Zs(){const{t:s}=te(),n=ge(m=>m.locale),t=ge(m=>m.locales),r=ge(m=>m.setLocale),a=W.getState().authUsername,i=a!==null&&a!=="anonymous",l=W.getState().deployPath??"",o=l+(l.endsWith("/")?"":"/")+"login",c=tt();function u(m){m!==null&&r(m)}function f(){return i?e.jsxs(Ee.Text,{className:"ms-auto",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Tt}})," Signed in as"," ",e.jsx("span",{className:"fw-bold",children:a})]}):e.jsxs(ue.Link,{href:`${o}${c??""}`,className:"ms-auto",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Tt}})," ",s("header.login.login")]})}function C(){if(!t||t.length===1)return null;const m=new Intl.DisplayNames([n,"en"],{type:"language"}),L=e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ue}})," ",n.toUpperCase()," "]});return e.jsx(Ct,{title:L,align:"end",className:"ms-2",onSelect:u,children:t.map(w=>{const j=new Intl.DisplayNames([w,"en"],{type:"language"});return e.jsxs(Ct.Item,{disabled:w===n,"aria-disabled":w===n,eventKey:w,title:s("header.localeOptionTitle",{code:w,name:j.of(w),context:w!==n?"translated":null,translated:m.of(w)}),children:[w.toUpperCase()," – ",j.of(w)]},w)})})}return e.jsx("header",{children:e.jsx(Ee,{expand:"md",className:"bg-body-tertiary",children:e.jsxs(se,{children:[e.jsxs(Ee.Brand,{as:Ze,to:{pathname:"/",search:c},children:[e.jsx("img",{src:Js,width:"30",height:"30",className:"d-inline-block align-top",alt:`${s("header.title")} logo`})," ",s("header.title")]}),e.jsx(Ee.Toggle,{"aria-controls":"header-navbar-nav"}),e.jsx(Ee.Collapse,{id:"header-navbar-nav",children:e.jsxs(ue,{className:"w-100 d-flex",children:[e.jsx(ue.Link,{as:Nt,to:{pathname:"/",search:c},children:s("header.menu.home")}),e.jsx(ue.Link,{as:Nt,to:{pathname:"/help",search:c},children:s("header.menu.help")}),f(),C()]})})]})})})}/*!
 * Color mode switcher based on example from Bootstrap 5 docs.
 * @see https://getbootstrap.com/docs/5.3/customize/color-modes/#javascript
 */function en(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function tn(s){s==="auto"?document.documentElement.setAttribute("data-bs-theme",window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"):document.documentElement.setAttribute("data-bs-theme",s)}function sn(){d.useEffect(()=>{function s(){tn(en())}return s(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",s),()=>window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",s)},[])}const nn="modulepreload",rn=function(s,n){return new URL(s,n).href},_t={},ae=function(n,t,r){let a=Promise.resolve();if(t&&t.length>0){let u=function(f){return Promise.all(f.map(C=>Promise.resolve(C).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};const l=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");a=u(t.map(f=>{if(f=rn(f,r),f in _t)return;_t[f]=!0;const C=f.endsWith(".css"),m=C?'[rel="stylesheet"]':"";if(!!r)for(let j=l.length-1;j>=0;j--){const b=l[j];if(b.href===f&&(!C||b.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${f}"]${m}`))return;const w=document.createElement("link");if(w.rel=C?"stylesheet":nn,C||(w.as="script"),w.crossOrigin="",w.href=f,c&&w.setAttribute("nonce",c),document.head.appendChild(w),C)return new Promise((j,b)=>{w.addEventListener("load",j),w.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${f}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return a.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return n().catch(i)})},an=(s,n,t)=>{const r=s[n];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((a,i)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(i.bind(null,new Error("Unknown variable dynamic import: "+n+(n.split("/").length!==t?". Note that variables only represent file names one level deep.":""))))})},on={en:{app:Kt,common:$t}},lt="clarin",ln=ee.getInitialState().locale,cn=ee.getInitialState().locales;function un(s,n){if(!s)return n;const t=typeof s=="string"?[s]:s;return[...t.map(a=>`${lt}.${a}`),...t]}const ct=["app","common"],dn=un(ct);function Ge(s){return typeof s=="string"||!Array.isArray(s)?[String(s)]:s}function hn(s,n,t,r){if(t?.postProcessTryPrefixedNamespacesFirst!==void 0)return s;const a=Ge(n),i=Ge(t.ns||r.options.defaultNS||[]),l=r.resolve(a,t),c=(l?.res!==void 0?[...Ge(t.ns||[]),l.usedNS]:[...Ge(t.ns||[]),...i]).map(f=>f.startsWith(lt)?f:`${lt}.${f}`),u=r.translate(a,{...t,ns:c,postProcessTryPrefixedNamespacesFirst:!0});return a.includes(u)?s:u}de.use(ps).use({type:"postProcessor",name:"try-prefixed-namespaces-first",process:hn}).use(fs((s,n)=>an(Object.assign({"../locales/de/app.json":()=>ae(()=>import("./locales/de/default.js").then(r=>r.a),[],import.meta.url),"../locales/de/clarin.app.json":()=>ae(()=>import("./locales/de/default.js").then(r=>r.c),[],import.meta.url),"../locales/de/common.json":()=>ae(()=>import("./locales/de/default.js").then(r=>r.b),[],import.meta.url),"../locales/de/textplus.app.json":()=>ae(()=>import("./locales/de/textplus.app.js"),[],import.meta.url),"../locales/en/app.json":()=>ae(()=>import("./locales/en/default.js").then(r=>r.e),[],import.meta.url),"../locales/en/clarin.app.json":()=>ae(()=>import("./locales/en/default.js").then(r=>r.g),[],import.meta.url),"../locales/en/clarin.common.json":()=>ae(()=>import("./locales/en/default.js").then(r=>r.h),[],import.meta.url),"../locales/en/common.json":()=>ae(()=>import("./locales/en/default.js").then(r=>r.f),[],import.meta.url),"../locales/en/querybuilder.json":()=>ae(()=>import("./locales/en/querybuilder.js"),[],import.meta.url),"../locales/en/querysuggestions.json":()=>ae(()=>import("./locales/en/default.js").then(r=>r.q),[],import.meta.url),"../locales/en/textplus.app.json":()=>ae(()=>import("./locales/en/textplus.app.js"),[],import.meta.url),"../locales/en/textplus.common.json":()=>ae(()=>import("./locales/en/textplus.common.js"),[],import.meta.url)}),`../locales/${s}/${n}.json`,4))).init({lng:ln,fallbackLng:"en",supportedLngs:cn,ns:dn,defaultNS:ct,fallbackNS:ct,debug:!1,interpolation:{escapeValue:!1},postProcess:["try-prefixed-namespaces-first"],resources:on,partialBundledLanguages:!0,react:{nsMode:"fallback",transKeepBasicHtmlNodesFor:["br","strong","i","p","em","kbd","code"]}});de.addResourceBundle("en","clarin.app",ks);de.addResourceBundle("en","clarin.common",Ms);de.addResourceBundle("en","app",Kt);de.addResourceBundle("en","querysuggestions",Ps);de.addResourceBundle("en","common",$t);Object.assign(window,{i18n:de});const mn=["Emanuel Dima","Erik Körner","Leif-Jöran Olsson","Yana Panchenko","Oliver Schonefeld","Dieter Van Uytvanck"],gn=[{id:"dropwizard",name:"Dropwizard",url:"https://www.dropwizard.io/",license:"Apache License 2.0",licenseUrl:"https://github.com/dropwizard/dropwizard/blob/release/3.0.x/LICENSE",usage:"web server"},{id:"de.mpg.mpgaai:mpgaai-shhaa",name:"MPG-AAI - simple http header authn/z",url:"https://github.com/clarin-eric/mpgaai",license:"Apache License 2.0",licenseUrl:"http://www.apache.org/licenses/LICENSE-2.0.txt",usage:"AAI / Shibboleth support"},{id:"io.swagger.core.v3",name:"Swagger Core",url:"https://github.com/swagger-api/swagger-core",license:"Apache License 2.0",licenseUrl:"https://github.com/swagger-api/swagger-core/blob/master/LICENSE",usage:"REST API documentation"},{id:"org.glassfish.jersey",name:"Eclipse Jersey",url:"https://eclipse-ee4j.github.io/jersey/",license:"Eclipse Public License 2.0",licenseUrl:"https://github.com/eclipse-ee4j/jersey/blob/2.x/LICENSE.md",usage:"RESTful web services"},{id:"org.slf4j",name:"Simple Logging Facade for Java (SLF4J)",url:"https://www.slf4j.org/",license:"MIT License",licenseUrl:"https://www.slf4j.org/license.html",usage:"logging"},{id:"org.junit",name:"JUnit 5",url:"https://junit.org/",license:"Eclipse Public License 2.0",licenseUrl:"https://github.com/junit-team/junit-framework/blob/main/LICENSE.md",usage:"testing"},{id:"optimaize/language-detector",name:"Optimaize Language Detector",url:"https://github.com/optimaize/language-detector",license:"Apache License 2.0",licenseUrl:"https://github.com/optimaize/language-detector/blob/master/LICENSE",usage:"language detection of results"},{id:"org.apache.commons:commons-text",name:"Apache Commons Text",url:"https://commons.apache.org/proper/commons-text/",license:"Apache License 2.0",licenseUrl:"https://github.com/apache/commons-text/blob/master/LICENSE.txt",usage:"export format"},{id:"com.sun.xml.bind",name:"JAXB Reference Implementation",url:"https://eclipse-ee4j.github.io/jaxb-ri/",license:"Common Development and Distribution License (CCDL) 1.1",licenseUrl:"https://github.com/javaee/jaxb-v2/blob/2.3.0.1/jaxb-ri/License.txt",usage:"XML support",hide:!0},{id:"eu.clarin.weblicht:wlfxb",name:"Weblicht wlfxb",url:"https://weblicht.sfs.uni-tuebingen.de",license:"GNU Lesser General Public License v3.0",licenseUrl:"https://github.com/weblicht/wlfxb/blob/master/LICENSE.txt",usage:"export format"},{id:"org.apache.poi:poi-ooxml",name:"Apache POI",url:"https://poi.apache.org/",license:"Apache License 2.0",licenseUrl:"https://github.com/apache/poi/blob/trunk/legal/LICENSE",usage:"export format"},{id:"org.jopendocument:jOpenDocument",name:"jOpenDocument",url:"https://www.jopendocument.org/",license:"GNU Lesser General Public License v3.0",licenseUrl:"https://www.jopendocument.org/support.html",usage:"export format"},{id:"eu.clarin.sru:sru-client",name:"CLARIN SRU/CQL Client",license:"GNU General Public License v3.0",licenseUrl:"https://github.com/clarin-eric/fcs-sru-client/blob/main/LICENSE.txt",usage:"SRU / CQL client framework",hide:!0},{id:"eu.clarin.sru.fcs:fcs-simple-client",name:"CLARIN-FCS Client",license:"GNU General Public License v3.0",licenseUrl:"https://github.com/clarin-eric/fcs-simple-client/blob/main/LICENSE.txt",usage:"FCS client framework",hide:!0}],pn=[{id:"react",name:"React",url:"https://react.dev/",license:"MIT License",licenseUrl:"https://github.com/facebook/react/blob/main/LICENSE"},{id:"react-dom",name:"ReactDOM",url:"https://react.dev/reference/react-dom",license:"MIT License",licenseUrl:"https://github.com/facebook/react/blob/main/LICENSE",hide:!0},{id:"react-router",name:"React Router",url:"https://reactrouter.com/",license:"MIT License",licenseUrl:"https://github.com/remix-run/react-router/blob/main/LICENSE.md",usage:"single page application routing"},{id:"react-bootstrap",name:"React Bootstrap",url:"https://react-bootstrap.netlify.app/",license:"MIT License",licenseUrl:"https://github.com/react-bootstrap/react-bootstrap/blob/master/LICENSE",usage:"react bindings for bootstrap"},{id:"bootstrap",name:"Bootstrap",url:"https://getbootstrap.com/",license:"MIT License",licenseUrl:"https://github.com/twbs/bootstrap/blob/main/LICENSE",usage:"UI framework"},{id:"bootstrap-icons",name:"Bootstrap Icons",url:"https://icons.getbootstrap.com/",license:"MIT License",licenseUrl:"https://github.com/twbs/icons/blob/main/LICENSE"},{id:"@tanstack/react-query",name:"TanStack Query",url:"https://tanstack.com/query",license:"MIT License",licenseUrl:"https://github.com/TanStack/query/blob/main/LICENSE",usage:"data loading via REST APIs"},{id:"axios",name:"Axios",url:"https://axios-http.com/",license:"MIT License",licenseUrl:"https://github.com/axios/axios/blob/v1.x/LICENSE",usage:"cross-browser support for REST API requests"},{id:"antlr4ng",name:"Next Generation TypeScript runtime for ANTLR4",url:"https://github.com/mike-lischke/antlr4ng",license:'The "BSD license"',licenseUrl:"https://github.com/mike-lischke/antlr4ng/blob/main/LICENSE.txt",usage:"query parser"},{id:"i18next",name:"i18next",url:"https://www.i18next.com/",license:"MIT License",licenseUrl:"https://github.com/i18next/i18next/blob/master/LICENSE",usage:"translations"},{id:"react-i18next",name:"react-i18next",url:"https://react.i18next.com/",license:"MIT License",licenseUrl:"https://github.com/i18next/react-i18next/blob/master/LICENSE",usage:"translations",hide:!0},{id:"i18next-resources-to-backend",name:"i18next-resources-to-backend",url:"https://github.com/i18next/i18next-resources-to-backend",license:"MIT License",licenseUrl:"https://github.com/i18next/i18next-resources-to-backend/blob/main/licence",usage:"translation resource loading",hide:!0},{id:"zustand",name:"Zustand",url:"https://zustand-demo.pmnd.rs/",license:"MIT License",licenseUrl:"https://github.com/pmndrs/zustand/blob/main/LICENSE",usage:"state management"},{id:"@nozbe/microfuzz",name:"microfuzz",url:"https://github.com/Nozbe/microfuzz",license:"MIT License",licenseUrl:"https://github.com/Nozbe/microfuzz/blob/main/LICENSE",usage:"fuzzy search"},{id:"react-helmet-async",name:"React Helmet (async fork)",url:"https://github.com/staylor/react-helmet-async",license:"Apache License 2.0",licenseUrl:"https://github.com/staylor/react-helmet-async/blob/main/LICENSE",usage:"HTML head modifications"},{id:"react-slugify",name:"react-slugify",url:"https://github.com/martpie/react-slugify",license:"MIT License",licenseUrl:"https://github.com/martpie/react-slugify/blob/master/LICENSE",usage:"jump id fragment generation"}];function fn(){const{t:s}=te(),n="urls.termsUseAndDisclaimer",t=s(n,{ns:"common"}),r=t!==n,a=W.getState().matomoTrackingEnabled,i=W.getState().appTitleHead,l=tt();function o(c){return e.jsx("ul",{children:c.filter(u=>u.hide!==!0).map(u=>e.jsxs("li",{children:[u.url?e.jsx("a",{href:u.url,children:u.name}):e.jsx("span",{children:u.name}),u.license&&e.jsxs(e.Fragment,{children:[" ","(",u.licenseUrl?e.jsx("a",{href:u.licenseUrl,children:u.license}):e.jsx("span",{children:u.license}),")"]})]},u.id))})}return e.jsxs(e.Fragment,{children:[e.jsx(Pe,{children:e.jsxs("title",{children:[i," – About"]})}),e.jsxs(se,{className:"py-4",children:[e.jsx("h1",{className:"h1 mb-4",children:s("about.title")}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:s("about.people.title")}),e.jsx("p",{children:s("about.people.developedBy")}),e.jsx("ul",{children:mn.map(c=>e.jsx("li",{children:c},c))})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:s("about.statistics.title")}),e.jsx("p",{children:e.jsx(z,{i18nKey:"about.statistics.text",components:[e.jsx(Ze,{to:{pathname:"/stats",search:l},children:"endpoint statistics"})]})})]}),(r||a)&&e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:s("about.privacyPolicy.title")}),r&&e.jsx("p",{children:e.jsx(z,{i18nKey:"about.privacyPolicy.termsInfo",components:[e.jsx("a",{href:t,children:"clarin.eu"})]})}),a&&e.jsx("p",{children:e.jsx(z,{i18nKey:"about.privacyPolicy.matomoInfo",components:[e.jsx("a",{href:"https://matomo.org/",children:"Matomo"})]})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:s("about.sourceCode.title")}),e.jsx("p",{children:e.jsx(z,{i18nKey:"about.sourceCode.sourceInfo.text",components:[e.jsx("a",{href:s("about.sourceCode.sourceInfo.repoUrl"),children:"GitHub"}),e.jsx("a",{href:s("about.sourceCode.sourceInfo.licenseUrl"),children:"GPL 3.0 license"})]})}),e.jsx("p",{children:s("about.sourceCode.licenseInfo")})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:s("about.technology.title")}),e.jsx("p",{children:s("about.technology.backendUses")}),o(gn),e.jsx("p",{children:s("about.technology.frontendUses")}),o(pn),e.jsx("p",{children:e.jsx(z,{i18nKey:"about.technology.iconLicenseInfo",components:[e.jsx("a",{href:"http://www.freepik.com/",children:"Freepik"}),e.jsx("a",{href:"www.flaticon.com",children:"www.flaticon.com"}),e.jsx("a",{href:"http://creativecommons.org/licenses/by/3.0/",children:"CC BY 3.0"})]})})]})]})]})}const Qt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
  <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"/>
  <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"/>
</svg>`,ut=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-magic" viewBox="0 0 16 16">
  <path d="M9.5 2.672a.5.5 0 1 0 1 0V.843a.5.5 0 0 0-1 0zm4.5.035A.5.5 0 0 0 13.293 2L12 3.293a.5.5 0 1 0 .707.707zM7.293 4A.5.5 0 1 0 8 3.293L6.707 2A.5.5 0 0 0 6 2.707zm-.621 2.5a.5.5 0 1 0 0-1H4.843a.5.5 0 1 0 0 1zm8.485 0a.5.5 0 1 0 0-1h-1.829a.5.5 0 0 0 0 1zM13.293 10A.5.5 0 1 0 14 9.293L12.707 8a.5.5 0 1 0-.707.707zM9.5 11.157a.5.5 0 0 0 1 0V9.328a.5.5 0 0 0-1 0zm1.854-5.097a.5.5 0 0 0 0-.706l-.708-.708a.5.5 0 0 0-.707 0L8.646 5.94a.5.5 0 0 0 0 .707l.708.708a.5.5 0 0 0 .707 0l1.293-1.293Zm-3 3a.5.5 0 0 0 0-.706l-.708-.708a.5.5 0 0 0-.707 0L.646 13.94a.5.5 0 0 0 0 .707l.708.708a.5.5 0 0 0 .707 0z"/>
</svg>`;function xn(){const{t:s}=te(),n=W.getState().appTitleHead;return e.jsxs(e.Fragment,{children:[e.jsx(Pe,{children:e.jsxs("title",{children:[n," – Help"]})}),e.jsxs(se,{className:"my-4",children:[e.jsx("h1",{className:"h1",children:s("help.title")}),e.jsx("h2",{className:"h2",id:"performing-a-fcs-search-in-resources",children:s("help.performSearch.title")}),e.jsx("p",{children:e.jsx(z,{i18nKey:"help.performSearch.textBasicSearch"})}),e.jsx("p",{children:e.jsx(z,{i18nKey:"help.performSearch.textAdvancedSearch",components:{iconMagicWand:e.jsx("i",{dangerouslySetInnerHTML:{__html:ut},"aria-hidden":"true"})}})}),e.jsx("p",{children:e.jsx(z,{i18nKey:"help.performSearch.textLexicalSearch",components:{iconMagicWand:e.jsx("i",{dangerouslySetInnerHTML:{__html:ut},"aria-hidden":"true"})}})}),e.jsx("p",{children:e.jsx(z,{i18nKey:"help.performSearch.textSearchProgress"})}),e.jsx("p",{children:e.jsx(z,{i18nKey:"help.performSearch.textViewResource",components:{iconEye:e.jsx("i",{dangerouslySetInnerHTML:{__html:Qt},"aria-hidden":"true"})}})}),e.jsx("h2",{className:"h2",id:"adjusting-search-criteria",children:s("help.adjustSearchCriteria.title")}),e.jsx("p",{children:e.jsx(z,{i18nKey:"help.adjustSearchCriteria.text"})}),e.jsx("p",{children:e.jsx(z,{i18nKey:"help.adjustSearchCriteria.textOtherSearchTypes"})}),e.jsx("h2",{className:"h2",id:"more-help",children:s("help.moreHelp.title")}),e.jsx("p",{children:e.jsx(z,{i18nKey:"help.moreHelp.text",components:[e.jsx("a",{href:"https://www.clarin.eu/content/content-search-tutorial",children:"Content Search: Tutorial at CLARIN.eu"}),e.jsx("a",{title:s("help.contactTitle"),href:s("urls.contact",{ns:"common"}),children:"CLARIN FCS Helpdesk"})]})})]})]})}const xt=d.createContext({resources:[],languages:{},weblichtLanguages:[]});xt.displayName="AggregatorDataContext";function jn({resources:s,languages:n,weblichtLanguages:t,children:r}){const a={resources:s,languages:n,weblichtLanguages:t};return e.jsx(xt.Provider,{value:a,children:r})}function jt(){return d.useContext(xt)}const bt=d.createContext(void 0);bt.displayName="AxiosContext";function ve(){const s=d.useContext(bt);if(!s)throw new Error('No "axios" instance set, use AxiosProvider to set one');return s}function bn({axios:s,children:n}){return e.jsx(bt.Provider,{value:s,children:n})}const yt=d.createContext(void 0);yt.displayName="SearchParamsContext";function wt(){const s=d.useContext(yt);if(!s)throw new Error('No "params" data set, use SearchParamsProvider to set one');return s}function yn({language:s,languageFilter:n,queryType:t,query:r,resourceIDs:a,numberOfResults:i,children:l}){const o={language:s,languageFilter:n,queryType:t,query:r,resourceIDs:a,numberOfResults:i};return e.jsx(yt.Provider,{value:o,children:l})}function wn(s,n=0){let t=3735928559^n,r=1103547991^n;for(let a=0,i;a<s.length;a++)i=s.charCodeAt(a),t=Math.imul(t^i,2654435761),r=Math.imul(r^i,1597334677);return t=Math.imul(t^t>>>16,2246822507),t^=Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507),r^=Math.imul(t^t>>>13,3266489909),4294967296*(2097151&r)+(t>>>0)}window._paq=window._paq||[];function Sn({siteId:s,trackerUrl:n,enableLinkTracking:t=!0,domains:r=[],userId:a=void 0}){window._paq.push(["setTrackerUrl",n]),window._paq.push(["setSiteId",s]),a&&window._paq.push(["setUserId",a]),Array.isArray(r)&&r.length>0&&window._paq.push(["setDomains",r]),t&&(window._paq.push(["enableLinkTracking"]),window._paq.push(["setLinkTrackingTimer",250]))}function vn({srcUrl:s}){const n=document.createElement("script"),t=document.getElementsByTagName("script")[0];n.type="text/javascript",n.async=!0,n.defer=!0,n.src=s,t&&t.parentNode&&t.parentNode.insertBefore(n,t)}function Rn(s){if(!s)return!1;let n=null;if(typeof s=="string")try{n=JSON.parse(s)}catch(u){return console.error("Error trying to parse tracking params!",u),!1}else typeof s=="object"&&(n=s);const t=n.siteId,r=n.trackerUrl,a=n.srcUrl,i=n.domains,l=n.userId?.toString();if(a===void 0)return console.warn('No "srcUrl" configuration set for tracking!'),!1;if(r===void 0)return console.warn('No "trackerUrl" configuration set for tracking!'),!1;if(t===void 0||!Number.isInteger(t))return console.warn('No "siteId" configuration set for tracking!'),!1;const o={siteId:t,trackerUrl:r,domains:i};l&&(o.userId=wn(l).toString());const c={srcUrl:a};return Sn(o),Gt(document.location.href||window.location.href,document.title),vn(c),!0}function Gt(s,n,t){window._paq.push(["setDocumentTitle",n??document.title]),window._paq.push(["setCustomUrl",s]),t!==void 0&&window._paq.push(["setReferrerUrl",t]),window._paq.push(["trackPageView"])}function Wt(s,n=!1,t=!1){window._paq.push(["trackSiteSearch",s,n,t])}const dt="byMeta",Ln="all",Yt="resource",Nn="title-up",me="mul";function st(s,n=void 0,t={}){return s===me?t?.defaultAnyLanguage??"Any Language":n?.[s]||(t?.defaultUnknownLanguage??"Unknown Language")}function Xt(s){const n=ee.getState().locale,t=(i,l=null)=>({...i,subResources:i.subResources.map(o=>t(o,l??i)),rootResourceId:l?.id??null}),r=s.map(i=>t(i,null)),a=function(i,l){const o=U(i.institution,n)??"",c=U(l.institution,n)??"",u=o.localeCompare(c);if(u!==0)return u;const f=U(i.title,n)??"",C=U(l.title,n)??"";return f.toLowerCase().localeCompare(C.toLowerCase())};return Le(r,i=>{i.subResources.sort(a)}),r.sort(a),r}function Cn(s,n){const t=[],r=[],a=[];return Object.entries(n).forEach(([i,l])=>{l.forEach(o=>{let c=!1;Le(s,u=>{u.handle===o&&(c=!0,a.push(u))}),c||(console.warn("Handle not found in resources",o),r.push(o))})}),Le(a,i=>{t.push(i.id)}),{selected:t,unavailable:r}}function Le(s,n){const t=(r,a)=>{n(r,a)===!1||r.subResources.forEach(t)};s.forEach(t)}function et(s,n){let t;const r=a=>t!==void 0?!0:n(a)?(t=a,!0):a.subResources.find(r)!==void 0;return s.find(r),t}function fe(s){const n=[];return Le(s,t=>{n.push(t.id)}),n}function In(s,n,t){const r=[],a=i=>Zt(i,a)||On(i,n,t);return Le(s,i=>{a(i)&&r.push(i.id)}),r}function Tn(s,n){const t=ee.getState().locale,r=new Set;return Le(s,a=>{if(n.includes(a.id)){const i=U(a.institution,t)??"";r.add(i)}return!0}),Array.from(r)}function _n(s){const n=t=>[t,...t.subResources.map(n).flat()];return s.map(n).flat()}const Jt=["en","eng","de","deu"];function En(s){if(s===null)return null;if(typeof s=="string")return s;for(const t of Jt)if(Object.hasOwn(s,t))return s[t];const n=Object.getOwnPropertyNames(s);return n.length>0?s[n[0]]:null}function An(s,n){return s===null?null:typeof s=="string"?s:n&&Object.hasOwn(s,n)?s[n]:null}function U(s,n){n===void 0&&(n=ee.getState().locale);const t=An(s,n);return t!==null?t:En(s)}function kn(s,n){if(s===null||typeof s=="string")return;if(n===void 0&&(n=ee.getState().locale),n&&Object.hasOwn(s,n))return n;for(const r of Jt)if(Object.hasOwn(s,r))return r;const t=Object.getOwnPropertyNames(s);if(t.length>0)return t[0]}function De(s,n="en"){const t=typeof s.title=="string"||s.title===null?[n]:Object.getOwnPropertyNames(s.title),r=typeof s.description=="string"||s.description===null?[n]:Object.getOwnPropertyNames(s.description),a=typeof s.institution=="string"||s.institution===null?[n]:Object.getOwnPropertyNames(s.institution),i=[...t,...r,...a];return Array.from(new Set(i))}function Mn(s,n){return!(n==="fcs"&&!s.endpoint.searchCapabilities.includes("ADVANCED_SEARCH")||n==="lex"&&!s.endpoint.searchCapabilities.includes("LEX_SEARCH"))}function Pn(s,n){return!!(n===me||s.languages&&s.languages.length===1&&s.languages[0]===n||s.languages&&s.languages.indexOf(n)>=0)}function Zt(s,n){if(!s.subResources||s.subResources.length===0)return!1;let t=!1;const r=a=>{if(n?.(a)===!0){t=!0;return}a.subResources.forEach(r)};return s.subResources.forEach(r),t}function On(s,n,t){return!(!Mn(s,n)||!Pn(s,t))}const es={"title-up":(s,n)=>{const t=ee.getState().locale,r=U(s.title,t)??"",a=U(n.title,t)??"";return r.localeCompare(a)},"title-down":(s,n)=>{const t=ee.getState().locale,r=U(s.title,t)??"",a=U(n.title,t)??"";return-r.localeCompare(a)},"institution-up":(s,n)=>{const t=ee.getState().locale,r=U(s.institution,t)??"",a=U(n.institution,t)??"",i=U(s.title,t)??"",l=U(n.title,t)??"",o=r.localeCompare(a);return o!==0?o:i.localeCompare(l)},"institution-down":(s,n)=>{const t=ee.getState().locale,r=U(s.institution,t)??"",a=U(n.institution,t)??"",i=U(s.title,t)??"",l=U(n.title,t)??"",o=-r.localeCompare(a);return o!==0?o:i.localeCompare(l)}};function ts(s,n){const[t,r]=d.useState(s);return d.useEffect(()=>{const a=setTimeout(()=>{r(s)},n);return()=>{clearTimeout(a)}},[s,n]),t}function ht(s,n,t=0,r=n){if(n===s&&n===r&&n.nodeType===Node.ELEMENT_NODE&&t===1)return n.nodeType,n.textContent?.length,n.textContent?.length||0;if(n===s||s===null)return t;const a=n.parentNode;if(a===null)return t;let i=0;const l=a.childNodes;for(let o=0;o<l.length;o++){const c=l[o];if(c===n)break;c.nodeType===Node.TEXT_NODE||c.nodeType===Node.ELEMENT_NODE?i+=c.textContent?.length||0:console.warn("unknown node type",{container:s,node:n,offset:t,parent:a,i:o,child:c})}return ht(s,a,i+t,r)}function ss(s,n){const t=s.textContent?.length||0;if(t<n)return null;let r=0;const a=s.childNodes;for(let i=0;i<a.length;i++){const l=a[i];let o=0;if(l.nodeType===Node.TEXT_NODE||l.nodeType===Node.ELEMENT_NODE?o=l.textContent?.length||0:console.warn("unknown node type, skip",{container:s,offset:n,child:l}),!(o===0&&a.length!==1)&&(r+=o,r>=n)){const c=n-(r-o);return l.nodeType===Node.ELEMENT_NODE?ss(l,c):{node:l,offset:c}}}return a.length,null}function mt(s,n){if(!n)return null;const t=ht(s,n.startContainer,n.startOffset);if(n.startContainer.nodeType===Node.TEXT_NODE&&n.endContainer===n.startContainer)return[t,t+(n.endOffset-n.startOffset)];const r=ht(s,n.endContainer,n.endOffset);return[t,r]}function Un(s,n){if(!(document.activeElement===s))return null;const r=window.getSelection();if(!r)return null;const a=document.createRange(),i=ss(s,n);if(i)try{a.setStart(i.node,i.offset),a.collapse(!0),r.removeAllRanges(),r.addRange(a)}catch(l){console.error("Error trying to set cursor!",l,{container:s,offset:n,startRange:i})}}function Et(s){if(!(document.activeElement===s))return null;const t=window.getSelection();if(!t||t.rangeCount===0)return null;const r=t.getRangeAt(0),a=mt(s,r);return a?a[0]:null}function Dn(s){return s==="cql"?"fcs-cql":s==="fcs"?"fcs-fcsql":s==="lex"?"fcs-lexcql":"plain"}function gt(s,n){const t=Dn(n),r="match-braces rainbow-braces";let a=s;try{a=Os.highlight(s,t)}catch(l){console.warn("Error trying to highlight value",{value:s,error:l,language:t})}return`<pre><code class="language-${t} ${r}">${a}</code></pre>`}function Ae(s){return s?(s=s.replace(/[\n\t]/g," "),s=s.replace(/&nbsp;|\u202F|\u00A0/g," "),s):""}const ns=xs.forwardRef(({value:s,onChange:n,onCursorChange:t,disabled:r,placeholder:a,queryType:i,delay:l=200,...o},c)=>{const u=d.useRef(null),f=d.useRef(null);d.useImperativeHandle(c,()=>f.current);const[C,m]=d.useState(Ae(s)),[L,w]=d.useState(null),j=ts(C,l),[b,T]=d.useState(j);d.useEffect(()=>{const I=gt(j,i);if(T(I),f.current){const M=Et(f.current);w(M)}},[j,i]),d.useEffect(()=>{const I=Ae(s);if(j!==I&&(m(I),T(gt(I)),f.current)){const M=Et(f.current);w(M)}},[s,j]),d.useLayoutEffect(()=>{f.current&&L!==null&&Un(f.current,L)});function k(I){const M=I.target.innerText;u.current&&(u.current.value=M),m(M),n?.(M)}function y(I){I.stopPropagation(),I.preventDefault();const $=(I.clipboardData||window.clipboardData).getData("text");v($)}function O(I){I.key==="Enter"?(I.stopPropagation(),I.preventDefault(),u.current&&u.current.form?.requestSubmit()):I.key==="Backspace"?(I.stopPropagation(),I.preventDefault(),D()):I.key==="Delete"?(I.stopPropagation(),I.preventDefault(),V()):I.ctrlKey&&I.key==="a"||w(null)}function B(I=!1){if(!f.current||!t)return;const M=f.current;if(!(document.activeElement===M))return;const R=window.getSelection();if(!R||R.rangeCount===0)return;const E=[];for(let _=0;_<R.rangeCount;_++){const h=R.getRangeAt(_),N=mt(M,h);N&&E.push(N)}if(E.length===0)return;const[g,p]=E.pop();I?g===p&&(w(g),t?.(g)):t?.(g,g!==p?p:void 0)}function x(I){if(!f.current)return null;const M=f.current;if(!(document.activeElement===M))return null;const R=window.getSelection();if(!R||R.rangeCount===0)return null;const E=[];for(let h=0;h<R.rangeCount;h++){const N=R.getRangeAt(h),G=mt(M,N);G&&E.push(G)}if(E.length===0)return null;E.sort();const g=E.map(([h,N])=>N-h).reduce((h,N)=>h+N,0),p=M.innerText,_=E.toReversed().reduce((h,[N,G])=>h.slice(0,N)+h.slice(G),p);if(I==="backspace"){if(g===0){const h=E.filter(([N,G])=>N===G).map(([,N])=>N).pop();if(h===0)return null;if(h!==void 0)return{value:_.slice(0,h-1)+_.slice(h),offset:h-1}}else{const h=E.map(([,N])=>N).pop();if(h!==void 0)return{value:_,offset:h-g}}return console.warn('invalid "backspace" process, abort',{container:M,selectionIndices:E,oldValue:p,newValueSpansRemoved:_,numDeleted:g}),null}else if(I==="delete"){if(g===0){const h=E.filter(([N,G])=>N===G).map(([,N])=>N).pop();if(h!==void 0)return{value:_.slice(0,h)+_.slice(h+1),offset:h}}else{const h=E.map(([,N])=>N).pop();if(h!==void 0)return{value:_,offset:h-g}}return console.warn('invalid "delete" process, abort',{container:M,selectionIndices:E,oldValue:p,newValueSpansRemoved:_,numDeleted:g}),null}else if(I==="paste"){if(g===0){const h=E.filter(([N,G])=>N===G).map(([N])=>N).shift();if(h!==void 0)return{value:_,offset:h}}else{const h=E.map(([N])=>N).shift();if(h!==void 0)return{value:_,offset:h}}return console.warn('invalid "paste" process, abort',{container:M,selectionIndices:E,oldValue:p,newValueSpansRemoved:_,numDeleted:g}),null}}function v(I){const M=x("paste");if(!M)return;const $=Ae(I),{value:R,offset:E}=M,g=R.slice(0,E)+$+R.slice(E),p=E+I.length;m(g),w(p),u.current&&(u.current.value=g),n?.(g),t?.(p)}function D(){const I=x("backspace");if(!I)return;const{value:M,offset:$}=I,R=Ae(M);m(R),w($),u.current&&(u.current.value=R),n?.(R),t?.($)}function V(){const I=x("delete");if(!I)return;const{value:M,offset:$}=I,R=Ae(M);m(R),w($),u.current&&(u.current.value=R),n?.(R),t?.($)}return e.jsxs(e.Fragment,{children:[e.jsx("div",{role:"input",disabled:r,placeholder:a,spellCheck:!1,autoCapitalize:"off",autoCorrect:"off",...o,onInput:k,onPaste:y,onKeyDown:O,onKeyUp:()=>B(),onClick:()=>B(!0),tabIndex:r?-1:o.tabIndex,contentEditable:!0,dangerouslySetInnerHTML:{__html:b},ref:f}),a&&s===""&&e.jsx("span",{className:"input-placeholder-simulacrum",children:a}),e.jsx("input",{type:"hidden",ref:u})]})});ns.displayName="ContentEditable";var oe=js();function Hn({show:s,languages:n,resources:t,searchLanguage:r,searchLanguageFilter:a,onModalClose:i}){const{t:l}=te(),[o,c]=d.useState(r||me),[u,f]=d.useState(a||dt),[C,m]=d.useState(""),[L,w]=d.useState(!1),j=d.useMemo(()=>{const x=new Map;return t&&(t.forEach(v=>v.languages.forEach(D=>x.set(D,(x.get(D)??0)+1))),x.set(me,t.length)),x},[t]),b=oe.useFuzzySearchList({list:Object.entries(n??{}).toSorted(),queryText:C,getText:x=>[x[0],x[1]],mapResultItem:({item:x,score:v,matches:D})=>({item:x,matches:D,score:v})});if(!n)return null;const T=Math.floor((b.length+2)/3);function k(x){i({language:o,filter:u,action:x})}function y(){c(r||me),f(a||dt)}function O(){w(x=>!x)}function B(x,v,D,V){const I=o===x;let M="d-block py-0 my-1 border-0";return I&&(M+=" fw-semibold selected"),D===void 0&&(D=[null,null]),e.jsxs(X,{size:"sm",className:M,style:{color:`var(${I?"--bs-green":"--bs-body-colors"})`,backgroundColor:"var(--bs-body-bg)"},onClick:()=>c(x),"data-filter-score":V,children:[I&&e.jsx("span",{className:"selected-marker me-1",children:"✓"}),e.jsx(oe.Highlight,{ranges:D[1],text:v})," ",e.jsx("sup",{children:e.jsx(oe.Highlight,{ranges:D[0],text:x})}),L&&j.has(x)&&e.jsxs(e.Fragment,{children:[" (",j.get(x),")"]})]},x)}return e.jsxs(J,{show:s,onHide:()=>k("close"),size:"xl",fullscreen:"lg-down",centered:!0,children:[e.jsx(J.Header,{closeButton:!0,children:e.jsx(J.Title,{children:l("search.languagesModal.title")})}),e.jsxs(J.Body,{className:"px-0",children:[e.jsxs(se,{className:"px-4 pb-3 border-bottom",children:[e.jsxs(Z,{children:[e.jsx(P,{sm:!0}),e.jsx(P,{sm:!0,className:"mb-3 mb-sm-2 align-content-end",children:B(me,l("languageCodeToName.any",{ns:"common"}))}),e.jsxs(P,{sm:!0,children:[e.jsx(q.Control,{size:"sm",placeholder:l("search.languagesModal.filterInputPlaceholder"),name:"languages-filter",value:C,onChange:x=>m(x.target.value)}),t&&e.jsx(q.Check,{name:"languages-show-count",id:"languages-show-count",checked:L,onChange:O,type:"checkbox",label:l("search.languagesModal.checkboxShowNumberOfResources"),className:"mt-1"})]})]}),e.jsxs(Z,{children:[e.jsx(P,{sm:!0,children:b.slice(0,T).map(({item:[x,v],matches:D,score:V})=>B(x,v,D,V))}),e.jsx(P,{sm:!0,children:b.slice(T,2*T).map(({item:[x,v],matches:D,score:V})=>B(x,v,D,V))}),e.jsx(P,{sm:!0,children:b.slice(2*T).map(({item:[x,v],matches:D,score:V})=>B(x,v,D,V))})]})]}),e.jsx(q,{children:e.jsx(se,{className:"px-4 pt-3",children:["byMeta","byGuess","byMetaAndGuess"].map(x=>e.jsx(q.Check,{type:"radio",name:"filterOpts",value:x,id:`filterOpts-${x}`,checked:u===x,onChange:()=>f(x),label:l(`search.languagesModal.optionLanguage${x}`)},x))})})]}),e.jsxs(J.Footer,{children:[e.jsx(X,{variant:"secondary",onClick:y,children:l("search.languagesModal.buttonReset")}),e.jsx(X,{variant:"secondary",onClick:()=>k("abort"),children:l("search.languagesModal.buttonAbort")}),e.jsx(X,{variant:"primary",onClick:()=>k("confirm"),children:l("search.languagesModal.buttonConfirm")})]})]})}const St=[{id:"cql",name:"Text layer Contextual Query Language (CQL)",searchLabel:"Full-text search",color:"#29a900",searchPlaceholder:"Elephant"},{id:"fcs",name:"Multi-layer Federated Content Search Query Language (FCS-QL)",searchLabel:"Multi-layer annotation search",color:"#00a8cc",searchPlaceholder:"[word = 'annotation'][word = 'focused']"},{id:"lex",name:"Lexical Resources Contextual Query Language (LexCQL)",searchLabel:"Lexical resource search",color:"#e77e00",searchPlaceholder:"banana"}],Je=Object.fromEntries(["cql","fcs","lex"].map(s=>[s,St.find(n=>n.id===s)])),At=["fcs","lex"],Fn=[{id:"text",label:"Plain Text"},{id:"csv",label:"CSV"},{id:"tcf",label:"TCF"},{id:"ods",label:"ODS"},{id:"excel",label:"Excel"}],qn="cql",We=[10,20,50,100,200,250],je="info:srw/diagnostic/1/61",Bn=[{id:"cql-single-term",queryType:"cql",query:"Elephant",description:"Query with single term"},{id:"cql-with-boolean",queryType:"cql",query:"cat AND dog",description:"Query with boolean"},{id:"cql-with-phrase",queryType:"cql",query:'"exciting news"',description:"Query with phrase (quoting because of whitespaces)"},{id:"fcs-three-tokens-artznei",queryType:"fcs",query:'[ word = "her.*" ] [ lemma = "Artznei" ] [ pos = "VERB" ]',description:'Phrase with three tokens: a word starting with "her", a lemmatized word, and a verb'},{id:"lex-plain-string",queryType:"lex",query:"apple",description:"Search for plain string"},{id:"lex-lemma-with-language",queryType:"lex",query:'lemma =/lang=deu "Apfel"',description:'Search for German lemma "Apfel"'}];function zn({show:s,queryTypes:n,onModalClose:t}){const{t:r}=te(),a=n&&n.length>0?n:["cql","fcs","lex"],i=Bn.filter(u=>a.includes(u.queryType));if(i.length===0)return l("abort"),null;function l(u){t({query:void 0,queryType:void 0,action:u})}function o(u,f){t({query:u,queryType:f,action:"confirm"})}function c(u,f,C,m){return e.jsxs(Z,{children:[e.jsx(P,{md:"auto",className:"d-none d-md-block",children:m&&`${m}.`}),e.jsxs(P,{className:"d-flex flex-column",children:[C!==void 0&&e.jsx("div",{children:C}),e.jsx("div",{dangerouslySetInnerHTML:{__html:gt(u,f)}})]}),e.jsx(P,{md:"auto",className:"d-flex justify-content-end align-items-baseline",children:e.jsx(X,{size:"sm",onClick:()=>o(u,f),children:r("search.suggestionsModal.buttonUseQuery")})})]},u)}return e.jsxs(J,{id:"search-query-suggestions-modal",show:s,onHide:()=>l("close"),size:"xl",fullscreen:"xl-down",centered:!0,children:[e.jsx(J.Header,{closeButton:!0,children:e.jsx(J.Title,{children:r("search.suggestionsModal.title")})}),e.jsx(J.Body,{className:"px-0",children:e.jsx(se,{fluid:!0,children:a.map(u=>{const f=i.filter(C=>C.queryType===u);return f.length===0?null:e.jsxs(d.Fragment,{children:[e.jsx(Z,{children:e.jsx(P,{children:e.jsx("h4",{className:"border-bottom pb-2",children:r(`queryTypes.${u}.nameLong`,{ns:"common",defaultValue:Je[u]?.name??u.toUpperCase()})})})}),f.map((C,m)=>c(C.query,C.queryType,C.description,m+1))]},u)})})}),e.jsx(J.Footer,{children:e.jsx(X,{variant:"primary",onClick:()=>l("close"),children:r("search.suggestionsModal.buttonClose")})})]})}function rs({disabled:s,value:n,onChange:t,delay:r=300}){const[a,i]=d.useState(n??""),l=ts(a,r);return d.useEffect(()=>{t(l)},[t,l]),e.jsx(q.Control,{type:"search",placeholder:"Search for ...",value:a,onChange:o=>i(o.target.value),disabled:s})}function as(s,n,t,r){const a=_n(n);r??=["title","institution","description"];const i=oe.useFuzzySearchList({list:a,queryText:s,getText:m=>{const L=[];return r.includes("title")&&L.push(U(m.title,t)),r.includes("institution")&&L.push(U(m.institution,t)),r.includes("description")&&L.push(U(m.description,t)),L},mapResultItem:({item:m,score:L,matches:w})=>{const j=new Map;let b=0;return r.includes("title")&&j.set("title",w[b++]),r.includes("institution")&&j.set("institution",w[b++]),r.includes("description")&&j.set("description",w[b++]),{resource:m,matches:j,score:L}}}),l=i.reduce((m,{resource:L,matches:w})=>(m.set(L.id,w),m),new Map),o=i.reduce((m,{resource:L,score:w})=>m.set(L.id,w),new Map),c=new Set;i.filter(({resource:m})=>m.rootResourceId!==null).forEach(({resource:m,score:L})=>{const w=o.get(m.rootResourceId);w===void 0?(c.add(m.rootResourceId),o.set(m.rootResourceId,L)):L<w&&o.set(m.rootResourceId,L)});const u=n.filter(m=>c.has(m.id)).map(m=>({resource:m,score:o.get(m.id)}));return{resources:[...i.filter(({resource:m})=>!m.rootResourceId),...u].toSorted(({score:m},{score:L})=>m===L?0:m===void 0?1:L===void 0?-1:m-L).map(({resource:m})=>m),matches:l,scores:o}}const nt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bank" viewBox="0 0 16 16">
  <path d="m8 0 6.61 3h.89a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5H15v7a.5.5 0 0 1 .485.38l.5 2a.498.498 0 0 1-.485.62H.5a.498.498 0 0 1-.485-.62l.5-2A.5.5 0 0 1 1 13V6H.5a.5.5 0 0 1-.5-.5v-2A.5.5 0 0 1 .5 3h.89zM3.777 3h8.447L8 1zM2 6v7h1V6zm2 0v7h2.5V6zm3.5 0v7h1V6zm2 0v7H12V6zM13 6v7h1V6zm2-1V4H1v1zm-.39 9H1.39l-.25 1h13.72z"/>
</svg>`,vt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house-door" viewBox="0 0 16 16">
  <path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4z"/>
</svg>`;function Rt({resource:s,selectedResourceIDs:n,highlighting:t,highlightings:r,shouldBeShown:a,localeForInfos:i,onSelectClick:l,languageCodeToName:o}){const{t:c}=te(),[u,f]=d.useState(!1),[C,m]=d.useState(!1);t??=r?.get(s.id)??new Map;const L=n.includes(s.id),w=De(s),j=ge(x=>x.locale),[b,T]=d.useState(j);if(d.useEffect(()=>{j&&T(j)},[j]),d.useEffect(()=>{i&&T(i)},[i]),typeof a=="function"&&!a(s))return null;if(a===!1)return null;const k=typeof a=="function"?s.subResources.some(x=>a(x)):!0;function y(){u&&document.getSelection()?.type==="Range"||f(x=>!x)}function O(){l(s,!L)}function B(){m(x=>!x)}return e.jsxs(e.Fragment,{children:[e.jsxs(Z,{className:`p-2 m-1 ${u&&"border-bottom"}`,children:[e.jsx(P,{md:"auto",sm:1,onClick:O,children:e.jsx(q.Check,{id:`resource-selection-${s.id}`,"aria-label":c("search.results.resourceInfo.checkboxResourceAriaLabel",{title:s.title}),children:e.jsx(q.Check.Input,{checked:L,onChange:()=>{}})})}),e.jsxs(P,{md:8,sm:11,className:`mb-sm-2 ${u?"":"text-truncate"}`,onClick:y,children:[e.jsxs("h4",{className:`h5 ${u?"":"text-truncate"}`,children:[e.jsx(oe.Highlight,{text:U(s.title,b)??"",ranges:t.get("title")??null})," ",s.landingPage&&e.jsx("small",{children:e.jsxs("a",{href:s.landingPage,className:"matomo_link",target:"_blank",children:[c("search.resourcesModal.resource.moreInformation")," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:vt}})]})})]}),e.jsx("p",{className:`mb-0 ${u?"":"text-truncate"}`,children:U(s.description,b)&&e.jsx(oe.Highlight,{text:U(s.description,b)??"",ranges:t.get("description")??null})})]}),e.jsxs(P,{md:{span:3,offset:0},sm:{span:11,offset:1},className:`${u?"":" text-truncate"}`,onClick:y,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:nt}})," ",e.jsx(oe.Highlight,{text:U(s.institution,b)??"",ranges:t.get("institution")??null}),e.jsx("br",{}),e.jsx("i",{dangerouslySetInnerHTML:{__html:Ue}})," ",s.languages.map(o).sort().join(", "),u&&w.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx(Oe,{type:"radio",name:`resources-${s.id}-info-languages`,defaultValue:b,onChange:x=>T(x),onClick:x=>x.stopPropagation(),className:"mt-2",children:w.toSorted().map(x=>e.jsx(Ce,{variant:"outline-secondary",size:"sm",id:`resources-${s.id}-info-languages-${x}`,value:x,type:"radio",children:x},x))})]})]}),k&&s.subResources.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-100"}),e.jsx(P,{md:"auto",sm:1,style:{width:"2.8rem"}}),e.jsx(P,{md:{span:8,offset:0},sm:{span:11,offset:1},children:e.jsx(X,{variant:"link",size:"sm",className:"ps-0",onClick:B,children:c("search.resourcesModal.resource.toggleExpand",{context:C?"collapse":"expand",count:s.subResources.length})})})]})]}),k&&C&&e.jsx(H,{className:"ms-md-5 ms-sm-2 border-end-0 border-top-0 rounded-end-0 rounded-top-0",children:s.subResources.map(x=>e.jsx(Rt,{resource:x,highlightings:r,selectedResourceIDs:n,shouldBeShown:a,onSelectClick:l,languageCodeToName:o},x.id))})]})}function kt({title:s,resources:n,selectedResourceIDs:t,resourceScores:r,highlightings:a,expanded:i,shouldBeShown:l,localeForInfos:o,onSelectClick:c,onExpandToggleClick:u,onSelectAllClick:f,onDeselectAllClick:C,languageCodeToName:m}){const{t:L}=te(),[w,j]=d.useState(i);d.useEffect(()=>{j(i)},[i]);const b=r!==void 0?n.filter(y=>r.has(y.id)).toSorted((y,O)=>{const B=r.get(y.id),x=r.get(O.id);return B===x?0:B===void 0?1:x===void 0?-1:B-x}):n;if(b.length===0)return null;function T(){j(y=>!y),u(!w)}function k(){const y=n.filter(v=>!v.rootResourceId),O=fe(y).length,B=y.length,x=fe(y).filter(v=>t.includes(v)).length;return L("search.resourcesModal.grouped.msgResources",{count:B,nested:O-B,context:O-B?"nested":null})+(x!==O?L("search.resourcesModal.grouped.msgResourcesSelected",{count:x}):"")}return e.jsxs(se,{className:"border-bottom pb-2 mb-4 px-0",children:[e.jsxs(Z,{className:"px-3",children:[e.jsx(P,{md:9,sm:12,children:e.jsx("h3",{children:s})}),e.jsxs(P,{md:3,sm:12,className:"gap-1 d-inline-flex column-gap-2 justify-content-evenly",style:{height:"fit-content"},children:[e.jsx(X,{size:"sm",variant:"secondary",onClick:T,"aria-expanded":w,children:L("search.resourcesModal.grouped.buttonExpand",{context:w?"hide":"show"})}),e.jsx(X,{size:"sm",onClick:()=>f(n),children:L("search.resourcesModal.grouped.buttonSelectAll")}),e.jsx(X,{size:"sm",onClick:()=>C(n),children:L("search.resourcesModal.grouped.buttonDeselectAll")})]})]}),e.jsx(Z,{className:"px-3",children:e.jsx(P,{children:k()})}),e.jsx(zt,{in:w,children:e.jsx(se,{children:b.map(y=>e.jsx(Rt,{resource:y,highlightings:a,selectedResourceIDs:t,shouldBeShown:l,onSelectClick:c,languageCodeToName:m,localeForInfos:o},y.id))})})]})}function Vn({show:s,showGrouping:n,resources:t,languages:r,availableResources:a,selectedResources:i,onModalClose:l}){const{t:o}=te(),c=ge(S=>S.locale),[u,f]=d.useState(c);d.useEffect(()=>{c&&f(c)},[c]);const C=new Intl.DisplayNames([c,"en"],{type:"language"}),[m,L]=d.useState(i||a),[w,j]=d.useState(Ln),[b,T]=d.useState(Yt),[k,y]=d.useState(Nn),[O,B]=d.useState(""),[x,v]=d.useState({}),[D,V]=d.useState({});d.useEffect(()=>{n&&T(n)},[s,n]),d.useEffect(()=>L(i),[i]);const I=t.filter(S=>a.includes(S.id)).toSorted(es[k]),$=I.map(S=>De(S)).flat().reduce((S,K)=>S.set(K,(S.get(K)??0)+1),new Map),{resources:R,matches:E,scores:g}=as(O,I,u),p=d.useMemo(()=>{const S=new Map;return b==="institution"?Object.entries(x).forEach(([K,Y])=>{S.set(K,Y.resources.reduce((Q,he)=>{const le=g.get(he.id);return le===void 0?Q:Q===void 0?le:Q<le?Q:le},void 0))}):b==="language"&&Object.entries(D).forEach(([K,Y])=>{S.set(K,Y.resources.reduce((Q,he)=>{const le=g.get(he.id);return le===void 0?Q:Q===void 0?le:Q<le?Q:le},void 0))}),S},[b,g,x,D]);if(d.useMemo(()=>{const S={},K={};t.forEach(Y=>{const Q=U(Y.institution,u)??"";Object.getOwnPropertyNames(S).includes(Q)||(S[Q]={expanded:!0,resources:[]}),S[Q].resources.push(Y),Y.languages.forEach(he=>{Object.getOwnPropertyNames(K).includes(he)||(K[he]={expanded:!0,resources:[]}),K[he].resources.push(Y)})}),v(S),V(K)},[t,u]),!t)return null;const _={total:fe(t).length,totalRoot:t.length,available:a.length,selected:m.length,visible:fe(R.map(S=>S)).length,visibleRoot:R.length};function h(S){return st(S,r,{defaultAnyLanguage:o("languageCodeToName.any",{ns:"common"}),defaultUnknownLanguage:o("languageCodeToName.unknown",{ns:"common"})})}function N(S,K){const Y=m.filter(Q=>!S.includes(Q));L(K?[...Y,...S]:Y)}function G(S){l({resourceIDs:m,action:S})}function ne(S){j(S.target.value)}function Re(S){T(S.target.value)}function Fe(S){y(S.target.value)}function Te(){L(a)}function rt(){L([])}function qe(){L(R.map(S=>S.id))}function ye(S,K){N(fe([S]),K)}function Be(S){N(fe(S),!0)}function ze(S){N(fe(S),!1)}function _e(S){return!(!a.includes(S.id)||w==="selected"&&!m.includes(S.id)&&!Zt(S,K=>m.includes(K.id)))}function at(){return b==="institution"?Object.entries(x).toSorted(([S],[K])=>{const Y=p.get(S),Q=p.get(K);return Y===Q?0:Y===void 0?1:Q===void 0?-1:Y-Q}).map(([S,{expanded:K,resources:Y}])=>e.jsx(kt,{title:e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:nt}})," ",S]}),resources:Y,selectedResourceIDs:m,resourceScores:g,highlightings:E,expanded:K,shouldBeShown:_e,onSelectAllClick:Be,onExpandToggleClick:Q=>{v({...x,[S]:{...x[S],expanded:Q}})},onDeselectAllClick:ze,onSelectClick:ye,languageCodeToName:h,localeForInfos:u},S)):b==="language"?Object.entries(D).toSorted(([S],[K])=>{const Y=p.get(S),Q=p.get(K);return Y===Q?0:Y===void 0?1:Q===void 0?-1:Y-Q}).map(([S,{expanded:K,resources:Y}])=>e.jsx(kt,{title:e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ue}})," ",h(S)," [",S,"]"]}),resources:Y,selectedResourceIDs:m,resourceScores:g,highlightings:E,expanded:K,shouldBeShown:_e,onSelectAllClick:Be,onExpandToggleClick:Q=>D[S].expanded=Q,onDeselectAllClick:ze,onSelectClick:ye,languageCodeToName:h,localeForInfos:u},S)):R.filter(S=>!S.rootResourceId).map(S=>e.jsx(Rt,{resource:S,selectedResourceIDs:m,highlighting:E.get(S.id),highlightings:E,shouldBeShown:_e,onSelectClick:ye,languageCodeToName:h,localeForInfos:u},S.id))}return e.jsxs(J,{id:"resource-selection-modal",show:s,onHide:()=>G("close"),size:"xl",fullscreen:"xl-down",centered:!0,children:[e.jsx(J.Header,{closeButton:!0,children:e.jsx(J.Title,{children:o("search.resourcesModal.title")})}),e.jsxs(J.Body,{className:"px-0",children:[e.jsx(q,{className:"px-3 pb-3 border-bottom",onSubmit:S=>S.preventDefault(),children:e.jsxs(se,{children:[e.jsxs(Z,{className:"d-sm-flex row-gap-2 justify-content-around",children:[e.jsx(P,{md:2,sm:6,children:e.jsx(xe,{label:"View",controlId:"resource-view-options-visibility",children:e.jsxs(q.Select,{value:w,onChange:ne,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"selected",children:"Selected only"})]})})}),e.jsx(P,{md:2,sm:6,children:e.jsx(xe,{label:"Group by",controlId:"resource-view-options-grouping",children:e.jsxs(q.Select,{value:b,onChange:Re,children:[e.jsx("option",{value:"resource",children:"(Resource)"}),e.jsx("option",{value:"institution",children:"Institution"}),e.jsx("option",{value:"language",children:"Language"})]})})}),e.jsx(P,{md:2,sm:6,children:e.jsx(xe,{label:"Sort by",controlId:"resource-view-options-sorting",children:e.jsxs(q.Select,{value:k,onChange:Fe,disabled:b!=="resource"||O.trim()!=="",children:[e.jsx("option",{value:"title-up",children:"Title (up)"}),e.jsx("option",{value:"title-down",children:"Title (down)"}),e.jsx("option",{value:"institution-up",children:"Institution (up)"}),e.jsx("option",{value:"institution-down",children:"Institution (down)"})]})})}),e.jsx(P,{md:3,sm:12,children:e.jsx(xe,{label:"Resource filter query",controlId:"resource-view-options-filter",children:e.jsx(rs,{value:O,onChange:S=>B(S)})})}),e.jsxs(P,{md:3,sm:12,className:"gap-1 d-inline-flex column-gap-2 justify-content-evenly",children:[e.jsx(X,{onClick:Te,children:"Select all"}),e.jsx(X,{onClick:qe,disabled:w!=="all"||O.trim()==="",children:"Select visible"}),e.jsx(X,{onClick:rt,children:"Deselect all"})]})]}),$.size>1&&e.jsxs(q.Group,{as:Z,controlId:"resource-info-language",className:"mt-2",children:[e.jsx(q.Label,{column:!0,sm:"auto",style:{fontSize:"0.875rem"},children:o("search.resourcesModal.labelChangeResourceInfoLanguage")}),e.jsx(P,{sm:"auto",children:e.jsx(Oe,{type:"radio",name:"resource-info-languages",defaultValue:u,onChange:S=>f(S),children:Array.from($.entries()).toSorted().map(([S,K])=>e.jsxs(Ce,{size:"sm",id:`resource-info-languages-${S}`,value:S,variant:"secondary",title:o("search.resourcesModal.buttonChangeResourceInfoLanguageTitle",{count:K,language:S,languageName:C.of(S)}),children:[C.of(S)," ",e.jsx("sup",{children:S})]},S))})})]})]})}),e.jsx("p",{className:"m-4 mb-0",children:o("search.resourcesModal.msgResourcesSelected",{count:_.selected,total:_.visible,available:_.available,context:_.available!==_.visible?"available":null})}),e.jsx(se,{className:"px-3 pt-3",children:at()})]}),e.jsx(J.Footer,{children:e.jsx(X,{variant:"primary",onClick:()=>G("confirm"),children:o("search.resourcesModal.buttonConfirm")})})]})}function $n(){const[s,n]=d.useState(!1);return[s,()=>{s!==!0&&n(!0)}]}function Kn(){const s=Ht(),{hash:n}=ft(),t=d.useMemo(()=>new URLSearchParams(n.substring(1)),[n]),r=d.useCallback(a=>{const i=bs(typeof a=="function"?a(new URLSearchParams(t)):a),l=i.entries().next().done?"":`#${i}`;n!==l&&s({hash:l})},[t,n,s]);return[t,r]}const Qn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-balloon" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 9.984C10.403 9.506 12 7.48 12 5a4 4 0 0 0-8 0c0 2.48 1.597 4.506 4 4.984M13 5c0 2.837-1.789 5.227-4.52 5.901l.244.487a.25.25 0 1 1-.448.224l-.008-.017c.008.11.02.202.037.29.054.27.161.488.419 1.003.288.578.235 1.15.076 1.629-.157.469-.422.867-.588 1.115l-.004.007a.25.25 0 1 1-.416-.278c.168-.252.4-.6.533-1.003.133-.396.163-.824-.049-1.246l-.013-.028c-.24-.48-.38-.758-.448-1.102a3 3 0 0 1-.052-.45l-.04.08a.25.25 0 1 1-.447-.224l.244-.487C4.789 10.227 3 7.837 3 5a5 5 0 0 1 10 0m-6.938-.495a2 2 0 0 1 1.443-1.443C7.773 2.994 8 2.776 8 2.5s-.226-.504-.498-.459a3 3 0 0 0-2.46 2.461c-.046.272.182.498.458.498s.494-.227.562-.495"/>
</svg>`,Ye=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear-fill" viewBox="0 0 16 16">
  <path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z"/>
</svg>`,Gn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-highlights" viewBox="0 0 16 16">
  <path d="M16 8A8 8 0 1 0 0 8a8 8 0 0 0 16 0m-8 5v1H4.5a.5.5 0 0 0-.093.009A7 7 0 0 1 3.1 13zm0-1H2.255a7 7 0 0 1-.581-1H8zm-6.71-2a7 7 0 0 1-.22-1H8v1zM1 8q0-.51.07-1H8v1zm.29-2q.155-.519.384-1H8v1zm.965-2q.377-.54.846-1H8v1zm2.137-2A6.97 6.97 0 0 1 8 1v1z"/>
</svg>`,Wn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
  <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
</svg>`,Yn=d.lazy(()=>ae(()=>import("./fcs-sru-aggregator-ui-query-builder-0.0.0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]),import.meta.url));function Mt(s,n=""){const t=s.get("query");return t||n}function Pt(s,n="cql"){const t=s.get("queryType");if(t){if(St.find(r=>r.id===t)!==void 0)return t;console.warn("Found unsupported queryType in search params",t)}return n}function Xn({resources:s,languages:n,onSearch:t,onShowToast:r,availableResources:a=null,selectedResources:i=null,hasSearch:l=!1,disabled:o=!1}){const{t:c}=te(),[u,f]=Me(),[C,m]=Kn(),[L,w]=d.useState(!1),[j,b]=d.useState(Yt),[T,k]=d.useState(!1),[y,O]=d.useState(!1),[B,x]=d.useState(!1),[v,D]=$n(),[V,I]=d.useState(me),[M,$]=d.useState(dt),[R,E]=d.useState(Pt(u,qn)),[g,p]=d.useState(a??[]),[_,h]=d.useState(i??[]),[N,G]=d.useState(We[0]),[ne,Re]=d.useState(Mt(u,"")),[Fe]=d.useState(null),[Te,rt]=d.useState(!1);d.useEffect(()=>{h(i??[])},[i]);const qe=d.useCallback(A=>{const F=In(A,R,M==="byGuess"?me:V);return a&&a.length>0?F.filter(ce=>a.includes(ce)):F},[R,V,M,a]);d.useEffect(()=>{const A=qe(s);p(A),h(F=>F.filter(ce=>A.includes(ce)))},[s,qe]);const ye=d.useCallback(()=>{const A={language:V,languageFilter:M,queryType:R,query:ne,resourceIDs:_??[],numberOfResults:N};A.query!==""&&A.resourceIDs.length!==0&&t(A)},[V,M,N,t,ne,R,_]);d.useEffect(()=>{if(u&&(Re(F=>Mt(u,F)),E(F=>Pt(u,F)),!u.get("x-aggregation-context"))){const F=u.get("mode");F&&(F==="search"&&ye(),u.delete("mode"),f(u))}},[u,f,ye]),d.useEffect(()=>{u.get("query")!==ne&&(u.set("query",ne),f(u))},[ne,u,f]),d.useEffect(()=>{u.get("queryType")!==R&&(u.set("queryType",R),f(u))},[R,u,f]),d.useEffect(()=>{C.has("openQueryBuilder")&&(D(),x(!0),C.delete("openQueryBuilder"),m(C))},[C,m,D]);const Be=Tn(s,_??[]).length,ze=s.find(A=>A.searchCapabilitiesResolved.includes("ADVANCED_SEARCH"))!==void 0,_e=s.find(A=>A.searchCapabilitiesResolved.includes("LEX_SEARCH"))!==void 0,at=At.includes(R);function S(A){A&&E(A)}function K(A){let F=Number.parseInt(A.target.value);F<10&&(F=10),F>250&&(F=250),We.includes(F)||console.warn("Invalid number of results?!",{valid:We,value:F}),G(F)}function Y({language:A,filter:F,action:ce}){k(!1),ce!=="abort"&&(I(A),$(F))}function Q({resourceIDs:A,action:F}){w(!1),F!=="abort"&&h(A)}function he({query:A,queryType:F,action:ce}){O(!1),ce!=="abort"&&ce!=="close"&&(!A||!F||(E(F),Re(A)))}function le({query:A,validResources:F,action:ce}){x(!1),ce!=="abort"&&ce!=="close"&&(Re(A),_.length!==F.length&&r?.({title:c("search.toasts.searchInput.title"),body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:c("search.toasts.searchInput.msgResourcesChangedDueToQuery")}),e.jsx("p",{children:c("search.toasts.searchInput.msgResourcesAmountChanged",{before:_.length,after:F.length})}),e.jsx("hr",{}),e.jsx(X,{onClick:()=>h(_),children:c("search.toasts.searchInput.buttonRevertSelection")})]}),variant:"info",delay:7e3}),h(F))}function Lt(A){Re(A)}function hs(A){A.preventDefault(),ye()}function ms(){const A=(_??[]).length,F=s.length===A||g.length===A?"all":null;return c("search.searchInput.buttonSelectedResources",{count:A,context:F})}return e.jsxs("search",{id:"fcs-query",children:[e.jsxs(q,{noValidate:!0,onSubmit:hs,children:[e.jsxs(Es,{size:l?void 0:"lg",hasValidation:!0,children:[e.jsx(X,{variant:"outline-secondary",type:"button",id:"fcs-search-query-suggestions-button","aria-label":c("search.searchInput.buttonOpenQuerySuggestions"),onClick:()=>O(!0),children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Qn},"aria-hidden":"true"})}),e.jsx(q.Control,{placeholder:"Elephant","aria-label":c("search.searchInput.inputQueryAriaLabel"),"aria-describedby":"fcs-search-input-button",className:"text-center search-query-input",disabled:o,"aria-disabled":o,value:ne,isInvalid:!!Fe,...Te?{as:ns,queryType:R,onChange:Lt}:{onChange:A=>Lt(A.target.value)}}),at&&e.jsx(X,{id:"fcs-search-input-query-builder-button",variant:"outline-secondary","aria-label":c("search.searchInput.buttonOpenQueryBuilderAriaLabel"),className:"border-end-0 d-none d-md-block",onClick:()=>{D(),x(!0)},children:e.jsx("i",{dangerouslySetInnerHTML:{__html:ut},"aria-hidden":"true"})}),e.jsx(Ce,{id:"fcs-search-input-enhanced-button",value:"enhance-query",type:"checkbox",checked:Te,onChange:()=>rt(A=>!A),variant:"outline-secondary","aria-label":c("search.searchInput.buttonEnhanceQueryAriaLabel",{context:Te?"enabled":"disabled"}),className:"d-flex align-items-center border-end-0",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Gn},"aria-hidden":"true"})}),e.jsxs(X,{variant:"outline-primary",type:"submit",id:"fcs-search-input-button",disabled:o||ne.trim().length===0,"aria-disabled":o,"aria-label":c("search.searchInput.buttonSearchAriaLabel"),children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Wn},"aria-hidden":"true",className:"d-inline d-md-none"}),e.jsx("span",{className:"d-none d-md-inline",children:c("search.searchInput.buttonSearch")})]}),e.jsx(q.Control.Feedback,{type:"invalid",children:Fe?.msg})]}),e.jsx("div",{id:"fcs-query-filters",className:"mt-2 mb-3 lh-lg text-center",children:e.jsx(z,{i18nKey:"search.searchInput.filtersSummary",components:[e.jsxs(re,{className:"d-inline-block",onSelect:S,"aria-disabled":o,"aria-label":c("search.searchInput.dropdownQueryTypeAriaLabel"),children:[e.jsxs(re.Toggle,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2 no-arrow",disabled:o,"aria-disabled":o,style:Je[R]?{"--color":Je[R].color}:{},children:[c(`queryTypes.${R}.nameShort`,{ns:"common",defaultValue:Je[R]?.searchLabel??R.toUpperCase()})," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:Ye},"aria-hidden":"true"})]}),e.jsx(re.Menu,{children:St.filter(A=>A.id==="cql"||A.id==="fcs"&&ze||A.id==="lex"&&_e).map(A=>e.jsx(re.Item,{as:"button",eventKey:A.id,onClick:F=>F.preventDefault(),style:{"--color":A.color,background:"color-mix(in srgb, var(--color) 50%, transparent)"},children:c(`queryTypes.${A.id}.nameLong`,{ns:"common",defaultValue:A.name})},A.id))})]}),e.jsxs(X,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2",disabled:o,"aria-disabled":o,onClick:()=>{b("resource"),w(!0)},children:[ms()," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:Ye},"aria-hidden":"true"})]}),e.jsxs(X,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2",disabled:o,"aria-disabled":o,onClick:()=>{b("institution"),w(!0)},children:[c("search.searchInput.buttonSelectedInstitutions",{count:Be})," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:Ye},"aria-hidden":"true"})]}),e.jsxs(X,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2",onClick:()=>k(!0),disabled:o,"aria-disabled":o,children:[st(V,n??{},{defaultAnyLanguage:c("languageCodeToName.any",{ns:"common"}),defaultUnknownLanguage:c("languageCodeToName.unknown",{ns:"common"})})," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:Ye},"aria-hidden":"true"})]}),e.jsx(q.Select,{size:"sm",className:"d-inline-block w-auto mx-1",onChange:K,value:N,"aria-label":c("search.searchInput.selectNumberOfSearchResultsAriaLabel"),disabled:o,"aria-disabled":o,children:We.map(A=>e.jsx("option",{value:A,children:A},A))})]})})]}),e.jsx(Hn,{languages:n,resources:s,searchLanguage:V,show:T,onModalClose:Y}),e.jsx(Vn,{resources:s,languages:n,availableResources:g,selectedResources:_??[],show:L,showGrouping:j,onModalClose:Q}),e.jsx(zn,{queryTypes:[R],show:y,onModalClose:he}),At.includes(R)&&v&&e.jsx(d.Suspense,{fallback:e.jsx(e.Fragment,{children:c("loading",{ns:"querybuilder",defaultValue:c("generic.loadingComponent",{ns:"common"})})}),children:e.jsx(Yn,{query:ne,queryType:R,resources:s,selectedResources:_,show:B,onModalClose:le})})]})}const Jn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots" viewBox="0 0 16 16">
  <path d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"/>
</svg>`;function Zn({searchId:s,resourceId:n,numberOfResults:t,pollDelay:r=1500}){const{t:a}=te(),i=ve(),l=Ft(),[o,c]=d.useState(!1),{isPending:u,mutate:f,reset:C}=qt({mutationFn:zs.bind(null,i,s,{resourceId:n,numberOfResults:t}),mutationKey:["search-result-load-more",s,n],onSuccess:async y=>{y!==void 0&&s!==y&&console.warn("SearchIDs should be the same?!",{searchId:s,searchIdNewButSame:y,resourceId:n}),await l.invalidateQueries({queryKey:["search-results",s,n]}),c(!0)}});r??=1500;const{data:m,isLoading:L,isFetching:w}=Ne({queryKey:["search-results",s,n],queryFn:$s.bind(null,i,s,n),enabled:o,refetchInterval(y){return y.state.data&&y.state.data.inProgress?r:!1}}),j=u||L||w,b=!!m&&!m.inProgress,T=j||o;o&&b&&(o&&c(!1),l.invalidateQueries({queryKey:["search-result-details",s,n]}));async function k(){C(),f()}return e.jsx(X,{className:"more-results-button",disabled:T,onClick:k,children:T?e.jsx(Vt,{animation:"border",className:"d-block"}):e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Jn}})," ",a("search.results.buttonLoadMore")]})})}const He=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link-45deg" viewBox="0 0 16 16">
  <path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1 1 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4 4 0 0 1-.128-1.287z"/>
  <path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243z"/>
</svg>`;function er(s,n=".."){const t=s.map(o=>o.split("/")),r=Math.max(...t.map(o=>o.length)),i=Array.from(Array(r).keys()).map(o=>new Set(t.map(c=>c.length>o?c[o]:!1)).size===1).reduce((o,c,u,f,C=n??"..")=>c?o&&o[o.length-1]!==C?o.concat([C]):o:o.concat([u]),[]);return s.map(o=>[o,o.split("/")]).map(([o,c])=>[o,i.map(u=>typeof u=="number"?c[u]:u).join("/").replace(/\/+$/,"")]).reduce((o,[c,u])=>o.set(c,u),new Map)}function tr(s,n){const t=s.filter(a=>a.spans.every(i=>i.text&&i.text.length===(i.range?.[1]??0)-(i.range?.[0]??0))||a.spans.every(i=>i.text&&i.text.length===(i.range?.[1]??0)-(i.range?.[0]??0)+1));return n?t.filter(a=>{const i=n.get(a.id);return i?!!["text","word"].includes(i.layerType.toLowerCase()):!0}).toSorted((a,i)=>{const l=n.get(a.id),o=n.get(i.id);if(l===void 0||o===void 0){if(l===o)return 0;if(l===void 0)return 1;if(o===void 0)return-1}const c=l.layerType.toLowerCase(),u=o.layerType.toLowerCase();if(c==="word"||u==="word"){if(c===u)return 0;if(c==="word")return-1;if(u==="word")return 1}if(l.qualifier!==null&&l.qualifier!==void 0||o.qualifier!==null&&o.qualifier!==void 0){if(l.qualifier!==null&&l.qualifier!==void 0&&o.qualifier!==null&&o.qualifier!==void 0)return 0;if(l.qualifier!==null&&l.qualifier!==void 0)return 1;if(o.qualifier!==null&&o.qualifier!==void 0)return-1}return 0}):t}function is({data:s,resource:n}){const t=d.useRef(null),r=n?.availableLayers?.reduce((i,l)=>i.set(l.resultId,l),new Map);function a(i){const l=i.map(m=>m.id),o=er(l),c=Math.max(...i.map(m=>m.spans.length)),f=tr(i,r)?.[0]?.id;i.sort((m,L)=>f===void 0?0:m.id===f?-1:L.id===f?1:0);const C=l.length>1;return e.jsxs(be,{hover:!0,responsive:!0,className:"mb-0 results-plain",style:{width:"unset"},children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[r!==void 0&&C&&e.jsx("th",{scope:"col",children:"Layer Type"}),C&&e.jsx("th",{scope:"col",children:"Layer Identifier"}),Array(c).fill(null).map((m,L)=>e.jsx("th",{scope:"col",children:"Token"},L))]})}),e.jsx("tbody",{children:i.map(m=>e.jsxs("tr",{className:["text-nowrap"].concat([m.id===f&&i.length>1?"table-primary":null]).filter(Boolean).join(" "),children:[r!==void 0&&C&&e.jsx("td",{scope:"row",className:"text-uppercase",children:r.get(m.id)?.layerType}),C&&e.jsx("td",{scope:"row",title:m.id,className:"border-end",children:o.get(m.id)}),m.spans.map((L,w)=>e.jsx("td",{children:L.hit?e.jsx("mark",{children:e.jsx("strong",{children:L.text})},w):L.text},L.range?.join("-")??w))]},m.id))})]})}return e.jsxs(e.Fragment,{children:[e.jsxs(be,{responsive:!0,striped:!0,className:"mb-0 results-plain",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Result with Annotation Layers"})]})}),e.jsx("tbody",{children:s.records.map((i,l)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"result-idx text-end text-muted d-none d-sm-table-cell",children:l+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[i.ref&&e.jsx("a",{href:i.ref,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:He}})})," ",i.pid&&e.jsx(we,{placement:"auto-start",container:t,delay:{show:250,hide:400},overlay:e.jsx(Ie,{id:`ttip-${i.pid}-${l}`,children:i.pid}),children:e.jsx(pe,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:a(i.adv)})]},`${i.pid??i.ref??s.resource.id}-${l}`))})]}),e.jsx("div",{ref:t,className:"tooltip-mounting-point"})]})}function os({data:s}){const n=d.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs(be,{hover:!0,responsive:!0,className:"mb-0 results-kwic",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Left Context"}),e.jsx("th",{scope:"col",children:"Hit"}),e.jsx("th",{scope:"col",children:"Right Context"})]})}),e.jsx("tbody",{children:s.records.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"result-idx text-end text-muted d-none d-sm-table-cell",children:r+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[t.ref&&e.jsx("a",{href:t.ref,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:He}})})," ",t.pid&&e.jsx(we,{placement:"auto-start",container:n,delay:{show:250,hide:400},overlay:e.jsx(Ie,{id:`ttip-${t.pid}-${r}`,children:t.pid}),children:e.jsx(pe,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:t.hits.left}),e.jsx("td",{children:t.hits.keyword&&e.jsx("mark",{children:e.jsx("strong",{children:t.hits.keyword})})}),e.jsx("td",{children:t.hits.right})]},`${t.pid??t.ref??s.resource.id}-${r}`))})]}),e.jsx("div",{ref:n,className:"tooltip-mounting-point"})]})}function ls({data:s}){const n=d.useRef(null);return e.jsxs("div",{className:"results-lexical-entry d-flex flex-column flex-wrap column-gap-2 row-gap-2",children:[s.records.map((t,r)=>e.jsx(H,{className:"flex-grow-1",children:e.jsxs(H.Body,{children:[e.jsx(H.Title,{children:t.lex.fields.filter(a=>a.type==="lemma").map(a=>a.values).flat(1).map(a=>e.jsx("span",{children:a.value}))}),e.jsxs(ke,{variant:"flush",children:[(t.lex.lang||t.lex.langUri)&&e.jsxs(ke.Item,{children:[e.jsx("strong",{children:"lang"}),": ",t.lex.lang," ",t.lex.langUri]}),t.lex.fields.filter(a=>a.type!=="lemma").map(a=>e.jsxs(ke.Item,{children:[e.jsx("strong",{children:a.type}),":",a.values.map((i,l)=>e.jsx("span",{className:"ms-2 lex-value",children:i.value},l))]},a.type))]}),e.jsx(H.Link,{children:t.ref&&e.jsxs("a",{href:t.ref,className:"matomo_link",target:"_blank",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:He}})," Original results ..."]})}),e.jsx(H.Link,{children:t.pid&&e.jsx(we,{placement:"auto-start",container:n,delay:{show:250,hide:400},overlay:e.jsx(Ie,{id:`ttip-${t.pid}-${r}`,children:t.pid}),children:e.jsx(pe,{bg:"secondary",className:"pid-badge",children:"PID"})})})]})},`${t.pid??t.ref??s.resource.id}-${r}`)),e.jsx("div",{ref:n,className:"tooltip-mounting-point"})]})}function cs({data:s}){const n=d.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs(be,{hover:!0,responsive:!0,className:"mb-0 results-lex-plain",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Result with Hit"})]})}),e.jsx("tbody",{children:s.records.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"result-idx text-end text-muted d-none d-sm-table-cell",children:r+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[t.ref&&e.jsx("a",{href:t.ref,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:He}})})," ",t.pid&&e.jsx(we,{placement:"auto-start",container:n,delay:{show:250,hide:400},overlay:e.jsx(Ie,{id:`ttip-${t.pid}-${r}`,children:t.pid}),children:e.jsx(pe,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:t.hits.fragments.map((a,i)=>a.hit&&!a.hitKind?e.jsx("mark",{children:e.jsx("strong",{children:a.text})},i):a.hit&&a.hitKind?e.jsx("span",{className:`lex-hitkind-${a.hitKind}`,title:`Annotated as "${a.hitKind.split("-").slice(1).join("-")}"`,children:a.text},i):e.jsx("span",{children:a.text},i))})]},`${t.pid??t.ref??s.resource.id}-${r}`))})]}),e.jsx("div",{ref:n,className:"tooltip-mounting-point"})]})}function us({data:s}){const n=d.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs(be,{hover:!0,responsive:!0,className:"mb-0 results-plain",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Result with Hit"})]})}),e.jsx("tbody",{children:s.records.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"result-idx text-end text-muted d-none d-sm-table-cell",children:r+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[t.ref&&e.jsx("a",{href:t.ref,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:He}})})," ",t.pid&&e.jsx(we,{placement:"auto-start",container:n,delay:{show:250,hide:400},overlay:e.jsx(Ie,{id:`ttip-${t.pid}-${r}`,children:t.pid}),children:e.jsx(pe,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:t.hits.fragments.map((a,i)=>a.hit&&!a.hitKind?e.jsx("mark",{children:e.jsx("strong",{children:a.text})},i):e.jsx("span",{children:a.text},i))})]},`${t.pid??t.ref??s.resource.id}-${r}`))})]}),e.jsx("div",{ref:n,className:"tooltip-mounting-point"})]})}const sr=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
  <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"/>
  <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"/>
</svg>`,nr=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-envelope-arrow-up" viewBox="0 0 16 16">
  <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4.5a.5.5 0 0 1-1 0V5.383l-7 4.2-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h5.5a.5.5 0 0 1 0 1H2a2 2 0 0 1-2-1.99zm1 7.105 4.708-2.897L1 5.383zM1 4v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1"/>
  <path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m.354-5.354 1.25 1.25a.5.5 0 0 1-.708.708L13 12.207V14a.5.5 0 0 1-1 0v-1.717l-.28.305a.5.5 0 0 1-.737-.676l1.149-1.25a.5.5 0 0 1 .722-.016"/>
</svg>`,ds=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
  <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/>
</svg>`;function rr({show:s,searchId:n,resourceId:t,result:r,viewMode:a,showDiagnostics:i,onModalClose:l}){const o=ve(),{t:c}=te(),u=ge(g=>g.locale),{languages:f,resources:C,weblichtLanguages:m}=jt(),{numberOfResults:L,queryType:w,language:j,languageFilter:b}=wt(),[T,k]=d.useState(u);d.useEffect(()=>{u&&k(u)},[u]);const y=new Intl.DisplayNames([u,"en"],{type:"language"}),[O,B]=d.useState(i);d.useEffect(()=>B(i),[i]);const[x,v]=d.useState(a);d.useEffect(()=>v(a),[a]);const D=De(r.resource),V=r.exception||r.diagnostics?.filter(g=>g.uri!==je).length>0;function I(){return!r||r.nextRecordPosition===-1||r.numberOfRecords===-1?!1:(r.numberOfRecords===r.records.length,!0)}let M=null,$=!1;if(!m.includes(j)){if(j===me)if(r.resource.languages&&r.resource.languages.length===1)M=r.resource.languages[0];else{const g=[...new Set(r.records.map(p=>p.lang).filter(p=>p!==null))];g.length===1&&(M=g[0])}M||(console.warn("Cannot use WebLicht: unsupported language",{language:j,languageFilter:b}),$=!0)}function R(g){v(g.target.value)}function E(){if(!r)return null;if(x==="annotation-layers"&&r.hasAdvResults){const g=et(C,p=>p.id===r.id);return e.jsx(is,{data:r,resource:g})}return x==="kwic"&&(w!=="lex"||!r.isLexHits)?e.jsx(os,{data:r}):x==="lexical-entry"&&r.hasLexResults?e.jsx(ls,{data:r}):w==="lex"&&r.isLexHits?e.jsx(cs,{data:r}):e.jsx(us,{data:r})}return e.jsxs(J,{show:s,onHide:()=>l(),size:"xl",fullscreen:"lg-down",centered:!0,className:"resource-search-result-modal",children:[e.jsx(J.Header,{closeButton:!0,children:e.jsx(J.Title,{children:U(r.resource.title,T)})}),e.jsxs(J.Body,{className:"resource-info",children:[e.jsxs("dl",{className:"mb-0","aria-label":c("search.results.resourceInfo.infoTableAriaLabel"),children:[e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:nt}})," ",c("search.results.resourceInfo.labelInstitution")]}),e.jsx("dd",{className:"mb-0",children:U(r.resource.institution,T)}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:ds}})," ",c("search.results.resourceInfo.labelDescription")]}),U(r.resource.description,T)&&e.jsxs(e.Fragment,{children:[e.jsx("dd",{className:"mb-0",children:U(r.resource.description,T)}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ue}})," ",c("search.results.resourceInfo.labelLanguages")]})]}),e.jsx("dd",{className:"mb-0",children:r.resource.languages.map(f?g=>st(g,f,{defaultAnyLanguage:c("languageCodeToName.any",{ns:"common"}),defaultUnknownLanguage:c("languageCodeToName.unknown",{ns:"common"})}):g=>g).toSorted().join(", ")}),D&&D.length>1&&e.jsx(Oe,{type:"radio",name:`${r.resource.id}-result-modal-info-languages`,defaultValue:T,onChange:g=>k(g),className:"mt-2 mb-3",children:D.toSorted().map(g=>e.jsxs(Ce,{variant:"outline-secondary",size:"sm",id:`${r.resource.id}-result-modal-info-languages-${g}`,value:g,children:[y.of(g)," ",e.jsx("sup",{children:g})]},g))}),e.jsx("dt",{children:c("search.results.resourceInfo.labelPID")}),e.jsx("dd",{children:r.resource.handle})]}),r.resource.landingPage&&e.jsxs("a",{href:r.resource.landingPage,className:"matomo_link",target:"_blank",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:vt}})," ",c("search.results.resourceInfo.moreInformation")]}),e.jsx("hr",{}),e.jsxs(Z,{className:"row-gap-2",children:[e.jsx(P,{lg:"auto",md:3,sm:6,children:e.jsx(xe,{label:c("search.results.displayOptions.viewModeLabel"),controlId:"results-view-mode",children:e.jsxs(q.Select,{value:x,onChange:R,children:[e.jsx("option",{value:"plain",children:c("search.results.displayOptions.viewModeOptions.plain")}),(w!=="lex"||!r.isLexHits)&&e.jsx("option",{value:"kwic",children:c("search.results.displayOptions.viewModeOptions.kwic")}),w==="fcs"&&e.jsx("option",{value:"annotation-layers",children:c("search.results.displayOptions.viewModeOptions.annotation-layers")}),w==="lex"&&e.jsx("option",{value:"lexical-entry",children:c("search.results.displayOptions.viewModeOptions.lexical-entry")})]})})}),e.jsx(P,{lg:3,md:3,sm:6,className:"align-content-center",children:e.jsx(q.Check,{disabled:!V,checked:O,onChange:()=>B(g=>!g),id:"results-modal-view-warnings-errors",label:c("search.results.displayOptions.optionShowWarningsErrors")})}),e.jsxs(P,{lg:"auto",md:6,sm:6,className:"d-flex flex-grow-1 column-gap-3 align-items-center justify-content-end",children:[e.jsxs(re,{children:[e.jsxs(re.Toggle,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:sr}})," ",c("search.results.buttonDownload")]}),e.jsx(re.Menu,{children:Fn.map(({id:g,label:p})=>e.jsx(re.Item,{href:Qs(o,n,t,g,j,b),className:"matomo_download",children:e.jsx(z,{i18nKey:"search.results.msgButtonDownloadOption",values:{label:c(`downloadFormats.${g}.name`,{ns:"common",defaultValue:p})}})},g))})]}),e.jsxs(X,{disabled:$,"aria-disabled":$,href:Gs(o,n,t,M,j,b),className:"matomo_link",target:"_blank",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:nr}})," ",c("search.results.buttonSendToWeblicht")]})]})]}),e.jsx("hr",{}),e.jsx("p",{children:e.jsx(z,{i18nKey:"search.results.msgShowingXresults",values:{count:r.records.length,context:I()?"hasmore":null,total:r.numberOfRecords}})}),E()]}),O&&V&&e.jsxs(J.Body,{className:"border-top",children:[r.exception&&e.jsxs(ie,{variant:"danger","aria-label":c("search.results.diagnostics.alertAriaLabel"),children:[e.jsxs(ie.Heading,{style:{fontSize:"1rem"},children:[e.jsx("span",{className:"text-uppercase",children:c("search.results.diagnostics.titleException")})," ",e.jsx("span",{"aria-label":c("search.results.diagnostics.msgAriaLabel"),children:r.exception.message})]}),r.exception.cause&&e.jsx("p",{className:"mb-0 small",children:c("search.results.diagnostics.msgCause",{cause:r.exception.cause})}),r.exception.klass&&e.jsx("p",{className:"mb-0 small",children:e.jsx(z,{i18nKey:"search.results.diagnostics.msgCausedBy",values:{class:r.exception.klass}})})]}),r.diagnostics.filter(g=>g.uri!==je).map(g=>e.jsxs(ie,{variant:"warning",children:[e.jsx(ie.Heading,{style:{fontSize:"1rem"},children:g.message}),g.diagnostic&&e.jsx("p",{className:"mb-0 small",children:c("search.results.diagnostics.msgDiagnosticDetails",{details:g.diagnostic})}),e.jsx("p",{className:"mb-0 small",children:e.jsx(z,{i18nKey:"search.results.diagnostics.msgDiagnosticType",values:{uri:g.uri}})})]},`${g.uri}-${g.message}-${g.diagnostic}`))]}),I()&&e.jsx(J.Footer,{className:"justify-content-center border-top py-2",children:e.jsx(Zn,{searchId:n,resourceId:t,numberOfResults:L})})]})}function ar({searchId:s,resourceId:n,resultInfo:t,viewMode:r,showResourceDetails:a,showDiagnostics:i}){const l=ve(),{t:o}=te(),c=ge(g=>g.locale),{languages:u,resources:f}=jt(),{queryType:C}=wt(),[m,L]=d.useState(c);d.useEffect(()=>{c&&L(c)},[c]);const w=new Intl.DisplayNames([c,"en"],{type:"language"}),j=d.useId(),[b,T]=d.useState(!0),[k,y]=d.useState(!1),O=t.inProgress,B=t.numberOfRecordsLoaded>0,x=t.exception||t.diagnostics?.filter(g=>g.uri!==je).length>0,{data:v,isLoading:D,isError:V}=Ne({queryKey:["search-result-details",s,n],queryFn:Ks.bind(null,l,s,n),enabled:!O}),I=v?De(v.resource):[];if(O||!B&&(i&&!x||!i)||!v)return null;function M(){y(!0)}function $(){y(!1)}function R(){return v?v.numberOfRecords===-1?v.records.length:v.numberOfRecords===v.records.length&&v.nextRecordPosition===-1?`${v.records.length} / ${v.numberOfRecords}?`:`${v.records.length} / ${v.numberOfRecords}`:null}function E(){if(!v)return null;if(r==="annotation-layers"&&v.hasAdvResults){const g=et(f,p=>p.id===v.id);return e.jsx(is,{data:v,resource:g})}return r==="kwic"&&(C!=="lex"||!v.isLexHits)?e.jsx(os,{data:v}):r==="lexical-entry"&&v.hasLexResults?e.jsx(ls,{data:v}):C==="lex"&&v.isLexHits?e.jsx(cs,{data:v}):e.jsx(us,{data:v})}return e.jsxs(e.Fragment,{children:[e.jsxs(H,{className:"my-1 resource-search-result",role:"group","aria-label":o("search.results.resultResourceAriaLabel",{title:v.resource.title}),children:[e.jsxs(H.Header,{className:"d-flex accordion",children:[e.jsxs("button",{type:"button",onClick:()=>T(g=>!g),"aria-controls":j,"aria-expanded":b,className:`me-3 w-auto flex-grow-1 d-block text-start collapse-toggle-btn ${b?"":"collapsed"}`,children:[e.jsx(pe,{bg:"",className:"text-bg-light border me-2 user-select-text","aria-label":o("search.results.resultCountAriaLabel"),children:R()}),e.jsx("span",{"aria-label":o("search.results.resultResourceTitleAriaLabel"),className:"user-select-text",children:U(v.resource.title,m)}),e.jsx("small",{className:"text-muted user-select-text","aria-label":o("search.results.resultResourceInstitutionAriaLabel"),children:U(v.resource.institution,m)})]}),e.jsx("div",{className:"d-inline-block ms-auto",children:e.jsxs(X,{size:"sm",onClick:M,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Qt}})," View"]})})]}),e.jsx(zt,{in:b,children:e.jsxs("div",{id:j,children:[a&&e.jsxs(H.Body,{className:"border-bottom resource-info",children:[e.jsxs("dl",{className:"mb-0","aria-label":o("search.results.resourceInfo.infoTableAriaLabel"),children:[e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:nt}})," ",o("search.results.resourceInfo.labelInstitution")]}),e.jsx("dd",{className:"mb-0",children:U(v.resource.institution,m)}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:ds}})," ",o("search.results.resourceInfo.labelDescription")]}),U(v.resource.description,m)&&e.jsxs(e.Fragment,{children:[e.jsx("dd",{className:"mb-0",children:U(v.resource.description,m)}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ue}})," ",o("search.results.resourceInfo.labelLanguages")]})]}),e.jsx("dd",{className:"mb-0",children:v.resource.languages.map(u?g=>st(g,u,{defaultAnyLanguage:o("languageCodeToName.any",{ns:"common"}),defaultUnknownLanguage:o("languageCodeToName.unknown",{ns:"common"})}):g=>g).toSorted().join(", ")})]}),I&&I.length>1&&e.jsx(Oe,{type:"radio",name:`${v.resource.id}-result-info-languages`,defaultValue:m,onChange:g=>L(g),className:"mt-2",children:I.toSorted().map(g=>e.jsxs(Ce,{variant:"outline-secondary",size:"sm",id:`${v.resource.id}-result-info-languages-${g}`,value:g,children:[w.of(g)," ",e.jsx("sup",{children:g})]},g))})]}),B&&e.jsx(H.Body,{children:E()}),i&&x&&e.jsxs(H.Body,{className:B?"border-top":"",children:[v.exception&&e.jsxs(ie,{variant:"danger","aria-label":o("search.results.diagnostics.alertAriaLabel"),children:[e.jsxs(ie.Heading,{style:{fontSize:"1rem"},children:[e.jsx("span",{className:"text-uppercase",children:o("search.results.diagnostics.titleException")})," ",e.jsx("span",{"aria-label":o("search.results.diagnostics.msgAriaLabel"),children:v.exception.message})]}),v.exception.cause&&e.jsx("p",{className:"mb-0 small",children:o("search.results.diagnostics.msgCause",{cause:v.exception.cause})}),v.exception.klass&&e.jsx("p",{className:"mb-0 small",children:e.jsx(z,{i18nKey:"search.results.diagnostics.msgCausedBy",values:{class:v.exception.klass}})})]}),v.diagnostics.filter(g=>g.uri!==je).map(g=>e.jsxs(ie,{variant:"warning",children:[e.jsx(ie.Heading,{style:{fontSize:"1rem"},children:g.message}),g.diagnostic&&e.jsx("p",{className:"mb-0 small",children:o("search.results.diagnostics.msgDiagnosticDetails",{details:g.diagnostic})}),e.jsx("p",{className:"mb-0 small",children:e.jsx(z,{i18nKey:"search.results.diagnostics.msgDiagnosticType",values:{uri:g.uri}})})]},`${g.uri}-${g.message}-${g.diagnostic}`))]})]})})]}),e.jsx(rr,{show:k,searchId:s,resourceId:n,result:v,viewMode:r,showDiagnostics:i,onModalClose:$})]})}const ir="plain",or="lexical-entry",lr="plain",cr="default",ur={default:()=>()=>0,"title-up":s=>(n,t)=>{const r=ee.getState().locale,a=U(s.get(n.id)?.title??null,r)??"",i=U(s.get(t.id)?.title??null,r)??"";return a.localeCompare(i)},"title-down":s=>(n,t)=>{const r=ee.getState().locale,a=U(s.get(n.id)?.title??null,r)??"",i=U(s.get(t.id)?.title??null,r)??"";return-a.localeCompare(i)},"result-count-total-up":()=>(s,n)=>{const t=s.numberOfRecords!==-1?s.numberOfRecords:s.numberOfRecordsLoaded,r=n.numberOfRecords!==-1?n.numberOfRecords:n.numberOfRecordsLoaded;return t-r},"result-count-total-down":()=>(s,n)=>{const t=s.numberOfRecords!==-1?s.numberOfRecords:s.numberOfRecordsLoaded;return(n.numberOfRecords!==-1?n.numberOfRecords:n.numberOfRecordsLoaded)-t}},Ot=1500;function dr({searchId:s,pollDelay:n=Ot}){const{t}=te(),r=ve(),{resources:a}=jt(),{query:i,queryType:l,resourceIDs:o}=wt(),[c,u]=d.useState(l==="lex"?or:l==="fcs"?lr:ir),[f,C]=d.useState(cr),[m,L]=d.useState(""),[w,j]=d.useState(!1),[b,T]=d.useState(!1),k=d.useMemo(()=>{const h=new Map;return a?.forEach(N=>{h.set(N.id,N)}),ur[f](h)},[f,a]);n??=Ot;const{data:y}=Ne({queryKey:["search-results",s],queryFn:Vs.bind(null,r,s??""),enabled:!!s,refetchInterval(h){return h.state.data&&h.state.data.inProgress>0?n:!1}}),O=d.useMemo(()=>y?.results.toSorted(k)||[],[y,k]),B=l==="lex"&&y?.results.every(h=>h.numberOfRecords<=0||h.isLexHits===!0),x=o.length,v=y?.inProgress??x,D=d.useMemo(()=>y?.results.filter(h=>(h.numberOfRecords!==-1?h.numberOfRecords:h.numberOfRecordsLoaded)>0).length??0,[y]),V=d.useMemo(()=>y?.results.filter(h=>!h.inProgress&&(h.numberOfRecords!==-1?h.numberOfRecords:h.numberOfRecordsLoaded)>0&&h.diagnostics.filter(N=>N.uri!==je).length>0).length??0,[y]),I=d.useMemo(()=>y?.results.filter(h=>!h.inProgress&&(h.numberOfRecords!==-1?h.numberOfRecords:h.numberOfRecordsLoaded)<=0&&h.diagnostics.filter(N=>N.uri!==je).length===0&&h.exception===null).length??0,[y]),M=d.useMemo(()=>y?.results.filter(h=>!h.inProgress&&(h.numberOfRecords!==-1?h.numberOfRecords:h.numberOfRecordsLoaded)<=0&&(h.diagnostics.filter(N=>N.uri!==je).length>0||h.exception!==null)).length??0,[y]),$=d.useMemo(()=>y?.results.filter(h=>!h.inProgress&&h.numberOfRecords<=0&&h.exception!==null).length??0,[y]),R=d.useMemo(()=>y?.results.filter(h=>!h.inProgress&&(h.numberOfRecords!==-1?h.numberOfRecords:h.numberOfRecordsLoaded)<=0&&h.diagnostics.filter(N=>N.uri!==je).length>0&&h.exception===null).length??0,[y]),E=d.useMemo(()=>y?.results.map(h=>h.numberOfRecords!==-1?h.numberOfRecords:h.numberOfRecordsLoaded).reduce((h,N)=>h+N,0)??0,[y]),g=d.useMemo(()=>y?.results.map(h=>h.numberOfRecordsLoaded).reduce((h,N)=>h+N,0)??0,[y]);{const[h,N]=d.useState(!1);d.useEffect(()=>{y&&v===0&&(h||(N(!0),Wt(i,l,g)))},[y,v,i,l,s,h,g])}function p(h){u(h.target.value)}function _(h){C(h.target.value)}return e.jsxs("div",{id:"search-results",className:"mt-2 mb-4",children:[e.jsx(we,{placement:"auto",overlay:e.jsxs(it,{id:"search-progress-information-popover",children:[e.jsx(it.Header,{children:t("search.results.progressPopover.title")}),e.jsxs(it.Body,{style:{textIndent:"2rem hanging"},children:[e.jsx("div",{children:e.jsx(z,{i18nKey:"search.results.progressPopover.numResourcesRequested",count:x})}),v>0&&e.jsx("div",{children:e.jsx(z,{i18nKey:"search.results.progressPopover.numResourcesRequestedPending",count:v})}),e.jsx("hr",{className:"mt-2 mb-1"}),e.jsx("div",{children:e.jsx(z,{i18nKey:"search.results.progressPopover.numResourcesWithoutResults",count:I+M})}),e.jsx("div",{children:e.jsx(z,{i18nKey:"search.results.progressPopover.numResourcesWithoutResultsOK",count:I})}),R>0&&e.jsx("div",{children:e.jsx(z,{i18nKey:"search.results.progressPopover.numResourcesWithoutResultsWarnings",count:R})}),$>0&&e.jsx("div",{children:e.jsx(z,{i18nKey:"search.results.progressPopover.numResourcesWithoutResultsErrors",count:$})}),e.jsx("hr",{className:"mt-2 mb-1"}),e.jsx("div",{children:e.jsx(z,{i18nKey:"search.results.progressPopover.numResourcesWithResults",count:D})}),V>0&&e.jsx("div",{children:e.jsx(z,{i18nKey:"search.results.progressPopover.numResourcesWithResultsWarnings",count:V})}),e.jsx("hr",{className:"mt-2 mb-0"}),e.jsx("hr",{className:"mt-1 mb-1"}),e.jsx("div",{children:e.jsx(z,{i18nKey:"search.results.progressPopover.numResourcesWithResultsTotal",count:g,values:{available:E}})})]})]}),children:e.jsxs($e,{className:"mb-3",children:[e.jsx($e,{variant:"success",now:D,max:x,label:e.jsx("span",{children:t("search.results.progressBar.numWithResults",{count:D})}),"aria-label":t("search.results.progressBar.numWithResultsAriaLabel")}),e.jsx($e,{variant:"secondary",now:I+M,max:x,label:e.jsx("span",{children:t("search.results.progressBar.numWithResults",{count:I+M})}),"aria-label":t("search.results.progressBar.numWithoutResultsAriaLabel")}),e.jsx($e,{striped:!0,animated:!0,now:v,max:x,label:e.jsx("span",{children:t("search.results.progressBar.numResultsPending",{count:v})}),"aria-label":t("search.results.progressBar.numResultsPendingAriaLabel")})]})}),e.jsx(H,{className:"mb-2",role:"group","aria-label":t("search.results.displayOptions.cardAriaLabel"),children:e.jsx(H.Body,{children:e.jsxs(Z,{className:"row-gap-2",children:[e.jsx(P,{lg:"auto",md:6,sm:6,children:e.jsx(xe,{label:t("search.results.displayOptions.viewModeLabel"),controlId:"results-view-mode",children:e.jsxs(q.Select,{value:c,onChange:p,children:[e.jsx("option",{value:"plain",children:t("search.results.displayOptions.viewModeOptions.plain")}),(l!=="lex"||!B)&&e.jsx("option",{value:"kwic",children:t("search.results.displayOptions.viewModeOptions.kwic")}),l==="fcs"&&e.jsx("option",{value:"annotation-layers",children:t("search.results.displayOptions.viewModeOptions.annotation-layers")}),l==="lex"&&e.jsx("option",{value:"lexical-entry",children:t("search.results.displayOptions.viewModeOptions.lexical-entry")})]})})}),e.jsx(P,{lg:"auto",md:6,sm:6,children:e.jsx(xe,{label:t("search.results.displayOptions.sortingLabel"),controlId:"results-sorting",children:e.jsxs(q.Select,{value:f,onChange:_,children:[e.jsx("option",{value:"default",children:t("search.results.displayOptions.sortingOptions.default")}),e.jsx("option",{value:"title-up",children:t("search.results.displayOptions.sortingOptions.title-up")}),e.jsx("option",{value:"title-down",children:t("search.results.displayOptions.sortingOptions.title-down")}),e.jsx("option",{value:"result-count-total-up",children:t("search.results.displayOptions.sortingOptions.result-count-total-up")}),e.jsx("option",{value:"result-count-total-down",children:t("search.results.displayOptions.sortingOptions.result-count-total-down")})]})})}),e.jsx(P,{lg:"auto",md:12,sm:6,className:"flex-fill order-xl-4",children:e.jsx(xe,{label:t("search.results.displayOptions.resultFilterQueryLabel"),controlId:"result-filter",children:e.jsx(rs,{disabled:f!=="default"||!0,value:m,onChange:h=>L(h)})})}),e.jsxs(P,{lg:"auto",md:12,sm:12,className:"align-content-center order-xl-3",children:[e.jsx(q.Check,{checked:w,onChange:()=>j(h=>!h),id:"results-view-resource-details",label:t("search.results.displayOptions.optionShowResultDetails")}),e.jsx(q.Check,{checked:b,onChange:()=>T(h=>!h),id:"results-view-warnings-errors",label:t("search.results.displayOptions.optionShowWarningsErrors")})]})]})})}),s&&y&&O.map(h=>e.jsx(ar,{searchId:s,resourceId:h.id,resultInfo:h,viewMode:c,showResourceDetails:w,showDiagnostics:b},`${s}-${h.id}`))]})}const hr=""+new URL("assets/logo-fcs-dark.png",import.meta.url).href,Ut=""+new URL("assets/logo-fcs.png",import.meta.url).href;function mr(){const s=ve(),{t:n}=te(),[t,r]=Me(),[a,i]=d.useState([]),[l,o]=d.useState({}),[c,u]=d.useState([]),[f,C]=d.useState(null),[m,L]=d.useState(!1),[w,j]=d.useState(null),[b,T]=d.useState([]),k=W.getState().appTitleHead,y={consortia:t.get(Se)},{data:O,isLoading:B,isError:x}=Ne({queryKey:["init"],queryFn:Hs.bind(null,s,y)});d.useEffect(()=>{if(!O)return;const R=Xt(O.resources);o(O.languages),u(O.weblichtLanguages),i(R),C(fe(R))},[O]),d.useEffect(()=>{if(!a||a.length===0)return;const R=t.get("x-aggregation-context");if(R){try{const E=JSON.parse(R),{selected:g,unavailable:p}=Cn(a,E);g.length>0&&(C(g),T(_=>[..._,{title:n("search.toasts.resourceSelection.title"),body:e.jsxs(e.Fragment,{children:[n("search.toasts.resourceSelection.msgPreselectedResources",{count:g.length}),e.jsx("br",{}),e.jsx("ul",{className:"ps-3",children:g.map(h=>e.jsx("li",{style:{wordBreak:"break-all",fontSize:"0.7rem"},children:h}))})]}),variant:"success"}])),p.length>0&&T(_=>[..._,{title:n("search.toasts.resourceSelection.title"),body:e.jsxs(e.Fragment,{children:[n("search.toasts.resourceSelection.msgUnableToSelectResources",{count:p.length}),e.jsx("br",{}),e.jsx("ul",{className:"ps-3",children:p.map(h=>e.jsx("li",{style:{wordBreak:"break-all",fontSize:"0.7rem"},children:h}))})]}),variant:"warning"}])}catch(E){console.error('Error trying to parse "x-aggregation-context" search parameter!',{aggregationContext:R},E),E instanceof Error&&T(g=>[...g,{title:n("search.toasts.resourceSelection.title"),body:e.jsxs(e.Fragment,{children:[n("search.toasts.resourceSelection.msgErrorUnableToSelectResources",{error:E.name}),e.jsx("br",{}),e.jsx("small",{children:E.message})]}),variant:"error"}])}t.delete("x-aggregation-context"),r(t)}},[a,t,r,n]);const v=B||x,{mutate:D,data:V,isPending:I}=qt({mutationKey:["search"],mutationFn:({query:R,queryType:E,language:g,numberOfResults:p,resourceIDs:_})=>Bs(s,{query:R,queryType:E,language:g,numberOfResults:p.toString(),resourceIds:_})});function M(R){C(R.resourceIDs),j(R),L(!0),Wt(R.query,R.queryType),D(R)}function $(R){T(E=>[...E,R])}return e.jsxs(e.Fragment,{children:[e.jsx(Pe,{children:e.jsx("title",{children:k})}),e.jsxs(se,{id:"search",children:[e.jsx("div",{"aria-live":"polite","aria-atomic":"true",className:"bg-dark position-relative",children:e.jsx(As,{position:"top-end",className:"mt-2",style:{zIndex:100},children:b.map((R,E)=>e.jsxs(ot,{bg:R.variant,onClose:()=>T(g=>g.filter(p=>p!==R)),delay:R.delay??5e3,autohide:!0,children:[e.jsx(ot.Header,{closeButton:!0,children:e.jsx("strong",{className:"me-auto",children:R.title})}),e.jsx(ot.Body,{children:R.body})]},E))})}),!m&&e.jsx(Z,{children:e.jsx(P,{className:"text-center",children:e.jsxs("picture",{children:[e.jsx("source",{srcSet:Ut,media:"(prefers-color-scheme: light)"}),e.jsx("source",{srcSet:hr,media:"(prefers-color-scheme: dark)"}),e.jsx("img",{src:Ut,className:"logo",alt:"FCS logo"})]})})}),e.jsx(Z,{className:"mt-3",children:e.jsx(P,{children:e.jsx(Xn,{resources:a,languages:l,availableResources:null,selectedResources:f,onSearch:M,onShowToast:$,hasSearch:m,disabled:v})})}),!m&&e.jsx(Z,{className:"mt-3",children:e.jsxs(P,{children:[e.jsx("p",{children:e.jsx(z,{i18nKey:"search.intro.textGeneral"})}),e.jsx("p",{children:e.jsx(z,{i18nKey:"search.intro.textLearnMore",components:[e.jsxs("a",{href:n("search.intro.url"),children:["page ",e.jsx("em",{children:"Content Search"})," at CLARIN.eu"]})]})})]})}),m&&I&&e.jsx(Z,{children:e.jsx(P,{className:"text-center my-5",children:e.jsx(Vt,{animation:"border"})})}),w&&V&&e.jsx(jn,{resources:a,languages:l,weblichtLanguages:c,children:e.jsx(yn,{...w,children:e.jsx(dr,{searchId:V})})})]})]})}function gr(){const s=Ht(),n=tt();return d.useCallback((r,a,i)=>{const l=ys(r,a);s({pathname:l,search:n},i)},[s,n])}function pr(){const s=d.useContext(ws),n=ft(),t=s.matches.map(a=>a.route),r=Ss(t,n);return r!==null&&r.length>0?r[0]:null}const pt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
  <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"/>
  <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7"/>
</svg>`,Xe="resource";function fr({validatorUrl:s}){const n=ve(),{t}=te(),r=ge(p=>p.locale),[a,i]=d.useState(r),l=new Intl.DisplayNames([r,"en"],{type:"language"}),[o,c]=Me(),[u,f]=d.useState([]),[C,m]=d.useState(""),[L,w]=d.useState(o.get(Xe)),j=L?et(u,p=>p.id===L):void 0,b={consortia:o.get(Se)},{data:T,isPending:k,isError:y,error:O}=Ne({queryKey:["resources"],queryFn:Fs.bind(null,n,b)});d.useEffect(()=>{if(!T)return;const p=Xt(T);f(p)},[T]),d.useEffect(()=>{const p=o.get(Xe);p&&p!==L&&w(p)},[o,L]);const x=u.map(p=>De(p)).flat().reduce((p,_)=>p.set(_,(p.get(_)??0)+1),new Map),v=u.toSorted(es["title-up"]),{resources:D,matches:V}=as(C,v,a,["title","institution"]);function I(p){if(!p)return;const _=p;w(_),o.set(Xe,_),c(o)}function M(p,_,h=0){const N=_?.get(p.id)??new Map,G=e.jsx(re.Item,{eventKey:p.id,style:{paddingInlineStart:`${1+h*1}em`},children:e.jsx(oe.Highlight,{text:U(p.title,a)??"",ranges:N.get("title")??null})},p.id);return p.subResources&&p.subResources.length>0?e.jsxs(d.Fragment,{children:[G,p.subResources.map(ne=>M(ne,V,h+1))]},p.id):G}function $(p,_,h="–"){if(_===null)return null;const N=kn(_,r);return e.jsxs(H,{className:"my-2",children:[e.jsx(H.Header,{children:t(`statistics.resources.cardHeader${p[0].toUpperCase()}${p.slice(1)}`)}),typeof _=="string"?e.jsx(H.Body,{children:_||h}):e.jsx(ke,{className:"list-group-flush",children:Object.entries(_).map(([G,ne])=>e.jsxs(ke.Item,{children:[e.jsxs(pe,{bg:N===G?"primary":"secondary",className:"me-2",children:[l.of(G)," ",e.jsx("sup",{children:G})]})," ",ne||h]},G))})]})}function R(p){if(!u||!p)return null;const _=p.rootResourceId===null?p:et(u,N=>N.id===p.rootResourceId);if(!_)return null;function h(N){return e.jsxs("li",{children:[N.id===p.id?e.jsx("strong",{children:N.handle}):e.jsxs(e.Fragment,{children:[N.handle,e.jsx("a",{href:`?${Xe}=${encodeURIComponent(N.id)}`,onClick:G=>{G.preventDefault(),I(N.id)},children:e.jsx("i",{dangerouslySetInnerHTML:{__html:pt},className:"align-baseline ms-2 me-1"})})]})," ","– ",U(N.title,r),N.subResources.length>0&&e.jsx("ul",{children:N.subResources.map(G=>h(G))})]},N.id)}return e.jsx("ul",{children:h(_)})}const E=j&&(j.availableDataViews?.find(p=>p.mimeType==="application/x-clarin-fcs-lex+xml")||j.availableLexFields&&j.availableLexFields.length>0),g=j&&(j.availableDataViews?.find(p=>p.mimeType==="application/x-clarin-fcs-adv+xml")||j.availableLayers&&j.availableLayers.length>0);return e.jsxs(se,{className:"d-grid gap-2 mt-3",children:[(k||y)&&e.jsx(Z,{children:e.jsxs(P,{children:[k?t("statistics.loading"):null,e.jsx("br",{}),y?O.message:null]})}),e.jsx(q,{onSubmit:p=>p.preventDefault(),children:e.jsxs(re,{onSelect:I,children:[e.jsxs(re.Toggle,{variant:"outline-dark",children:[t("statistics.resources.dropdownLabel",{count:u.length})," "]}),e.jsxs(re.Menu,{children:[e.jsxs(re.ItemText,{children:[e.jsx(q.Control,{value:C,onChange:p=>m(p.target.value)}),x.size>1&&e.jsxs(q.Group,{as:Z,controlId:"resource-info-language",className:"mt-2",children:[e.jsx(q.Label,{column:!0,sm:"auto",style:{fontSize:"0.875rem"},children:t("search.resourcesModal.labelChangeResourceInfoLanguage")}),e.jsx(P,{sm:"auto",children:e.jsx(Oe,{type:"radio",name:"resource-info-languages",defaultValue:a,onChange:p=>i(p),children:Array.from(x.entries()).toSorted().map(([p,_])=>e.jsxs(Ce,{size:"sm",id:`resource-info-languages-${p}`,value:p,variant:"secondary",title:t("search.resourcesModal.buttonChangeResourceInfoLanguageTitle",{count:_,language:p,languageName:l.of(p)}),children:[l.of(p)," ",e.jsx("sup",{children:p})]},p))})})]})]}),e.jsx(re.Divider,{}),D.map(p=>M(p,V))]})]})}),j&&e.jsxs(H,{className:"p-3 mt-3",children:[e.jsx("h3",{className:"h4 pb-1 mb-3 border-bottom",children:U(j.title,r)}),e.jsx("h4",{className:"h5 pb-1 mb-3 border-bottom",children:t("statistics.resources.titleBasicMetadata")}),$("title",j.title),$("description",j.description),$("institution",j.institution),j.landingPage&&e.jsxs(H,{className:"my-2",children:[e.jsx(H.Header,{children:t("statistics.resources.cardHeaderLandingPage")}),e.jsx(H.Body,{children:e.jsx("a",{href:j.landingPage,className:"matomo_link",target:"_blank",children:j.landingPage})})]}),e.jsx("h4",{className:"h5 pb-1 mt-4 mb-3 border-bottom",children:t("statistics.resources.titleTechnicalMetadata")}),e.jsxs(H,{className:"my-2",children:[e.jsx(H.Header,{children:t("statistics.resources.cardHeaderResource")}),e.jsx(H.Body,{children:e.jsxs("dl",{className:"mb-0",children:[e.jsx("dt",{children:t("statistics.labels.resourcePid")}),e.jsx("dd",{children:j.handle}),e.jsx("dt",{children:t("statistics.labels.resourceHierarchy")}),e.jsx("dd",{children:R(j)})]})})]}),e.jsxs(H,{className:"my-2",children:[e.jsx(H.Header,{children:t("statistics.resources.cardHeaderEndpoint")}),e.jsx(H.Body,{children:e.jsxs("dl",{className:"mb-0",children:[e.jsx("dt",{children:t("statistics.labels.endpointUrl")}),e.jsxs("dd",{children:[j.endpoint.url," ",s&&e.jsxs(e.Fragment,{children:[" ",e.jsx("a",{href:`${s}?url=${encodeURIComponent(j.endpoint.url)}`,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:pt},className:"align-baseline ms-2"})})]})]}),e.jsx("dt",{children:t("statistics.labels.fcsVersion")}),e.jsx("dd",{children:j.endpoint.protocol}),e.jsx("dt",{children:t("statistics.labels.searchCapabilities")}),e.jsx("dd",{children:j.endpoint.searchCapabilities.join(", ")}),e.jsx("dt",{children:t("statistics.labels.endpointInstitution")}),e.jsxs("dd",{children:[j.endpointInstitution.name,j.endpointInstitution.link&&e.jsxs(e.Fragment,{children:[" – ",e.jsxs("a",{href:j.endpointInstitution.link,className:"matomo_link",target:"_blank",children:[t("statistics.labels.moreInformation")," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:vt}})]})]})]})]})})]}),e.jsx("h4",{className:"h5 pb-1 mt-4 mb-3 border-bottom",children:t("statistics.resources.titleSeachInformation")}),e.jsxs(H,{className:"my-2",children:[e.jsx(H.Header,{children:t("statistics.resources.cardHeaderDataViews")}),e.jsx(H.Body,{children:j.availableDataViews&&e.jsxs(be,{hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:t("statistics.resources.thDataViewIdentifier")}),e.jsx("th",{scope:"col",children:t("statistics.resources.thDataViewMimeType")}),e.jsx("th",{scope:"col",children:t("statistics.resources.thDataViewDeliveryPolicy")})]})}),e.jsx("tbody",{children:j.availableDataViews.map(p=>e.jsxs("tr",{children:[e.jsx("td",{children:p.identifier}),e.jsx("td",{children:p.mimeType}),e.jsx("td",{children:p.deliveryPolicy})]},p.identifier))})]})})]}),g&&e.jsxs(H,{className:"my-2",children:[e.jsx(H.Header,{children:t("statistics.resources.cardHeaderAdvancedDataView")}),e.jsx(H.Body,{children:j.availableLayers&&e.jsxs(be,{hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:t("statistics.resources.thLayerType")}),e.jsx("th",{scope:"col",children:t("statistics.resources.thQualifier")}),e.jsx("th",{scope:"col",children:t("statistics.resources.thResultId")}),e.jsx("th",{scope:"col",children:t("statistics.resources.thIdentifier")}),e.jsx("th",{scope:"col",children:t("statistics.resources.thEncoding")}),e.jsx("th",{scope:"col",children:t("statistics.resources.thAltValueInfo")}),e.jsx("th",{scope:"col",children:t("statistics.resources.thAltValueInfoURI")})]})}),e.jsx("tbody",{children:j.availableLayers.map(p=>e.jsxs("tr",{children:[e.jsx("td",{children:p.layerType}),e.jsx("td",{children:p.qualifier}),e.jsx("td",{children:p.resultId}),e.jsx("td",{children:p.identifier}),e.jsx("td",{children:p.encoding}),e.jsx("td",{children:p.altValueInfo}),e.jsx("td",{children:p.altValueInfoURI})]},p.identifier))})]})})]}),E&&e.jsxs(H,{className:"my-2",children:[e.jsx(H.Header,{children:t("statistics.resources.cardHeaderLexDataView")}),e.jsx(H.Body,{children:j.availableLexFields&&e.jsxs(be,{hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:t("statistics.resources.thLexFieldType")}),e.jsx("th",{scope:"col",children:t("statistics.resources.thLexIdentifier")})]})}),e.jsx("tbody",{children:j.availableLexFields.map(p=>e.jsxs("tr",{children:[e.jsx("td",{children:p.type}),e.jsx("td",{children:p.id})]},p.id))})]})})]})]})]})}const xr=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-exclamation-triangle" viewBox="0 0 16 16">
  <path d="M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"/>
  <path d="M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"/>
</svg>`;function jr({url:s,statistics:n,validatorUrl:t,isScan:r}){const{t:a,i18n:i}=te(),l=new Intl.NumberFormat(i.language,{style:"unit",unit:"second",unitDisplay:"short"});function o(c,u){const f=e.jsx(oe.Highlight,{text:c.title,ranges:n.matchResources?.[u]??null});return c.valid&&c.notes.length===0?f:e.jsx(we,{placement:"auto-start",delay:{show:250,hide:400},overlay:e.jsxs(Ie,{id:`resource-info-warning-${c.handle}`,children:[!c.valid&&a("statistics.errors.notAvailableInAggregator"),!c.valid&&c.notes.length>=1&&e.jsx("hr",{className:"mt-2 mb-1"}),c.notes.length===1?c.notes[0]:c.notes.length>=1?e.jsx("ul",{className:"text-start m-0 my-1 ps-3",children:c.notes.map((C,m)=>e.jsx("li",{children:C},m))}):null]}),children:e.jsxs("span",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:xr},className:"align-baseline me-2"}),c.valid?f:e.jsx("s",{children:f})]})})}return e.jsxs("div",{className:"ps-sm-4 mt-sm-0 mt-2 pt-sm-0 pt-1",children:[e.jsxs("h4",{className:"h5",id:`${Bt(s)}-${r?"scan":"search"}`,children:[e.jsx(oe.Highlight,{text:s,ranges:n.matchEndpoint}),t&&e.jsxs(e.Fragment,{children:[" ",e.jsx("a",{href:`${t}?url=${encodeURIComponent(s)}`,children:e.jsx("i",{dangerouslySetInnerHTML:{__html:pt},className:"align-baseline ms-2"})})]})]}),e.jsxs("dl",{className:"ps-sm-4",children:[e.jsx("dt",{children:a("statistics.labels.fcsVersion")}),e.jsx("dd",{children:n.version}),e.jsx("dt",{children:a("statistics.labels.searchCapabilities")}),e.jsx("dd",{children:n.searchCapabilities.join(", ")}),e.jsx("dt",{children:a("statistics.labels.maxConcurrentScanRequests")}),e.jsx("dd",{children:n.maxConcurrentRequests}),e.jsx("dt",{children:a("statistics.labels.requestStatistics")}),e.jsx("dd",{className:"mb-0",children:a("statistics.labels.numberOfRequests",{count:n.numberOfRequests})}),n.avgQueueTime!==0&&e.jsx("dd",{className:"mb-0",children:a("statistics.labels.queueTime",{avg:l.format(n.avgQueueTime),max:l.format(n.maxQueueTime)})}),e.jsx("dd",{children:a("statistics.labels.executionTime",{avg:l.format(n.avgExecutionTime),max:l.format(n.maxExecutionTime)})}),n.rootResources?.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("dt",{children:a("statistics.labels.resources")}),e.jsx("dd",{children:a("statistics.labels.numberOfRootResources",{count:n.rootResources.length})}),e.jsx("dd",{children:e.jsx("ul",{children:n.rootResources.map((c,u)=>typeof c=="string"?e.jsx("li",{children:e.jsx(oe.Highlight,{text:c,ranges:n.matchResources?.[u]??null})},c):e.jsx("li",{children:o(c,u)},c.handle))})})]}),e.jsxs(e.Fragment,{children:[Object.entries(n.diagnostics||{}).map(([c,u])=>e.jsxs(ie,{variant:"warning",style:{fontSize:"0.85rem"},children:[e.jsxs(ie.Heading,{style:{fontSize:"1rem"},children:[e.jsxs(pe,{bg:"warning",children:[u.counter,"x"]})," ",e.jsx("span",{className:"text-uppercase",children:a("statistics.diagnostic.diagnostic")})," ",u.diagnostic.message,u.diagnostic.diagnostic&&e.jsxs(e.Fragment,{children:[" - ",e.jsx("small",{children:u.diagnostic.diagnostic})]})]}),e.jsxs("p",{className:"mb-0",children:[a("statistics.diagnostic.context")," ",e.jsx("a",{href:u.context,children:u.context})]})]},c)),Object.entries(n.errors||{}).map(([c,u])=>e.jsxs(ie,{variant:"danger",style:{fontSize:"0.85rem"},children:[e.jsxs(ie.Heading,{style:{fontSize:"1rem"},children:[e.jsxs(pe,{bg:"danger",children:[u.counter,"x"]})," ",e.jsx("span",{className:"text-uppercase",children:a("statistics.diagnostic.exception")})," ",u.exception.message]}),e.jsxs("p",{className:"mb-0",children:[a("statistics.diagnostic.context")," ",e.jsx("a",{href:u.context,children:u.context})]}),u.exception.cause&&e.jsxs("p",{className:"mb-0",children:[a("statistics.diagnostic.causedBy")," ",u.exception.cause]})]},c))]})]})]},s)}function br({data:s,validatorUrl:n}){const{t,i18n:r}=te(),[a,i]=d.useState(""),[l,o]=d.useState(["institution","endpoint","resources"]),[c,u]=d.useState(!1),f=`-${s.isScan?"scan":"search"}`,C=d.useMemo(()=>Object.entries(s.institutions).toSorted().map(([b,T])=>Object.entries(T).toSorted().map(([k,y])=>({institutionName:b,endpointUrl:k,endpointInfo:{...y,rootResources:y.rootResources.toSorted()}}))).flat(1).filter(c?b=>Object.keys(b.endpointInfo.diagnostics).length>0||Object.keys(b.endpointInfo.errors).length>0:()=>!0),[s,c]),m=C.filter(b=>Object.keys(b.endpointInfo.diagnostics).length>0||Object.keys(b.endpointInfo.errors).length>0),w=oe.useFuzzySearchList({list:C,queryText:a,getText:b=>{const T=[];return l.length===0?T.push(b.institutionName,b.endpointUrl,...b.endpointInfo.rootResources.map(k=>typeof k=="string"?k:k.title)):(l.includes("institution")&&T.push(b.institutionName),l.includes("endpoint")&&T.push(b.endpointUrl),l.includes("resources")&&T.push(...b.endpointInfo.rootResources.map(k=>typeof k=="string"?k:k.title))),T},mapResultItem:({item:b,score:T,matches:k})=>({item:b,matches:k,score:T})}).reduce((b,T)=>{const{institutionName:k,endpointUrl:y,endpointInfo:O}=T.item;return Object.getOwnPropertyNames(b).includes(k)||(b[k]={match:l.length===0||l.includes("institution")?T.matches[0]:null,endpoints:{}}),b[k].endpoints[y]={...O,matchEndpoint:l.length===0||l.includes("endpoint")?T.matches[l.length===0||l.includes("institution")?1:0]:null,matchResources:l.length===0||l.includes("resources")?T.matches.slice(0+(l.length===0||l.includes("institution")?1:0)+(l.length===0||l.includes("endpoint")?1:0)):[]},b},{});function j(b){l.includes(b)?o(l.filter(T=>T!==b)):o([...l,b])}return e.jsxs(se,{className:"d-grid gap-2 mt-3",children:[e.jsx(ie,{variant:"info",className:"mb-0",children:e.jsxs("dl",{className:"mb-0",children:[e.jsx("dt",{children:t("statistics.labels.startDate")}),e.jsx("dd",{className:"mb-0",children:new Date(s.date).toLocaleString(r.language)}),e.jsx("dt",{children:t("statistics.labels.timeout")}),e.jsx("dd",{className:"mb-0",children:new Intl.NumberFormat(r.language,{style:"unit",unit:"second",unitDisplay:"short"}).format(s.timeout)})]})}),e.jsx(q,{onSubmit:b=>b.preventDefault(),children:e.jsxs(Z,{className:"gy-2",children:[e.jsx(P,{lg:6,md:12,children:e.jsx(q.Control,{placeholder:t("statistics.filter.inputPlaceholder"),value:a,onChange:b=>i(b.target.value)})}),e.jsxs(P,{className:"filter-checkboxes",lg:6,md:12,children:[e.jsx(q.Text,{className:"me-2",children:t("statistics.filter.labelForCheckboxes")}),e.jsx(q.Check,{type:"checkbox",checked:l.includes("institution"),onChange:()=>j("institution"),id:`filter-institution-name${f}`,label:t("statistics.filter.checkboxInstitution")}),e.jsx(q.Check,{type:"checkbox",checked:l.includes("endpoint"),onChange:()=>j("endpoint"),id:`filter-endpoint-url${f}`,label:t("statistics.filter.checkboxEndpoint")}),e.jsx(q.Check,{type:"checkbox",checked:l.includes("resources"),onChange:()=>j("resources"),id:`filter-resource-names${f}`,label:t("statistics.filter.checkboxResources")})]})]})}),e.jsx(Z,{children:e.jsx(P,{children:e.jsx(q.Check,{type:"checkbox",checked:c,onChange:()=>u(!c),id:`filter-show-issues-only${f}`,label:t("statistics.filter.checkboxShowWithIssues",{count:m.length})})})}),Object.entries(w).map(([b,{match:T,endpoints:k}])=>e.jsxs(H,{className:"p-2",children:[e.jsx("h3",{className:"h4 pb-1 border-bottom",id:`${Bt(b)}${f}`,children:e.jsx(oe.Highlight,{text:b,ranges:T})}),Object.entries(k).toSorted().map(([y,O])=>e.jsx(jr,{url:y,statistics:O,validatorUrl:n,isScan:s.isScan},y))]},b))]})}const yr=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"/>
  <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"/>
</svg>`,wr=[{id:"last-scan",label:"Last Scan"},{id:"recent-searches",label:"Recent Searches"}],Sr=Object.fromEntries(wr.map(s=>[s.id,s])),vr=["resources"];function Rr(){const s=ve(),n=Ft(),[t]=Me(),{t:r}=te(),{categoryId:a}=vs(),i=pr(),l=gr(),o={consortia:t.get(Se)},{isPending:c,isError:u,data:f,error:C}=Ne({queryKey:["statistics"],queryFn:qs.bind(null,s,o)}),[m,L]=d.useState(W.getState().validatorURL);W.subscribe(y=>L(y.validatorURL));const w=W.getState().appTitleHead,j=[...f!==void 0?Object.keys(f).toSorted():[],...vr],b=a!=null&&j.includes(a)?a:j.length>0?j[0]:void 0;function T(){n.invalidateQueries({queryKey:["statistics"]})}function k(y){i?.params.categoryId,i&&i.params.categoryId!==y&&i.route.path&&l(i.route.path,{categoryId:y})}return e.jsxs(e.Fragment,{children:[e.jsx(Pe,{children:e.jsxs("title",{children:[w," – Statistics"]})}),e.jsxs(se,{id:"statistics",className:"my-4",children:[e.jsx("h1",{className:"h1",children:r("statistics.title")}),(c||u)&&e.jsx(Z,{children:e.jsxs(P,{children:[c?r("statistics.loading"):null,e.jsx("br",{}),u?C.message:null]})}),f&&e.jsxs(Ke.Container,{activeKey:a&&j.includes(a)?a:b,onSelect:k,children:[e.jsxs(ue,{className:"nav-tabs",as:"ul",children:[Object.keys(f).map(y=>e.jsx(ue.Item,{as:"li",role:"presentation",children:e.jsx(ue.Link,{as:"button",eventKey:y,children:r(`statistics.tabs.${y}`,{defaultValue:Sr[y]?.label??y})})},y)),e.jsx(ue.Item,{as:"li",role:"presentation",children:e.jsx(ue.Link,{as:"button",eventKey:"resources",children:r("statistics.tabs.resources")})},"resources"),e.jsx(ue.Item,{as:"li",role:"presentation",className:"ms-auto",children:e.jsxs(ue.Link,{as:"button",onClick:T,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:yr}})," ",r("statistics.tabs.btnRefresh")]})})]}),e.jsxs(Ke.Content,{children:[Object.entries(f).map(([y,O])=>e.jsx(Ke.Pane,{eventKey:y,children:e.jsx(br,{data:O,validatorUrl:m})},y)),e.jsx(Ke.Pane,{eventKey:"resources",children:e.jsx(fr,{validatorUrl:m})},"resources")]})]})]})]})}function Lr(){const s=W.getState().appTitleHead;sn();const n=ge(t=>t.locale);d.useEffect(()=>{de.language!==n&&de.changeLanguage(n)},[n]);{const t=ft(),[r,a]=d.useState(t.pathname);d.useEffect(()=>{const i=t.pathname;i!==r&&(a(i+t.search),Gt(i,document.title,r))},[t,r])}return e.jsxs(e.Fragment,{children:[e.jsx(Pe,{children:e.jsx("title",{children:s})}),e.jsx(Zs,{}),e.jsx("main",{children:e.jsxs(Rs,{children:[e.jsx(Ve,{index:!0,element:e.jsx(mr,{})}),e.jsx(Ve,{path:"/about",element:e.jsx(fn,{})}),e.jsx(Ve,{path:"/help",element:e.jsx(xn,{})}),e.jsx(Ve,{path:"/stats/:categoryId?",element:e.jsx(Rr,{})})]})}),e.jsx(Ys,{})]})}window.MyAggregator=window.MyAggregator||{};window._paq=window._paq||[];const Nr=["DEPLOY_PATH","API_URL","APP_TITLE","APP_TITLE_HEAD","MATOMO_TRACKING_PARAMS"];function Cr(){window.MyAggregator.DEPLOY_PATH!==void 0&&W.getState().setDeployPath(window.MyAggregator.DEPLOY_PATH),window.MyAggregator.API_URL!==void 0&&W.getState().setApiURL(window.MyAggregator.API_URL),window.MyAggregator.VALIDATOR_URL!==void 0&&W.getState().setValidatorURL(window.MyAggregator.VALIDATOR_URL),window.MyAggregator.SHOW_SEARCH_RESULT_LINK!==void 0&&W.getState().setShowSearchResultLink(window.MyAggregator.SHOW_SEARCH_RESULT_LINK),window.MyAggregator.APP_TITLE!==void 0&&W.getState().setAppTitle(window.MyAggregator.APP_TITLE),window.MyAggregator.APP_TITLE_HEAD!==void 0&&W.getState().setAppTitleHead(window.MyAggregator.APP_TITLE_HEAD),window.MyAggregator.MATOMO_TRACKING_PARAMS!==void 0&&W.getState().setMatomoTrackingParams(window.MyAggregator.MATOMO_TRACKING_PARAMS),window.MyAggregator.AUTH_USERNAME!==void 0&&W.getState().setAuthUsername(window.MyAggregator.AUTH_USERNAME),window.MyAggregator=new Proxy(window.MyAggregator,{get(s,n){return s[n]},set(s,n,t){return Nr.includes(n)?(console.error(`Configuration ${n} can only be set on initialization!`),!1):n==="VALIDATOR_URL"?t===null||typeof t=="string"?(W.getState().setValidatorURL(t),!0):!1:n==="SHOW_SEARCH_RESULT_LINK"?typeof t=="boolean"?(W.getState().setShowSearchResultLink(t),!0):!1:n==="AUTH_USERNAME"?t===null||typeof t=="string"?(W.getState().setAuthUsername(t),!0):!1:(s[n]=t,!0)}}),Object.assign(window.MyAggregator,{getAppStore:()=>W})}function Ir(){const s=ee.getState(),n=[navigator.language,...navigator.languages];let t=!1;for(const r of n){if(r===s.locale){t=!0;break}if(s.locales.includes(r)){s.setLocale(r),t=!0;break}}t||console.warn("User locale",n,"was not found in available languages",s.locales),Object.assign(window.MyAggregator,{getLocaleStore:()=>ee})}Cr();Ir();W.getInitialState(),W.getState();ee.getInitialState(),ee.getState();const Tr=W.getState().deployPath,_r=W.getState().apiURL,Er=ee.getState().locale;de.changeLanguage(Er);const Ar=new Ls({defaultOptions:{queries:{}}}),kr=Ns.create({baseURL:_r,timeout:5e3,responseType:"json",transitional:{silentJSONParsing:!1}});{const s=W.getState().matomoTrackingParams;Rn(s)||console.warn("Unable to setup tracking ...")}const Mr="root",Pr=document.getElementById(Mr),Or=Ds.createRoot(Pr);Or.render(e.jsx(d.StrictMode,{children:e.jsx(bn,{axios:kr,children:e.jsx(Cs,{client:Ar,children:e.jsx(Is,{children:e.jsx(Ts,{basename:Tr,children:e.jsx(Lr,{})})})})})}));export{ns as C,_n as f,Gn as h,ts as u};
//# sourceMappingURL=fcs-sru-aggregator-ui-0.0.0.js.map
