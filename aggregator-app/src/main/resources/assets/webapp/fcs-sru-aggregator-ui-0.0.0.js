const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./fcs-sru-aggregator-ui-query-builder-0.0.0.js","./vendor/react-ext.js","./vendor/react.js","./vendor/bootstrap.js","./vendor/antlr4.js","./vendor/prism.js","./fcs-sru-aggregator-ui-query-builder-0.0.0.css","./vendor/bootstrap.css"])))=>i.map(i=>d[i]);
import{j as e,L as ve,N as Ke,r as a,H as me,R as Es,a as Is,u as ns,b as rs,c as is,d as xe,e as As,f as Ms,g as _s,h as pe,Q as Os,i as Ps,k as Fs,l as Hs,B as Ds}from"./vendor/react-ext.js";import{b as qs}from"./vendor/react.js";/* empty css                            */import{C as Y,R as B,a as T,N as ue,b as ne,M as U,F as P,B as q,c as W,d as ls,e as ie,I as zs,T as Vs,D as le,S as as,f as He,O as ge,g as ae,h as Ce,L as Ee,A as J,P as je,i as Ie,j as Us,k as Ae,l as Me}from"./vendor/bootstrap.js";import{g as Bs}from"./vendor/prism.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}})();var be={},We;function $s(){if(We)return be;We=1;var s=qs();return be.createRoot=s.createRoot,be.hydrateRoot=s.hydrateRoot,be}var Qs=$s();function Gs(){return e.jsx("footer",{className:"text-muted",children:e.jsx(Y,{children:e.jsxs(B,{children:[e.jsxs(T,{className:"text-start d-flex flex-sm-row flex-column column-gap-3 row-gap-2",children:[e.jsxs("div",{children:[e.jsx(ve,{to:"/about",className:"hidden-xs",children:"About"}),e.jsxs("div",{className:"version-info text-muted text-center-xs",children:["v","0.0.0"]})]}),e.jsx(ve,{to:"/stats",children:"Statistics"})]}),e.jsxs(T,{className:"text-center",children:[e.jsxs("span",{className:"footer-fineprint",children:["Service provided by ",e.jsx("a",{href:"https://www.clarin.eu",children:"CLARIN"})]}),e.jsxs("span",{children:[e.jsx("br",{}),"Hosted by CLARIN ERIC"]})]}),e.jsxs(T,{className:"hidden-xs text-end d-flex flex-sm-row flex-column justify-content-sm-end column-gap-3 row-gap-2",children:[e.jsx("a",{href:"https://www.clarin.eu/content/terms-use-and-disclaimer",children:"Terms & Disclaimer"}),e.jsx("a",{href:"mailto:fcs@clarin.eu",children:"Contact"})]})]})})})}const Ks=""+new URL("assets/icon-services-fcs.png",import.meta.url).href;function Ws(){return e.jsx("header",{children:e.jsx(ue,{expand:"md",className:"bg-body-tertiary",children:e.jsxs(Y,{children:[e.jsxs(ue.Brand,{as:ve,to:"/",children:[e.jsx("img",{src:Ks,width:"30",height:"30",className:"d-inline-block align-top",alt:"CLARIN Content Search logo"})," ","Content Search"]}),e.jsx(ue.Toggle,{"aria-controls":"header-navbar-nav"}),e.jsx(ue.Collapse,{id:"header-navbar-nav",children:e.jsxs(ne,{className:"w-100 d-flex",children:[e.jsx(ne.Link,{as:Ke,to:"/",children:"Home"}),e.jsx(ne.Link,{as:Ke,to:"/help",children:"Help"}),e.jsxs(ue.Text,{className:"ms-auto",children:["Signed in as ",e.jsx("span",{className:"fw-bold",children:"XYZ"})]})]})})]})})})}/*!
 * Color mode switcher based on example from Bootstrap 5 docs.
 * @see https://getbootstrap.com/docs/5.3/customize/color-modes/#javascript
 */function Ys(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Xs(s){s==="auto"?document.documentElement.setAttribute("data-bs-theme",window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"):document.documentElement.setAttribute("data-bs-theme",s)}function Js(){a.useEffect(()=>{function s(){Xs(Ys())}return s(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",s),()=>window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",s)},[])}function Zs(){return e.jsxs(e.Fragment,{children:[e.jsx(me,{children:e.jsx("title",{children:"FCS Aggregator – Content Search – About"})}),e.jsxs(Y,{children:[e.jsx("h1",{className:"h1",children:"About the Federated Content Search (FCS) Aggregator"}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:"People"}),e.jsx("p",{children:"The Aggregator was developed by:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Emanuel Dima"}),e.jsx("li",{children:"Erik Körner"}),e.jsx("li",{children:"Leif-Jöran Olsson"}),e.jsx("li",{children:"Yana Panchenko"}),e.jsx("li",{children:"Oliver Schonefeld"}),e.jsx("li",{children:"Dieter Van Uytvanck"})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:"Statistics"}),e.jsxs("p",{children:["View ",e.jsx(ve,{to:"/stats",children:"endpoint statistics"})," to see details about scanned resources, performed searches, warnings and errors."]})]}),e.jsx("div",{children:e.jsx("h2",{className:"h2",children:"Privacy Policy"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:"Source Code"}),e.jsxs("p",{children:["The Aggregator source code and documentation are published on"," ",e.jsx("a",{href:"https://github.com/clarin-eric/fcs-sru-aggregator",children:"GitHub"})," and are made available under the"," ",e.jsx("a",{href:"https://github.com/clarin-eric/fcs-sru-aggregator/blob/master/LICENSE",children:"GPL 3.0 license"}),"."]}),e.jsx("p",{children:"The full license can be found in the source code repository and in the packaged sources and binaries."})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:"Technology Used"}),e.jsx("p",{children:"The Aggregator uses the following software components:"}),e.jsx("ul",{children:e.jsxs("li",{children:[e.jsx("a",{href:"https://www.dropwizard.io/",children:"Dropwizard"})," (",e.jsx("a",{href:"https://github.com/dropwizard/dropwizard/blob/release/4.0.x/LICENSE",children:"Apache License 2.0"}),")"]})})]}),e.jsx("div",{children:e.jsx("h2",{className:"h2",children:"Funding"})})]})]})}function et(){return e.jsxs(e.Fragment,{children:[e.jsx(me,{children:e.jsx("title",{children:"FCS Aggregator – Content Search – Help"})}),e.jsxs(Y,{children:[e.jsx("h1",{className:"h1",children:"Help"}),e.jsx("h2",{className:"h2",children:"Performing a Federated Content Search in resources"}),e.jsx("p",{}),e.jsx("h2",{className:"h2",children:"Adjusting search criteria"}),e.jsx("p",{}),e.jsx("h2",{children:"More help"}),e.jsxs("p",{children:["More detailed information on using FCS Aggregator is available at the"," ",e.jsx("a",{href:"https://www.clarin.eu/content/content-search-tutorial",children:"Content Search: Tutorial at CLARIN.eu"}),". If you still cannot find an answer to your question, or if want to send a feedback, you can write to the"," ",e.jsx("a",{title:"contact",href:"mailto:fcs@clarin.eu",children:"CLARIN FCS Helpdesk"}),"."]})]})]})}const De=a.createContext({resources:[],languages:{},weblichtLanguages:[]});De.displayName="AggregatorDataContext";function st({resources:s,languages:t,weblichtLanguages:n,children:i}){const r={resources:s,languages:t,weblichtLanguages:n};return e.jsx(De.Provider,{value:r,children:i})}function qe(){return a.useContext(De)}const ze=a.createContext(void 0);ze.displayName="AxiosContext";function ce(){const s=a.useContext(ze);if(!s)throw new Error('No "axios" instance set, use AxiosProvider to set one');return s}function tt({axios:s,children:t}){return e.jsx(ze.Provider,{value:s,children:t})}const Ve=a.createContext(void 0);Ve.displayName="SearchParamsContext";function Ue(){const s=a.useContext(Ve);if(!s)throw new Error('No "params" data set, use SearchParamsProvider to set one');return s}function nt({language:s,languageFilter:t,queryType:n,query:i,resourceIDs:r,numberOfResults:l,children:o}){const h={language:s,languageFilter:t,queryType:n,query:i,resourceIDs:r,numberOfResults:l};return e.jsx(Ve.Provider,{value:h,children:o})}async function rt(s){return(await s.get("init")).data}async function it(s){return(await s.get("statistics")).data}async function lt(s,t){return(await s.post("search",t,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data}async function at(s,t,n){return(await s.post(`search/${t}`,n,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data}async function ot(s,t){if(!t)throw new Error('Invalid "searchID" parameter!');return(await s.get(`search/${t}/metaonly`)).data}async function ct(s,t,n){if(!t)throw new Error('Invalid "searchID" parameter!');if(!n)throw new Error('Invalid "resourceID" parameter!');const r=(await s.get(`search/${t}/metaonly?resourceId=${encodeURIComponent(n)}`)).data.results.filter(l=>l.id===n);if(r.length===0)throw new Error(`Results (meta) for resource not found! (searchId: ${t}, resourceId: ${n})`);return r[0]}async function dt(s,t,n){if(!t)throw new Error('Invalid "searchID" parameter!');if(!n)throw new Error('Invalid "resourceID" parameter!');const r=(await s.get(`search/${t}?resourceId=${encodeURIComponent(n)}`)).data.results.filter(l=>l.resource.id===n);if(r.length===0)throw new Error(`Results for resource not found! (searchId: ${t}, resourceId: ${n})`);return r[0]}function ut(s,t,n,i,r,l){const o=new URLSearchParams({resourceId:n,format:i});(l==="byGuess"||l==="byMetaAndGuess")&&o.set("filterLanguage",r);const h=`search/${t}/download?${o.toString()}`;return s.getUri({url:h})}function ht(s,t,n,i,r,l){const o=new URLSearchParams({resourceId:n});i?o.set("filterLanguage",i):(l==="byGuess"||l==="byMetaAndGuess")&&o.set("filterLanguage",r);const h=`search/${t}/toWeblicht?${o.toString()}`;return s.getUri({url:h})}window._paq=window._paq||[];function mt(s){return!1}function xt(s,t,n){window._paq.push(["setDocumentTitle",t??document.title]),window._paq.push(["setCustomUrl",s]),n!==void 0&&window._paq.push(["setReferrerUrl",n]),window._paq.push(["trackPageView"])}function os(s,t=!1,n=!1){window._paq.push(["trackSiteSearch",s,t,n])}const _e="byMeta",gt="all",cs="resource",ft="title-up",te="mul";function fe(s,t=void 0){return s===te?"Any Language":(t==null?void 0:t[s])||"Unknown Language"}function pt(s){const t=r=>({...r,subResources:r.subResources.map(t)}),n=s.map(t),i=function(r,l){const o=r.institution.localeCompare(l.institution);return o!==0?o:r.title.toLowerCase().localeCompare(l.title.toLowerCase())};return oe(n,r=>{r.subResources.sort(i)}),n.sort(i),n}function jt(s,t){const n=[],i=[],r=[];return Object.entries(t).forEach(([l,o])=>{o.forEach(h=>{let x=!1;oe(s,d=>{d.handle===h&&(x=!0,r.push(d))}),x||(console.warn("Handle not found in resources",h),i.push(h))})}),oe(r,l=>{n.push(l.id)}),{selected:n,unavailable:i}}function oe(s,t){const n=(i,r)=>{t(i,r)===!1||i.subResources.forEach(n)};s.forEach(n)}function re(s){const t=[];return oe(s,n=>{t.push(n.id)}),t}function bt(s,t,n){const i=[],r=l=>ds(l,r)||vt(l,t,n);return oe(s,l=>{r(l)&&i.push(l.id)}),i}function wt(s,t){const n=new Set;return oe(s,i=>(t.includes(i.id)&&n.add(i.institution),!0)),Array.from(n)}function yt(s,t){return!(t==="fcs"&&!s.endpoint.searchCapabilities.includes("ADVANCED_SEARCH")||t==="lex"&&!s.endpoint.searchCapabilities.includes("LEX_SEARCH"))}function St(s,t){return!!(t===te||s.languages&&s.languages.length===1&&s.languages[0]===t||s.languages&&s.languages.indexOf(t)>=0)}function ds(s,t){if(!s.subResources||s.subResources.length===0)return!1;let n=!1;const i=r=>{if((t==null?void 0:t(r))===!0){n=!0;return}r.subResources.forEach(i)};return s.subResources.forEach(i),n}function vt(s,t,n){return!(!yt(s,t)||!St(s,n))}const Rt={"title-up":(s,t)=>s.title.localeCompare(t.title),"title-down":(s,t)=>-s.title.localeCompare(t.title),"institution-up":(s,t)=>{const n=s.institution.localeCompare(t.institution);return n!==0?n:s.title.localeCompare(t.title)},"institution-down":(s,t)=>{const n=-s.institution.localeCompare(t.institution);return n!==0?n:s.title.localeCompare(t.title)}},Ct="modulepreload",Nt=function(s,t){return new URL(s,t).href},Ye={},Lt=function(t,n,i){let r=Promise.resolve();if(n&&n.length>0){const o=document.getElementsByTagName("link"),h=document.querySelector("meta[property=csp-nonce]"),x=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));r=Promise.allSettled(n.map(d=>{if(d=Nt(d,i),d in Ye)return;Ye[d]=!0;const j=d.endsWith(".css"),S=j?'[rel="stylesheet"]':"";if(!!i)for(let f=o.length-1;f>=0;f--){const C=o[f];if(C.href===d&&(!j||C.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${S}`))return;const g=document.createElement("link");if(g.rel=j?"stylesheet":Ct,j||(g.as="script"),g.crossOrigin="",g.href=d,x&&g.setAttribute("nonce",x),document.head.appendChild(g),j)return new Promise((f,C)=>{g.addEventListener("load",f),g.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${d}`)))})}))}function l(o){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=o,window.dispatchEvent(h),!h.defaultPrevented)throw o}return r.then(o=>{for(const h of o||[])h.status==="rejected"&&l(h.reason);return t().catch(l)})};function us(s,t){const[n,i]=a.useState(s);return a.useEffect(()=>{const r=setTimeout(()=>{i(s)},t);return()=>{clearTimeout(r)}},[s,t]),n}function Oe(s,t,n=0,i=t){var h,x,d,j;if(t===s&&t===i&&t.nodeType===Node.ELEMENT_NODE&&n===1)return t.nodeType,(h=t.textContent)==null||h.length,((x=t.textContent)==null?void 0:x.length)||0;if(t===s||s===null)return n;const r=t.parentNode;if(r===null)return n;let l=0;const o=r.childNodes;for(let S=0;S<o.length;S++){const L=o[S];if(L===t)break;L.nodeType===Node.TEXT_NODE?l+=((d=L.textContent)==null?void 0:d.length)||0:L.nodeType===Node.ELEMENT_NODE?l+=((j=L.textContent)==null?void 0:j.length)||0:console.warn("unknown node type",{container:s,node:t,offset:n,parent:r,i:S,child:L})}return Oe(s,r,l+n,i)}function hs(s,t){var l,o,h;const n=((l=s.textContent)==null?void 0:l.length)||0;if(n<t)return null;let i=0;const r=s.childNodes;for(let x=0;x<r.length;x++){const d=r[x];let j=0;if(d.nodeType===Node.TEXT_NODE?j=((o=d.textContent)==null?void 0:o.length)||0:d.nodeType===Node.ELEMENT_NODE?j=((h=d.textContent)==null?void 0:h.length)||0:console.warn("unknown node type, skip",{container:s,offset:t,child:d}),!(j===0&&r.length!==1)&&(i+=j,i>=t)){const S=t-(i-j);return d.nodeType===Node.ELEMENT_NODE?hs(d,S):{node:d,offset:S}}}return r.length,null}function Pe(s,t){if(!t)return null;const n=Oe(s,t.startContainer,t.startOffset);if(t.startContainer.nodeType===Node.TEXT_NODE&&t.endContainer===t.startContainer)return[n,n+(t.endOffset-t.startOffset)];const i=Oe(s,t.endContainer,t.endOffset);return[n,i]}function Tt(s,t){if(!(document.activeElement===s))return null;const i=window.getSelection();if(!i)return null;const r=document.createRange(),l=hs(s,t);if(l)try{r.setStart(l.node,l.offset),r.collapse(!0),i.removeAllRanges(),i.addRange(r)}catch(o){console.error("Error trying to set cursor!",o,{container:s,offset:t,startRange:l})}}function Xe(s){if(!(document.activeElement===s))return null;const n=window.getSelection();if(!n||n.rangeCount===0)return null;const i=n.getRangeAt(0),r=Pe(s,i);return r?r[0]:null}function kt(s){return s==="cql"?"fcs-cql":s==="fcs"?"fcs-fcsql":s==="lex"?"fcs-lexcql":"plain"}function Fe(s,t){const n=kt(t),i="match-braces rainbow-braces";let r=s;try{r=Bs.highlight(s,n)}catch(o){console.warn("Error trying to highlight value",{value:s,error:o,language:n})}return`<pre><code class="language-${n} ${i}">${r}</code></pre>`}function he(s){return s?(s=s.replace(/[\n\t]/g," "),s=s.replace(/&nbsp;|\u202F|\u00A0/g," "),s):""}const ms=Es.forwardRef(({value:s,onChange:t,onCursorChange:n,disabled:i,placeholder:r,queryType:l,delay:o=200,...h},x)=>{const d=a.useRef(null),j=a.useRef(null);a.useImperativeHandle(x,()=>j.current);const[S,L]=a.useState(he(s)),[g,f]=a.useState(null),C=us(S,o),[k,b]=a.useState(C);a.useEffect(()=>{const c=Fe(C,l);if(b(c),j.current){const R=Xe(j.current);f(R)}},[C,l]),a.useEffect(()=>{const c=he(s);if(C!==c&&(L(c),b(Fe(c)),j.current)){const R=Xe(j.current);f(R)}},[s,C]),a.useLayoutEffect(()=>{j.current&&g!==null&&Tt(j.current,g)});function p(c){const R=c.target.innerText;d.current&&(d.current.value=R),L(R),t==null||t(R)}function G(c){c.stopPropagation(),c.preventDefault();const F=(c.clipboardData||window.clipboardData).getData("text");E(F)}function V(c){var R;c.key==="Enter"?(c.stopPropagation(),c.preventDefault(),d.current&&((R=d.current.form)==null||R.requestSubmit())):c.key==="Backspace"?(c.stopPropagation(),c.preventDefault(),H()):c.key==="Delete"?(c.stopPropagation(),c.preventDefault(),m()):c.ctrlKey&&c.key==="a"||f(null)}function v(c=!1){if(!j.current||!n)return;const R=j.current;if(!(document.activeElement===R))return;const A=window.getSelection();if(!A||A.rangeCount===0)return;const _=[];for(let u=0;u<A.rangeCount;u++){const N=A.getRangeAt(u),I=Pe(R,N);I&&_.push(I)}if(_.length===0)return;const[D,$]=_.pop();c?D===$&&(f(D),n==null||n(D)):n==null||n(D,D!==$?$:void 0)}function M(c){if(!j.current)return null;const R=j.current;if(!(document.activeElement===R))return null;const A=window.getSelection();if(!A||A.rangeCount===0)return null;const _=[];for(let N=0;N<A.rangeCount;N++){const I=A.getRangeAt(N),Q=Pe(R,I);Q&&_.push(Q)}if(_.length===0)return null;_.sort();const D=_.map(([N,I])=>I-N).reduce((N,I)=>N+I,0),$=R.innerText,u=_.toReversed().reduce((N,[I,Q])=>N.slice(0,I)+N.slice(Q),$);if(c==="backspace"){if(D===0){const N=_.filter(([I,Q])=>I===Q).map(([,I])=>I).pop();if(N===0)return null;if(N!==void 0)return{value:u.slice(0,N-1)+u.slice(N),offset:N-1}}else{const N=_.map(([,I])=>I).pop();if(N!==void 0)return{value:u,offset:N-D}}return console.warn('invalid "backspace" process, abort',{container:R,selectionIndices:_,oldValue:$,newValueSpansRemoved:u,numDeleted:D}),null}else if(c==="delete"){if(D===0){const N=_.filter(([I,Q])=>I===Q).map(([,I])=>I).pop();if(N!==void 0)return{value:u.slice(0,N)+u.slice(N+1),offset:N}}else{const N=_.map(([,I])=>I).pop();if(N!==void 0)return{value:u,offset:N-D}}return console.warn('invalid "delete" process, abort',{container:R,selectionIndices:_,oldValue:$,newValueSpansRemoved:u,numDeleted:D}),null}else if(c==="paste"){if(D===0){const N=_.filter(([I,Q])=>I===Q).map(([I])=>I).shift();if(N!==void 0)return{value:u,offset:N}}else{const N=_.map(([I])=>I).shift();if(N!==void 0)return{value:u,offset:N}}return console.warn('invalid "paste" process, abort',{container:R,selectionIndices:_,oldValue:$,newValueSpansRemoved:u,numDeleted:D}),null}}function E(c){const R=M("paste");if(!R)return;const F=he(c),{value:A,offset:_}=R,D=A.slice(0,_)+F+A.slice(_),$=_+c.length;L(D),f($),d.current&&(d.current.value=D),t==null||t(D),n==null||n($)}function H(){const c=M("backspace");if(!c)return;const{value:R,offset:F}=c,A=he(R);L(A),f(F),d.current&&(d.current.value=A),t==null||t(A),n==null||n(F)}function m(){const c=M("delete");if(!c)return;const{value:R,offset:F}=c,A=he(R);L(A),f(F),d.current&&(d.current.value=A),t==null||t(A),n==null||n(F)}return e.jsxs(e.Fragment,{children:[e.jsx("div",{role:"input",disabled:i,placeholder:r,spellCheck:!1,autoCapitalize:"off",autoCorrect:"off",...h,onInput:p,onPaste:G,onKeyDown:V,onKeyUp:()=>v(),onClick:()=>v(!0),tabIndex:i?-1:h.tabIndex,contentEditable:!0,dangerouslySetInnerHTML:{__html:k},ref:j}),r&&s===""&&e.jsx("span",{className:"input-placeholder-simulacrum",children:r}),e.jsx("input",{type:"hidden",ref:d})]})});ms.displayName="ContentEditable";var se=Is();function Et({show:s,languages:t,resources:n,searchLanguage:i,searchLanguageFilter:r,onModalClose:l}){const[o,h]=a.useState(i||te),[x,d]=a.useState(r||_e),[j,S]=a.useState(""),[L,g]=a.useState(!1),f=a.useMemo(()=>{const v=new Map;return n&&(n.forEach(M=>M.languages.forEach(E=>v.set(E,(v.get(E)??0)+1))),v.set(te,n.length)),v},[n]),C=se.useFuzzySearchList({list:Object.entries(t??{}).toSorted(),queryText:j,getText:v=>[v[0],v[1]],mapResultItem:({item:v,score:M,matches:E})=>({item:v,matches:E,score:M})});if(!t)return null;const k=Math.floor((C.length+2)/3);function b(v){l({language:o,filter:x,action:v})}function p(){h(i||te),d(r||_e)}function G(){g(v=>!v)}function V(v,M,E,H){const m=o===v;let c="d-block py-0 my-1 border-0";return m&&(c+=" fw-semibold selected"),E===void 0&&(E=[null,null]),e.jsxs(q,{size:"sm",className:c,style:{color:`var(${m?"--bs-green":"--bs-body-colors"})`,backgroundColor:"var(--bs-body-bg)"},onClick:()=>h(v),"data-filter-score":H,children:[m&&e.jsx("span",{className:"selected-marker me-1",children:"✓"}),e.jsx(se.Highlight,{ranges:E[1],text:M})," ",e.jsx("sup",{children:e.jsx(se.Highlight,{ranges:E[0],text:v})}),L&&f.has(v)&&e.jsxs(e.Fragment,{children:[" (",f.get(v),")"]})]},v)}return e.jsxs(U,{show:s,onHide:()=>b("close"),size:"xl",fullscreen:"lg-down",centered:!0,children:[e.jsx(U.Header,{closeButton:!0,children:e.jsx(U.Title,{children:"Languages"})}),e.jsxs(U.Body,{className:"px-0",children:[e.jsxs(Y,{className:"px-4 pb-3 border-bottom",children:[e.jsxs(B,{children:[e.jsx(T,{sm:!0}),e.jsx(T,{sm:!0,className:"mb-3 mb-sm-2 align-content-end",children:V(te,fe(te))}),e.jsxs(T,{sm:!0,children:[e.jsx(P.Control,{size:"sm",placeholder:"Filter languages ...",name:"languages-filter",value:j,onChange:v=>S(v.target.value)}),n&&e.jsx(P.Check,{name:"languages-show-count",id:"languages-show-count",checked:L,onChange:G,type:"checkbox",label:"Show number of resources per language",className:"mt-1"})]})]}),e.jsxs(B,{children:[e.jsx(T,{sm:!0,children:C.slice(0,k).map(({item:[v,M],matches:E,score:H})=>V(v,M,E,H))}),e.jsx(T,{sm:!0,children:C.slice(k,2*k).map(({item:[v,M],matches:E,score:H})=>V(v,M,E,H))}),e.jsx(T,{sm:!0,children:C.slice(2*k).map(({item:[v,M],matches:E,score:H})=>V(v,M,E,H))})]})]}),e.jsx(P,{children:e.jsxs(Y,{className:"px-4 pt-3",children:[e.jsx(P.Check,{type:"radio",name:"filterOpts",value:"byMeta",id:"filterOpts-byMeta",checked:x==="byMeta",onChange:()=>d("byMeta"),label:"Use the resources' specified language to filter results"}),e.jsx(P.Check,{type:"radio",name:"filterOpts",value:"byGuess",id:"filterOpts-byGuess",checked:x==="byGuess",onChange:()=>d("byGuess"),label:"Filter results by using a language detector"}),e.jsx(P.Check,{type:"radio",name:"filterOpts",value:"byMetaAndGuess",id:"filterOpts-byMetaAndGuess",checked:x==="byMetaAndGuess",onChange:()=>d("byMetaAndGuess"),label:"First use the resources' specified language then also use a language detector"})]})})]}),e.jsxs(U.Footer,{children:[e.jsx(q,{variant:"secondary",onClick:p,children:"Revert Selection"}),e.jsx(q,{variant:"secondary",onClick:()=>b("abort"),children:"Abort"}),e.jsx(q,{variant:"primary",onClick:()=>b("confirm"),children:"Confirm and Close"})]})]})}const Be=[{id:"cql",name:"Text layer Contextual Query Language (CQL)",searchLabel:"Full-text search",color:"#29a900",searchPlaceholder:"Elephant"},{id:"fcs",name:"Multi-layer Federated Content Search Query Language (FCS-QL)",searchLabel:"Multi-layer annotation search",color:"#00a8cc",searchPlaceholder:"[word = 'annotation'][word = 'focused']"},{id:"lex",name:"Lexical Resources Contextual Query Language (LexCQL)",searchLabel:"Lexical resource search",color:"#e77e00",searchPlaceholder:"banana"}],Se=Object.fromEntries(["cql","fcs","lex"].map(s=>[s,Be.find(t=>t.id===s)])),Je=["fcs","lex"],It=[{id:"text",label:"Plain Text"},{id:"csv",label:"CSV"},{id:"tcf",label:"TCF"},{id:"ods",label:"ODS"},{id:"excel",label:"Excel"}],At="cql",we=[10,20,50,100,200,250],Re="info:srw/diagnostic/1/61",Mt=[{queryType:"cql",query:"Elephant",description:"Query with single term"},{queryType:"cql",query:"cat AND dog",description:"Query with boolean"},{queryType:"cql",query:'"exciting news"',description:"Query with phrase (quoting because of whitespaces)"},{queryType:"fcs",query:'[ word = "her.*" ] [ lemma = "Artznei" ] [ pos = "VERB" ]',description:'Phrase with three tokens: a word starting with "her", a lemmatized word, and a verb'},{queryType:"lex",query:"apple",description:"Search for plain string"}];function _t({show:s,queryTypes:t,onModalClose:n}){const i=t&&t.length>0?t:["cql","fcs","lex"],r=Mt.filter(x=>i.includes(x.queryType));if(r.length===0)return l("abort"),null;function l(x){n({query:void 0,queryType:void 0,action:x})}function o(x,d){n({query:x,queryType:d,action:"confirm"})}function h(x,d,j,S){return e.jsxs(B,{children:[e.jsx(T,{md:"auto",className:"d-none d-md-block",children:S&&`${S}.`}),e.jsxs(T,{className:"d-flex flex-column",children:[j!==void 0&&e.jsx("div",{children:j}),e.jsx("div",{dangerouslySetInnerHTML:{__html:Fe(x,d)}})]}),e.jsx(T,{md:"auto",className:"d-flex justify-content-end align-items-baseline",children:e.jsx(q,{size:"sm",onClick:()=>o(x,d),children:"Use Query"})})]},x)}return e.jsxs(U,{id:"search-query-suggestions-modal",show:s,onHide:()=>l("close"),size:"xl",fullscreen:"xl-down",centered:!0,children:[e.jsx(U.Header,{closeButton:!0,children:e.jsx(U.Title,{children:"Search Query Suggestions"})}),e.jsx(U.Body,{className:"px-0",children:e.jsx(Y,{fluid:!0,children:i.map(x=>{var j;const d=r.filter(S=>S.queryType===x);return d.length===0?null:e.jsxs(a.Fragment,{children:[e.jsx(B,{children:e.jsx(T,{children:e.jsx("h4",{className:"border-bottom pb-2",children:((j=Se[x])==null?void 0:j.name)??x.toUpperCase()})})}),d.map((S,L)=>h(S.query,S.queryType,S.description,L+1))]},x)})})}),e.jsx(U.Footer,{children:e.jsx(q,{variant:"primary",onClick:()=>l("close"),children:"Close"})})]})}function xs({disabled:s,value:t,onChange:n,delay:i=300}){const[r,l]=a.useState(t??""),o=us(r,i);return a.useEffect(()=>{n(o)},[n,o]),e.jsx(P.Control,{type:"search",placeholder:"Search for ...",value:r,onChange:h=>l(h.target.value),disabled:s})}const Ne=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bank" viewBox="0 0 16 16">
  <path d="m8 0 6.61 3h.89a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5H15v7a.5.5 0 0 1 .485.38l.5 2a.498.498 0 0 1-.485.62H.5a.498.498 0 0 1-.485-.62l.5-2A.5.5 0 0 1 1 13V6H.5a.5.5 0 0 1-.5-.5v-2A.5.5 0 0 1 .5 3h.89zM3.777 3h8.447L8 1zM2 6v7h1V6zm2 0v7h2.5V6zm3.5 0v7h1V6zm2 0v7H12V6zM13 6v7h1V6zm2-1V4H1v1zm-.39 9H1.39l-.25 1h13.72z"/>
</svg>`,gs=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house-door" viewBox="0 0 16 16">
  <path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4z"/>
</svg>`,Le=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-translate" viewBox="0 0 16 16">
  <path d="M4.545 6.714 4.11 8H3l1.862-5h1.284L8 8H6.833l-.435-1.286zm1.634-.736L5.5 3.956h-.049l-.679 2.022z"/>
  <path d="M0 2a2 2 0 0 1 2-2h7a2 2 0 0 1 2 2v3h3a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-3H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zm7.138 9.995q.289.451.63.846c-.748.575-1.673 1.001-2.768 1.292.178.217.451.635.555.867 1.125-.359 2.08-.844 2.886-1.494.777.665 1.739 1.165 2.93 1.472.133-.254.414-.673.629-.89-1.125-.253-2.057-.694-2.82-1.284.681-.747 1.222-1.651 1.621-2.757H14V8h-3v1.047h.765c-.318.844-.74 1.546-1.272 2.13a6 6 0 0 1-.415-.492 2 2 0 0 1-.94.31"/>
</svg>`;function $e({resource:s,selectedResourceIDs:t,highlighting:n,shouldBeShown:i,onSelectClick:r,languageCodeToName:l}){const[o,h]=a.useState(!1),[x,d]=a.useState(!1);n===void 0&&(n=[null,null,null]);const j=t.includes(s.id);if(typeof i=="function"&&!i(s))return null;if(i===!1)return null;function S(){var f;o&&((f=document.getSelection())==null?void 0:f.type)==="Range"||h(C=>!C)}function L(){r(s,!j)}function g(){d(f=>!f)}return e.jsxs(e.Fragment,{children:[e.jsxs(B,{className:`p-2 m-1 ${o&&"border-bottom"}`,children:[e.jsx(T,{md:"auto",sm:1,onClick:L,children:e.jsx(P.Check,{id:`resource-selection-${s.id}`,"aria-label":`Checkbox for resource: ${s.title}`,children:e.jsx(P.Check.Input,{checked:j,onChange:()=>{}})})}),e.jsxs(T,{md:8,sm:11,className:`mb-sm-2 ${o?"":"text-truncate"}`,onClick:S,children:[e.jsxs("h4",{className:`h5 ${o?"":"text-truncate"}`,children:[e.jsx(se.Highlight,{text:s.title,ranges:n[0]})," ",s.landingPage&&e.jsx("small",{children:e.jsxs("a",{href:s.landingPage,className:"matomo_link",target:"_blank",children:["More information ",e.jsx("i",{dangerouslySetInnerHTML:{__html:gs}})]})})]}),e.jsx("p",{className:`mb-0 ${o?"":"text-truncate"}`,children:s.description&&e.jsx(se.Highlight,{text:s.description,ranges:n[2]})})]}),e.jsxs(T,{md:{span:3,offset:0},sm:{span:11,offset:1},className:`${o?"":" text-truncate"}`,onClick:S,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ne}})," ",e.jsx(se.Highlight,{text:s.institution,ranges:n[1]}),e.jsx("br",{}),e.jsx("i",{dangerouslySetInnerHTML:{__html:Le}})," ",s.languages.map(l).sort().join(", ")]}),s.subResources.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-100"}),e.jsx(T,{md:"auto",sm:1,style:{width:"2.8rem"}}),e.jsx(T,{md:{span:8,offset:0},sm:{span:11,offset:1},children:e.jsxs(q,{variant:"link",size:"sm",className:"ps-0",onClick:g,children:[x?"Collapse":"Expand"," (",s.subResources.length," ","subresources)"]})})]})]}),x&&e.jsx(W,{className:"ms-md-5 ms-sm-2 border-end-0 border-top-0 rounded-end-0 rounded-top-0",children:s.subResources.map(f=>e.jsx($e,{resource:f,selectedResourceIDs:t,shouldBeShown:i,onSelectClick:r,languageCodeToName:l},f.id))})]})}function Ze({title:s,resources:t,selectedResourceIDs:n,expanded:i,shouldBeShown:r,onSelectClick:l,onExpandToggleClick:o,onSelectAllClick:h,onDeselectAllClick:x,languageCodeToName:d}){const[j,S]=a.useState(i);a.useEffect(()=>{S(i)},[i]);function L(){S(f=>!f),o(!j)}function g(){const f=re(t).length,C=t.length,k=re(t).filter(b=>n.includes(b)).length;return e.jsxs(e.Fragment,{children:[C," ",f!==C&&e.jsxs(e.Fragment,{children:["(+ ",f-C," nested)"]})," ","Resource",f!==1?"s":"",k!==f&&e.jsxs(e.Fragment,{children:[", ",k," Resource",k!==1?"s":""," selected"]})]})}return e.jsxs(Y,{className:"border-bottom pb-2 mb-4 px-0",children:[e.jsxs(B,{className:"px-3",children:[e.jsx(T,{md:9,sm:12,children:e.jsx("h3",{children:s})}),e.jsxs(T,{md:3,sm:12,className:"gap-1 d-inline-flex column-gap-2 justify-content-evenly",style:{height:"fit-content"},children:[e.jsxs(q,{size:"sm",variant:"secondary",onClick:L,"aria-expanded":j,children:[j?"Hide":"Show"," Resources"]}),e.jsx(q,{size:"sm",onClick:()=>h(t),children:"Select All"}),e.jsx(q,{size:"sm",onClick:()=>x(t),children:"Deselect All"})]})]}),e.jsx(B,{className:"px-3",children:e.jsx(T,{children:g()})}),e.jsx(ls,{in:j,children:e.jsx(Y,{children:t.map(f=>e.jsx($e,{resource:f,selectedResourceIDs:n,shouldBeShown:r,onSelectClick:l,languageCodeToName:d},f.id))})})]})}function Ot({show:s,showGrouping:t,resources:n,languages:i,availableResources:r,selectedResources:l,onModalClose:o}){const[h,x]=a.useState(l||r),[d,j]=a.useState(gt),[S,L]=a.useState(cs),[g,f]=a.useState(ft),[C,k]=a.useState(""),[b,p]=a.useState({}),[G,V]=a.useState({});a.useEffect(()=>{t&&L(t)},[s,t]),a.useEffect(()=>x(l),[l]);const v=n.filter(y=>r.includes(y.id)).toSorted(Rt[g]),M=se.useFuzzySearchList({list:v,queryText:S==="resource"?C:"",getText:y=>[y.title,y.institution,y.description],mapResultItem:({item:y,score:z,matches:K})=>({item:y,matches:K,score:z})});if(a.useMemo(()=>{const y={},z={};n.forEach(K=>{const Z=K.institution;Object.getOwnPropertyNames(y).includes(Z)||(y[Z]={expanded:!0,resources:[]}),y[Z].resources.push(K),K.languages.forEach(de=>{Object.getOwnPropertyNames(z).includes(de)||(z[de]={expanded:!0,resources:[]}),z[de].resources.push(K)})}),p(y),V(z)},[n]),!n)return null;const E={total:re(n).length,totalRoot:n.length,available:r.length,selected:h.length,visible:re(M.map(y=>y.item)).length,visibleRoot:M.length};function H(y){return fe(y,i)}function m(y,z){const K=h.filter(Z=>!y.includes(Z));x(z?[...K,...y]:K)}function c(y){o({resourceIDs:h,action:y})}function R(y){j(y.target.value)}function F(y){L(y.target.value)}function A(y){f(y.target.value)}function _(){x(r)}function D(){x([])}function $(){x(M.map(y=>y.item.id))}function u(y,z){m(re([y]),z)}function N(y){m(re(y),!0)}function I(y){m(re(y),!1)}function Q(y){return!(!r.includes(y.id)||d==="selected"&&!h.includes(y.id)&&!ds(y,z=>h.includes(z.id)))}function ke(){return S==="institution"?Object.entries(b).toSorted().map(([y,{expanded:z,resources:K}])=>e.jsx(Ze,{title:e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ne}})," ",y]}),resources:K,selectedResourceIDs:h,expanded:z,shouldBeShown:Q,onSelectAllClick:N,onExpandToggleClick:Z=>{p({...b,[y]:{...b[y],expanded:Z}})},onDeselectAllClick:I,onSelectClick:u,languageCodeToName:H},y)):S==="language"?Object.entries(G).toSorted().map(([y,{expanded:z,resources:K}])=>e.jsx(Ze,{title:e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Le}})," ",H(y)," [",y,"]"]}),resources:K,selectedResourceIDs:h,expanded:z,shouldBeShown:Q,onSelectAllClick:N,onExpandToggleClick:Z=>G[y].expanded=Z,onDeselectAllClick:I,onSelectClick:u,languageCodeToName:H},y)):M.map(({item:y,matches:z})=>e.jsx($e,{resource:y,selectedResourceIDs:h,highlighting:z,shouldBeShown:Q,onSelectClick:u,languageCodeToName:H},y.id))}return e.jsxs(U,{id:"resource-selection-modal",show:s,onHide:()=>c("close"),size:"xl",fullscreen:"xl-down",centered:!0,children:[e.jsx(U.Header,{closeButton:!0,children:e.jsx(U.Title,{children:"Resources"})}),e.jsxs(U.Body,{className:"px-0",children:[e.jsx(P,{className:"px-3 pb-3 border-bottom",onSubmit:y=>y.preventDefault(),children:e.jsx(Y,{children:e.jsxs(B,{className:"d-sm-flex row-gap-2 justify-content-around",children:[e.jsx(T,{md:2,sm:6,children:e.jsx(ie,{label:"View",controlId:"resource-view-options-visibility",children:e.jsxs(P.Select,{value:d,onChange:R,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"selected",children:"Selected only"})]})})}),e.jsx(T,{md:2,sm:6,children:e.jsx(ie,{label:"Group by",controlId:"resource-view-options-grouping",children:e.jsxs(P.Select,{value:S,onChange:F,children:[e.jsx("option",{value:"resource",children:"(Resource)"}),e.jsx("option",{value:"institution",children:"Institution"}),e.jsx("option",{value:"language",children:"Language"})]})})}),e.jsx(T,{md:2,sm:6,children:e.jsx(ie,{label:"Sort by",controlId:"resource-view-options-sorting",children:e.jsxs(P.Select,{value:g,onChange:A,disabled:S!=="resource"||C.trim()!=="",children:[e.jsx("option",{value:"title-up",children:"Title (up)"}),e.jsx("option",{value:"title-down",children:"Title (down)"}),e.jsx("option",{value:"institution-up",children:"Institution (up)"}),e.jsx("option",{value:"institution-down",children:"Institution (down)"})]})})}),e.jsx(T,{md:3,sm:12,children:e.jsx(ie,{label:"Resource filter query",controlId:"resource-view-options-filter",children:e.jsx(xs,{disabled:S!=="resource",value:C,onChange:y=>k(y)})})}),e.jsxs(T,{md:3,sm:12,className:"gap-1 d-inline-flex column-gap-2 justify-content-evenly",children:[e.jsx(q,{onClick:_,children:"Select all"}),e.jsx(q,{onClick:$,disabled:d!=="all"||C.trim()==="",children:"Select visible"}),e.jsx(q,{onClick:D,children:"Deselect all"})]})]})})}),e.jsxs("p",{className:"m-4 mb-0",children:[E.selected," / ",E.visible," ",E.available!==E.visible&&e.jsxs(e.Fragment,{children:["(",E.available,")"]})," ","resources selected."]}),e.jsx(Y,{className:"px-3 pt-3",children:ke()})]}),e.jsx(U.Footer,{children:e.jsx(q,{variant:"primary",onClick:()=>c("confirm"),children:"Confirm and Close"})})]})}function Pt(){const[s,t]=a.useState(!1);return[s,()=>{s!==!0&&t(!0)}]}const Ft=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-balloon" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 9.984C10.403 9.506 12 7.48 12 5a4 4 0 0 0-8 0c0 2.48 1.597 4.506 4 4.984M13 5c0 2.837-1.789 5.227-4.52 5.901l.244.487a.25.25 0 1 1-.448.224l-.008-.017c.008.11.02.202.037.29.054.27.161.488.419 1.003.288.578.235 1.15.076 1.629-.157.469-.422.867-.588 1.115l-.004.007a.25.25 0 1 1-.416-.278c.168-.252.4-.6.533-1.003.133-.396.163-.824-.049-1.246l-.013-.028c-.24-.48-.38-.758-.448-1.102a3 3 0 0 1-.052-.45l-.04.08a.25.25 0 1 1-.447-.224l.244-.487C4.789 10.227 3 7.837 3 5a5 5 0 0 1 10 0m-6.938-.495a2 2 0 0 1 1.443-1.443C7.773 2.994 8 2.776 8 2.5s-.226-.504-.498-.459a3 3 0 0 0-2.46 2.461c-.046.272.182.498.458.498s.494-.227.562-.495"/>
</svg>`,ye=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear-fill" viewBox="0 0 16 16">
  <path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z"/>
</svg>`,Ht=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-highlights" viewBox="0 0 16 16">
  <path d="M16 8A8 8 0 1 0 0 8a8 8 0 0 0 16 0m-8 5v1H4.5a.5.5 0 0 0-.093.009A7 7 0 0 1 3.1 13zm0-1H2.255a7 7 0 0 1-.581-1H8zm-6.71-2a7 7 0 0 1-.22-1H8v1zM1 8q0-.51.07-1H8v1zm.29-2q.155-.519.384-1H8v1zm.965-2q.377-.54.846-1H8v1zm2.137-2A6.97 6.97 0 0 1 8 1v1z"/>
</svg>`,Dt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-magic" viewBox="0 0 16 16">
  <path d="M9.5 2.672a.5.5 0 1 0 1 0V.843a.5.5 0 0 0-1 0zm4.5.035A.5.5 0 0 0 13.293 2L12 3.293a.5.5 0 1 0 .707.707zM7.293 4A.5.5 0 1 0 8 3.293L6.707 2A.5.5 0 0 0 6 2.707zm-.621 2.5a.5.5 0 1 0 0-1H4.843a.5.5 0 1 0 0 1zm8.485 0a.5.5 0 1 0 0-1h-1.829a.5.5 0 0 0 0 1zM13.293 10A.5.5 0 1 0 14 9.293L12.707 8a.5.5 0 1 0-.707.707zM9.5 11.157a.5.5 0 0 0 1 0V9.328a.5.5 0 0 0-1 0zm1.854-5.097a.5.5 0 0 0 0-.706l-.708-.708a.5.5 0 0 0-.707 0L8.646 5.94a.5.5 0 0 0 0 .707l.708.708a.5.5 0 0 0 .707 0l1.293-1.293Zm-3 3a.5.5 0 0 0 0-.706l-.708-.708a.5.5 0 0 0-.707 0L.646 13.94a.5.5 0 0 0 0 .707l.708.708a.5.5 0 0 0 .707 0z"/>
</svg>`,qt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
  <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
</svg>`,zt=a.lazy(()=>Lt(()=>import("./fcs-sru-aggregator-ui-query-builder-0.0.0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url));function es(s,t=""){const n=s.get("query");return n||t}function ss(s,t="cql"){const n=s.get("queryType");if(n){if(Be.find(i=>i.id===n)!==void 0)return n;console.warn("Found unsupported queryType in search params",n)}return t}function Vt({resources:s,languages:t,onSearch:n,availableResources:i=null,selectedResources:r=null,hasSearch:l=!1,disabled:o=!1}){var Ge;const[h,x]=ns(),[d,j]=a.useState(!1),[S,L]=a.useState(cs),[g,f]=a.useState(!1),[C,k]=a.useState(!1),[b,p]=a.useState(!1),[G,V]=Pt(),[v,M]=a.useState(te),[E,H]=a.useState(_e),[m,c]=a.useState(ss(h,At)),[R,F]=a.useState(i??[]),[A,_]=a.useState(r??[]),[D,$]=a.useState(we[0]),[u,N]=a.useState(es(h,"")),[I]=a.useState(null),[Q,ke]=a.useState(!1);a.useEffect(()=>{_(r??[])},[r]);const y=a.useCallback(w=>{const O=bt(w,m,E==="byGuess"?te:v);return i&&i.length>0?O.filter(ee=>i.includes(ee)):O},[m,v,E,i]);a.useEffect(()=>{const w=y(s);F(w),_(O=>O.filter(ee=>w.includes(ee)))},[s,y]);const z=a.useCallback(()=>{const w={language:v,languageFilter:E,queryType:m,query:u,resourceIDs:A??[],numberOfResults:D};w.query!==""&&w.resourceIDs.length!==0&&n(w)},[v,E,D,n,u,m,A]);a.useEffect(()=>{if(h&&(N(O=>es(h,O)),c(O=>ss(h,O)),!h.get("x-aggregation-context"))){const O=h.get("mode");O&&(O==="search"&&z(),x(ee=>(ee.delete("mode"),ee)))}},[h,x,z]),a.useEffect(()=>x(w=>(w.set("query",u),w)),[u,x]),a.useEffect(()=>x(w=>(w.set("queryType",m),w)),[m,x]);const K=wt(s,A??[]).length,Z=s.find(w=>w.searchCapabilitiesResolved.includes("ADVANCED_SEARCH"))!==void 0,de=s.find(w=>w.searchCapabilitiesResolved.includes("LEX_SEARCH"))!==void 0,ys=Je.includes(m);function Ss(w){w&&c(w)}function vs(w){let O=Number.parseInt(w.target.value);O<10&&(O=10),O>250&&(O=250),we.includes(O)||console.warn("Invalid number of results?!",{valid:we,value:O}),$(O)}function Rs({language:w,filter:O,action:ee}){f(!1),ee!=="abort"&&(M(w),H(O))}function Cs({resourceIDs:w,action:O}){j(!1),O!=="abort"&&_(w)}function Ns({query:w,queryType:O,action:ee}){k(!1),ee!=="abort"&&ee!=="close"&&(!w||!O||(c(O),N(w)))}function Ls({query:w,action:O}){p(!1),O!=="abort"&&O!=="close"&&N(w)}function Qe(w){N(w)}function Ts(w){w.preventDefault(),z()}function ks(){const w=(A??[]).length;return w===1?"1 selected resource":s.length===w||R.length===w?`All available resources (${w})`:`${w} selected resources`}return e.jsxs("search",{id:"fcs-query",children:[e.jsxs(P,{noValidate:!0,onSubmit:Ts,children:[e.jsxs(zs,{size:l?void 0:"lg",hasValidation:!0,children:[e.jsx(q,{variant:"outline-secondary",type:"button",id:"fcs-search-query-suggestions-button","aria-label":"Open modal with suggestions for search queries",onClick:()=>k(!0),children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ft},"aria-hidden":"true"})}),e.jsx(P.Control,{placeholder:"Elephant","aria-label":"search query input","aria-describedby":"fcs-search-input-button",className:"text-center search-query-input",disabled:o,"aria-disabled":o,value:u,isInvalid:!!I,...Q?{as:ms,queryType:m,onChange:Qe}:{onChange:w=>Qe(w.target.value)}}),ys&&e.jsx(q,{id:"fcs-search-input-query-builder-button",variant:"outline-secondary","aria-label":"Open modal to use the visual query builder to construct a search query",className:"border-end-0 d-none d-md-block",onClick:()=>{V(),p(!0)},children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Dt},"aria-hidden":"true"})}),e.jsx(Vs,{id:"fcs-search-input-enhanced-button",value:"enhance-query",type:"checkbox",checked:Q,onChange:()=>ke(w=>!w),variant:"outline-secondary","aria-label":"Enable enhanced visual input support with syntax highlighting",className:"d-flex align-items-center border-end-0",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ht},"aria-hidden":"true"})}),e.jsxs(q,{variant:"outline-primary",type:"submit",id:"fcs-search-input-button",disabled:o||u.trim().length===0,"aria-disabled":o,"aria-label":"Start the search",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:qt},"aria-hidden":"true",className:"d-inline d-md-none"}),e.jsx("span",{className:"d-none d-md-inline",children:"Search"})]}),e.jsx(P.Control.Feedback,{type:"invalid",children:I==null?void 0:I.msg})]}),e.jsxs("div",{id:"fcs-query-filters",className:"mt-2 mb-3 lh-lg text-center",children:["Perform a"," ",e.jsxs(le,{className:"d-inline-block",onSelect:Ss,"aria-disabled":o,"aria-label":"Search query type",children:[e.jsxs(le.Toggle,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2 no-arrow",disabled:o,"aria-disabled":o,style:Se[m]?{"--color":Se[m].color}:{},children:[((Ge=Se[m])==null?void 0:Ge.searchLabel)||"???"," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:ye},"aria-hidden":"true"})]}),e.jsx(le.Menu,{children:Be.filter(w=>w.id==="cql"||w.id==="fcs"&&Z||w.id==="lex"&&de).map(w=>e.jsx(le.Item,{as:"button",eventKey:w.id,onClick:O=>O.preventDefault(),style:{"--color":w.color,background:"color-mix(in srgb, var(--color) 50%, transparent)"},children:w.name},w.id))})]})," ","in"," ",e.jsxs(q,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2",disabled:o,"aria-disabled":o,onClick:()=>{L("resource"),j(!0)},children:[ks()," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:ye},"aria-hidden":"true"})]})," ","from"," ",e.jsxs(q,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2",disabled:o,"aria-disabled":o,onClick:()=>{L("institution"),j(!0)},children:[K," Institution",K!==1?"s":""," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:ye},"aria-hidden":"true"})]})," ","in"," ",e.jsxs(q,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2",onClick:()=>f(!0),disabled:o,"aria-disabled":o,children:[fe(v,t??{})," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:ye},"aria-hidden":"true"})]})," ","with up to"," ",e.jsx(P.Select,{size:"sm",className:"d-inline-block w-auto mx-1",onChange:vs,value:D,"aria-label":"Number of search results per endpoint",disabled:o,"aria-disabled":o,children:we.map(w=>e.jsx("option",{value:w,children:w},w))})," ","results per endpoint."]})]}),e.jsx(Et,{languages:t,resources:s,searchLanguage:v,show:g,onModalClose:Rs}),e.jsx(Ot,{resources:s,languages:t,availableResources:R,selectedResources:A??[],show:d,showGrouping:S,onModalClose:Cs}),e.jsx(_t,{queryTypes:[m],show:C,onModalClose:Ns}),Je.includes(m)&&G&&e.jsx(a.Suspense,{fallback:e.jsx(e.Fragment,{children:"Trying to load Query Builder extension ..."}),children:e.jsx(zt,{query:u,queryType:m,resources:s,selectedResources:A,show:b,onModalClose:Ls})})]})}const Ut=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots" viewBox="0 0 16 16">
  <path d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"/>
</svg>`;function Bt({searchId:s,resourceId:t,numberOfResults:n,pollDelay:i=1500}){const r=ce(),l=rs(),[o,h]=a.useState(!1),{isPending:x,mutate:d,reset:j}=is({mutationFn:at.bind(null,r,s,{resourceId:t,numberOfResults:n}),mutationKey:["search-result-load-more",s,t],onSuccess:async p=>{p!==void 0&&s!==p&&console.warn("SearchIDs should be the same?!",{searchId:s,searchIdNewButSame:p,resourceId:t}),await l.invalidateQueries({queryKey:["search-results",s,t]}),h(!0)}});i??(i=1500);const{data:S,isLoading:L,isFetching:g}=xe({queryKey:["search-results",s,t],queryFn:ct.bind(null,r,s,t),enabled:o,refetchInterval(p){return p.state.data&&p.state.data.inProgress?i:!1}}),f=x||L||g,C=!!S&&!S.inProgress,k=f||o;o&&C&&(o&&h(!1),l.invalidateQueries({queryKey:["search-result-details",s,t]}));async function b(){j(),d()}return e.jsx(q,{className:"more-results-button",disabled:k,onClick:b,children:k?e.jsx(as,{animation:"border",className:"d-block"}):e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ut}})," Load more results"]})})}const Te=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link-45deg" viewBox="0 0 16 16">
  <path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1 1 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4 4 0 0 1-.128-1.287z"/>
  <path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243z"/>
</svg>`;function fs({data:s}){const t=a.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs(He,{hover:!0,responsive:!0,className:"mb-0 results-kwic",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Left Context"}),e.jsx("th",{scope:"col",children:"Hit"}),e.jsx("th",{scope:"col",children:"Right Context"})]})}),e.jsx("tbody",{children:s.kwics.map((n,i)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"text-end text-muted d-none d-sm-table-cell",children:i+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[n.reference&&e.jsx("a",{href:n.reference,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Te}})})," ",n.pid&&e.jsx(ge,{placement:"auto-start",container:t,delay:{show:250,hide:400},overlay:e.jsx(Ce,{id:`ttip-${n.pid}-${i}`,children:n.pid}),children:e.jsx(ae,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:n.left}),e.jsx("td",{children:e.jsx("mark",{children:e.jsx("strong",{children:n.keyword})})}),e.jsx("td",{children:n.right})]},`${n.pid??n.reference??s.resource.id}-${i}`))})]}),e.jsx("div",{ref:t,className:"tooltip-mounting-point"})]})}function ps({data:s}){const t=a.useRef(null);return e.jsxs("div",{className:"results-lexical-entry d-flex flex-column flex-wrap column-gap-2 row-gap-2",children:[s.lexEntries.map((n,i)=>e.jsx(W,{className:"flex-grow-1",children:e.jsxs(W.Body,{children:[e.jsx(W.Title,{children:n.fields.filter(r=>r.type==="lemma").map(r=>r.values).flat(1).map(r=>e.jsx("span",{children:r.value}))}),e.jsxs(Ee,{variant:"flush",children:[(n.lang||n.langUri)&&e.jsxs(Ee.Item,{children:[e.jsx("strong",{children:"lang"}),": ",n.lang," ",n.langUri]}),n.fields.filter(r=>r.type!=="lemma").map(r=>e.jsxs(Ee.Item,{children:[e.jsx("strong",{children:r.type}),":",r.values.map((l,o)=>e.jsx("span",{className:"ms-2 lex-value",children:l.value},o))]},r.type))]}),e.jsx(W.Link,{children:n.reference&&e.jsxs("a",{href:n.reference,className:"matomo_link",target:"_blank",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Te}})," Original results ..."]})}),e.jsx(W.Link,{children:n.pid&&e.jsx(ge,{placement:"auto-start",container:t,delay:{show:250,hide:400},overlay:e.jsx(Ce,{id:`ttip-${n.pid}-${i}`,children:n.pid}),children:e.jsx(ae,{bg:"secondary",className:"pid-badge",children:"PID"})})})]})},`${n.pid??n.reference??s.resource.id}-${i}`)),e.jsx("div",{ref:t,className:"tooltip-mounting-point"})]})}function js({data:s}){const t=a.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs(He,{hover:!0,responsive:!0,className:"mb-0 results-lex-plain",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Result with Hit"})]})}),e.jsx("tbody",{children:s.kwics.map((n,i)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"text-end text-muted d-none d-sm-table-cell",children:i+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[n.reference&&e.jsx("a",{href:n.reference,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Te}})})," ",n.pid&&e.jsx(ge,{placement:"auto-start",container:t,delay:{show:250,hide:400},overlay:e.jsx(Ce,{id:`ttip-${n.pid}-${i}`,children:n.pid}),children:e.jsx(ae,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:n.fragments.map((r,l)=>r.hit&&!r.hitKind?e.jsx("mark",{children:e.jsx("strong",{children:r.text})},l):r.hit&&r.hitKind?e.jsx("span",{className:`lex-hitkind-${r.hitKind}`,title:`Annotated as "${r.hitKind.split("-").slice(1).join("-")}"`,children:r.text},l):e.jsx("span",{children:r.text},l))})]},`${n.pid??n.reference??s.resource.id}-${i}`))})]}),e.jsx("div",{ref:t,className:"tooltip-mounting-point"})]})}function bs({data:s}){const t=a.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs(He,{hover:!0,responsive:!0,className:"mb-0 results-plain",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Result with Hit"})]})}),e.jsx("tbody",{children:s.kwics.map((n,i)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"text-end text-muted d-none d-sm-table-cell",children:i+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[n.reference&&e.jsx("a",{href:n.reference,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Te}})})," ",n.pid&&e.jsx(ge,{placement:"auto-start",container:t,delay:{show:250,hide:400},overlay:e.jsx(Ce,{id:`ttip-${n.pid}-${i}`,children:n.pid}),children:e.jsx(ae,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:n.fragments.map((r,l)=>r.hit&&!r.hitKind?e.jsx("mark",{children:e.jsx("strong",{children:r.text})},l):e.jsx("span",{children:r.text},l))})]},`${n.pid??n.reference??s.resource.id}-${i}`))})]}),e.jsx("div",{ref:t,className:"tooltip-mounting-point"})]})}const $t=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
  <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"/>
  <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"/>
</svg>`,Qt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-envelope-arrow-up" viewBox="0 0 16 16">
  <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4.5a.5.5 0 0 1-1 0V5.383l-7 4.2-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h5.5a.5.5 0 0 1 0 1H2a2 2 0 0 1-2-1.99zm1 7.105 4.708-2.897L1 5.383zM1 4v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1"/>
  <path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m.354-5.354 1.25 1.25a.5.5 0 0 1-.708.708L13 12.207V14a.5.5 0 0 1-1 0v-1.717l-.28.305a.5.5 0 0 1-.737-.676l1.149-1.25a.5.5 0 0 1 .722-.016"/>
</svg>`,ws=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
  <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/>
</svg>`;function Gt({show:s,searchId:t,resourceId:n,result:i,viewMode:r,showDiagnostics:l,onModalClose:o}){var m;const h=ce(),{languages:x,weblichtLanguages:d}=qe(),{numberOfResults:j,queryType:S,language:L,languageFilter:g}=Ue(),[f,C]=a.useState(l);a.useEffect(()=>C(l),[l]);const[k,b]=a.useState(r);a.useEffect(()=>b(r),[r]);const p=i.exception||((m=i.diagnostics)==null?void 0:m.filter(c=>c.uri!==Re).length)>0;function G(){return!i||i.nextRecordPosition===-1||i.numberOfRecords===-1?!1:(i.numberOfRecords===i.kwics.length,!0)}let V=null,v=!1;if(!d.includes(L)){if(L===te)if(i.resource.languages&&i.resource.languages.length===1)V=i.resource.languages[0];else{const c=[...new Set(i.kwics.map(R=>R.language).filter(R=>R!==null))];c.length===1&&(V=c[0])}V||(console.warn("Cannot use WebLicht: unsupported language",{language:L,languageFilter:g}),v=!0)}function M(c){b(c.target.value)}function E(){return i?k==="kwic"&&(S!=="lex"||!i.isLexHits)?e.jsx(fs,{data:i}):k==="lexical-entry"?e.jsx(ps,{data:i}):S==="lex"&&i.isLexHits?e.jsx(js,{data:i}):e.jsx(bs,{data:i}):null}function H(){return e.jsxs(e.Fragment,{children:["Showing ",e.jsx("strong",{children:i.kwics.length}),G()?e.jsxs(e.Fragment,{children:[" / ",e.jsx("strong",{children:i.numberOfRecords})]}):""," ","results."]})}return e.jsxs(U,{show:s,onHide:()=>o(),size:"xl",fullscreen:"lg-down",centered:!0,className:"resource-search-result-modal",children:[e.jsx(U.Header,{closeButton:!0,children:e.jsx(U.Title,{children:i.resource.title})}),e.jsxs(U.Body,{className:"resource-info",children:[e.jsxs("dl",{className:"mb-0","aria-label":"Resource information",children:[e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ne}}),e.jsx("span",{children:" Institution"})]}),e.jsx("dd",{className:"mb-0",children:i.resource.institution}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:ws}}),e.jsx("span",{children:" Description"})]}),i.resource.description&&e.jsxs(e.Fragment,{children:[e.jsx("dd",{className:"mb-0",children:i.resource.description}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Le}}),e.jsx("span",{children:" Languages"})]})]}),e.jsx("dd",{className:"mb-0",children:i.resource.languages.map(x?c=>fe(c,x):c=>c).toSorted().join(", ")}),e.jsx("dt",{children:"Persistent Identifier"}),e.jsx("dd",{children:i.resource.handle})]}),i.resource.landingPage&&e.jsxs("a",{href:i.resource.landingPage,className:"matomo_link",target:"_blank",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:gs}})," More Information ..."]}),e.jsx("hr",{}),e.jsxs(B,{className:"row-gap-2",children:[e.jsx(T,{lg:"auto",md:3,sm:6,children:e.jsx(ie,{label:"View mode",controlId:"results-view-mode",children:e.jsxs(P.Select,{value:k,onChange:M,children:[e.jsx("option",{value:"plain",children:"Plain"}),(S!=="lex"||!i.isLexHits)&&e.jsx("option",{value:"kwic",children:"Keyword in Context"}),S==="fcs"&&e.jsx("option",{value:"annotation-layers",children:"Annotation Layers"}),S==="lex"&&e.jsx("option",{value:"lexical-entry",children:"Dictionary"})]})})}),e.jsx(T,{lg:3,md:3,sm:6,className:"align-content-center",children:e.jsx(P.Check,{disabled:!p,checked:f,onChange:()=>C(c=>!c),id:"results-modal-view-warnings-errors",label:"Show warning and error messages"})}),e.jsxs(T,{lg:"auto",md:6,sm:6,className:"d-flex flex-grow-1 column-gap-3 align-items-center justify-content-end",children:[e.jsxs(le,{children:[e.jsxs(le.Toggle,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:$t}})," Download"]}),e.jsx(le.Menu,{children:It.map(({id:c,label:R})=>e.jsxs(le.Item,{href:ut(h,t,n,c,L,g),className:"matomo_download",children:["As ",e.jsx("strong",{children:R})," file"]},c))})]}),e.jsxs(q,{disabled:v,"aria-disabled":v,href:ht(h,t,n,V,L,g),className:"matomo_link",target:"_blank",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Qt}})," Send to Weblicht"]})]})]}),e.jsx("hr",{}),e.jsx("p",{children:H()}),E()]}),f&&p&&e.jsxs(U.Body,{className:"border-top",children:[i.exception&&e.jsxs(J,{variant:"danger","aria-label":"Error information",children:[e.jsxs(J.Heading,{style:{fontSize:"1rem"},children:[e.jsx("span",{className:"text-uppercase",children:"Exception:"})," ",e.jsx("span",{"aria-label":"Error message",children:i.exception.message})]}),i.exception.cause&&e.jsxs("p",{className:"mb-0 small",children:["Cause: ",i.exception.cause]}),i.exception.klass&&e.jsxs("p",{className:"mb-0 small",children:["Caused by: ",e.jsx("code",{children:i.exception.klass})]})]}),i.diagnostics.filter(c=>c.uri!==Re).map(c=>e.jsxs(J,{variant:"warning",children:[e.jsx(J.Heading,{style:{fontSize:"1rem"},children:c.message}),c.diagnostic&&e.jsxs("p",{className:"mb-0 small",children:["Details: ",c.diagnostic]}),e.jsxs("p",{className:"mb-0 small",children:["Diagnostic type: ",e.jsx("code",{children:c.uri})]})]},`${c.uri}-${c.message}-${c.diagnostic}`))]}),G()&&e.jsx(U.Footer,{className:"justify-content-center border-top py-2",children:e.jsx(Bt,{searchId:t,resourceId:n,numberOfResults:j})})]})}const Kt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
  <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"/>
  <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"/>
</svg>`;function Wt({searchId:s,resourceId:t,resultInfo:n,viewMode:i,showResourceDetails:r,showDiagnostics:l}){var H;const o=ce(),{languages:h}=qe(),{queryType:x}=Ue(),d=a.useId(),[j,S]=a.useState(!0),[L,g]=a.useState(!1),f=n.inProgress,C=n.numberOfRecordsLoaded>0,k=n.exception||((H=n.diagnostics)==null?void 0:H.filter(m=>m.uri!==Re).length)>0,{data:b,isLoading:p,isError:G}=xe({queryKey:["search-result-details",s,t],queryFn:dt.bind(null,o,s,t),enabled:!f});if(f||!C&&(l&&!k||!l)||!b)return null;function V(){g(!0)}function v(){g(!1)}function M(){return b?b.numberOfRecords===-1?b.kwics.length:b.numberOfRecords===b.kwics.length&&b.nextRecordPosition===-1?`${b.kwics.length} / ${b.numberOfRecords}?`:`${b.kwics.length} / ${b.numberOfRecords}`:null}function E(){return b?i==="kwic"&&(x!=="lex"||!b.isLexHits)?e.jsx(fs,{data:b}):i==="lexical-entry"?e.jsx(ps,{data:b}):x==="lex"&&b.isLexHits?e.jsx(js,{data:b}):e.jsx(bs,{data:b}):null}return e.jsxs(e.Fragment,{children:[e.jsxs(W,{className:"my-1 resource-search-result",role:"group","aria-label":`Results and details for resource ${b.resource.title}`,children:[e.jsxs(W.Header,{className:"d-flex accordion",children:[e.jsxs("button",{type:"button",onClick:()=>S(m=>!m),"aria-controls":d,"aria-expanded":j,className:`me-3 w-auto flex-grow-1 d-block text-start collapse-toggle-btn ${j?"":"collapsed"}`,children:[e.jsx(ae,{bg:"",className:"text-bg-light border me-2","aria-label":"Number of results (total amount, or currently loaded amount with total available)",children:M()}),e.jsx("span",{"aria-label":"Resource title",children:b.resource.title}),e.jsx("small",{className:"text-muted","aria-label":"Institution name",children:b.resource.institution})]}),e.jsx("div",{className:"d-inline-block ms-auto",children:e.jsxs(q,{size:"sm",onClick:V,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Kt}})," View"]})})]}),e.jsx(ls,{in:j,children:e.jsxs("div",{id:d,children:[r&&e.jsx(W.Body,{className:"border-bottom resource-info",children:e.jsxs("dl",{className:"mb-0","aria-label":"Resource information",children:[e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ne}}),e.jsx("span",{children:" Institution"})]}),e.jsx("dd",{className:"mb-0",children:b.resource.institution}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:ws}}),e.jsx("span",{children:" Description"})]}),b.resource.description&&e.jsxs(e.Fragment,{children:[e.jsx("dd",{className:"mb-0",children:b.resource.description}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Le}}),e.jsx("span",{children:" Languages"})]})]}),e.jsx("dd",{className:"mb-0",children:b.resource.languages.map(h?m=>fe(m,h):m=>m).toSorted().join(", ")})]})}),C&&e.jsx(W.Body,{children:E()}),l&&k&&e.jsxs(W.Body,{className:C?"border-top":"",children:[b.exception&&e.jsxs(J,{variant:"danger","aria-label":"Error information",children:[e.jsxs(J.Heading,{style:{fontSize:"1rem"},children:[e.jsx("span",{className:"text-uppercase",children:"Exception:"})," ",e.jsx("span",{"aria-label":"Error message",children:b.exception.message})]}),b.exception.cause&&e.jsxs("p",{className:"mb-0 small",children:["Cause: ",b.exception.cause]}),b.exception.klass&&e.jsxs("p",{className:"mb-0 small",children:["Caused by: ",e.jsx("code",{children:b.exception.klass})]})]}),b.diagnostics.filter(m=>m.uri!==Re).map(m=>e.jsxs(J,{variant:"warning",children:[e.jsx(J.Heading,{style:{fontSize:"1rem"},children:m.message}),m.diagnostic&&e.jsxs("p",{className:"mb-0 small",children:["Details: ",m.diagnostic]}),e.jsxs("p",{className:"mb-0 small",children:["Diagnostic type: ",e.jsx("code",{children:m.uri})]})]},`${m.uri}-${m.message}-${m.diagnostic}`))]})]})})]}),e.jsx(Gt,{show:L,searchId:s,resourceId:t,result:b,viewMode:i,showDiagnostics:l,onModalClose:v})]})}const Yt="plain",Xt="default",Jt={default:()=>()=>0,"title-up":s=>(t,n)=>{var l,o;const i=((l=s.get(t.id))==null?void 0:l.title)||"",r=((o=s.get(n.id))==null?void 0:o.title)||"";return i.localeCompare(r)},"title-down":s=>(t,n)=>{var l,o;const i=((l=s.get(t.id))==null?void 0:l.title)||"",r=((o=s.get(n.id))==null?void 0:o.title)||"";return-i.localeCompare(r)},"result-count-total-up":()=>(s,t)=>{const n=s.numberOfRecords!==-1?s.numberOfRecords:s.numberOfRecordsLoaded,i=t.numberOfRecords!==-1?t.numberOfRecords:t.numberOfRecordsLoaded;return n-i},"result-count-total-down":()=>(s,t)=>{const n=s.numberOfRecords!==-1?s.numberOfRecords:s.numberOfRecordsLoaded;return(t.numberOfRecords!==-1?t.numberOfRecords:t.numberOfRecordsLoaded)-n}};function Zt({searchId:s,pollDelay:t=1500}){const n=ce(),{resources:i}=qe(),{query:r,queryType:l,resourceIDs:o}=Ue(),[h,x]=a.useState(Yt),[d,j]=a.useState(Xt),[S,L]=a.useState(""),[g,f]=a.useState(!1),[C,k]=a.useState(!1),b=a.useMemo(()=>{const u=new Map;return i==null||i.forEach(N=>{u.set(N.id,N)}),Jt[d](u)},[d,i]);t??(t=1500);const{data:p}=xe({queryKey:["search-results",s],queryFn:ot.bind(null,n,s??""),enabled:!!s,refetchInterval(u){return u.state.data&&u.state.data.inProgress>0?t:!1}}),G=a.useMemo(()=>(p==null?void 0:p.results.toSorted(b))||[],[p,b]),V=l==="lex"&&(p==null?void 0:p.results.every(u=>u.numberOfRecords<=0||u.isLexHits===!0)),v=o.length,M=(p==null?void 0:p.inProgress)??v,E=a.useMemo(()=>(p==null?void 0:p.results.filter(u=>u.numberOfRecords>0).length)??0,[p]),H=a.useMemo(()=>(p==null?void 0:p.results.filter(u=>u.numberOfRecords>0&&u.diagnostics.length>0).length)??0,[p]),m=a.useMemo(()=>(p==null?void 0:p.results.filter(u=>u.numberOfRecords<=0&&u.diagnostics.length===0&&u.exception===null).length)??0,[p]),c=a.useMemo(()=>(p==null?void 0:p.results.filter(u=>u.numberOfRecords<=0&&(u.diagnostics.length>0||u.exception!==null)).length)??0,[p]),R=a.useMemo(()=>(p==null?void 0:p.results.filter(u=>u.numberOfRecords<=0&&u.exception!==null).length)??0,[p]),F=a.useMemo(()=>(p==null?void 0:p.results.filter(u=>u.numberOfRecords<=0&&u.diagnostics.length>0&&u.exception===null).length)??0,[p]),A=a.useMemo(()=>(p==null?void 0:p.results.map(u=>u.numberOfRecords!==-1?u.numberOfRecords:u.numberOfRecordsLoaded).reduce((u,N)=>u+N,0))??0,[p]),_=a.useMemo(()=>(p==null?void 0:p.results.map(u=>u.numberOfRecordsLoaded).reduce((u,N)=>u+N,0))??0,[p]);{const[u,N]=a.useState(!1);a.useEffect(()=>{p&&M===0&&(u||(N(!0),os(r,l,_)))},[p,M,r,l,s,u,_])}function D(u){x(u.target.value)}function $(u){j(u.target.value)}return e.jsxs("div",{id:"search-results",className:"mt-2 mb-4",children:[e.jsx(ge,{placement:"auto",overlay:e.jsxs(Ie,{id:"search-progress-information-popover",children:[e.jsx(Ie.Header,{children:"Search Progress Information"}),e.jsxs(Ie.Body,{style:{textIndent:"2rem hanging"},children:[e.jsxs("div",{children:[e.jsx("code",{children:v.toString().padStart(4," ")})," resources requested"]}),M>0&&e.jsxs("div",{children:[e.jsx("code",{children:M.toString().padStart(4," ")})," ↳ resources pending"]}),e.jsx("hr",{className:"mt-2 mb-1"}),e.jsxs("div",{children:[e.jsx("code",{children:(m+c).toString().padStart(4," ")})," ","resources without results"]}),e.jsxs("div",{children:[e.jsx("code",{children:m.toString().padStart(4," ")})," ↳ OK, without issues"]}),F>0&&e.jsxs("div",{children:[e.jsx("code",{children:F.toString().padStart(4," ")})," ↳ with warnings"]}),R>0&&e.jsxs("div",{children:[e.jsx("code",{children:R.toString().padStart(4," ")})," ↳ due to fatal errors"]}),e.jsx("hr",{className:"mt-2 mb-1"}),e.jsxs("div",{children:[e.jsx("code",{children:E.toString().padStart(4," ")})," resources with results"]}),H>0&&e.jsxs("div",{children:[e.jsx("code",{children:H.toString().padStart(4," ")})," ↳ with warnings"]}),e.jsx("hr",{className:"mt-2 mb-0"}),e.jsx("hr",{className:"mt-1 mb-1"}),e.jsxs("div",{children:[e.jsxs("code",{children:[" ",_," ","/"," ",A]})," ","total hits"]})]})]}),children:e.jsxs(je,{className:"mb-3",children:[e.jsx(je,{variant:"success",now:E,max:v,label:e.jsxs("span",{children:[E," resources with results"]}),"aria-label":"Resources with results"}),e.jsx(je,{variant:"secondary",now:m+c,max:v,label:e.jsxs("span",{children:[m+c," resources without results"]}),"aria-label":"Resources without results (might be due to issues)"}),e.jsx(je,{striped:!0,animated:!0,now:M,max:v,label:e.jsxs("span",{children:["Search through ",M," Resources"]}),"aria-label":"Resources with pending results"})]})}),e.jsx(W,{className:"mb-2",role:"group","aria-label":"Result display and filter options",children:e.jsx(W.Body,{children:e.jsxs(B,{className:"row-gap-2",children:[e.jsx(T,{lg:"auto",md:6,sm:6,children:e.jsx(ie,{label:"View mode",controlId:"results-view-mode",children:e.jsxs(P.Select,{value:h,onChange:D,children:[e.jsx("option",{value:"plain",children:"Plain"}),(l!=="lex"||!V)&&e.jsx("option",{value:"kwic",children:"Keyword in Context"}),l==="fcs"&&e.jsx("option",{value:"annotation-layers",children:"Annotation Layers"}),l==="lex"&&e.jsx("option",{value:"lexical-entry",children:"Dictionary"})]})})}),e.jsx(T,{lg:"auto",md:6,sm:6,children:e.jsx(ie,{label:"Sorting",controlId:"results-sorting",children:e.jsxs(P.Select,{value:d,onChange:$,children:[e.jsx("option",{value:"default",children:"(default)"}),e.jsx("option",{value:"title-up",children:"Title (up)"}),e.jsx("option",{value:"title-down",children:"Title (down)"}),e.jsx("option",{value:"result-count-total-up",children:"Total result count (up)"}),e.jsx("option",{value:"result-count-total-down",children:"Total result count (down)"})]})})}),e.jsx(T,{lg:"auto",md:12,sm:6,className:"flex-fill order-xl-4",children:e.jsx(ie,{label:"Result filter query",controlId:"result-filter",children:e.jsx(xs,{disabled:d!=="default"||!0,value:S,onChange:u=>L(u)})})}),e.jsxs(T,{lg:"auto",md:12,sm:12,className:"align-content-center order-xl-3",children:[e.jsx(P.Check,{checked:g,onChange:()=>f(u=>!u),id:"results-view-resource-details",label:"Show result details"}),e.jsx(P.Check,{checked:C,onChange:()=>k(u=>!u),id:"results-view-warnings-errors",label:"Show warning and error messages"})]})]})})}),s&&p&&G.map(u=>e.jsx(Wt,{searchId:s,resourceId:u.id,resultInfo:u,viewMode:h,showResourceDetails:g,showDiagnostics:C},`${s}-${u.id}`))]})}const en=""+new URL("assets/logo-fcs-dark.png",import.meta.url).href,ts=""+new URL("assets/logo-fcs.png",import.meta.url).href;function sn(){const s=ce(),[t,n]=ns(),[i,r]=a.useState([]),[l,o]=a.useState({}),[h,x]=a.useState([]),[d,j]=a.useState(null),[S,L]=a.useState(!1),[g,f]=a.useState(null),[C,k]=a.useState([]),{data:b,isLoading:p,isError:G}=xe({queryKey:["init"],queryFn:rt.bind(null,s)});a.useEffect(()=>{if(!b)return;const m=pt(b.resources);o(b.languages),x(b.weblichtLanguages),r(m),j(re(m))},[b]),a.useEffect(()=>{if(!i||i.length===0)return;const m=t.get("x-aggregation-context");if(m){try{const c=JSON.parse(m),{selected:R,unavailable:F}=jt(i,c);R.length>0&&(j(R),k(A=>[...A,{title:"Resource Selection",body:e.jsxs(e.Fragment,{children:["Preselected ",e.jsx("strong",{children:R.length})," resources:",e.jsx("br",{}),e.jsx("ul",{className:"ps-3",children:R.map(_=>e.jsx("li",{style:{wordBreak:"break-all",fontSize:"0.7rem"},children:_}))})]}),variant:"success"}])),F.length>0&&k(A=>[...A,{title:"Resource Selection",body:e.jsxs(e.Fragment,{children:["Unable to select ",e.jsx("strong",{children:F.length})," resources:",e.jsx("br",{}),e.jsx("ul",{className:"ps-3",children:F.map(_=>e.jsx("li",{style:{wordBreak:"break-all",fontSize:"0.7rem"},children:_}))})]}),variant:"warning"}])}catch(c){console.error('Error trying to parse "x-aggregation-context" search parameter!',{aggregationContext:m},c),c instanceof Error&&k(R=>[...R,{title:"Resource Selection",body:e.jsxs(e.Fragment,{children:["Unable to preselect resources: ",c.name,e.jsx("br",{}),e.jsx("small",{children:c.message})]}),variant:"error"}])}n(c=>(c.delete("x-aggregation-context"),c))}},[i,t,n]);const V=p||G,{mutate:v,data:M,isPending:E}=is({mutationKey:["search"],mutationFn:({query:m,queryType:c,language:R,numberOfResults:F,resourceIDs:A})=>lt(s,{query:m,queryType:c,language:R,numberOfResults:F.toString(),resourceIds:A})});function H(m){j(m.resourceIDs),f(m),L(!0),os(m.query,m.queryType),v(m)}return e.jsxs(e.Fragment,{children:[e.jsx(me,{children:e.jsx("title",{children:"FCS Aggregator – Content Search"})}),e.jsxs(Y,{id:"search",children:[e.jsx("div",{"aria-live":"polite","aria-atomic":"true",className:"bg-dark position-relative",children:e.jsx(Us,{position:"top-end",className:"mt-2",style:{zIndex:100},children:C.map((m,c)=>e.jsxs(Ae,{bg:m.variant,onClose:()=>k(R=>R.filter(F=>F!==m)),delay:5e3,autohide:!0,children:[e.jsx(Ae.Header,{closeButton:!0,children:e.jsx("strong",{className:"me-auto",children:m.title})}),e.jsx(Ae.Body,{children:m.body})]},c))})}),!S&&e.jsx(B,{children:e.jsx(T,{className:"text-center",children:e.jsxs("picture",{children:[e.jsx("source",{srcSet:ts,media:"(prefers-color-scheme: light)"}),e.jsx("source",{srcSet:en,media:"(prefers-color-scheme: dark)"}),e.jsx("img",{src:ts,className:"logo",alt:"FCS logo"})]})})}),e.jsx(B,{className:"mt-3",children:e.jsx(T,{children:e.jsx(Vt,{resources:i,languages:l,availableResources:null,selectedResources:d,onSearch:H,hasSearch:S,disabled:V})})}),!S&&e.jsx(B,{className:"mt-3",children:e.jsxs(T,{children:[e.jsxs("p",{children:["To enable researchers to search for specific patterns across collections of data, CLARIN offers a search engine that connects to the local data collections that are available in the centres. The data itself stays at the centre where it is hosted – which is why the underlying technique is called ",e.jsx("em",{children:"federated content search"}),"."]}),e.jsx("p",{children:"TODO: some more brief intro text and maybe links for further information ..."})]})}),S&&E&&e.jsx(B,{children:e.jsx(T,{className:"text-center my-5",children:e.jsx(as,{animation:"border"})})}),g&&M&&e.jsx(st,{resources:i,languages:l,weblichtLanguages:h,children:e.jsx(nt,{...g,children:e.jsx(Zt,{searchId:M})})})]})]})}const X=As(s=>({deployPath:"/",apiURL:"https://contentsearch.clarin.eu/rest/",validatorURL:"https://www.clarin.eu/fcsvalidator/",showSearchResultLink:!1,setDeployPath:t=>s(n=>({deployPath:typeof t=="function"?t(n.deployPath):t})),setApiURL:t=>s(n=>({apiURL:typeof t=="function"?t(n.apiURL):t})),setValidatorURL:t=>s(n=>({validatorURL:typeof t=="function"?t(n.validatorURL):t})),setShowSearchResultLink:t=>s(n=>({showSearchResultLink:typeof t=="function"?t(n.showSearchResultLink):t}))})),tn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
  <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"/>
  <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7"/>
</svg>`;function nn({url:s,statistics:t,validatorUrl:n}){var i;return e.jsxs("div",{className:"ps-sm-4 mt-sm-0 mt-2 pt-sm-0 pt-1",children:[e.jsxs("h4",{className:"h5",children:[e.jsx(se.Highlight,{text:s,ranges:t.matchEndpoint}),n&&e.jsxs(e.Fragment,{children:[" ",e.jsx("a",{href:`${n}?url=${encodeURIComponent(s)}`,children:e.jsx("i",{dangerouslySetInnerHTML:{__html:tn},className:"align-baseline ms-2"})})]})]}),e.jsxs("dl",{className:"ps-sm-4",children:[e.jsx("dt",{children:"FCS Version"}),e.jsx("dd",{children:t.version}),e.jsx("dt",{children:"Search capabilities"}),e.jsx("dd",{children:t.searchCapabilities.join(", ")}),e.jsx("dt",{children:"Max concurrent scan requests"}),e.jsx("dd",{children:t.maxConcurrentRequests}),e.jsx("dt",{children:"Request statistics"}),e.jsxs("dd",{className:"mb-0",children:[t.numberOfRequests," request(s)"]}),t.avgQueueTime!==0&&e.jsxs("dd",{className:"mb-0",children:["Queue time (in seconds): average: ",t.avgQueueTime,", max:"," ",t.maxQueueTime]}),e.jsxs("dd",{children:["Execution time (in seconds): average: ",t.avgExecutionTime,", max:"," ",t.maxExecutionTime]}),((i=t.rootResources)==null?void 0:i.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx("dt",{children:"Resources"}),e.jsxs("dd",{children:[t.rootResources.length," root resources"]}),e.jsx("dd",{children:e.jsx("ul",{children:t.rootResources.map((r,l)=>{var o;return e.jsx("li",{children:e.jsx(se.Highlight,{text:r,ranges:((o=t.matchResources)==null?void 0:o[l])??null})},r)})})})]}),e.jsxs(e.Fragment,{children:[Object.entries(t.diagnostics||{}).map(([r,l])=>e.jsxs(J,{variant:"warning",style:{fontSize:"0.85rem"},children:[e.jsxs(J.Heading,{style:{fontSize:"1rem"},children:[e.jsxs(ae,{bg:"warning",children:[l.counter,"x"]})," ",e.jsx("span",{className:"text-uppercase",children:"Diagnostic:"})," ",l.diagnostic.message,l.diagnostic.diagnostic&&e.jsxs(e.Fragment,{children:[" - ",e.jsx("small",{children:l.diagnostic.diagnostic})]})]}),e.jsxs("p",{className:"mb-0",children:["Context: ",e.jsx("a",{href:l.context,children:l.context})]})]},r)),Object.entries(t.errors||{}).map(([r,l])=>e.jsxs(J,{variant:"danger",style:{fontSize:"0.85rem"},children:[e.jsxs(J.Heading,{style:{fontSize:"1rem"},children:[e.jsxs(ae,{bg:"danger",children:[l.counter,"x"]})," ",e.jsx("span",{className:"text-uppercase",children:"Exception:"})," ",l.exception.message]}),e.jsxs("p",{className:"mb-0",children:["Context: ",e.jsx("a",{href:l.context,children:l.context})]}),l.exception.cause&&e.jsxs("p",{className:"mb-0",children:["Caused by: ",l.exception.cause]})]},r))]})]})]},s)}function rn({data:s,validatorUrl:t}){const[n,i]=a.useState(""),[r,l]=a.useState(["institution","endpoint","resources"]),[o,h]=a.useState(!1),x=a.useMemo(()=>Object.entries(s.institutions).toSorted().map(([g,f])=>Object.entries(f).toSorted().map(([C,k])=>({institutionName:g,endpointUrl:C,endpointInfo:{...k,rootResources:k.rootResources.toSorted()}}))).flat(1).filter(o?g=>Object.keys(g.endpointInfo.diagnostics).length>0||Object.keys(g.endpointInfo.errors).length>0:()=>!0),[s,o]),d=x.filter(g=>Object.keys(g.endpointInfo.diagnostics).length>0||Object.keys(g.endpointInfo.errors).length>0),S=se.useFuzzySearchList({list:x,queryText:n,getText:g=>{const f=[];return r.length===0?f.push(g.institutionName,g.endpointUrl,...g.endpointInfo.rootResources):(r.includes("institution")&&f.push(g.institutionName),r.includes("endpoint")&&f.push(g.endpointUrl),r.includes("resources")&&f.push(...g.endpointInfo.rootResources)),f},mapResultItem:({item:g,score:f,matches:C})=>({item:g,matches:C,score:f})}).reduce((g,f)=>{const{institutionName:C,endpointUrl:k,endpointInfo:b}=f.item;return Object.getOwnPropertyNames(g).includes(C)||(g[C]={match:r.length===0||r.includes("institution")?f.matches[0]:null,endpoints:{}}),g[C].endpoints[k]={...b,matchEndpoint:r.length===0||r.includes("endpoint")?f.matches[r.length===0||r.includes("institution")?1:0]:null,matchResources:r.length===0||r.includes("resources")?f.matches.slice(0+(r.length===0||r.includes("institution")?1:0)+(r.length===0||r.includes("endpoint")?1:0)):[]},g},{});function L(g){r.includes(g)?l(r.filter(f=>f!==g)):l([...r,g])}return e.jsxs(Y,{className:"d-grid gap-2 mt-3",children:[e.jsx(J,{variant:"info",className:"mb-0",children:e.jsxs("dl",{className:"mb-0",children:[e.jsx("dt",{children:"Start date"}),e.jsx("dd",{className:"mb-0",children:new Date(s.date).toLocaleString()}),e.jsx("dt",{children:"Timeout (in seconds)"}),e.jsx("dd",{className:"mb-0",children:s.timeout})]})}),e.jsx(P,{onSubmit:g=>g.preventDefault(),children:e.jsxs(B,{className:"gy-2",children:[e.jsx(T,{lg:6,md:12,children:e.jsx(P.Control,{placeholder:"Type to filter statistics ...",value:n,onChange:g=>i(g.target.value)})}),e.jsxs(T,{id:"filter-checkboxes",lg:6,md:12,children:[e.jsx(P.Text,{className:"me-2",children:"Apply filter to:"}),e.jsx(P.Check,{type:"checkbox",checked:r.includes("institution"),onChange:()=>L("institution"),id:"filter-institution-name",label:"Institution"}),e.jsx(P.Check,{type:"checkbox",checked:r.includes("endpoint"),onChange:()=>L("endpoint"),id:"filter-endpoint-url",label:"Endpoint"}),e.jsx(P.Check,{type:"checkbox",checked:r.includes("resources"),onChange:()=>L("resources"),id:"filter-resource-names",label:"Resources"})]})]})}),e.jsx(B,{children:e.jsx(T,{children:e.jsx(P.Check,{type:"checkbox",checked:o,onChange:()=>h(!o),id:"filter-show-issues-only",label:`Only show endpoints with issues (errors or warnings, currently affects ${d.length} endpoint${d.length!==1?"s":""})`})})}),Object.entries(S).map(([g,{match:f,endpoints:C}])=>e.jsxs(W,{className:"p-2",children:[e.jsx("h3",{className:"h4 pb-1 border-bottom",children:e.jsx(se.Highlight,{text:g,ranges:f})}),Object.entries(C).toSorted().map(([k,b])=>e.jsx(nn,{url:k,statistics:b,validatorUrl:t},k))]},g))]})}const ln=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"/>
  <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"/>
</svg>`;function an(){const s=ce(),t=rs(),{isPending:n,isError:i,data:r,error:l}=xe({queryKey:["statistics"],queryFn:it.bind(null,s)}),[o,h]=a.useState(X.getState().validatorURL);X.subscribe(d=>h(d.validatorURL));function x(){t.invalidateQueries({queryKey:["statistics"]})}return e.jsxs(e.Fragment,{children:[e.jsx(me,{children:e.jsx("title",{children:"FCS Aggregator – Content Search – Statistics"})}),e.jsxs(Y,{id:"statistics",className:"my-3",children:[e.jsx("h1",{className:"h1",children:"Statistics"}),(n||i)&&e.jsx(B,{children:e.jsxs(T,{children:[n?"Loading ...":null,e.jsx("br",{}),i?l.message:null]})}),r&&e.jsxs(Me.Container,{defaultActiveKey:Object.keys(r).concat(null)[0],children:[e.jsxs(ne,{className:"nav-tabs",as:"ul",children:[Object.keys(r).map(d=>e.jsx(ne.Item,{as:"li",role:"presentation",children:e.jsx(ne.Link,{as:"button",eventKey:d,children:d})},d)),e.jsx(ne.Item,{as:"li",role:"presentation",className:"ms-auto",children:e.jsxs(ne.Link,{as:"button",onClick:x,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:ln}})," Refresh"]})})]}),e.jsx(Me.Content,{children:Object.entries(r).map(([d,j])=>e.jsx(Me.Pane,{eventKey:d,children:e.jsx(rn,{data:j,validatorUrl:o})},d))})]})]})]})}function on(){Js();{const s=Ms(),[t,n]=a.useState(s.pathname);a.useEffect(()=>{const i=s.pathname;i!==t&&(n(i+s.search),xt(i,document.title,t))},[s,t])}return e.jsxs(e.Fragment,{children:[e.jsx(me,{children:e.jsx("title",{children:"FCS Aggregator – Content Search"})}),e.jsx(Ws,{}),e.jsx("main",{children:e.jsxs(_s,{children:[e.jsx(pe,{index:!0,element:e.jsx(sn,{})}),e.jsx(pe,{path:"about",element:e.jsx(Zs,{})}),e.jsx(pe,{path:"help",element:e.jsx(et,{})}),e.jsx(pe,{path:"stats",element:e.jsx(an,{})})]})}),e.jsx(Gs,{})]})}window.MyAggregator=window.MyAggregator||{};window._paq=window._paq||[];function cn(){window.MyAggregator.DEPLOY_PATH!==void 0&&X.getState().setDeployPath(window.MyAggregator.DEPLOY_PATH),window.MyAggregator.API_URL!==void 0&&X.getState().setApiURL(window.MyAggregator.API_URL),window.MyAggregator.VALIDATOR_URL!==void 0&&X.getState().setValidatorURL(window.MyAggregator.VALIDATOR_URL),window.MyAggregator.SHOW_SEARCH_RESULT_LINK!==void 0&&X.getState().setShowSearchResultLink(window.MyAggregator.SHOW_SEARCH_RESULT_LINK),window.MyAggregator=new Proxy(window.MyAggregator,{get(s,t){return s[t]},set(s,t,n){return t==="DEPLOY_PATH"?(console.error("Configuration DEPLOY_PATH can only be set on initialization!"),!1):t==="API_URL"?(console.error("Configuration API_URL can only be set on initialization!"),!1):t==="VALIDATOR_URL"?n===null||typeof n=="string"?(X.getState().setValidatorURL(n),!0):!1:t==="SHOW_SEARCH_RESULT_LINK"?typeof n=="boolean"?(X.getState().setShowSearchResultLink(n),!0):!1:(s[t]=n,!0)}}),Object.assign(window.MyAggregator,{getAppStore:()=>X})}cn();X.getInitialState(),X.getState();const dn=X.getState().deployPath,un=X.getState().apiURL,hn=new Os({defaultOptions:{queries:{}}}),mn=Ps.create({baseURL:un,timeout:5e3,responseType:"json",transitional:{silentJSONParsing:!1}});mt()||console.warn("Unable to setup tracking ...");const xn="root",gn=document.getElementById(xn),fn=Qs.createRoot(gn);fn.render(e.jsx(a.StrictMode,{children:e.jsx(tt,{axios:mn,children:e.jsx(Fs,{client:hn,children:e.jsx(Hs,{children:e.jsx(Ds,{basename:dn,children:e.jsx(on,{})})})})})}));export{ms as C,Ht as h,us as u};
//# sourceMappingURL=fcs-sru-aggregator-ui-0.0.0.js.map
