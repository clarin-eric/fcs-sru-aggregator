import{r as d,j as i,b as Mr,T as qr,f as Hr}from"./vendor/react-ext.js";import{F as W,e as Re,D as g,I as wt,M as Te,C as Ve,R as Br,a as Dr,f as Gr,A as Pr}from"./vendor/bootstrap.js";import{p as qe,x as Tt,r as Wr,b as Fr,u as $r,f as Vr,C as Kr,h as Xr}from"./fcs-sru-aggregator-ui.js";import{P as It,F as Ot,a as Qt,b as He,R as N,N as le,A as yt,c as Be,V as De,D as Ge,d as A,B as zr,L as Ut,e as jt,f as kt,C as Mt,g as qt,T as Ht}from"./vendor/antlr4.js";import"./vendor/react.js";/* empty css                      */import"./locales/en/default.js";import"./vendor/prism.js";/*!
 * FCS SRU Aggragator UI
 * @module lib/fcs-sru-aggregator-ui-querybuilder.js
 * @version 1.0.0-alpha
 * @license GPL-3.0-or-later
 * @see {@link https://github.com/clarin-eric/fcs-sru-aggregator-ui.git}
 */function Yr(r,e){const[t,s]=d.useState(r),o=d.useRef(void 0),f=d.useCallback(c=>{clearTimeout(o.current),o.current=setTimeout(()=>{s(c)},e)},[s,e]);return[t,f,s]}class n extends It{static L_PAREN=1;static R_PAREN=2;static L_SQUARE_BRACKET=3;static R_SQUARE_BRACKET=4;static OR=5;static AND=6;static NOT=7;static FWD_SLASH=8;static L_CURLY_BRACKET=9;static R_CURLY_BRACKET=10;static Q_ONE_OR_MORE=11;static Q_ZERO_OR_MORE=12;static Q_ZERO_OR_ONE=13;static Q_COMMA=14;static OPERATOR_EQ=15;static OPERATOR_NE=16;static COLON=17;static WITHIN=18;static SIMPLE_WITHIN_SCOPE=19;static REGEXP_FLAGS=20;static IDENTIFIER=21;static INTEGER=22;static REGEXP=23;static QUOTED_STRING=24;static Space=25;static RULE_query=0;static RULE_main_query=1;static RULE_query_disjunction=2;static RULE_query_sequence=3;static RULE_query_group=4;static RULE_query_simple=5;static RULE_quantifier=6;static RULE_query_implicit=7;static RULE_query_segment=8;static RULE_within_part=9;static RULE_within_part_simple=10;static RULE_expression=11;static RULE_expression_or=12;static RULE_expression_and=13;static RULE_expression_group=14;static RULE_expression_not=15;static RULE_expression_basic=16;static RULE_attribute=17;static RULE_qualifier=18;static RULE_identifier=19;static RULE_regexp=20;static RULE_regexp_pattern=21;static RULE_regexp_flag=22;static literalNames=[null,"'('","')'","'['","']'","'|'","'&'","'!'","'/'","'{'","'}'","'+'","'*'","'?'","','","'='","'!='","':'","'within'"];static symbolicNames=[null,"L_PAREN","R_PAREN","L_SQUARE_BRACKET","R_SQUARE_BRACKET","OR","AND","NOT","FWD_SLASH","L_CURLY_BRACKET","R_CURLY_BRACKET","Q_ONE_OR_MORE","Q_ZERO_OR_MORE","Q_ZERO_OR_ONE","Q_COMMA","OPERATOR_EQ","OPERATOR_NE","COLON","WITHIN","SIMPLE_WITHIN_SCOPE","REGEXP_FLAGS","IDENTIFIER","INTEGER","REGEXP","QUOTED_STRING","Space"];static ruleNames=["query","main_query","query_disjunction","query_sequence","query_group","query_simple","quantifier","query_implicit","query_segment","within_part","within_part_simple","expression","expression_or","expression_and","expression_group","expression_not","expression_basic","attribute","qualifier","identifier","regexp","regexp_pattern","regexp_flag"];get grammarFileName(){return"FCSParser.g4"}get literalNames(){return n.literalNames}get symbolicNames(){return n.symbolicNames}get ruleNames(){return n.ruleNames}get serializedATN(){return n._serializedATN}createFailedPredicateException(e,t){return new Ot(this,e,t)}constructor(e){super(e),this.interpreter=new Qt(this,n._ATN,n.decisionsToDFA,new He)}query(){const e=new Zr(this.context,this.state);this.enterRule(e,0,n.RULE_query);let t;try{this.enterOuterAlt(e,1),this.state=46,this.main_query(),this.state=49,this.errorHandler.sync(this),t=this.tokenStream.LA(1),t===18&&(this.state=47,this.match(n.WITHIN),this.state=48,this.within_part()),this.state=51,this.match(n.EOF)}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}main_query(){const e=new Bt(this.context,this.state);this.enterRule(e,2,n.RULE_main_query);try{switch(this.state=57,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,1,this.context)){case 1:this.enterOuterAlt(e,1),this.state=53,this.query_simple();break;case 2:this.enterOuterAlt(e,2),this.state=54,this.query_group();break;case 3:this.enterOuterAlt(e,3),this.state=55,this.query_sequence();break;case 4:this.enterOuterAlt(e,4),this.state=56,this.query_disjunction();break}}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}query_disjunction(){const e=new Pe(this.context,this.state);this.enterRule(e,4,n.RULE_query_disjunction);let t;try{this.enterOuterAlt(e,1);{switch(this.state=62,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,2,this.context)){case 1:this.state=59,this.query_simple();break;case 2:this.state=60,this.query_sequence();break;case 3:this.state=61,this.query_group();break}this.state=70,this.errorHandler.sync(this),t=this.tokenStream.LA(1);do{switch(this.state=64,this.match(n.OR),this.state=68,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,3,this.context)){case 1:this.state=65,this.query_simple();break;case 2:this.state=66,this.query_sequence();break;case 3:this.state=67,this.query_group();break}this.state=72,this.errorHandler.sync(this),t=this.tokenStream.LA(1)}while(t===5)}}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}query_sequence(){const e=new me(this.context,this.state);this.enterRule(e,6,n.RULE_query_sequence);let t;try{this.enterOuterAlt(e,1);{this.state=76,this.errorHandler.sync(this),t=this.tokenStream.LA(1);do{switch(this.state=76,this.errorHandler.sync(this),this.tokenStream.LA(1)){case n.L_SQUARE_BRACKET:case n.REGEXP:this.state=74,this.query_simple();break;case n.L_PAREN:this.state=75,this.query_group();break;default:throw new le(this)}this.state=78,this.errorHandler.sync(this),t=this.tokenStream.LA(1)}while((t&-32)===0&&(1<<t&8388618)!==0)}}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}query_group(){const e=new xe(this.context,this.state);this.enterRule(e,8,n.RULE_query_group);let t;try{this.enterOuterAlt(e,1);{switch(this.state=80,this.match(n.L_PAREN),this.state=83,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,7,this.context)){case 1:this.state=81,this.query_disjunction();break;case 2:this.state=82,this.query_sequence();break}this.state=85,this.match(n.R_PAREN),this.state=87,this.errorHandler.sync(this),t=this.tokenStream.LA(1),(t&-32)===0&&(1<<t&14848)!==0&&(this.state=86,this.quantifier())}}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}query_simple(){const e=new pe(this.context,this.state);this.enterRule(e,10,n.RULE_query_simple);let t;try{this.enterOuterAlt(e,1);{switch(this.state=91,this.errorHandler.sync(this),this.tokenStream.LA(1)){case n.REGEXP:this.state=89,this.query_implicit();break;case n.L_SQUARE_BRACKET:this.state=90,this.query_segment();break;default:throw new le(this)}this.state=94,this.errorHandler.sync(this),t=this.tokenStream.LA(1),(t&-32)===0&&(1<<t&14848)!==0&&(this.state=93,this.quantifier())}}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}quantifier(){const e=new it(this.context,this.state);this.enterRule(e,12,n.RULE_quantifier);let t;try{switch(this.enterOuterAlt(e,1),this.state=114,this.errorHandler.sync(this),this.tokenStream.LA(1)){case n.Q_ONE_OR_MORE:this.state=96,this.match(n.Q_ONE_OR_MORE);break;case n.Q_ZERO_OR_MORE:this.state=97,this.match(n.Q_ZERO_OR_MORE);break;case n.Q_ZERO_OR_ONE:this.state=98,this.match(n.Q_ZERO_OR_ONE);break;case n.L_CURLY_BRACKET:{switch(this.state=99,this.match(n.L_CURLY_BRACKET),this.state=111,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,13,this.context)){case 1:this.state=100,this.match(n.INTEGER);break;case 2:this.state=102,this.errorHandler.sync(this),t=this.tokenStream.LA(1),t===22&&(this.state=101,this.match(n.INTEGER)),this.state=104,this.match(n.Q_COMMA),this.state=105,this.match(n.INTEGER);break;case 3:this.state=106,this.match(n.INTEGER),this.state=107,this.match(n.Q_COMMA),this.state=109,this.errorHandler.sync(this),t=this.tokenStream.LA(1),t===22&&(this.state=108,this.match(n.INTEGER));break}this.state=113,this.match(n.R_CURLY_BRACKET)}break;default:throw new le(this)}}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}query_implicit(){const e=new Dt(this.context,this.state);this.enterRule(e,14,n.RULE_query_implicit);try{this.enterOuterAlt(e,1),this.state=116,this.regexp()}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}query_segment(){const e=new Gt(this.context,this.state);this.enterRule(e,16,n.RULE_query_segment);let t;try{this.enterOuterAlt(e,1),this.state=118,this.match(n.L_SQUARE_BRACKET),this.state=120,this.errorHandler.sync(this),t=this.tokenStream.LA(1),(t&-32)===0&&(1<<t&3932290)!==0&&(this.state=119,this.expression()),this.state=122,this.match(n.R_SQUARE_BRACKET)}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}within_part(){const e=new Pt(this.context,this.state);this.enterRule(e,18,n.RULE_within_part);try{this.enterOuterAlt(e,1),this.state=124,this.within_part_simple()}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}within_part_simple(){const e=new Wt(this.context,this.state);this.enterRule(e,20,n.RULE_within_part_simple);try{this.enterOuterAlt(e,1),this.state=126,this.match(n.SIMPLE_WITHIN_SCOPE)}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}expression(){const e=new Ft(this.context,this.state);this.enterRule(e,22,n.RULE_expression);try{switch(this.state=133,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,16,this.context)){case 1:this.enterOuterAlt(e,1),this.state=128,this.expression_basic();break;case 2:this.enterOuterAlt(e,2),this.state=129,this.expression_group();break;case 3:this.enterOuterAlt(e,3),this.state=130,this.expression_or();break;case 4:this.enterOuterAlt(e,4),this.state=131,this.expression_and();break;case 5:this.enterOuterAlt(e,5),this.state=132,this.expression_not();break}}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}expression_or(){const e=new ue(this.context,this.state);this.enterRule(e,24,n.RULE_expression_or);try{let t;this.enterOuterAlt(e,1);{switch(this.state=139,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,17,this.context)){case 1:this.state=135,this.expression_basic();break;case 2:this.state=136,this.expression_group();break;case 3:this.state=137,this.expression_and();break;case 4:this.state=138,this.expression_not();break}this.state=148,this.errorHandler.sync(this),t=1;do{switch(t){case 1:switch(this.state=141,this.match(n.OR),this.state=146,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,18,this.context)){case 1:this.state=142,this.expression_basic();break;case 2:this.state=143,this.expression_group();break;case 3:this.state=144,this.expression_and();break;case 4:this.state=145,this.expression_not();break}break;default:throw new le(this)}this.state=150,this.errorHandler.sync(this),t=this.interpreter.adaptivePredict(this.tokenStream,19,this.context)}while(t!==2&&t!==yt.INVALID_ALT_NUMBER)}}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}expression_and(){const e=new ce(this.context,this.state);this.enterRule(e,26,n.RULE_expression_and);try{let t;this.enterOuterAlt(e,1);{switch(this.state=155,this.errorHandler.sync(this),this.tokenStream.LA(1)){case n.WITHIN:case n.SIMPLE_WITHIN_SCOPE:case n.REGEXP_FLAGS:case n.IDENTIFIER:this.state=152,this.expression_basic();break;case n.L_PAREN:this.state=153,this.expression_group();break;case n.NOT:this.state=154,this.expression_not();break;default:throw new le(this)}this.state=164,this.errorHandler.sync(this),t=1;do{switch(t){case 1:switch(this.state=157,this.match(n.AND),this.state=162,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,21,this.context)){case 1:this.state=158,this.expression_basic();break;case 2:this.state=159,this.expression_group();break;case 3:this.state=160,this.expression_or();break;case 4:this.state=161,this.expression_not();break}break;default:throw new le(this)}this.state=166,this.errorHandler.sync(this),t=this.interpreter.adaptivePredict(this.tokenStream,22,this.context)}while(t!==2&&t!==yt.INVALID_ALT_NUMBER)}}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}expression_group(){const e=new F(this.context,this.state);this.enterRule(e,28,n.RULE_expression_group);try{this.enterOuterAlt(e,1);{switch(this.state=168,this.match(n.L_PAREN),this.state=174,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,23,this.context)){case 1:this.state=169,this.expression_basic();break;case 2:this.state=170,this.expression_group();break;case 3:this.state=171,this.expression_or();break;case 4:this.state=172,this.expression_and();break;case 5:this.state=173,this.expression_not();break}this.state=176,this.match(n.R_PAREN)}}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}expression_not(){const e=new V(this.context,this.state);this.enterRule(e,30,n.RULE_expression_not);try{switch(this.enterOuterAlt(e,1),this.state=178,this.match(n.NOT),this.state=184,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,24,this.context)){case 1:this.state=179,this.expression_basic();break;case 2:this.state=180,this.expression_group();break;case 3:this.state=181,this.expression_not();break;case 4:this.state=182,this.expression_or();break;case 5:this.state=183,this.expression_and();break}}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}expression_basic(){const e=new re(this.context,this.state);this.enterRule(e,32,n.RULE_expression_basic);let t;try{this.enterOuterAlt(e,1),this.state=186,this.attribute(),this.state=187,t=this.tokenStream.LA(1),t===15||t===16?(this.errorHandler.reportMatch(this),this.consume()):this.errorHandler.recoverInline(this),this.state=188,this.regexp()}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}attribute(){const e=new $t(this.context,this.state);this.enterRule(e,34,n.RULE_attribute);try{this.enterOuterAlt(e,1);{switch(this.state=193,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,25,this.context)){case 1:this.state=190,this.qualifier(),this.state=191,this.match(n.COLON);break}this.state=195,this.identifier()}}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}qualifier(){const e=new Vt(this.context,this.state);this.enterRule(e,36,n.RULE_qualifier);let t;try{this.enterOuterAlt(e,1),this.state=197,t=this.tokenStream.LA(1),(t&-32)===0&&(1<<t&3932160)!==0?(this.errorHandler.reportMatch(this),this.consume()):this.errorHandler.recoverInline(this)}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}identifier(){const e=new Kt(this.context,this.state);this.enterRule(e,38,n.RULE_identifier);let t;try{this.enterOuterAlt(e,1),this.state=199,t=this.tokenStream.LA(1),(t&-32)===0&&(1<<t&3932160)!==0?(this.errorHandler.reportMatch(this),this.consume()):this.errorHandler.recoverInline(this)}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}regexp(){const e=new st(this.context,this.state);this.enterRule(e,40,n.RULE_regexp);let t;try{this.enterOuterAlt(e,1),this.state=201,this.regexp_pattern(),this.state=204,this.errorHandler.sync(this),t=this.tokenStream.LA(1),t===8&&(this.state=202,this.match(n.FWD_SLASH),this.state=203,this.regexp_flag())}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}regexp_pattern(){const e=new Xt(this.context,this.state);this.enterRule(e,42,n.RULE_regexp_pattern);try{this.enterOuterAlt(e,1),this.state=206,this.match(n.REGEXP)}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}regexp_flag(){const e=new zt(this.context,this.state);this.enterRule(e,44,n.RULE_regexp_flag);try{this.enterOuterAlt(e,1),this.state=208,this.match(n.REGEXP_FLAGS)}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}static _serializedATN=[4,1,25,211,2,0,7,0,2,1,7,1,2,2,7,2,2,3,7,3,2,4,7,4,2,5,7,5,2,6,7,6,2,7,7,7,2,8,7,8,2,9,7,9,2,10,7,10,2,11,7,11,2,12,7,12,2,13,7,13,2,14,7,14,2,15,7,15,2,16,7,16,2,17,7,17,2,18,7,18,2,19,7,19,2,20,7,20,2,21,7,21,2,22,7,22,1,0,1,0,1,0,3,0,50,8,0,1,0,1,0,1,1,1,1,1,1,1,1,3,1,58,8,1,1,2,1,2,1,2,3,2,63,8,2,1,2,1,2,1,2,1,2,3,2,69,8,2,4,2,71,8,2,11,2,12,2,72,1,3,1,3,4,3,77,8,3,11,3,12,3,78,1,4,1,4,1,4,3,4,84,8,4,1,4,1,4,3,4,88,8,4,1,5,1,5,3,5,92,8,5,1,5,3,5,95,8,5,1,6,1,6,1,6,1,6,1,6,1,6,3,6,103,8,6,1,6,1,6,1,6,1,6,1,6,3,6,110,8,6,3,6,112,8,6,1,6,3,6,115,8,6,1,7,1,7,1,8,1,8,3,8,121,8,8,1,8,1,8,1,9,1,9,1,10,1,10,1,11,1,11,1,11,1,11,1,11,3,11,134,8,11,1,12,1,12,1,12,1,12,3,12,140,8,12,1,12,1,12,1,12,1,12,1,12,3,12,147,8,12,4,12,149,8,12,11,12,12,12,150,1,13,1,13,1,13,3,13,156,8,13,1,13,1,13,1,13,1,13,1,13,3,13,163,8,13,4,13,165,8,13,11,13,12,13,166,1,14,1,14,1,14,1,14,1,14,1,14,3,14,175,8,14,1,14,1,14,1,15,1,15,1,15,1,15,1,15,1,15,3,15,185,8,15,1,16,1,16,1,16,1,16,1,17,1,17,1,17,3,17,194,8,17,1,17,1,17,1,18,1,18,1,19,1,19,1,20,1,20,1,20,3,20,205,8,20,1,21,1,21,1,22,1,22,1,22,0,0,23,0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,0,2,1,0,15,16,1,0,18,21,237,0,46,1,0,0,0,2,57,1,0,0,0,4,62,1,0,0,0,6,76,1,0,0,0,8,80,1,0,0,0,10,91,1,0,0,0,12,114,1,0,0,0,14,116,1,0,0,0,16,118,1,0,0,0,18,124,1,0,0,0,20,126,1,0,0,0,22,133,1,0,0,0,24,139,1,0,0,0,26,155,1,0,0,0,28,168,1,0,0,0,30,178,1,0,0,0,32,186,1,0,0,0,34,193,1,0,0,0,36,197,1,0,0,0,38,199,1,0,0,0,40,201,1,0,0,0,42,206,1,0,0,0,44,208,1,0,0,0,46,49,3,2,1,0,47,48,5,18,0,0,48,50,3,18,9,0,49,47,1,0,0,0,49,50,1,0,0,0,50,51,1,0,0,0,51,52,5,0,0,1,52,1,1,0,0,0,53,58,3,10,5,0,54,58,3,8,4,0,55,58,3,6,3,0,56,58,3,4,2,0,57,53,1,0,0,0,57,54,1,0,0,0,57,55,1,0,0,0,57,56,1,0,0,0,58,3,1,0,0,0,59,63,3,10,5,0,60,63,3,6,3,0,61,63,3,8,4,0,62,59,1,0,0,0,62,60,1,0,0,0,62,61,1,0,0,0,63,70,1,0,0,0,64,68,5,5,0,0,65,69,3,10,5,0,66,69,3,6,3,0,67,69,3,8,4,0,68,65,1,0,0,0,68,66,1,0,0,0,68,67,1,0,0,0,69,71,1,0,0,0,70,64,1,0,0,0,71,72,1,0,0,0,72,70,1,0,0,0,72,73,1,0,0,0,73,5,1,0,0,0,74,77,3,10,5,0,75,77,3,8,4,0,76,74,1,0,0,0,76,75,1,0,0,0,77,78,1,0,0,0,78,76,1,0,0,0,78,79,1,0,0,0,79,7,1,0,0,0,80,83,5,1,0,0,81,84,3,4,2,0,82,84,3,6,3,0,83,81,1,0,0,0,83,82,1,0,0,0,84,85,1,0,0,0,85,87,5,2,0,0,86,88,3,12,6,0,87,86,1,0,0,0,87,88,1,0,0,0,88,9,1,0,0,0,89,92,3,14,7,0,90,92,3,16,8,0,91,89,1,0,0,0,91,90,1,0,0,0,92,94,1,0,0,0,93,95,3,12,6,0,94,93,1,0,0,0,94,95,1,0,0,0,95,11,1,0,0,0,96,115,5,11,0,0,97,115,5,12,0,0,98,115,5,13,0,0,99,111,5,9,0,0,100,112,5,22,0,0,101,103,5,22,0,0,102,101,1,0,0,0,102,103,1,0,0,0,103,104,1,0,0,0,104,105,5,14,0,0,105,112,5,22,0,0,106,107,5,22,0,0,107,109,5,14,0,0,108,110,5,22,0,0,109,108,1,0,0,0,109,110,1,0,0,0,110,112,1,0,0,0,111,100,1,0,0,0,111,102,1,0,0,0,111,106,1,0,0,0,112,113,1,0,0,0,113,115,5,10,0,0,114,96,1,0,0,0,114,97,1,0,0,0,114,98,1,0,0,0,114,99,1,0,0,0,115,13,1,0,0,0,116,117,3,40,20,0,117,15,1,0,0,0,118,120,5,3,0,0,119,121,3,22,11,0,120,119,1,0,0,0,120,121,1,0,0,0,121,122,1,0,0,0,122,123,5,4,0,0,123,17,1,0,0,0,124,125,3,20,10,0,125,19,1,0,0,0,126,127,5,19,0,0,127,21,1,0,0,0,128,134,3,32,16,0,129,134,3,28,14,0,130,134,3,24,12,0,131,134,3,26,13,0,132,134,3,30,15,0,133,128,1,0,0,0,133,129,1,0,0,0,133,130,1,0,0,0,133,131,1,0,0,0,133,132,1,0,0,0,134,23,1,0,0,0,135,140,3,32,16,0,136,140,3,28,14,0,137,140,3,26,13,0,138,140,3,30,15,0,139,135,1,0,0,0,139,136,1,0,0,0,139,137,1,0,0,0,139,138,1,0,0,0,140,148,1,0,0,0,141,146,5,5,0,0,142,147,3,32,16,0,143,147,3,28,14,0,144,147,3,26,13,0,145,147,3,30,15,0,146,142,1,0,0,0,146,143,1,0,0,0,146,144,1,0,0,0,146,145,1,0,0,0,147,149,1,0,0,0,148,141,1,0,0,0,149,150,1,0,0,0,150,148,1,0,0,0,150,151,1,0,0,0,151,25,1,0,0,0,152,156,3,32,16,0,153,156,3,28,14,0,154,156,3,30,15,0,155,152,1,0,0,0,155,153,1,0,0,0,155,154,1,0,0,0,156,164,1,0,0,0,157,162,5,6,0,0,158,163,3,32,16,0,159,163,3,28,14,0,160,163,3,24,12,0,161,163,3,30,15,0,162,158,1,0,0,0,162,159,1,0,0,0,162,160,1,0,0,0,162,161,1,0,0,0,163,165,1,0,0,0,164,157,1,0,0,0,165,166,1,0,0,0,166,164,1,0,0,0,166,167,1,0,0,0,167,27,1,0,0,0,168,174,5,1,0,0,169,175,3,32,16,0,170,175,3,28,14,0,171,175,3,24,12,0,172,175,3,26,13,0,173,175,3,30,15,0,174,169,1,0,0,0,174,170,1,0,0,0,174,171,1,0,0,0,174,172,1,0,0,0,174,173,1,0,0,0,175,176,1,0,0,0,176,177,5,2,0,0,177,29,1,0,0,0,178,184,5,7,0,0,179,185,3,32,16,0,180,185,3,28,14,0,181,185,3,30,15,0,182,185,3,24,12,0,183,185,3,26,13,0,184,179,1,0,0,0,184,180,1,0,0,0,184,181,1,0,0,0,184,182,1,0,0,0,184,183,1,0,0,0,185,31,1,0,0,0,186,187,3,34,17,0,187,188,7,0,0,0,188,189,3,40,20,0,189,33,1,0,0,0,190,191,3,36,18,0,191,192,5,17,0,0,192,194,1,0,0,0,193,190,1,0,0,0,193,194,1,0,0,0,194,195,1,0,0,0,195,196,3,38,19,0,196,35,1,0,0,0,197,198,7,1,0,0,198,37,1,0,0,0,199,200,7,1,0,0,200,39,1,0,0,0,201,204,3,42,21,0,202,203,5,8,0,0,203,205,3,44,22,0,204,202,1,0,0,0,204,205,1,0,0,0,205,41,1,0,0,0,206,207,5,23,0,0,207,43,1,0,0,0,208,209,5,20,0,0,209,45,1,0,0,0,27,49,57,62,68,72,76,78,83,87,91,94,102,109,111,114,120,133,139,146,150,155,162,166,174,184,193,204];static __ATN;static get _ATN(){return n.__ATN||(n.__ATN=new Be().deserialize(n._serializedATN)),n.__ATN}static vocabulary=new De(n.literalNames,n.symbolicNames,[]);get vocabulary(){return n.vocabulary}static decisionsToDFA=n._ATN.decisionToState.map((e,t)=>new Ge(e,t))}let Zr=class extends A{constructor(e,t){super(e,t)}main_query(){return this.getRuleContext(0,Bt)}EOF(){return this.getToken(n.EOF,0)}WITHIN(){return this.getToken(n.WITHIN,0)}within_part(){return this.getRuleContext(0,Pt)}get ruleIndex(){return n.RULE_query}enterRule(e){e.enterQuery&&e.enterQuery(this)}exitRule(e){e.exitQuery&&e.exitQuery(this)}accept(e){return e.visitQuery?e.visitQuery(this):e.visitChildren(this)}};class Bt extends A{constructor(e,t){super(e,t)}query_simple(){return this.getRuleContext(0,pe)}query_group(){return this.getRuleContext(0,xe)}query_sequence(){return this.getRuleContext(0,me)}query_disjunction(){return this.getRuleContext(0,Pe)}get ruleIndex(){return n.RULE_main_query}enterRule(e){e.enterMain_query&&e.enterMain_query(this)}exitRule(e){e.exitMain_query&&e.exitMain_query(this)}accept(e){return e.visitMain_query?e.visitMain_query(this):e.visitChildren(this)}}class Pe extends A{constructor(e,t){super(e,t)}query_simple(e){return e===void 0?this.getRuleContexts(pe):this.getRuleContext(e,pe)}query_sequence(e){return e===void 0?this.getRuleContexts(me):this.getRuleContext(e,me)}query_group(e){return e===void 0?this.getRuleContexts(xe):this.getRuleContext(e,xe)}OR(e){return e===void 0?this.getTokens(n.OR):this.getToken(n.OR,e)}get ruleIndex(){return n.RULE_query_disjunction}enterRule(e){e.enterQuery_disjunction&&e.enterQuery_disjunction(this)}exitRule(e){e.exitQuery_disjunction&&e.exitQuery_disjunction(this)}accept(e){return e.visitQuery_disjunction?e.visitQuery_disjunction(this):e.visitChildren(this)}}class me extends A{constructor(e,t){super(e,t)}query_simple(e){return e===void 0?this.getRuleContexts(pe):this.getRuleContext(e,pe)}query_group(e){return e===void 0?this.getRuleContexts(xe):this.getRuleContext(e,xe)}get ruleIndex(){return n.RULE_query_sequence}enterRule(e){e.enterQuery_sequence&&e.enterQuery_sequence(this)}exitRule(e){e.exitQuery_sequence&&e.exitQuery_sequence(this)}accept(e){return e.visitQuery_sequence?e.visitQuery_sequence(this):e.visitChildren(this)}}class xe extends A{constructor(e,t){super(e,t)}L_PAREN(){return this.getToken(n.L_PAREN,0)}R_PAREN(){return this.getToken(n.R_PAREN,0)}query_disjunction(){return this.getRuleContext(0,Pe)}query_sequence(){return this.getRuleContext(0,me)}quantifier(){return this.getRuleContext(0,it)}get ruleIndex(){return n.RULE_query_group}enterRule(e){e.enterQuery_group&&e.enterQuery_group(this)}exitRule(e){e.exitQuery_group&&e.exitQuery_group(this)}accept(e){return e.visitQuery_group?e.visitQuery_group(this):e.visitChildren(this)}}class pe extends A{constructor(e,t){super(e,t)}query_implicit(){return this.getRuleContext(0,Dt)}query_segment(){return this.getRuleContext(0,Gt)}quantifier(){return this.getRuleContext(0,it)}get ruleIndex(){return n.RULE_query_simple}enterRule(e){e.enterQuery_simple&&e.enterQuery_simple(this)}exitRule(e){e.exitQuery_simple&&e.exitQuery_simple(this)}accept(e){return e.visitQuery_simple?e.visitQuery_simple(this):e.visitChildren(this)}}class it extends A{constructor(e,t){super(e,t)}Q_ONE_OR_MORE(){return this.getToken(n.Q_ONE_OR_MORE,0)}Q_ZERO_OR_MORE(){return this.getToken(n.Q_ZERO_OR_MORE,0)}Q_ZERO_OR_ONE(){return this.getToken(n.Q_ZERO_OR_ONE,0)}L_CURLY_BRACKET(){return this.getToken(n.L_CURLY_BRACKET,0)}R_CURLY_BRACKET(){return this.getToken(n.R_CURLY_BRACKET,0)}INTEGER(e){return e===void 0?this.getTokens(n.INTEGER):this.getToken(n.INTEGER,e)}Q_COMMA(){return this.getToken(n.Q_COMMA,0)}get ruleIndex(){return n.RULE_quantifier}enterRule(e){e.enterQuantifier&&e.enterQuantifier(this)}exitRule(e){e.exitQuantifier&&e.exitQuantifier(this)}accept(e){return e.visitQuantifier?e.visitQuantifier(this):e.visitChildren(this)}}class Dt extends A{constructor(e,t){super(e,t)}regexp(){return this.getRuleContext(0,st)}get ruleIndex(){return n.RULE_query_implicit}enterRule(e){e.enterQuery_implicit&&e.enterQuery_implicit(this)}exitRule(e){e.exitQuery_implicit&&e.exitQuery_implicit(this)}accept(e){return e.visitQuery_implicit?e.visitQuery_implicit(this):e.visitChildren(this)}}class Gt extends A{constructor(e,t){super(e,t)}L_SQUARE_BRACKET(){return this.getToken(n.L_SQUARE_BRACKET,0)}R_SQUARE_BRACKET(){return this.getToken(n.R_SQUARE_BRACKET,0)}expression(){return this.getRuleContext(0,Ft)}get ruleIndex(){return n.RULE_query_segment}enterRule(e){e.enterQuery_segment&&e.enterQuery_segment(this)}exitRule(e){e.exitQuery_segment&&e.exitQuery_segment(this)}accept(e){return e.visitQuery_segment?e.visitQuery_segment(this):e.visitChildren(this)}}class Pt extends A{constructor(e,t){super(e,t)}within_part_simple(){return this.getRuleContext(0,Wt)}get ruleIndex(){return n.RULE_within_part}enterRule(e){e.enterWithin_part&&e.enterWithin_part(this)}exitRule(e){e.exitWithin_part&&e.exitWithin_part(this)}accept(e){return e.visitWithin_part?e.visitWithin_part(this):e.visitChildren(this)}}class Wt extends A{constructor(e,t){super(e,t)}SIMPLE_WITHIN_SCOPE(){return this.getToken(n.SIMPLE_WITHIN_SCOPE,0)}get ruleIndex(){return n.RULE_within_part_simple}enterRule(e){e.enterWithin_part_simple&&e.enterWithin_part_simple(this)}exitRule(e){e.exitWithin_part_simple&&e.exitWithin_part_simple(this)}accept(e){return e.visitWithin_part_simple?e.visitWithin_part_simple(this):e.visitChildren(this)}}class Ft extends A{constructor(e,t){super(e,t)}expression_basic(){return this.getRuleContext(0,re)}expression_group(){return this.getRuleContext(0,F)}expression_or(){return this.getRuleContext(0,ue)}expression_and(){return this.getRuleContext(0,ce)}expression_not(){return this.getRuleContext(0,V)}get ruleIndex(){return n.RULE_expression}enterRule(e){e.enterExpression&&e.enterExpression(this)}exitRule(e){e.exitExpression&&e.exitExpression(this)}accept(e){return e.visitExpression?e.visitExpression(this):e.visitChildren(this)}}class ue extends A{constructor(e,t){super(e,t)}expression_basic(e){return e===void 0?this.getRuleContexts(re):this.getRuleContext(e,re)}expression_group(e){return e===void 0?this.getRuleContexts(F):this.getRuleContext(e,F)}expression_and(e){return e===void 0?this.getRuleContexts(ce):this.getRuleContext(e,ce)}expression_not(e){return e===void 0?this.getRuleContexts(V):this.getRuleContext(e,V)}OR(e){return e===void 0?this.getTokens(n.OR):this.getToken(n.OR,e)}get ruleIndex(){return n.RULE_expression_or}enterRule(e){e.enterExpression_or&&e.enterExpression_or(this)}exitRule(e){e.exitExpression_or&&e.exitExpression_or(this)}accept(e){return e.visitExpression_or?e.visitExpression_or(this):e.visitChildren(this)}}class ce extends A{constructor(e,t){super(e,t)}expression_basic(e){return e===void 0?this.getRuleContexts(re):this.getRuleContext(e,re)}expression_group(e){return e===void 0?this.getRuleContexts(F):this.getRuleContext(e,F)}expression_not(e){return e===void 0?this.getRuleContexts(V):this.getRuleContext(e,V)}AND(e){return e===void 0?this.getTokens(n.AND):this.getToken(n.AND,e)}expression_or(e){return e===void 0?this.getRuleContexts(ue):this.getRuleContext(e,ue)}get ruleIndex(){return n.RULE_expression_and}enterRule(e){e.enterExpression_and&&e.enterExpression_and(this)}exitRule(e){e.exitExpression_and&&e.exitExpression_and(this)}accept(e){return e.visitExpression_and?e.visitExpression_and(this):e.visitChildren(this)}}class F extends A{constructor(e,t){super(e,t)}L_PAREN(){return this.getToken(n.L_PAREN,0)}R_PAREN(){return this.getToken(n.R_PAREN,0)}expression_basic(){return this.getRuleContext(0,re)}expression_group(){return this.getRuleContext(0,F)}expression_or(){return this.getRuleContext(0,ue)}expression_and(){return this.getRuleContext(0,ce)}expression_not(){return this.getRuleContext(0,V)}get ruleIndex(){return n.RULE_expression_group}enterRule(e){e.enterExpression_group&&e.enterExpression_group(this)}exitRule(e){e.exitExpression_group&&e.exitExpression_group(this)}accept(e){return e.visitExpression_group?e.visitExpression_group(this):e.visitChildren(this)}}class V extends A{constructor(e,t){super(e,t)}NOT(){return this.getToken(n.NOT,0)}expression_basic(){return this.getRuleContext(0,re)}expression_group(){return this.getRuleContext(0,F)}expression_not(){return this.getRuleContext(0,V)}expression_or(){return this.getRuleContext(0,ue)}expression_and(){return this.getRuleContext(0,ce)}get ruleIndex(){return n.RULE_expression_not}enterRule(e){e.enterExpression_not&&e.enterExpression_not(this)}exitRule(e){e.exitExpression_not&&e.exitExpression_not(this)}accept(e){return e.visitExpression_not?e.visitExpression_not(this):e.visitChildren(this)}}class re extends A{constructor(e,t){super(e,t)}attribute(){return this.getRuleContext(0,$t)}regexp(){return this.getRuleContext(0,st)}OPERATOR_EQ(){return this.getToken(n.OPERATOR_EQ,0)}OPERATOR_NE(){return this.getToken(n.OPERATOR_NE,0)}get ruleIndex(){return n.RULE_expression_basic}enterRule(e){e.enterExpression_basic&&e.enterExpression_basic(this)}exitRule(e){e.exitExpression_basic&&e.exitExpression_basic(this)}accept(e){return e.visitExpression_basic?e.visitExpression_basic(this):e.visitChildren(this)}}class $t extends A{constructor(e,t){super(e,t)}identifier(){return this.getRuleContext(0,Kt)}qualifier(){return this.getRuleContext(0,Vt)}COLON(){return this.getToken(n.COLON,0)}get ruleIndex(){return n.RULE_attribute}enterRule(e){e.enterAttribute&&e.enterAttribute(this)}exitRule(e){e.exitAttribute&&e.exitAttribute(this)}accept(e){return e.visitAttribute?e.visitAttribute(this):e.visitChildren(this)}}class Vt extends A{constructor(e,t){super(e,t)}IDENTIFIER(){return this.getToken(n.IDENTIFIER,0)}WITHIN(){return this.getToken(n.WITHIN,0)}SIMPLE_WITHIN_SCOPE(){return this.getToken(n.SIMPLE_WITHIN_SCOPE,0)}REGEXP_FLAGS(){return this.getToken(n.REGEXP_FLAGS,0)}get ruleIndex(){return n.RULE_qualifier}enterRule(e){e.enterQualifier&&e.enterQualifier(this)}exitRule(e){e.exitQualifier&&e.exitQualifier(this)}accept(e){return e.visitQualifier?e.visitQualifier(this):e.visitChildren(this)}}class Kt extends A{constructor(e,t){super(e,t)}IDENTIFIER(){return this.getToken(n.IDENTIFIER,0)}WITHIN(){return this.getToken(n.WITHIN,0)}SIMPLE_WITHIN_SCOPE(){return this.getToken(n.SIMPLE_WITHIN_SCOPE,0)}REGEXP_FLAGS(){return this.getToken(n.REGEXP_FLAGS,0)}get ruleIndex(){return n.RULE_identifier}enterRule(e){e.enterIdentifier&&e.enterIdentifier(this)}exitRule(e){e.exitIdentifier&&e.exitIdentifier(this)}accept(e){return e.visitIdentifier?e.visitIdentifier(this):e.visitChildren(this)}}class st extends A{constructor(e,t){super(e,t)}regexp_pattern(){return this.getRuleContext(0,Xt)}FWD_SLASH(){return this.getToken(n.FWD_SLASH,0)}regexp_flag(){return this.getRuleContext(0,zt)}get ruleIndex(){return n.RULE_regexp}enterRule(e){e.enterRegexp&&e.enterRegexp(this)}exitRule(e){e.exitRegexp&&e.exitRegexp(this)}accept(e){return e.visitRegexp?e.visitRegexp(this):e.visitChildren(this)}}class Xt extends A{constructor(e,t){super(e,t)}REGEXP(){return this.getToken(n.REGEXP,0)}get ruleIndex(){return n.RULE_regexp_pattern}enterRule(e){e.enterRegexp_pattern&&e.enterRegexp_pattern(this)}exitRule(e){e.exitRegexp_pattern&&e.exitRegexp_pattern(this)}accept(e){return e.visitRegexp_pattern?e.visitRegexp_pattern(this):e.visitChildren(this)}}class zt extends A{constructor(e,t){super(e,t)}REGEXP_FLAGS(){return this.getToken(n.REGEXP_FLAGS,0)}get ruleIndex(){return n.RULE_regexp_flag}enterRule(e){e.enterRegexp_flag&&e.enterRegexp_flag(this)}exitRule(e){e.exitRegexp_flag&&e.exitRegexp_flag(this)}accept(e){return e.visitRegexp_flag?e.visitRegexp_flag(this):e.visitChildren(this)}}class Yt extends zr{errors=[];syntaxError(e,t,s,o,f,c){this.errors.push(`Syntax error: ${f} at position ${o}`)}}function Ie(r,e){if(!r||e===void 0)return!1;const t=Array.isArray(e)?e[0]:e,s=Array.isArray(e)?e[1]:e;if(r instanceof A&&r.start!==null&&r.stop!==null){const o=r.start.start,f=r.stop.stop+1;if(o<t&&t<f||o<s&&s<f||t===s&&(o===s||s===f)||t<=o&&f<=s)return!0}return!1}const Zt=[{id:"text",label:"textual representation"},{id:"lemma",label:"lemmatization of tokens"},{id:"pos",label:"part-of-speech UD v2.0 tagset"},{id:"orth",label:"orthographic transcription"},{id:"norm",label:"orthographic normalization"},{id:"phonetic",label:"phonetic transcription SAMPA"}],bt=Object.fromEntries(Zt.map(r=>[r.id,r])),Jr=[{id:"pos",operators:["is","is-not"],options:[{value:"ADJ",label:"Adjective"},{value:"ADV",label:"Adverb"},{value:"INTJ",label:"Interjection"},{value:"NOUN",label:"Noun"},{value:"PROPN",label:"Proper noun"},{value:"VERB",label:"Verb"},{value:"ADP",label:"Adposition"},{value:"AUX",label:"Auxiliary"},{value:"CCONJ",label:"Coordinating conjunction"},{value:"DET",label:"Determiner"},{value:"NUM",label:"Numeral"},{value:"PART",label:"Particle"},{value:"PRON",label:"Pronoun"},{value:"SCONJ",label:"Subordinating conjunction"},{value:"PUNCT",label:"Punctuation"},{value:"SYM",label:"Symbol"},{value:"X",label:"Other"}]}],At=Object.fromEntries(Jr.map(r=>[r.id,r])),Jt=[{id:"is",label:"is",operator:"=",valueAfter:null,valueBefore:null,escape:!0},{id:"is-not",label:"is not",operator:"!=",valueAfter:null,valueBefore:null,escape:!0},{id:"contains",label:"contains",operator:"=",valueAfter:".*",valueBefore:".*",escape:!0},{id:"starts-with",label:"starts with",operator:"=",valueAfter:".*",valueBefore:null,escape:!0},{id:"ends-with",label:"ends with",operator:"=",valueAfter:null,valueBefore:".*",escape:!0},{id:"regex",label:"regex",operator:"=",valueAfter:null,valueBefore:null,escape:!1},{id:"not-regex",label:"not regex",operator:"!=",valueAfter:null,valueBefore:null,escape:!1}],Ke=Object.fromEntries(Jt.map(r=>[r.id,r])),ei="?",se='text = ""',ti=["sentence","s","utterance","u","paragraph","p","turn","t","text","session"],er=[{id:"*",label:"Zero or More",type:"symbol",new:"*"},{id:"+",label:"One or More",type:"symbol",new:"+"},{id:"?",label:"Zero or One",type:"symbol",new:"?"},{id:"n-n",label:"Exactly N",type:"range",new:"{1}"},{id:"n-m",label:"N to M",type:"range",new:"{0,1}"},{id:"n-",label:"At least N",type:"range",new:"{0,}"},{id:"-m",label:"At most M",type:"range",new:"{,1}"}],ri=Object.fromEntries(er.map(r=>[r.id,r])),tr=[{id:"token",label:"Normal Token",new:`[ ${se} ]`},{id:"unspecific-token",label:"Unspecific Token",new:"[]"},{id:"string",label:"Plain String",new:'""'}],ze=Object.fromEntries(tr.map(r=>[r.id,r])),rr=[{id:"basic",label:"Expression",new:`${se}`},{id:"or",label:"OR",new:`${se} | ${se}`},{id:"and",label:"AND",new:`${se} & ${se}`}],Ue=Object.fromEntries(rr.map(r=>[r.id,r])),ir=[{id:"or",label:"OR",newBefore:`${se} |`,newAfter:`| ${se}`},{id:"and",label:"AND",newBefore:`${se} &`,newAfter:`& ${se}`}],ii=Object.fromEntries(ir.map(r=>[r.id,r])),sr=[{id:"group",label:"Group",newBefore:"(",newAfter:")"},{id:"not",label:"Negation",newBefore:"!",newAfter:null}],Nt=Object.fromEntries(sr.map(r=>[r.id,r])),nt=d.createContext(void 0);nt.displayName="FCSParserLexerContext";function si({parser:r,lexer:e,cursorPos:t,children:s}){const o={parser:r,lexer:e,cursorPos:t};return i.jsx(nt.Provider,{value:o,children:s})}function nr(){const r=d.useContext(nt);if(!r)throw new Error('No parser and lexer "data" set, use FCSParserLexerProvider to set');return r}const ot=d.createContext(void 0);ot.displayName="FCSQueryBuilderConfigContext";function ni({enableWithin:r=!0,enableWrapGroup:e=!0,enableWrapNegation:t=!0,enableImplicitQuery:s=!0,enableMultipleQuerySegments:o=!0,enableQuantifiers:f=!0,enableRegexpFlags:c=!0,showBasicLayer:h=!0,showAllAdvancedLayers:u=!0,showCustomLayers:p=!0,showLayerQualifiers:E=!0,showResourceCountForLayer:L=!0,children:R}){const _={enableWithin:r,enableWrapGroup:e,enableWrapNegation:t,enableImplicitQuery:s,enableMultipleQuerySegments:o,enableQuantifiers:f,enableRegexpFlags:c,showBasicLayer:h,showAllAdvancedLayers:u,showCustomLayers:p,showLayerQualifiers:E,showResourceCountForLayer:L};return i.jsx(ot.Provider,{value:_,children:R})}function Ee(){const r=d.useContext(ot);if(!r)throw new Error('No flags "data" set, use FCSQueryBuilderConfigProvider to set');return r}const at=d.createContext(void 0);at.displayName="FCSQueryUpdaterContext";function oi({rewriter:r,children:e}){const t={rewriter:r};return i.jsx(at.Provider,{value:t,children:e})}function ge(){const r=d.useContext(at);if(!r)throw new Error('No rewriter "data" set, use FCSQueryUpdaterProvider to set');return r}const lt=d.createContext(void 0);lt.displayName="FCSResourceLayerInfoContext";function ai({resources:r,layerInfo:e,children:t}){const s={resources:r,layerInfo:e};return i.jsx(lt.Provider,{value:s,children:t})}function li(){const r=d.useContext(lt);if(!r)throw new Error('No resources and layer info "data" set, use FCSResourceLayerInfoProvider to set');return r}class D extends Ut{static L_PAREN=1;static R_PAREN=2;static L_SQUARE_BRACKET=3;static R_SQUARE_BRACKET=4;static OR=5;static AND=6;static NOT=7;static FWD_SLASH=8;static L_CURLY_BRACKET=9;static R_CURLY_BRACKET=10;static Q_ONE_OR_MORE=11;static Q_ZERO_OR_MORE=12;static Q_ZERO_OR_ONE=13;static Q_COMMA=14;static OPERATOR_EQ=15;static OPERATOR_NE=16;static COLON=17;static WITHIN=18;static SIMPLE_WITHIN_SCOPE=19;static REGEXP_FLAGS=20;static IDENTIFIER=21;static INTEGER=22;static REGEXP=23;static QUOTED_STRING=24;static Space=25;static channelNames=["DEFAULT_TOKEN_CHANNEL","HIDDEN"];static literalNames=[null,"'('","')'","'['","']'","'|'","'&'","'!'","'/'","'{'","'}'","'+'","'*'","'?'","','","'='","'!='","':'","'within'"];static symbolicNames=[null,"L_PAREN","R_PAREN","L_SQUARE_BRACKET","R_SQUARE_BRACKET","OR","AND","NOT","FWD_SLASH","L_CURLY_BRACKET","R_CURLY_BRACKET","Q_ONE_OR_MORE","Q_ZERO_OR_MORE","Q_ZERO_OR_ONE","Q_COMMA","OPERATOR_EQ","OPERATOR_NE","COLON","WITHIN","SIMPLE_WITHIN_SCOPE","REGEXP_FLAGS","IDENTIFIER","INTEGER","REGEXP","QUOTED_STRING","Space"];static modeNames=["DEFAULT_MODE"];static ruleNames=["L_PAREN","R_PAREN","L_SQUARE_BRACKET","R_SQUARE_BRACKET","OR","AND","NOT","FWD_SLASH","L_CURLY_BRACKET","R_CURLY_BRACKET","Q_ONE_OR_MORE","Q_ZERO_OR_MORE","Q_ZERO_OR_ONE","Q_COMMA","OPERATOR_EQ","OPERATOR_NE","COLON","WITHIN","SIMPLE_WITHIN_SCOPE","REGEXP_FLAGS","IDENTIFIER_FIRST_CHAR","IDENTIFIER_LAST_CHAR","IDENTIFIER_CHAR","IDENTIFIER","INTEGER","REGEXP","QUOTED_STRING","CHAR","WS","ESCAPED_CHAR","HEX","Space"];constructor(e){super(e),this.interpreter=new jt(this,D._ATN,D.decisionsToDFA,new He)}get grammarFileName(){return"FCSLexer.g4"}get literalNames(){return D.literalNames}get symbolicNames(){return D.symbolicNames}get ruleNames(){return D.ruleNames}get serializedATN(){return D._serializedATN}get channelNames(){return D.channelNames}get modeNames(){return D.modeNames}static _serializedATN=[4,0,25,238,6,-1,2,0,7,0,2,1,7,1,2,2,7,2,2,3,7,3,2,4,7,4,2,5,7,5,2,6,7,6,2,7,7,7,2,8,7,8,2,9,7,9,2,10,7,10,2,11,7,11,2,12,7,12,2,13,7,13,2,14,7,14,2,15,7,15,2,16,7,16,2,17,7,17,2,18,7,18,2,19,7,19,2,20,7,20,2,21,7,21,2,22,7,22,2,23,7,23,2,24,7,24,2,25,7,25,2,26,7,26,2,27,7,27,2,28,7,28,2,29,7,29,2,30,7,30,2,31,7,31,1,0,1,0,1,1,1,1,1,2,1,2,1,3,1,3,1,4,1,4,1,5,1,5,1,6,1,6,1,7,1,7,1,8,1,8,1,9,1,9,1,10,1,10,1,11,1,11,1,12,1,12,1,13,1,13,1,14,1,14,1,15,1,15,1,15,1,16,1,16,1,17,1,17,1,17,1,17,1,17,1,17,1,17,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,3,18,153,8,18,1,19,4,19,156,8,19,11,19,12,19,157,1,20,1,20,1,21,1,21,1,22,1,22,1,23,1,23,5,23,168,8,23,10,23,12,23,171,9,23,1,23,3,23,174,8,23,1,24,4,24,177,8,24,11,24,12,24,178,1,25,1,25,1,26,1,26,1,26,5,26,186,8,26,10,26,12,26,189,9,26,1,26,1,26,1,26,1,26,5,26,195,8,26,10,26,12,26,198,9,26,1,26,3,26,201,8,26,1,27,1,27,3,27,205,8,27,1,28,1,28,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,3,29,231,8,29,1,30,1,30,1,31,1,31,1,31,1,31,0,0,32,1,1,3,2,5,3,7,4,9,5,11,6,13,7,15,8,17,9,19,10,21,11,23,12,25,13,27,14,29,15,31,16,33,17,35,18,37,19,39,20,41,0,43,0,45,0,47,21,49,22,51,23,53,24,55,0,57,0,59,0,61,0,63,25,1,0,10,5,0,67,67,73,73,99,100,105,105,108,108,2,0,65,90,97,122,3,0,48,57,65,90,97,122,4,0,45,45,48,57,65,90,97,122,1,0,48,57,2,0,39,39,92,92,2,0,34,34,92,92,10,0,9,13,32,32,133,133,160,160,5760,5760,8192,8202,8232,8233,8239,8239,8287,8287,12288,12288,9,0,34,34,36,36,39,43,46,46,63,63,91,94,110,110,116,116,123,125,3,0,48,57,65,70,97,102,252,0,1,1,0,0,0,0,3,1,0,0,0,0,5,1,0,0,0,0,7,1,0,0,0,0,9,1,0,0,0,0,11,1,0,0,0,0,13,1,0,0,0,0,15,1,0,0,0,0,17,1,0,0,0,0,19,1,0,0,0,0,21,1,0,0,0,0,23,1,0,0,0,0,25,1,0,0,0,0,27,1,0,0,0,0,29,1,0,0,0,0,31,1,0,0,0,0,33,1,0,0,0,0,35,1,0,0,0,0,37,1,0,0,0,0,39,1,0,0,0,0,47,1,0,0,0,0,49,1,0,0,0,0,51,1,0,0,0,0,53,1,0,0,0,0,63,1,0,0,0,1,65,1,0,0,0,3,67,1,0,0,0,5,69,1,0,0,0,7,71,1,0,0,0,9,73,1,0,0,0,11,75,1,0,0,0,13,77,1,0,0,0,15,79,1,0,0,0,17,81,1,0,0,0,19,83,1,0,0,0,21,85,1,0,0,0,23,87,1,0,0,0,25,89,1,0,0,0,27,91,1,0,0,0,29,93,1,0,0,0,31,95,1,0,0,0,33,98,1,0,0,0,35,100,1,0,0,0,37,152,1,0,0,0,39,155,1,0,0,0,41,159,1,0,0,0,43,161,1,0,0,0,45,163,1,0,0,0,47,165,1,0,0,0,49,176,1,0,0,0,51,180,1,0,0,0,53,200,1,0,0,0,55,204,1,0,0,0,57,206,1,0,0,0,59,208,1,0,0,0,61,232,1,0,0,0,63,234,1,0,0,0,65,66,5,40,0,0,66,2,1,0,0,0,67,68,5,41,0,0,68,4,1,0,0,0,69,70,5,91,0,0,70,6,1,0,0,0,71,72,5,93,0,0,72,8,1,0,0,0,73,74,5,124,0,0,74,10,1,0,0,0,75,76,5,38,0,0,76,12,1,0,0,0,77,78,5,33,0,0,78,14,1,0,0,0,79,80,5,47,0,0,80,16,1,0,0,0,81,82,5,123,0,0,82,18,1,0,0,0,83,84,5,125,0,0,84,20,1,0,0,0,85,86,5,43,0,0,86,22,1,0,0,0,87,88,5,42,0,0,88,24,1,0,0,0,89,90,5,63,0,0,90,26,1,0,0,0,91,92,5,44,0,0,92,28,1,0,0,0,93,94,5,61,0,0,94,30,1,0,0,0,95,96,5,33,0,0,96,97,5,61,0,0,97,32,1,0,0,0,98,99,5,58,0,0,99,34,1,0,0,0,100,101,5,119,0,0,101,102,5,105,0,0,102,103,5,116,0,0,103,104,5,104,0,0,104,105,5,105,0,0,105,106,5,110,0,0,106,36,1,0,0,0,107,108,5,115,0,0,108,109,5,101,0,0,109,110,5,110,0,0,110,111,5,116,0,0,111,112,5,101,0,0,112,113,5,110,0,0,113,114,5,99,0,0,114,153,5,101,0,0,115,153,5,115,0,0,116,117,5,117,0,0,117,118,5,116,0,0,118,119,5,116,0,0,119,120,5,101,0,0,120,121,5,114,0,0,121,122,5,97,0,0,122,123,5,110,0,0,123,124,5,99,0,0,124,153,5,101,0,0,125,153,5,117,0,0,126,127,5,112,0,0,127,128,5,97,0,0,128,129,5,114,0,0,129,130,5,97,0,0,130,131,5,103,0,0,131,132,5,114,0,0,132,133,5,97,0,0,133,134,5,112,0,0,134,153,5,104,0,0,135,153,5,112,0,0,136,137,5,116,0,0,137,138,5,117,0,0,138,139,5,114,0,0,139,153,5,110,0,0,140,153,5,116,0,0,141,142,5,116,0,0,142,143,5,101,0,0,143,144,5,120,0,0,144,153,5,116,0,0,145,146,5,115,0,0,146,147,5,101,0,0,147,148,5,115,0,0,148,149,5,115,0,0,149,150,5,105,0,0,150,151,5,111,0,0,151,153,5,110,0,0,152,107,1,0,0,0,152,115,1,0,0,0,152,116,1,0,0,0,152,125,1,0,0,0,152,126,1,0,0,0,152,135,1,0,0,0,152,136,1,0,0,0,152,140,1,0,0,0,152,141,1,0,0,0,152,145,1,0,0,0,153,38,1,0,0,0,154,156,7,0,0,0,155,154,1,0,0,0,156,157,1,0,0,0,157,155,1,0,0,0,157,158,1,0,0,0,158,40,1,0,0,0,159,160,7,1,0,0,160,42,1,0,0,0,161,162,7,2,0,0,162,44,1,0,0,0,163,164,7,3,0,0,164,46,1,0,0,0,165,173,3,41,20,0,166,168,3,45,22,0,167,166,1,0,0,0,168,171,1,0,0,0,169,167,1,0,0,0,169,170,1,0,0,0,170,172,1,0,0,0,171,169,1,0,0,0,172,174,3,43,21,0,173,169,1,0,0,0,173,174,1,0,0,0,174,48,1,0,0,0,175,177,7,4,0,0,176,175,1,0,0,0,177,178,1,0,0,0,178,176,1,0,0,0,178,179,1,0,0,0,179,50,1,0,0,0,180,181,3,53,26,0,181,52,1,0,0,0,182,187,5,39,0,0,183,186,3,59,29,0,184,186,8,5,0,0,185,183,1,0,0,0,185,184,1,0,0,0,186,189,1,0,0,0,187,185,1,0,0,0,187,188,1,0,0,0,188,190,1,0,0,0,189,187,1,0,0,0,190,201,5,39,0,0,191,196,5,34,0,0,192,195,3,59,29,0,193,195,8,6,0,0,194,192,1,0,0,0,194,193,1,0,0,0,195,198,1,0,0,0,196,194,1,0,0,0,196,197,1,0,0,0,197,199,1,0,0,0,198,196,1,0,0,0,199,201,5,34,0,0,200,182,1,0,0,0,200,191,1,0,0,0,201,54,1,0,0,0,202,205,3,59,29,0,203,205,8,7,0,0,204,202,1,0,0,0,204,203,1,0,0,0,205,56,1,0,0,0,206,207,7,7,0,0,207,58,1,0,0,0,208,230,5,92,0,0,209,231,7,8,0,0,210,211,5,120,0,0,211,212,3,61,30,0,212,213,3,61,30,0,213,231,1,0,0,0,214,215,5,117,0,0,215,216,3,61,30,0,216,217,3,61,30,0,217,218,3,61,30,0,218,219,3,61,30,0,219,231,1,0,0,0,220,221,5,85,0,0,221,222,3,61,30,0,222,223,3,61,30,0,223,224,3,61,30,0,224,225,3,61,30,0,225,226,3,61,30,0,226,227,3,61,30,0,227,228,3,61,30,0,228,229,3,61,30,0,229,231,1,0,0,0,230,209,1,0,0,0,230,210,1,0,0,0,230,214,1,0,0,0,230,220,1,0,0,0,231,60,1,0,0,0,232,233,7,9,0,0,233,62,1,0,0,0,234,235,3,57,28,0,235,236,1,0,0,0,236,237,6,31,0,0,237,64,1,0,0,0,13,0,152,157,169,173,178,185,187,194,196,200,204,230,1,0,1,0];static __ATN;static get _ATN(){return D.__ATN||(D.__ATN=new Be().deserialize(D._serializedATN)),D.__ATN}static vocabulary=new De(D.literalNames,D.symbolicNames,[]);get vocabulary(){return D.vocabulary}static decisionsToDFA=D._ATN.decisionToState.map((e,t)=>new Ge(e,t))}class ui extends kt{visitQuery;visitMain_query;visitQuery_disjunction;visitQuery_sequence;visitQuery_group;visitQuery_simple;visitQuantifier;visitQuery_implicit;visitQuery_segment;visitWithin_part;visitWithin_part_simple;visitExpression;visitExpression_or;visitExpression_and;visitExpression_group;visitExpression_not;visitExpression_basic;visitAttribute;visitQualifier;visitIdentifier;visitRegexp;visitRegexp_pattern;visitRegexp_flag}function or(r){if(!r||!r.trim())return null;const e=Mt.fromString(r),t=new D(e),s=new qt(t),o=new Ht(s),f=new n(s),c=new Yt;return t.removeErrorListeners(),t.addErrorListener(c),f.removeErrorListeners(),f.addErrorListener(c),{tree:f.query(),lexer:t,parser:f,rewriter:o,errors:c.errors}}class ci extends ui{layers=[];visitAttribute=e=>{this.layers.push(e.getText())}}function hi(r){const e=new ci;r&&e.visit(r);const t=e.layers;return[...new Set(t)]}function di(r,e){const t=e.filter(u=>u!=="word").filter(u=>u!=="text");if(t.length===0||r.length===0)return{supported:r,unsupported:[],unsupportedByLayer:new Map};const s=t.map(u=>u.split(":").toReversed()),o=r.map(u=>{const p=[];return s.forEach(([E,L])=>{L?u.availableLayers?.find(R=>R.layerType===E&&R.qualifier===L)||p.push(`${L}:${E}`):u.availableLayers?.find(R=>R.layerType===E)||p.push(E)}),[u,p]}),f=o.filter(([,u])=>u.length===0).map(([u])=>u),c=o.filter(([,u])=>u.length!==0),h=c.map(([u,p])=>p.map(E=>[E,u])).flat(1).reduce((u,[p,E])=>(u.has(p)||u.set(p,[]),u.get(p).push(E),u),new Map);return{supported:f,unsupported:c,unsupportedByLayer:h}}const fi=/([\^$\\.*+?()[\]{}|/])/g,xi=/\\([\^$\\.*+?()[\]{}|/])/g,pi=/(^|[^\\])([\^$.*+?()[\]{}|/])/g,ar=/(^|[^\\])((?:\\{2})*['"])/g,lr=/(^|[^\\])\\((?:\\{2})*['"])/g;function Ct(r){if(!r)return r;let e=r;return e=e.replace(fi,"\\$1"),e=e.replace(ar,"$1\\$2"),e}function _i(r){if(!r)return r;let e=r;return e=e.replace(lr,"$1$2"),e=e.replace(xi,"$1"),e}function Ri(r){return r?r.replace(pi,"\\$1$2")!==r:!1}function Ye(r){return r&&r.replaceAll("\\","\\\\").replace(ar,"$1\\$2")}function ur(r){return r&&r.replace(lr,"$1$2").replaceAll("\\\\","\\")}function mi({query:r,cursorPos:e,resources:t,onChange:s,...o}){const[f,c]=d.useState(r??"");d.useEffect(()=>c(r??""),[r]);const h=d.useMemo(()=>{const R=t?.filter(_=>(_.availableDataViews?.find(x=>x.mimeType==="application/x-clarin-fcs-adv+xml")!==void 0||_.searchCapabilitiesResolved.includes("ADVANCED_SEARCH"))&&_.availableLayers!==null&&_.availableLayers.length>0)??[];if(t&&t.length!==R.length){const _=t.filter(x=>!R.includes(x));console.warn("Filter out resource(s) that do(es) not correctly declare ADV query support",_)}return R},[t]),u=d.useMemo(()=>h.map(R=>{const _=new Map;return R.availableLayers.forEach(x=>{_.has(x.layerType)||_.set(x.layerType,{resultIDs:[],qualifiers:[]});const C=_.get(x.layerType);C.resultIDs.push(x.resultId),x.qualifier!==null&&x.qualifier!==void 0&&C.qualifiers.push(x.qualifier)}),[..._.entries()].map(([x,C])=>({layerType:x,resource:R,layerIDs:C}))}).reduce((R,_)=>(_.forEach(({layerType:x,resource:C,layerIDs:w})=>{R.has(x)||R.set(x,{resources:[],qualifiers:new Map});const Q=R.get(x);Q.resources.push({resource:C,layerIDs:w}),w.qualifiers.length>0&&w.qualifiers.forEach(P=>{Q.qualifiers.has(P)||Q.qualifiers.set(P,[]),Q.qualifiers.get(P).push(C)})}),R),new Map),[h]),p=d.useMemo(()=>or(f),[f]);function E(){if(p){const{rewriter:R}=p,_=R.getText();c(_),s?.(_)}else console.warn("No parsed query! Unable to handle change request",p)}function L(R){const _=ze[R].new;c(_),s?.(_)}return i.jsx("div",{id:"query-builder",className:"fcs-query d-flex justify-content-center",children:i.jsx(ni,{enableWithin:o.enableWithin??!1,enableWrapGroup:o.enableWrapGroup??!1,enableWrapNegation:o.enableWrapNegation??!1,enableImplicitQuery:o.enableImplicitQuery??!1,enableMultipleQuerySegments:o.enableMultipleQuerySegments??!0,enableQuantifiers:o.enableQuantifiers??!0,enableRegexpFlags:o.enableRegexpFlags??!1,showBasicLayer:o.showBasicLayer??!0,showAllAdvancedLayers:o.showAllAdvancedLayers??!1,showCustomLayers:o.showCustomLayers??!0,showLayerQualifiers:o.showLayerQualifiers??!0,showResourceCountForLayer:o.showResourceCountForLayer??!0,children:i.jsx(ai,{resources:h,layerInfo:u,children:p?i.jsx(si,{parser:p.parser,lexer:p.lexer,cursorPos:e,children:i.jsx(oi,{rewriter:p.rewriter,children:i.jsx(yi,{tree:p.tree,onChange:E})})}):i.jsx(Ze,{onClick:L})})})})}function cr(r,e=!0){if(r instanceof Pe){if(e)throw Error("Unsupported syntax: Query-Disjunction");return[]}if(r instanceof xe){if(e)throw Error("Unsupported syntax: Query-Group");return[]}if(r instanceof pe)return[r];if(r instanceof me)return r.children.map(t=>cr(t,e)).flat(1);if(e)throw Error(`Invalid ParseTree for tokens ${r.getSourceInterval().toString()}: ${r.getText()}`);return[]}function je(r,e){e.delete(r.start,r.stop);const t=r.parent;if(t instanceof ce||t instanceof ue){if(t.children.length===1){je(t,e);return}const s=t.children.findIndex(o=>o===r);if(s===0){const o=t.getChild(s+1);e.delete(o.symbol)}else{const o=t.getChild(s-1);e.delete(o.symbol)}if(t.children.length===3){const o=t.parent,f=t.getChild(s+(s===0?2:-2));o instanceof F&&f instanceof F&&(e.delete(f.L_PAREN().symbol),e.delete(f.R_PAREN().symbol))}return}if(t instanceof F){je(t,e);return}if(t instanceof V){je(t,e);return}console.warn("Unexpected other parent to remove?",{parentCtx:t,ctx:r})}function Ze({onClick:r}){const{enableImplicitQuery:e}=Ee();function t(s){s&&r?.(s)}return i.jsx(i.Fragment,{children:i.jsxs(g,{className:"d-inline-block",onSelect:t,"aria-label":"Add query segment",children:[i.jsx(g.Toggle,{variant:"link",className:"add-query-segment-btn action-btn no-arrow",children:i.jsx("i",{dangerouslySetInnerHTML:{__html:qe},"aria-hidden":"true"})}),i.jsx(g.Menu,{children:tr.filter(e?()=>!0:s=>s.id!=="string").map(s=>i.jsx(g.Item,{eventKey:s.id,children:s.label},s.id))})]})})}function Je({allowedIds:r,onClick:e}){function t(s){s&&e?.(s)}return i.jsx(i.Fragment,{children:i.jsxs(g,{className:"d-inline-block",onSelect:t,"aria-label":"Add expression",children:[i.jsx(g.Toggle,{variant:"link",className:"add-expression-btn action-btn no-arrow",children:i.jsx("i",{dangerouslySetInnerHTML:{__html:qe},"aria-hidden":"true"})}),i.jsx(g.Menu,{children:rr.filter(r&&r.length>0?s=>r.includes(s.id):()=>!0).map(s=>i.jsx(g.Item,{eventKey:s.id,children:s.label},s.id))})]})})}function Lt({className:r,onClick:e}){function t(s){s&&e?.(s)}return i.jsx(i.Fragment,{children:i.jsxs(g,{className:["d-inline-block"].concat(r??[]).join(" "),onSelect:t,"aria-label":"Change to expressions list",children:[i.jsx(g.Toggle,{variant:"link",className:"change-to-expression-list-btn action-btn no-arrow",children:i.jsx("i",{dangerouslySetInnerHTML:{__html:qe},"aria-hidden":"true"})}),i.jsx(g.Menu,{children:ir.map(s=>i.jsx(g.Item,{eventKey:s.id,children:s.label},s.id))})]})})}function Ei({allowedIds:r,className:e,onClick:t}){const{enableWrapGroup:s,enableWrapNegation:o}=Ee();function f(c){c&&t?.(c)}return s||o?i.jsx(i.Fragment,{children:i.jsxs(g,{className:["d-inline-block"].concat(e??[]).join(" "),onSelect:f,"aria-label":"Wrap expression",children:[i.jsx(g.Toggle,{variant:"link",className:"wrap-expression-btn action-btn rounded-circle p-1 no-arrow",children:i.jsx("i",{dangerouslySetInnerHTML:{__html:Fr},"aria-hidden":"true"})}),i.jsx(g.Menu,{children:sr.filter(r&&r.length>0?c=>r.includes(c.id):()=>!0).filter(s?()=>!0:c=>c.id!=="group").filter(o?()=>!0:c=>c.id!=="not").map(c=>i.jsx(g.Item,{eventKey:c.id,children:c.label},c.id))})]})}):null}function We({className:r,onClick:e}){return i.jsx(Re,{variant:"link",className:["del-btn action-btn rounded-circle p-1"].concat(r??[]).join(" "),onClick:e,children:i.jsx("i",{dangerouslySetInnerHTML:{__html:Tt},"aria-hidden":"true"})})}function gi({className:r,onClick:e}){return i.jsx(Re,{variant:"link",className:["add-quantifier-btn action-btn rounded-circle p-1"].concat(r??[]).join(" "),onClick:e,children:i.jsx("i",{dangerouslySetInnerHTML:{__html:Wr},"aria-hidden":"true"})})}function yi({tree:r,onChange:e}){const{rewriter:t}=ge(),{enableWithin:s}=Ee(),o=r.main_query(),f=o.getChild(0),c=cr(f,!1),h=s?r.within_part():null,u=h?.getText()??"",[p,E]=d.useState(u);d.useEffect(()=>E(u),[u]);function L(){const x="sentence";E(x);const C=o.stop?.tokenIndex;C!==void 0?(t.insertAfter(C,` within ${x}`),e?.()):console.warn("Unable to add within part. End token index not found!",{queryCtx:o})}function R(x){const C=x.target.value;if(E(C),h){const w=h.within_part_simple(),Q=w?.SIMPLE_WITHIN_SCOPE();Q?(t.replaceSingle(Q.symbol,C),e?.()):console.warn("Error trying to update within part. Token not found!",{withinCtx:h,withinPartCtx:w,token:Q})}else console.warn("Error trying to update within part. Context not found!",{tree:r,withinCtx:h})}function _(){h?(E(""),t.delete(r.WITHIN().symbol,h.stop),e?.()):console.warn("Error trying to remove within part. Context not found!",{tree:r,withinCtx:h})}return i.jsxs("div",{className:"block query flex-grow-1 justify-content-center d-flex flex-wrap row-gap-2 column-gap-1 border rounded p-1",children:[i.jsx(bi,{children:c,onChange:e}),s&&(p?i.jsxs("div",{className:"block within-clause position-relative d-flex column-gap-2 align-items-center border rounded p-1",children:[i.jsx("code",{className:"keyword",children:"within"}),i.jsx(W.Select,{className:"w-auto",value:p,onChange:R,children:ti.map(x=>i.jsx("option",{value:x,children:x},x))}),i.jsx(We,{className:"del-within-clause-btn position-absolute top-0 start-100 translate-middle",onClick:_})]}):i.jsx(Re,{size:"sm",onClick:L,style:{alignSelf:"center"},children:"Add within clause"}))]})}function bi({children:r,onChange:e}){const{rewriter:t}=ge(),{enableMultipleQuerySegments:s}=Ee(),o=d.useCallback(c=>{const h=r&&r.length>0?r[0].start.tokenIndex:0,u=ze[c].new;t.insertBefore(h,`${u} `),e?.()},[t,r,e]),f=d.useCallback((c,h)=>{const u=h.stop.tokenIndex,p=ze[c].new;t.insertAfter(u,` ${p}`),e?.()},[t,e]);return i.jsxs("div",{className:"block query-simple-or-sequence border rounded py-1 px-2 d-flex flex-wrap row-gap-3 column-gap-2 align-items-center",children:[s&&i.jsx(Ze,{onClick:o},"add-0"),r.map(c=>i.jsxs(d.Fragment,{children:[i.jsx(Ci,{ctx:c,onChange:e}),s&&i.jsx(Ze,{onClick:h=>f(h,c)})]},`query-${c.getSourceInterval().toString()}`))]})}function Ai({value:r,onChange:e}){const[t,s]=d.useState(r);return d.useEffect(()=>s(r),[r]),i.jsx(W.Control,{className:"d-inline",style:{width:"10ch"},value:t,onChange:o=>s(o.target.value),onBlur:()=>e?.(t)})}function ut({ctx:r,showChangeToExpressionListButton:e=!1,onChange:t}){const{rewriter:s}=ge(),{layerInfo:o}=li(),{showBasicLayer:f,showAllAdvancedLayers:c,showCustomLayers:h,showLayerQualifiers:u,showResourceCountForLayer:p}=Ee(),{cursorPos:E}=nr(),L=Ie(r,E),R="word",_=Object.keys(bt),x=[R,..._],C=h?[...o.keys()].filter(a=>!x.includes(a)).toSorted():[],w=o.has(R),Q=[...o.keys()].filter(a=>Object.keys(bt).includes(a)).length>0,P=C.length>0,$=r.attribute(),O=r.getChild(1),U=r.regexp().regexp_pattern().REGEXP(),[j,Z]=d.useState("text"),[q,k]=d.useState("is"),[S,z]=d.useState(""),Y=d.useRef(q);d.useEffect(()=>{const a=$.identifier(),b=$.qualifier(),M=b!==null?`${b.getText()}:${a.getText()}`:`${a.getText()}`,H=O.symbol.type===n.OPERATOR_EQ,ne=U.symbol.text?.slice(1,-1),ve=be(ne??"",H);let oe=ve.operator,Se=Ae(ve.value,oe);Y.current!==oe&&["regex","not-regex"].includes(Y.current)&&(Y.current,oe=Y.current);const fe=At[M];fe&&fe.options&&fe.options.length>0&&(!fe.options.map(gt=>gt.value).includes(Se)||!Se)&&(Se=fe.options[0]?.value??"",oe="is"),Z(M??""),k(oe),z(Se),Y.current=oe},[$,O,U]);const he=r.parent,de=Object.keys(Nt).filter(he instanceof F?a=>a!=="group":()=>!0).filter(he instanceof V?a=>a!=="group":()=>!0),ae=At[j];function be(a,b){const M=a.startsWith(".*"),H=a.endsWith(".*"),X=M&&H?a.slice(2,-2):M?a.slice(2):H?a.slice(0,-2):a;return Ri(X)?{operator:b?"regex":"not-regex",value:a}:b?M&&H?{operator:"contains",value:X}:M?{operator:"ends-with",value:a.slice(2)}:H?{operator:"starts-with",value:a.slice(0,-2)}:{operator:"is",value:a}:M||H?{operator:"not-regex",value:a}:{operator:"is-not",value:a}}function Ae(a,b){return["regex","not-regex"].includes(b)?ur(a):_i(a)}function Ne(a,b){return["regex","not-regex"].includes(b)?Ye(a):Ct(a)}function Oe(a){const b=a;b&&b!==j&&(Z(b),s.replace($.start,$.stop,b),t?.())}function Ce(a){const b=a.target.value,M=q;k(b),Y.current=b;const H=["is-not","not-regex"].includes(b)?"!=":"=";s.replaceSingle(O.symbol,H);let X=S??"";const ne=Ke[b],ve=Ke[M];if(!ne){console.warn("Unexpected state, did not find known operator value!",{newOpInfo:ne,oldOpInfo:ve,newOperator:b,oldOperator:M});return}X=Ne(X,b),s.replaceSingle(U.symbol,`"${ne.valueBefore??""}${X}${ne.valueAfter??""}"`),t?.()}function Le(){const a=["regex","not-regex"].includes(q)?Ye(S):Ct(S),b=Ke[q];s.replaceSingle(U.symbol,`"${b?.valueBefore??""}${a}${b?.valueAfter??""}"`),t?.()}function m(a,b){const M=ii[a];b?s.insertBefore(r.start,`${M.newBefore} `):s.insertAfter(r.stop,` ${M.newAfter}`),t?.()}function y(a){const b=Nt[a];b.newBefore&&s.insertBefore(r.start,b.newBefore),b.newAfter&&s.insertAfter(r.stop,b.newAfter),t?.()}function T(){je(r,s),t?.()}function I(a,b=void 0){return b?i.jsxs(i.Fragment,{children:[i.jsx("strong",{children:a}),": ",b,K(a)]}):i.jsxs(i.Fragment,{children:[i.jsx("strong",{children:a}),K(a)]})}function K(a,b=void 0){if(!p)return null;const M=o.get(a)?.resources.length??0,H=b?o.get(a)?.qualifiers?.get(b)?.length??0:void 0;if(b&&M===H)return null;const X=b?H:M;return i.jsxs(i.Fragment,{children:[i.jsx("br",{}),i.jsxs("small",{className:"text-body-secondary",children:["Supported by ",X," resources."]})]})}function ie(a){if(!u)return null;const b=o.get(a)?.qualifiers;return!b||b.size===0?null:[...b.keys()].map(H=>{const X=`${H}:${a}`;return i.jsx(g.Item,{eventKey:X,active:j===X,children:i.jsxs("div",{className:"ms-3",children:[i.jsx("strong",{children:H}),":",a,K(a,H)]})},X)})}function J(){return ae&&ae.options?.length>0?i.jsxs(g,{onSelect:a=>z(a??""),onBlur:Le,children:[i.jsx(g.Toggle,{className:"form-select",children:S}),i.jsx(g.Menu,{children:ae.options.map(a=>i.jsx(g.Item,{eventKey:a.value,active:S===a.value,children:a.label},a.value))})]}):i.jsx(W.Control,{className:"d-inline",style:{width:"10ch"},value:S,onChange:a=>z(a.target.value),onBlur:Le})}return i.jsxs("div",{className:["block input-block basic-expression position-relative focus-ring border rounded py-3 ps-2 pe-3 my-2 ms-1 me-2"].concat([L?"cursor-focus":""]).join(" "),children:[e&&i.jsx(Lt,{className:"position-absolute top-0 start-50 translate-middle rounded-circle p-1",onClick:a=>m(a,!0)}),i.jsxs("div",{className:"d-flex justify-content-center column-gap-2",children:[i.jsxs(g,{onSelect:Oe,children:[i.jsx(g.Toggle,{className:"form-select",children:j}),i.jsx(g.Menu,{children:i.jsxs("div",{className:"d-flex",children:[i.jsxs("div",{className:[].concat(h&&P?["border-end pe-1"]:[]).join(" "),children:[f&&i.jsxs(i.Fragment,{children:[i.jsx(g.Header,{children:"Basic Search Layer"}),i.jsx(g.Item,{eventKey:R,active:j===R,children:I(R)}),i.jsx(g.Divider,{})]}),(f||h&&C.length>0)&&i.jsx(g.Header,{children:"Advanced Search Layers"}),Zt.filter(c?()=>!0:a=>o.has(a.id)).map(a=>i.jsxs(d.Fragment,{children:[i.jsxs(g.Item,{eventKey:a.id,active:j===a.id,children:[i.jsx("strong",{children:a.id}),": ",a.label,K(a.id)]}),ie(a.id)]},a.id)),!f&&!c&&C.length===0&&i.jsxs(g.ItemText,{style:{width:"max-content"},children:[i.jsx("em",{className:"text-warning-emphasis",children:"No supported layers available?!"}),i.jsx("br",{}),i.jsx("em",{className:"text-secondary",children:"Maybe select a few more resources."})]})]}),i.jsx("div",{className:[].concat(f&&w||Q?["ps-1"]:[]).join(" "),children:h&&C.length>0&&i.jsxs(i.Fragment,{children:[i.jsx(g.Header,{children:"Custom Layers"}),C.map(a=>i.jsxs(d.Fragment,{children:[i.jsxs(g.Item,{eventKey:a,active:j===a,children:[i.jsx("strong",{children:a}),K(a)]}),ie(a)]},a))]})})]})})]}),i.jsx(W.Select,{style:{width:"fit-content"},value:q,onChange:Ce,children:Jt.map(a=>i.jsx("option",{value:a.id,children:a.label},a.id))}),J()]}),e&&i.jsx(Lt,{className:"position-absolute top-100 start-50 translate-middle rounded-circle p-1",onClick:a=>m(a,!1)}),i.jsxs("div",{className:"actions position-absolute top-0 d-flex",children:[i.jsx(Ei,{allowedIds:de,onClick:y}),i.jsx(We,{onClick:T})]})]})}function Ni({ctx:r,onChange:e}){const{rewriter:t}=ge(),s=r.Q_ZERO_OR_MORE()!==null,o=r.Q_ONE_OR_MORE()!==null,f=r.Q_ZERO_OR_ONE()!==null,c=!(s||o||f),h=r.getChildCount(),u=h>=4,p=c&&(h===3||r.Q_COMMA()===r.getChild(2))?r.getChild(1).symbol:null,E=c&&h>=4&&r.Q_COMMA()===r.getChild(h-3)?r.getChild(h-2).symbol:null,L=p!==null?Number.parseInt(p.text):null,R=E!==null?Number.parseInt(E.text):null,_=c?L!==null&&R!==null?"n-m":L!==null?u?"n-":"n-n":R!==null?"-m":null:s?"*":f?"?":o?"+":null,[x,C]=d.useState(_??"?"),[w,Q]=d.useState(L),[P,$]=d.useState(R);d.useEffect(()=>{Q(L),$(R)},[L,R]);const O=w!==null&&P!==null&&w>P||w!==null&&w<0||P!==null&&P<1;function U(k){const S=k.target.value;C(S);const z=ri[S].new??"?";t.replace(r.start,r.stop,z),e?.()}function j(k){const S=Number.parseInt(k.target.value);Q(Number.isNaN(S)?null:S),p!==null&&!Number.isNaN(S)&&(t.replaceSingle(p,S.toString()),e?.())}function Z(k){const S=Number.parseInt(k.target.value);$(Number.isNaN(S)?null:S),E!==null&&!Number.isNaN(S)&&(t.replaceSingle(E,S.toString()),e?.())}function q(){t.delete(r.start,r.stop),e?.()}return i.jsxs("div",{className:["block input-block quantifier position-relative border rounded p-1 pt-3 px-1 m-1 me-2 mt-2"].concat(O?["invalid-range"]:[]).join(" "),children:[i.jsxs("div",{className:"d-flex flex-column align-items-center row-gap-1",children:[i.jsx(W.Select,{size:"sm",style:{width:"fit-content"},value:x,onChange:U,children:er.map(k=>i.jsx("option",{value:k.id,children:k.label},k.id))}),i.jsx("div",{className:"d-flex align-items-baseline column-gap-1",children:["+","*","?"].includes(x)?i.jsx("code",{className:"keyword",children:x}):i.jsxs(i.Fragment,{children:[i.jsx("code",{className:"keyword",children:"{"}),i.jsx(W.Text,{children:"Repeat"}),["n-m","n-","n-n"].includes(x)&&i.jsx(W.Control,{size:"sm",style:{width:"8ch"},type:"number",min:x==="n-n"?1:0,max:x==="n-m"?P??void 0:void 0,value:w??0,onChange:j}),x==="n-m"&&i.jsx(W.Text,{children:"to"}),["n-m","-m"].includes(x)&&i.jsx(W.Control,{size:"sm",style:{width:"8ch"},type:"number",min:x==="n-m"&&w||1,value:P??w??1,onChange:Z}),i.jsx("code",{className:"keyword",children:"}"})]})})]}),i.jsx(We,{className:"del-quantifier-btn position-absolute top-0 start-100 translate-middle",onClick:q})]})}function Ci({ctx:r,onChange:e}){const{rewriter:t}=ge(),{enableQuantifiers:s}=Ee(),{cursorPos:o}=nr(),f=r.query_implicit(),c=r.query_segment(),h=r.quantifier(),u=f!==null,p=Ie(u?f:c,o);function E(){t.delete(r.start,r.stop),e?.()}function L(){t.insertAfter(r.stop,` ${ei}`),e?.()}function R(){if(f!==null){let _=function(Q){t.replaceSingle(x.symbol,`"${Ye(Q)}"`),e?.()};const x=f.regexp().regexp_pattern().REGEXP(),C=x.symbol.text,w=ur(C?.slice(1,-1));return i.jsx(Ai,{value:w??"",onChange:_})}if(c!==null){const _=c.expression();if(!_){let x=function(C){const w=Ue[C].new;t.insertAfter(r.start,` ${w} `),e?.()};return i.jsx(Je,{onClick:C=>x(C)})}return i.jsx(Li,{ctx:_,onChange:e})}throw Error('Invalid parse tree. Expected "query-segment" context.')}return i.jsxs("div",{className:["block query-simple focus-ring border rounded p-1 pe-2 my-2 position-relative d-flex align-items-center"].concat(p?"cursor-focus":"").join(" "),children:[u?i.jsx("code",{className:"delims",children:'"'}):i.jsx("code",{className:"delims",children:"["}),R(),u?i.jsx("code",{className:"delims",children:'"'}):i.jsx("code",{className:"delims",children:"]"}),s&&h!==null&&i.jsx(Ni,{ctx:h,onChange:e}),i.jsx(We,{className:"del-query-segment-btn position-absolute top-0 start-100 translate-middle",onClick:E}),s&&h===null&&i.jsx(gi,{className:"position-absolute top-100 start-100 translate-middle",onClick:L})]})}function Li({ctx:r,onChange:e}){const t=r.getChild(0);return t instanceof re?i.jsx(ut,{ctx:t,showChangeToExpressionListButton:!0,onChange:e}):t instanceof V||t instanceof F?i.jsx(ct,{ctx:t,onChange:e}):i.jsx(ht,{ctx:t,onChange:e})}function ct({ctx:r,onChange:e}){const t=r instanceof V,s=r instanceof F,o=r.getChild(1);return i.jsxs("div",{className:["block expression-wrap position-relative p-1 m-1 border rounded"].concat(t?["negation-expression d-flex align-items-center"]:[]).concat(s?["group-expression d-flex align-items-center"]:[]).join(" "),children:[t&&i.jsx("code",{className:"delims",children:"!"}),s&&i.jsx("code",{className:"delims",children:"("}),o instanceof re?i.jsx(ut,{ctx:o,showChangeToExpressionListButton:!t,onChange:e}):o instanceof V||o instanceof F?i.jsx(ct,{ctx:o,onChange:e}):i.jsx(ht,{ctx:o,onChange:e}),s&&i.jsx("code",{className:"delims",children:")"})]})}function ht({ctx:r,onChange:e}){const{rewriter:t}=ge(),s=r instanceof ce,o=r instanceof ue,f=Object.keys(Ue).filter(s?E=>E!=="and":()=>!0).filter(o?E=>E!=="or":()=>!0),c=s?"&":"|";function h(E){const L=r.children.length>0?r.children[0].start.tokenIndex:0,R=Ue[E].new,_=E==="basic"?R:`( ${R} )`;t.insertBefore(L,`${_} ${c} `),e?.()}function u(E,L){const R=L.stop.tokenIndex,_=Ue[E].new,x=E==="basic"?_:`( ${_} )`;t.insertAfter(R,` ${c} ${x}`),e?.()}function p(E){return E instanceof re?i.jsx(ut,{ctx:E,showChangeToExpressionListButton:!1,onChange:e}):E instanceof V||E instanceof F?i.jsx(ct,{ctx:E,onChange:e}):i.jsx(ht,{ctx:E,onChange:e})}return i.jsxs("div",{className:["block expression-list p-1 m-1 border rounded position-relative"].concat(o?["or-expression"]:[]).concat(s?["and-expression"]:[]).join(" "),children:[o&&i.jsx("code",{className:"delims position-absolute ps-1",children:"OR"}),s&&i.jsx("code",{className:"delims position-absolute ps-1",children:"AND"}),i.jsxs("div",{className:"d-flex flex-column align-items-center mt-1",children:[i.jsx(Je,{allowedIds:f,onClick:h}),r.children.filter((E,L)=>L%2===0).map(E=>i.jsxs(d.Fragment,{children:[p(E),i.jsx(Je,{allowedIds:f,onClick:L=>u(L,E)})]},`expression-${E.getSourceInterval().toString()}`))]})]})}class l extends It{static L_PAREN=1;static R_PAREN=2;static EQUAL=3;static GREATER=4;static LESSER=5;static GREATER_EQUAL=6;static LESSER_EQUAL=7;static NOT_EQUAL=8;static EQUAL_EQUAL=9;static SLASH=10;static AND=11;static OR=12;static NOT=13;static DOT=14;static QUOTED_STRING=15;static SIMPLE_STRING=16;static WS=17;static RULE_query=0;static RULE_boolean_query=1;static RULE_subquery=2;static RULE_search_clause=3;static RULE_search_term=4;static RULE_index=5;static RULE_relation_modified=6;static RULE_relation=7;static RULE_relation_name=8;static RULE_relation_symbol=9;static RULE_boolean_modified=10;static RULE_r_boolean=11;static RULE_modifier_list=12;static RULE_modifier=13;static RULE_modifier_name=14;static RULE_modifier_relation=15;static RULE_modifier_value=16;static RULE_prefix_name=17;static RULE_prefix=18;static RULE_simple_name=19;static literalNames=[null,"'('","')'","'='","'>'","'<'","'>='","'<='","'<>'","'=='","'/'",null,null,null,"'.'"];static symbolicNames=[null,"L_PAREN","R_PAREN","EQUAL","GREATER","LESSER","GREATER_EQUAL","LESSER_EQUAL","NOT_EQUAL","EQUAL_EQUAL","SLASH","AND","OR","NOT","DOT","QUOTED_STRING","SIMPLE_STRING","WS"];static ruleNames=["query","boolean_query","subquery","search_clause","search_term","index","relation_modified","relation","relation_name","relation_symbol","boolean_modified","r_boolean","modifier_list","modifier","modifier_name","modifier_relation","modifier_value","prefix_name","prefix","simple_name"];get grammarFileName(){return"LexParser.g4"}get literalNames(){return l.literalNames}get symbolicNames(){return l.symbolicNames}get ruleNames(){return l.ruleNames}get serializedATN(){return l._serializedATN}createFailedPredicateException(e,t){return new Ot(this,e,t)}constructor(e){super(e),this.interpreter=new Qt(this,l._ATN,l.decisionsToDFA,new He)}query(){const e=new vi(this.context,this.state);this.enterRule(e,0,l.RULE_query);try{this.enterOuterAlt(e,1),this.state=40,this.boolean_query(),this.state=41,this.match(l.EOF)}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}boolean_query(){const e=new Fe(this.context,this.state);this.enterRule(e,2,l.RULE_boolean_query);let t;try{for(this.enterOuterAlt(e,1),this.state=43,this.subquery(),this.state=49,this.errorHandler.sync(this),t=this.tokenStream.LA(1);(t&-32)===0&&(1<<t&14336)!==0;)this.state=44,this.boolean_modified(),this.state=45,this.subquery(),this.state=51,this.errorHandler.sync(this),t=this.tokenStream.LA(1)}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}subquery(){const e=new ke(this.context,this.state);this.enterRule(e,4,l.RULE_subquery);try{switch(this.state=57,this.errorHandler.sync(this),this.tokenStream.LA(1)){case l.L_PAREN:this.enterOuterAlt(e,1),this.state=52,this.match(l.L_PAREN),this.state=53,this.boolean_query(),this.state=54,this.match(l.R_PAREN);break;case l.QUOTED_STRING:case l.SIMPLE_STRING:this.enterOuterAlt(e,2),this.state=56,this.search_clause();break;default:throw new le(this)}}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}search_clause(){const e=new hr(this.context,this.state);this.enterRule(e,6,l.RULE_search_clause);try{this.enterOuterAlt(e,1);{switch(this.state=62,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,2,this.context)){case 1:this.state=59,this.index(),this.state=60,this.relation_modified();break}this.state=64,this.search_term()}}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}search_term(){const e=new dr(this.context,this.state);this.enterRule(e,8,l.RULE_search_term);let t;try{this.enterOuterAlt(e,1),this.state=66,t=this.tokenStream.LA(1),t===15||t===16?(this.errorHandler.reportMatch(this),this.consume()):this.errorHandler.recoverInline(this)}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}index(){const e=new fr(this.context,this.state);this.enterRule(e,10,l.RULE_index);try{switch(this.state=70,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,3,this.context)){case 1:this.enterOuterAlt(e,1),this.state=68,this.simple_name();break;case 2:this.enterOuterAlt(e,2),this.state=69,this.prefix_name();break}}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}relation_modified(){const e=new xr(this.context,this.state);this.enterRule(e,12,l.RULE_relation_modified);let t;try{this.enterOuterAlt(e,1),this.state=72,this.relation(),this.state=74,this.errorHandler.sync(this),t=this.tokenStream.LA(1),t===10&&(this.state=73,this.modifier_list())}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}relation(){const e=new pr(this.context,this.state);this.enterRule(e,14,l.RULE_relation);try{switch(this.state=78,this.errorHandler.sync(this),this.tokenStream.LA(1)){case l.SIMPLE_STRING:this.enterOuterAlt(e,1),this.state=76,this.relation_name();break;case l.EQUAL:case l.GREATER:case l.LESSER:case l.GREATER_EQUAL:case l.LESSER_EQUAL:case l.NOT_EQUAL:case l.EQUAL_EQUAL:this.enterOuterAlt(e,2),this.state=77,this.relation_symbol();break;default:throw new le(this)}}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}relation_name(){const e=new _r(this.context,this.state);this.enterRule(e,16,l.RULE_relation_name);try{switch(this.state=82,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,6,this.context)){case 1:this.enterOuterAlt(e,1),this.state=80,this.simple_name();break;case 2:this.enterOuterAlt(e,2),this.state=81,this.prefix_name();break}}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}relation_symbol(){const e=new dt(this.context,this.state);this.enterRule(e,18,l.RULE_relation_symbol);let t;try{this.enterOuterAlt(e,1),this.state=84,t=this.tokenStream.LA(1),(t&-32)===0&&(1<<t&1016)!==0?(this.errorHandler.reportMatch(this),this.consume()):this.errorHandler.recoverInline(this)}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}boolean_modified(){const e=new Me(this.context,this.state);this.enterRule(e,20,l.RULE_boolean_modified);let t;try{this.enterOuterAlt(e,1),this.state=86,this.r_boolean(),this.state=88,this.errorHandler.sync(this),t=this.tokenStream.LA(1),t===10&&(this.state=87,this.modifier_list())}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}r_boolean(){const e=new Rr(this.context,this.state);this.enterRule(e,22,l.RULE_r_boolean);let t;try{this.enterOuterAlt(e,1),this.state=90,t=this.tokenStream.LA(1),(t&-32)===0&&(1<<t&14336)!==0?(this.errorHandler.reportMatch(this),this.consume()):this.errorHandler.recoverInline(this)}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}modifier_list(){const e=new ft(this.context,this.state);this.enterRule(e,24,l.RULE_modifier_list);let t;try{this.enterOuterAlt(e,1);{this.state=93,this.errorHandler.sync(this),t=this.tokenStream.LA(1);do this.state=92,this.modifier(),this.state=95,this.errorHandler.sync(this),t=this.tokenStream.LA(1);while(t===10)}}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}modifier(){const e=new et(this.context,this.state);this.enterRule(e,26,l.RULE_modifier);let t;try{this.enterOuterAlt(e,1),this.state=97,this.match(l.SLASH),this.state=98,this.modifier_name(),this.state=100,this.errorHandler.sync(this),t=this.tokenStream.LA(1),(t&-32)===0&&(1<<t&1016)!==0&&(this.state=99,this.modifier_relation())}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}modifier_name(){const e=new mr(this.context,this.state);this.enterRule(e,28,l.RULE_modifier_name);try{this.enterOuterAlt(e,1),this.state=102,this.simple_name()}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}modifier_relation(){const e=new Er(this.context,this.state);this.enterRule(e,30,l.RULE_modifier_relation);try{this.enterOuterAlt(e,1),this.state=104,this.relation_symbol(),this.state=105,this.modifier_value()}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}modifier_value(){const e=new gr(this.context,this.state);this.enterRule(e,32,l.RULE_modifier_value);let t;try{this.enterOuterAlt(e,1),this.state=107,t=this.tokenStream.LA(1),t===15||t===16?(this.errorHandler.reportMatch(this),this.consume()):this.errorHandler.recoverInline(this)}catch(s){if(s instanceof N)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}prefix_name(){const e=new xt(this.context,this.state);this.enterRule(e,34,l.RULE_prefix_name);try{this.enterOuterAlt(e,1),this.state=109,this.prefix(),this.state=110,this.match(l.DOT),this.state=111,this.simple_name()}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}prefix(){const e=new yr(this.context,this.state);this.enterRule(e,36,l.RULE_prefix);try{this.enterOuterAlt(e,1),this.state=113,this.simple_name()}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}simple_name(){const e=new ye(this.context,this.state);this.enterRule(e,38,l.RULE_simple_name);try{this.enterOuterAlt(e,1),this.state=115,this.match(l.SIMPLE_STRING)}catch(t){if(t instanceof N)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}static _serializedATN=[4,1,17,118,2,0,7,0,2,1,7,1,2,2,7,2,2,3,7,3,2,4,7,4,2,5,7,5,2,6,7,6,2,7,7,7,2,8,7,8,2,9,7,9,2,10,7,10,2,11,7,11,2,12,7,12,2,13,7,13,2,14,7,14,2,15,7,15,2,16,7,16,2,17,7,17,2,18,7,18,2,19,7,19,1,0,1,0,1,0,1,1,1,1,1,1,1,1,5,1,48,8,1,10,1,12,1,51,9,1,1,2,1,2,1,2,1,2,1,2,3,2,58,8,2,1,3,1,3,1,3,3,3,63,8,3,1,3,1,3,1,4,1,4,1,5,1,5,3,5,71,8,5,1,6,1,6,3,6,75,8,6,1,7,1,7,3,7,79,8,7,1,8,1,8,3,8,83,8,8,1,9,1,9,1,10,1,10,3,10,89,8,10,1,11,1,11,1,12,4,12,94,8,12,11,12,12,12,95,1,13,1,13,1,13,3,13,101,8,13,1,14,1,14,1,15,1,15,1,15,1,16,1,16,1,17,1,17,1,17,1,17,1,18,1,18,1,19,1,19,1,19,0,0,20,0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,0,3,1,0,15,16,1,0,3,9,1,0,11,13,107,0,40,1,0,0,0,2,43,1,0,0,0,4,57,1,0,0,0,6,62,1,0,0,0,8,66,1,0,0,0,10,70,1,0,0,0,12,72,1,0,0,0,14,78,1,0,0,0,16,82,1,0,0,0,18,84,1,0,0,0,20,86,1,0,0,0,22,90,1,0,0,0,24,93,1,0,0,0,26,97,1,0,0,0,28,102,1,0,0,0,30,104,1,0,0,0,32,107,1,0,0,0,34,109,1,0,0,0,36,113,1,0,0,0,38,115,1,0,0,0,40,41,3,2,1,0,41,42,5,0,0,1,42,1,1,0,0,0,43,49,3,4,2,0,44,45,3,20,10,0,45,46,3,4,2,0,46,48,1,0,0,0,47,44,1,0,0,0,48,51,1,0,0,0,49,47,1,0,0,0,49,50,1,0,0,0,50,3,1,0,0,0,51,49,1,0,0,0,52,53,5,1,0,0,53,54,3,2,1,0,54,55,5,2,0,0,55,58,1,0,0,0,56,58,3,6,3,0,57,52,1,0,0,0,57,56,1,0,0,0,58,5,1,0,0,0,59,60,3,10,5,0,60,61,3,12,6,0,61,63,1,0,0,0,62,59,1,0,0,0,62,63,1,0,0,0,63,64,1,0,0,0,64,65,3,8,4,0,65,7,1,0,0,0,66,67,7,0,0,0,67,9,1,0,0,0,68,71,3,38,19,0,69,71,3,34,17,0,70,68,1,0,0,0,70,69,1,0,0,0,71,11,1,0,0,0,72,74,3,14,7,0,73,75,3,24,12,0,74,73,1,0,0,0,74,75,1,0,0,0,75,13,1,0,0,0,76,79,3,16,8,0,77,79,3,18,9,0,78,76,1,0,0,0,78,77,1,0,0,0,79,15,1,0,0,0,80,83,3,38,19,0,81,83,3,34,17,0,82,80,1,0,0,0,82,81,1,0,0,0,83,17,1,0,0,0,84,85,7,1,0,0,85,19,1,0,0,0,86,88,3,22,11,0,87,89,3,24,12,0,88,87,1,0,0,0,88,89,1,0,0,0,89,21,1,0,0,0,90,91,7,2,0,0,91,23,1,0,0,0,92,94,3,26,13,0,93,92,1,0,0,0,94,95,1,0,0,0,95,93,1,0,0,0,95,96,1,0,0,0,96,25,1,0,0,0,97,98,5,10,0,0,98,100,3,28,14,0,99,101,3,30,15,0,100,99,1,0,0,0,100,101,1,0,0,0,101,27,1,0,0,0,102,103,3,38,19,0,103,29,1,0,0,0,104,105,3,18,9,0,105,106,3,32,16,0,106,31,1,0,0,0,107,108,7,0,0,0,108,33,1,0,0,0,109,110,3,36,18,0,110,111,5,14,0,0,111,112,3,38,19,0,112,35,1,0,0,0,113,114,3,38,19,0,114,37,1,0,0,0,115,116,5,16,0,0,116,39,1,0,0,0,10,49,57,62,70,74,78,82,88,95,100];static __ATN;static get _ATN(){return l.__ATN||(l.__ATN=new Be().deserialize(l._serializedATN)),l.__ATN}static vocabulary=new De(l.literalNames,l.symbolicNames,[]);get vocabulary(){return l.vocabulary}static decisionsToDFA=l._ATN.decisionToState.map((e,t)=>new Ge(e,t))}class vi extends A{constructor(e,t){super(e,t)}boolean_query(){return this.getRuleContext(0,Fe)}EOF(){return this.getToken(l.EOF,0)}get ruleIndex(){return l.RULE_query}enterRule(e){e.enterQuery&&e.enterQuery(this)}exitRule(e){e.exitQuery&&e.exitQuery(this)}accept(e){return e.visitQuery?e.visitQuery(this):e.visitChildren(this)}}class Fe extends A{constructor(e,t){super(e,t)}subquery(e){return e===void 0?this.getRuleContexts(ke):this.getRuleContext(e,ke)}boolean_modified(e){return e===void 0?this.getRuleContexts(Me):this.getRuleContext(e,Me)}get ruleIndex(){return l.RULE_boolean_query}enterRule(e){e.enterBoolean_query&&e.enterBoolean_query(this)}exitRule(e){e.exitBoolean_query&&e.exitBoolean_query(this)}accept(e){return e.visitBoolean_query?e.visitBoolean_query(this):e.visitChildren(this)}}class ke extends A{constructor(e,t){super(e,t)}L_PAREN(){return this.getToken(l.L_PAREN,0)}boolean_query(){return this.getRuleContext(0,Fe)}R_PAREN(){return this.getToken(l.R_PAREN,0)}search_clause(){return this.getRuleContext(0,hr)}get ruleIndex(){return l.RULE_subquery}enterRule(e){e.enterSubquery&&e.enterSubquery(this)}exitRule(e){e.exitSubquery&&e.exitSubquery(this)}accept(e){return e.visitSubquery?e.visitSubquery(this):e.visitChildren(this)}}class hr extends A{constructor(e,t){super(e,t)}search_term(){return this.getRuleContext(0,dr)}index(){return this.getRuleContext(0,fr)}relation_modified(){return this.getRuleContext(0,xr)}get ruleIndex(){return l.RULE_search_clause}enterRule(e){e.enterSearch_clause&&e.enterSearch_clause(this)}exitRule(e){e.exitSearch_clause&&e.exitSearch_clause(this)}accept(e){return e.visitSearch_clause?e.visitSearch_clause(this):e.visitChildren(this)}}class dr extends A{constructor(e,t){super(e,t)}SIMPLE_STRING(){return this.getToken(l.SIMPLE_STRING,0)}QUOTED_STRING(){return this.getToken(l.QUOTED_STRING,0)}get ruleIndex(){return l.RULE_search_term}enterRule(e){e.enterSearch_term&&e.enterSearch_term(this)}exitRule(e){e.exitSearch_term&&e.exitSearch_term(this)}accept(e){return e.visitSearch_term?e.visitSearch_term(this):e.visitChildren(this)}}class fr extends A{constructor(e,t){super(e,t)}simple_name(){return this.getRuleContext(0,ye)}prefix_name(){return this.getRuleContext(0,xt)}get ruleIndex(){return l.RULE_index}enterRule(e){e.enterIndex&&e.enterIndex(this)}exitRule(e){e.exitIndex&&e.exitIndex(this)}accept(e){return e.visitIndex?e.visitIndex(this):e.visitChildren(this)}}class xr extends A{constructor(e,t){super(e,t)}relation(){return this.getRuleContext(0,pr)}modifier_list(){return this.getRuleContext(0,ft)}get ruleIndex(){return l.RULE_relation_modified}enterRule(e){e.enterRelation_modified&&e.enterRelation_modified(this)}exitRule(e){e.exitRelation_modified&&e.exitRelation_modified(this)}accept(e){return e.visitRelation_modified?e.visitRelation_modified(this):e.visitChildren(this)}}class pr extends A{constructor(e,t){super(e,t)}relation_name(){return this.getRuleContext(0,_r)}relation_symbol(){return this.getRuleContext(0,dt)}get ruleIndex(){return l.RULE_relation}enterRule(e){e.enterRelation&&e.enterRelation(this)}exitRule(e){e.exitRelation&&e.exitRelation(this)}accept(e){return e.visitRelation?e.visitRelation(this):e.visitChildren(this)}}class _r extends A{constructor(e,t){super(e,t)}simple_name(){return this.getRuleContext(0,ye)}prefix_name(){return this.getRuleContext(0,xt)}get ruleIndex(){return l.RULE_relation_name}enterRule(e){e.enterRelation_name&&e.enterRelation_name(this)}exitRule(e){e.exitRelation_name&&e.exitRelation_name(this)}accept(e){return e.visitRelation_name?e.visitRelation_name(this):e.visitChildren(this)}}class dt extends A{constructor(e,t){super(e,t)}EQUAL(){return this.getToken(l.EQUAL,0)}GREATER(){return this.getToken(l.GREATER,0)}LESSER(){return this.getToken(l.LESSER,0)}GREATER_EQUAL(){return this.getToken(l.GREATER_EQUAL,0)}LESSER_EQUAL(){return this.getToken(l.LESSER_EQUAL,0)}NOT_EQUAL(){return this.getToken(l.NOT_EQUAL,0)}EQUAL_EQUAL(){return this.getToken(l.EQUAL_EQUAL,0)}get ruleIndex(){return l.RULE_relation_symbol}enterRule(e){e.enterRelation_symbol&&e.enterRelation_symbol(this)}exitRule(e){e.exitRelation_symbol&&e.exitRelation_symbol(this)}accept(e){return e.visitRelation_symbol?e.visitRelation_symbol(this):e.visitChildren(this)}}class Me extends A{constructor(e,t){super(e,t)}r_boolean(){return this.getRuleContext(0,Rr)}modifier_list(){return this.getRuleContext(0,ft)}get ruleIndex(){return l.RULE_boolean_modified}enterRule(e){e.enterBoolean_modified&&e.enterBoolean_modified(this)}exitRule(e){e.exitBoolean_modified&&e.exitBoolean_modified(this)}accept(e){return e.visitBoolean_modified?e.visitBoolean_modified(this):e.visitChildren(this)}}class Rr extends A{constructor(e,t){super(e,t)}AND(){return this.getToken(l.AND,0)}OR(){return this.getToken(l.OR,0)}NOT(){return this.getToken(l.NOT,0)}get ruleIndex(){return l.RULE_r_boolean}enterRule(e){e.enterR_boolean&&e.enterR_boolean(this)}exitRule(e){e.exitR_boolean&&e.exitR_boolean(this)}accept(e){return e.visitR_boolean?e.visitR_boolean(this):e.visitChildren(this)}}class ft extends A{constructor(e,t){super(e,t)}modifier(e){return e===void 0?this.getRuleContexts(et):this.getRuleContext(e,et)}get ruleIndex(){return l.RULE_modifier_list}enterRule(e){e.enterModifier_list&&e.enterModifier_list(this)}exitRule(e){e.exitModifier_list&&e.exitModifier_list(this)}accept(e){return e.visitModifier_list?e.visitModifier_list(this):e.visitChildren(this)}}class et extends A{constructor(e,t){super(e,t)}SLASH(){return this.getToken(l.SLASH,0)}modifier_name(){return this.getRuleContext(0,mr)}modifier_relation(){return this.getRuleContext(0,Er)}get ruleIndex(){return l.RULE_modifier}enterRule(e){e.enterModifier&&e.enterModifier(this)}exitRule(e){e.exitModifier&&e.exitModifier(this)}accept(e){return e.visitModifier?e.visitModifier(this):e.visitChildren(this)}}class mr extends A{constructor(e,t){super(e,t)}simple_name(){return this.getRuleContext(0,ye)}get ruleIndex(){return l.RULE_modifier_name}enterRule(e){e.enterModifier_name&&e.enterModifier_name(this)}exitRule(e){e.exitModifier_name&&e.exitModifier_name(this)}accept(e){return e.visitModifier_name?e.visitModifier_name(this):e.visitChildren(this)}}class Er extends A{constructor(e,t){super(e,t)}relation_symbol(){return this.getRuleContext(0,dt)}modifier_value(){return this.getRuleContext(0,gr)}get ruleIndex(){return l.RULE_modifier_relation}enterRule(e){e.enterModifier_relation&&e.enterModifier_relation(this)}exitRule(e){e.exitModifier_relation&&e.exitModifier_relation(this)}accept(e){return e.visitModifier_relation?e.visitModifier_relation(this):e.visitChildren(this)}}class gr extends A{constructor(e,t){super(e,t)}SIMPLE_STRING(){return this.getToken(l.SIMPLE_STRING,0)}QUOTED_STRING(){return this.getToken(l.QUOTED_STRING,0)}get ruleIndex(){return l.RULE_modifier_value}enterRule(e){e.enterModifier_value&&e.enterModifier_value(this)}exitRule(e){e.exitModifier_value&&e.exitModifier_value(this)}accept(e){return e.visitModifier_value?e.visitModifier_value(this):e.visitChildren(this)}}class xt extends A{constructor(e,t){super(e,t)}prefix(){return this.getRuleContext(0,yr)}DOT(){return this.getToken(l.DOT,0)}simple_name(){return this.getRuleContext(0,ye)}get ruleIndex(){return l.RULE_prefix_name}enterRule(e){e.enterPrefix_name&&e.enterPrefix_name(this)}exitRule(e){e.exitPrefix_name&&e.exitPrefix_name(this)}accept(e){return e.visitPrefix_name?e.visitPrefix_name(this):e.visitChildren(this)}}class yr extends A{constructor(e,t){super(e,t)}simple_name(){return this.getRuleContext(0,ye)}get ruleIndex(){return l.RULE_prefix}enterRule(e){e.enterPrefix&&e.enterPrefix(this)}exitRule(e){e.exitPrefix&&e.exitPrefix(this)}accept(e){return e.visitPrefix?e.visitPrefix(this):e.visitChildren(this)}}class ye extends A{constructor(e,t){super(e,t)}SIMPLE_STRING(){return this.getToken(l.SIMPLE_STRING,0)}get ruleIndex(){return l.RULE_simple_name}enterRule(e){e.enterSimple_name&&e.enterSimple_name(this)}exitRule(e){e.exitSimple_name&&e.exitSimple_name(this)}accept(e){return e.visitSimple_name?e.visitSimple_name(this):e.visitChildren(this)}}const Si=[{id:"lang",label:"Entry language",virtual:!0},{id:"lemma",label:"Lemma form"},{id:"entryId",label:"Identifier of the current entry"},{id:"phonetic",label:"Phonetic form"},{id:"translation",label:"Translation"},{id:"transcription",label:"Transcription or transliteration"},{id:"definition",label:"Definition or description"},{id:"etymology",label:"Etymology information"},{id:"case",label:"Morphological Case"},{id:"number",label:"Morphological Number"},{id:"gender",label:"Morphological Gender"},{id:"pos",label:"Part-of-Speech"},{id:"baseform",label:"Baseform (or stem )"},{id:"segmentation",label:"Composita segmentation, hyphenation"},{id:"sentiment",label:"Sentiment information",unstructured:!0},{id:"frequency",label:"Frequency information",unstructured:!0},{id:"antonym",label:"Antonym"},{id:"hyponym",label:"Hyponym"},{id:"hypernym",label:"Hypernym"},{id:"meronym",label:"Meronym"},{id:"holonym",label:"Holonym"},{id:"synonym",label:"Synonym"},{id:"related",label:"Unspecified relation"},{id:"ref",label:"A URI referencing a related resource"},{id:"senseRef",label:"ID of a sense definition"},{id:"citation",label:"Citation, quotation or example"}],wi=Object.fromEntries(Si.map(r=>[r.id,r])),Ti=[{id:"virtual",label:"Virtual fields",fields:["lang"]},{id:"core",label:"Basic fields",fields:["lemma","entryId","phonetic","translation","transcription"]},{id:"description",label:"Description fields",fields:["definition","etymology"]},{id:"grammar",label:"Grammar and morphology fields",fields:["case","number","gender","pos","baseform","segmentation"]},{id:"numeric",label:"Unstructured numeric fields",fields:["sentiment","frequency"]},{id:"relation",label:"Semantic relation fields",fields:["antonym","hyponym","hypernym","meronym","holonym","synonym","related"]},{id:"reference",label:"Reference fields",fields:["ref","senseRef"]},{id:"citation",label:"Citation and quotation fields",fields:["citation"]}],Ii=[{id:"=",label:"equal"},{id:"==",label:"exact equal"},{id:"is",label:"is a"}],br=[{id:"lang",label:"Language"},{id:"unmasked",label:"Unmasked"},{id:"ignoreCase",label:"Ignore Case"},{id:"respectCase",label:"Respect Case"},{id:"ignoreAccents",label:"Ignore Accents"},{id:"respectAccents",label:"Respect Accents"},{id:"honorWhitespace",label:"Honor Whitespace"},{id:"regexp",label:"Regular Expression"},{id:"partialMatch",label:"Partial Match"},{id:"fullMatch",label:"Full Match"}],vt=[["masked","unmasked","regexp"],["ignoreCase","respectCase"],["ignoreAccents","respectAccents"],["partialMatch","fullMatch"]],Oi=[{id:"and",label:"AND"},{id:"or",label:"OR"},{id:"not",label:"NOT"}],St="=",_e='""',Qe="or",Ar=[{id:"search-clause",label:"Search Clause",new:`${_e}`,newBefore:`${_e} ${Qe}`,newAfter:`${Qe} ${_e}`},{id:"sub-query",label:"Subquery",new:`( ${_e} )`,newBefore:`( ${_e} ) ${Qe}`,newAfter:`${Qe} ( ${_e} )`}],tt=Object.fromEntries(Ar.map(r=>[r.id,r])),pt=d.createContext(void 0);pt.displayName="LexCQLParserLexerContext";function Qi({parser:r,lexer:e,cursorPos:t,children:s}){const o={parser:r,lexer:e,cursorPos:t};return i.jsx(pt.Provider,{value:o,children:s})}function Nr(){const r=d.useContext(pt);if(!r)throw new Error('No parser and lexer "data" set, use LexCQLParserLexerProvider to set');return r}const _t=d.createContext(void 0);_t.displayName="LexCQLQueryBuilderConfigContext";function Ui({enableRelationModifiers:r=!0,forceSearchTermQuoting:e=!1,showAllFields:t=!0,showResourceCountForField:s=!0,children:o}){const f={enableRelationModifiers:r,forceSearchTermQuoting:e,showAllFields:t,showResourceCountForField:s};return i.jsx(_t.Provider,{value:f,children:o})}function ji(){const r=d.useContext(_t);if(!r)throw new Error('No flags "data" set, use LexCQLQueryBuilderConfigProvider to set');return r}const Rt=d.createContext(void 0);Rt.displayName="LexCQLQueryUpdaterContext";function ki({rewriter:r,children:e}){const t={rewriter:r};return i.jsx(Rt.Provider,{value:t,children:e})}function mt(){const r=d.useContext(Rt);if(!r)throw new Error('No rewriter "data" set, use LexCQLQueryUpdaterProvider to set');return r}const Et=d.createContext(void 0);Et.displayName="LexCQLResourceFieldInfoContext";function Mi({resources:r,fieldInfo:e,children:t}){const s={resources:r,fieldInfo:e};return i.jsx(Et.Provider,{value:s,children:t})}function qi(){const r=d.useContext(Et);if(!r)throw new Error('No resources and field info "data" set, use LexCQLResourceFieldInfoProvider to set');return r}class G extends Ut{static L_PAREN=1;static R_PAREN=2;static EQUAL=3;static GREATER=4;static LESSER=5;static GREATER_EQUAL=6;static LESSER_EQUAL=7;static NOT_EQUAL=8;static EQUAL_EQUAL=9;static SLASH=10;static AND=11;static OR=12;static NOT=13;static DOT=14;static QUOTED_STRING=15;static SIMPLE_STRING=16;static WS=17;static channelNames=["DEFAULT_TOKEN_CHANNEL","HIDDEN"];static literalNames=[null,"'('","')'","'='","'>'","'<'","'>='","'<='","'<>'","'=='","'/'",null,null,null,"'.'"];static symbolicNames=[null,"L_PAREN","R_PAREN","EQUAL","GREATER","LESSER","GREATER_EQUAL","LESSER_EQUAL","NOT_EQUAL","EQUAL_EQUAL","SLASH","AND","OR","NOT","DOT","QUOTED_STRING","SIMPLE_STRING","WS"];static modeNames=["DEFAULT_MODE"];static ruleNames=["L_PAREN","R_PAREN","EQUAL","GREATER","LESSER","GREATER_EQUAL","LESSER_EQUAL","NOT_EQUAL","EQUAL_EQUAL","SLASH","AND","OR","NOT","DOT","QUOTED_STRING","SIMPLE_STRING","WS"];constructor(e){super(e),this.interpreter=new jt(this,G._ATN,G.decisionsToDFA,new He)}get grammarFileName(){return"LexLexer.g4"}get literalNames(){return G.literalNames}get symbolicNames(){return G.symbolicNames}get ruleNames(){return G.ruleNames}get serializedATN(){return G._serializedATN}get channelNames(){return G.channelNames}get modeNames(){return G.modeNames}static _serializedATN=[4,0,17,92,6,-1,2,0,7,0,2,1,7,1,2,2,7,2,2,3,7,3,2,4,7,4,2,5,7,5,2,6,7,6,2,7,7,7,2,8,7,8,2,9,7,9,2,10,7,10,2,11,7,11,2,12,7,12,2,13,7,13,2,14,7,14,2,15,7,15,2,16,7,16,1,0,1,0,1,1,1,1,1,2,1,2,1,3,1,3,1,4,1,4,1,5,1,5,1,5,1,6,1,6,1,6,1,7,1,7,1,7,1,8,1,8,1,8,1,9,1,9,1,10,1,10,1,10,1,10,1,11,1,11,1,11,1,12,1,12,1,12,1,12,1,13,1,13,1,14,1,14,1,14,1,14,5,14,77,8,14,10,14,12,14,80,9,14,1,14,1,14,1,15,4,15,85,8,15,11,15,12,15,86,1,16,1,16,1,16,1,16,0,0,17,1,1,3,2,5,3,7,4,9,5,11,6,13,7,15,8,17,9,19,10,21,11,23,12,25,13,27,14,29,15,31,16,33,17,1,0,9,2,0,65,65,97,97,2,0,78,78,110,110,2,0,68,68,100,100,2,0,79,79,111,111,2,0,82,82,114,114,2,0,84,84,116,116,2,0,34,34,92,92,8,0,9,10,13,13,32,32,34,34,40,41,47,47,60,62,92,92,3,0,9,10,13,13,32,32,94,0,1,1,0,0,0,0,3,1,0,0,0,0,5,1,0,0,0,0,7,1,0,0,0,0,9,1,0,0,0,0,11,1,0,0,0,0,13,1,0,0,0,0,15,1,0,0,0,0,17,1,0,0,0,0,19,1,0,0,0,0,21,1,0,0,0,0,23,1,0,0,0,0,25,1,0,0,0,0,27,1,0,0,0,0,29,1,0,0,0,0,31,1,0,0,0,0,33,1,0,0,0,1,35,1,0,0,0,3,37,1,0,0,0,5,39,1,0,0,0,7,41,1,0,0,0,9,43,1,0,0,0,11,45,1,0,0,0,13,48,1,0,0,0,15,51,1,0,0,0,17,54,1,0,0,0,19,57,1,0,0,0,21,59,1,0,0,0,23,63,1,0,0,0,25,66,1,0,0,0,27,70,1,0,0,0,29,72,1,0,0,0,31,84,1,0,0,0,33,88,1,0,0,0,35,36,5,40,0,0,36,2,1,0,0,0,37,38,5,41,0,0,38,4,1,0,0,0,39,40,5,61,0,0,40,6,1,0,0,0,41,42,5,62,0,0,42,8,1,0,0,0,43,44,5,60,0,0,44,10,1,0,0,0,45,46,5,62,0,0,46,47,5,61,0,0,47,12,1,0,0,0,48,49,5,60,0,0,49,50,5,61,0,0,50,14,1,0,0,0,51,52,5,60,0,0,52,53,5,62,0,0,53,16,1,0,0,0,54,55,5,61,0,0,55,56,5,61,0,0,56,18,1,0,0,0,57,58,5,47,0,0,58,20,1,0,0,0,59,60,7,0,0,0,60,61,7,1,0,0,61,62,7,2,0,0,62,22,1,0,0,0,63,64,7,3,0,0,64,65,7,4,0,0,65,24,1,0,0,0,66,67,7,1,0,0,67,68,7,3,0,0,68,69,7,5,0,0,69,26,1,0,0,0,70,71,5,46,0,0,71,28,1,0,0,0,72,78,5,34,0,0,73,74,5,92,0,0,74,77,7,6,0,0,75,77,8,6,0,0,76,73,1,0,0,0,76,75,1,0,0,0,77,80,1,0,0,0,78,76,1,0,0,0,78,79,1,0,0,0,79,81,1,0,0,0,80,78,1,0,0,0,81,82,5,34,0,0,82,30,1,0,0,0,83,85,8,7,0,0,84,83,1,0,0,0,85,86,1,0,0,0,86,84,1,0,0,0,86,87,1,0,0,0,87,32,1,0,0,0,88,89,7,8,0,0,89,90,1,0,0,0,90,91,6,16,0,0,91,34,1,0,0,0,4,0,76,78,86,1,0,1,0];static __ATN;static get _ATN(){return G.__ATN||(G.__ATN=new Be().deserialize(G._serializedATN)),G.__ATN}static vocabulary=new De(G.literalNames,G.symbolicNames,[]);get vocabulary(){return G.vocabulary}static decisionsToDFA=G._ATN.decisionToState.map((e,t)=>new Ge(e,t))}class Hi extends kt{visitQuery;visitBoolean_query;visitSubquery;visitSearch_clause;visitSearch_term;visitIndex;visitRelation_modified;visitRelation;visitRelation_name;visitRelation_symbol;visitBoolean_modified;visitR_boolean;visitModifier_list;visitModifier;visitModifier_name;visitModifier_relation;visitModifier_value;visitPrefix_name;visitPrefix;visitSimple_name}function Cr(r){if(!r||!r.trim())return null;const e=Mt.fromString(r),t=new G(e),s=new qt(t),o=new Ht(s),f=new l(s),c=new Yt;return t.removeErrorListeners(),t.addErrorListener(c),f.removeErrorListeners(),f.addErrorListener(c),{tree:f.query(),lexer:t,parser:f,rewriter:o,errors:c.errors}}class Bi extends Hi{fields=[];visitIndex=e=>{this.fields.push(e.getText())}}function Di(r){const e=new Bi;r&&e.visit(r);const t=e.fields;return[...new Set(t)]}function Gi(r,e){if(e.length===0||r.length===0)return{supported:r,unsupported:[],unsupportedByField:new Map};const t=r.map(c=>{const h=[];return e.forEach(u=>{c.availableLexFields?.find(p=>p.type===u)||h.push(u)}),[c,h]}),s=t.filter(([,c])=>c.length===0).map(([c])=>c),o=t.filter(([,c])=>c.length!==0),f=o.map(([c,h])=>h.map(u=>[u,c])).flat(1).reduce((c,[h,u])=>(c.has(h)||c.set(h,[]),c.get(h).push(u),c),new Map);return{supported:s,unsupported:o,unsupportedByField:f}}const Pi=/([<>()=\\" ])/g,Wi=/([\\"])/g,Fi=/(?:\\)([\\"])/g;function Lr(r){if(!r)return"";if(r.startsWith('"')&&r.endsWith('"')){let e=r.slice(1,-1);return e=e.replace(Fi,"$1"),e}return r}function Xe(r,e=!1){return r?r.match(Pi)?`"${r.replace(Wi,"\\$1")}"`:e?`"${r}"`:r:'""'}function $i({query:r,cursorPos:e,resources:t,onChange:s,...o}){const[f,c]=d.useState(r??"");d.useEffect(()=>c(r??""),[r]);const h=d.useMemo(()=>{const R=t?.filter(_=>(_.availableDataViews?.find(x=>x.mimeType==="application/x-clarin-fcs-lex+xml")!==void 0||_.searchCapabilitiesResolved.includes("LEX_SEARCH"))&&_.availableLexFields!==null&&_.availableLexFields.length>0)??[];if(t&&t.length!==R.length){const _=t.filter(x=>!R.includes(x));console.warn("Filter out resource(s) that do(es) not correctly declare LexCQL query support",_)}return R},[t]),u=d.useMemo(()=>h.map(R=>{const _=new Set;return R.availableLexFields.forEach(x=>{_.has(x.type)||_.add(x.type)}),[..._.values()].map(x=>({fieldType:x,resource:R}))}).reduce((R,_)=>(_.forEach(({fieldType:x,resource:C})=>{R.has(x)||R.set(x,[]),R.get(x).push(C)}),R),new Map),[h]),p=d.useMemo(()=>Cr(f),[f]);function E(){if(p){const{rewriter:R}=p,_=R.getText();c(_),s?.(_)}else console.warn("No parsed query! Unable to handle change request",p)}function L(R){const _=tt[R].new;c(_),s?.(_)}return i.jsx("div",{id:"query-builder",className:"lex-query d-flex justify-content-center",children:i.jsx(Ui,{enableRelationModifiers:o.enableRelationModifiers??!0,forceSearchTermQuoting:o.forceSearchTermQuoting??!1,showAllFields:o.showAllFields??!1,showResourceCountForField:o.showResourceCountForField??!0,children:i.jsx(Mi,{resources:h,fieldInfo:u,children:p?i.jsx(Qi,{parser:p.parser,lexer:p.lexer,cursorPos:e,children:i.jsx(ki,{rewriter:p.rewriter,children:i.jsx(Vi,{tree:p.tree,onChange:E})})}):i.jsx(rt,{onClick:L})})})})}function vr({className:r,onClick:e}){return i.jsx(Re,{variant:"link",className:["del-btn action-btn rounded-circle p-1"].concat(r??[]).join(" "),onClick:e,children:i.jsx("i",{dangerouslySetInnerHTML:{__html:Tt},"aria-hidden":"true"})})}function rt({className:r,onClick:e}){function t(s){s&&e?.(s)}return i.jsxs(g,{className:[""].concat(r??[]).join(" "),onSelect:t,"aria-label":"Add search clause",children:[i.jsx(g.Toggle,{variant:"link",className:"add-search-clause-btn action-btn no-arrow",children:i.jsx("i",{dangerouslySetInnerHTML:{__html:qe},"aria-hidden":"true"})}),i.jsx(g.Menu,{children:Ar.map(s=>i.jsx(g.Item,{eventKey:s.id,children:s.label},s.id))})]})}function Vi({tree:r,onChange:e}){const t=r.boolean_query();return i.jsx("div",{className:"query flex-grow-1 justify-content-center d-flex flex-wrap row-gap-2 column-gap-1 rounded",children:i.jsx(Sr,{ctx:t,onChange:e})})}function Sr({ctx:r,onChange:e}){const{rewriter:t}=mt(),s=r.getChildCount()>1;function o(h){if(r.getChildCount()===1){const u=r.subquery(0);if(!u||!u.start){console.warn("Invalid parse tree state. A subquery with associated token should exist!",{ctx:r,subqueryCtx:u,childIdx:h});return}t.delete(u.start,u.stop),e?.()}else if(h===0){const u=r.subquery(0),p=r.boolean_modified(0);if(!u||!p||!u.start||!p.stop){console.warn("Invalid parse tree state. A subquery and boolean_modified with associated tokens should exist!",{ctx:r,subqueryCtx:u,booleanModifiedCtx:p,childIdx:h});return}t.delete(u.start,p.stop),e?.()}else{const u=r.getChild(h),p=r.getChild(h-1);if(!u||!p||!u.stop||!p.start){console.warn("Invalid parse tree state. A subquery and boolean_modified with associated tokens should exist!",{ctx:r,subqueryCtx:u,booleanModifiedCtx:p,childIdx:h});return}t.delete(p.start,u.stop),e?.()}}function f(h){const u=r.start.tokenIndex,p=tt[h].newBefore;t.insertBefore(u,`${p} `),e?.()}function c(h){const u=r.stop.tokenIndex,p=tt[h].newAfter;t.insertAfter(u,` ${p}`),e?.()}return i.jsxs("div",{className:["boolean-query d-flex align-items-center row-gap-2 column-gap-1"].concat(s?"block justify-content-center flex-wrap border rounded p-1":"").join(" "),children:[i.jsx(rt,{onClick:f}),r.children.map((h,u)=>{if(h instanceof ke)return i.jsx(Ki,{ctx:h,onChange:e,onDelete:()=>o(u)},u);if(h instanceof Me)return i.jsx(Xi,{ctx:h,onChange:e},u)}),i.jsx(rt,{onClick:c})]})}function Ki({ctx:r,onChange:e,onDelete:t}){const s=r.boolean_query(),o=r.search_clause(),f=s!==null,c=o!==null,h=f&&!(s.parent?.parent instanceof Fe&&s.parent?.parent.getChildCount()===1);return i.jsx("div",{className:["sub-query position-relative align-items-center justify-content-center d-flex"].concat(f?"block border rounded p-1":"").join(" "),children:f?i.jsxs(i.Fragment,{children:[i.jsx("code",{className:"delims",children:"("}),i.jsx(Sr,{ctx:s,onChange:e}),i.jsx("code",{className:"delims",children:")"}),h&&i.jsx(vr,{className:"del-within-clause-btn position-absolute top-0 start-100 translate-middle",onClick:t})]}):c?i.jsx(Zi,{ctx:o,onChange:e,onDelete:t}):i.jsx("div",{className:"text-danger px-1",title:"Parse error. Expected search clause or a sub query!",children:"???"})})}function Xi({ctx:r,onChange:e}){const{rewriter:t}=mt(),{cursorPos:s}=Nr(),o=Ie(r,s),f=r.getChild(0)?.getText().toLowerCase();function c(h){const u=h;if(!u||u===f)return;const p=r.r_boolean().getChild(0).symbol;if(!p){console.warn("Unexpected parse tree, expected terminal node as first child!",{ctx:r,boolean:r.r_boolean(),firstChild:r.r_boolean().getChild(0)});return}t.replaceSingle(p,u),e?.()}return i.jsx("div",{className:["boolean focus-ring rounded mx-1"].concat([o?"cursor-focus":""]).join(" "),children:i.jsxs(g,{onSelect:c,children:[i.jsx(g.Toggle,{className:"form-select",children:i.jsx("code",{className:"keyword",children:f})}),i.jsx(g.Menu,{children:Oi.map(h=>i.jsx(g.Item,{eventKey:h.id,children:h.label},h.id))})]})})}function zi(r){const t=(r?.modifier_list()?.modifier()??[]).map(s=>s.modifier_name().simple_name().SIMPLE_STRING().symbol.text?.toLowerCase()??"");return br.map(s=>s.id).filter(s=>t.includes(s.toLowerCase()))}function wr(r,e){return(r?.modifier_list()?.modifier()??[]).find(o=>o.modifier_name().simple_name().SIMPLE_STRING().symbol.text?.toLowerCase()===e)}function Yi(r){const e=wr(r,"lang");e?.modifier_relation()?.relation_symbol().EQUAL()||console.warn("Language relation modifier with unsupported relation!");const t=e?.modifier_relation()?.modifier_value();if(!t)return console.warn("No language value for for language relation modifier!"),"";const s=t.QUOTED_STRING(),o=t.SIMPLE_STRING(),f=s?.symbol.text??o?.symbol.text;return Lr(f)}function Zi({ctx:r,onChange:e,onDelete:t}){const{rewriter:s}=mt(),{cursorPos:o}=Nr(),{fieldInfo:f}=qi(),{forceSearchTermQuoting:c,enableRelationModifiers:h,showAllFields:u,showResourceCountForField:p}=ji(),E=[...f.keys()],L=Ie(r,o),R=r.parent?.parent?.getChildCount()!==1,_=r.index(),x=r.relation_modified(),C=r.search_term(),[w,Q]=d.useState(null),[P,$]=d.useState(null),[O,U]=d.useState([]),[j,Z]=d.useState(""),[q,k]=d.useState("");d.useEffect(()=>{const m=_?.getText(),y=x?.relation().getText(),T=C.QUOTED_STRING(),I=C.SIMPLE_STRING(),K=T?.symbol.text??I?.symbol.text;Q(m??null),$(y??null),U(zi(x)),Z(Yi(x)),k(Lr(K))},[_,x,C]);const S=h&&P!=="is";function z(m,y){const T=y.toLowerCase();return m.map(I=>I.toLowerCase()).includes(T)?m.filter(I=>I.toLowerCase()!==T):(vt.flat(1).map(I=>I.toLowerCase()).includes(T)&&vt.find(I=>{const K=I.map(ie=>ie.toLowerCase());if(K.includes(T)){const ie=K.filter(J=>J!==T);return m=m.filter(J=>!ie.includes(J.toLowerCase())),!0}}),[...m,y])}function Y(m,y){if(!y){console.warn("Unexpected parse state. For updating relation modifiers, the relation context should exist!",{relationModifiers:m,relationModifiedCtx:y});return}const T=y.stop.tokenIndex,I=y.modifier_list()?.modifier()??[],K=m.map(a=>a.toLowerCase()),ie=[];let J=!1;for(const a of I){const b=a.modifier_name().simple_name().SIMPLE_STRING().symbol.text?.toLowerCase()??"";K.includes(b)?ie.push(b):(s.delete(a.start,a.stop),J=!0)}for(const a of m)ie.includes(a.toLowerCase())||(a.toLowerCase()==="lang"?s.insertAfter(T,`/${a}=""`):s.insertAfter(T,`/${a}`),J=!0);J&&e?.()}function he(m){const y=m;if(y&&y!==w){if(Q(y),_===null){$(St);const T=`${y} ${St} ${Xe(q,c||C.QUOTED_STRING()!==null)}`;s.replace(r.start,r.stop,T)}else s.replace(_.start,_.stop,y);e?.()}}function de(m){const y=m;if(y&&y!==w){if($(y),x!==null){const T=x.relation();if(s.replace(T.start,T.stop,y),y==="is"){const I=x.modifier_list();I&&s.delete(I.start,I.stop)}}e?.()}}function ae(){const m=Xe(q,c||C.QUOTED_STRING()!==null);s.replace(C.start,C.stop,m),e?.()}function be(){if(!x){console.warn("Unexpected parse state. For updating relation modifiers, the relation context should exist!",{relationModifiers:O,relationModifiedCtx:x});return}const m=wr(x,"lang");if(!m){const I=x.stop.tokenIndex;s.insertAfter(I,`/lang="${j}"`),e?.();return}const y=m.modifier_relation()?.modifier_value();if(!y){const I=m.stop.tokenIndex;s.insertAfter(I,`="${j}"`),e?.();return}const T=Xe(j,c||y.QUOTED_STRING()!==null);s.replace(y.start,y.stop,T),e?.()}function Ae(m){const y=z(O,m);Y(y,x),U(T=>z(T,m))}function Ne(){return i.jsx(W.Control,{className:"d-inline",style:{width:"10ch"},value:q,onChange:m=>k(m.target.value),onBlur:ae})}function Oe(){const m=!j.match(/^[a-z]{3}$/i);return i.jsxs(wt,{hasValidation:!0,children:[i.jsx(W.Control,{className:"d-inline",style:{marginLeft:"1.5em"},placeholder:"ISO638-3 Code",pattern:"[a-zA-Z]{3}",required:!0,value:j,onChange:y=>Z(y.target.value),onBlur:be,isInvalid:m}),i.jsx(W.Control.Feedback,{style:{marginLeft:"1.75em",whiteSpace:"break-spaces"},type:"invalid",children:"Invalid ISO639-3 language code"})]})}function Ce(m,y=void 0){return i.jsxs(i.Fragment,{children:[i.jsx("strong",{children:m}),y&&`: ${y}`,Le(m)]})}function Le(m){if(!p)return null;const y=f.get(m)?.length??0;return i.jsxs(i.Fragment,{children:[i.jsx("br",{}),i.jsxs("small",{className:"text-body-secondary",children:["Supported by ",y," resources."]})]})}return i.jsxs("div",{className:["block input-block basic-expression position-relative focus-ring border rounded py-2 px-2"].concat([R?"me-2 mt-1":""]).concat([L?"cursor-focus":""]).join(" "),children:[i.jsxs("div",{className:"d-flex justify-content-center column-gap-2",children:[i.jsxs(g,{onSelect:he,children:[i.jsx(g.Toggle,{className:"form-select",children:w??i.jsx("em",{className:"text-muted",children:"(default)"})}),i.jsx(g.Menu,{children:Ti.map(m=>E.find(y=>m.fields.includes(y))||m.id==="virtual"||m.fields.includes(w)?i.jsxs(d.Fragment,{children:[(u||f.size>5)&&i.jsx(g.Header,{children:m.label}),m.fields.map(y=>(u||E.includes(y)||m.id==="virtual"||y===w)&&i.jsx(g.Item,{eventKey:y,active:y===w,children:Ce(y,wi[y]?.label)},y))]},m.id):null)})]}),P&&i.jsxs(g,{onSelect:de,children:[i.jsx(g.Toggle,{className:"form-select",children:P}),i.jsx(g.Menu,{children:i.jsxs("div",{className:"d-flex",children:[i.jsxs("div",{className:["flex-grow-1"].concat(S?["border-end pe-1"]:[]).join(" "),children:[S&&i.jsx(g.Header,{children:"Relations"}),Ii.map(m=>i.jsx(g.Item,{eventKey:m.id,active:m.id===w,children:m.label},m.id))]}),i.jsx("div",{className:["text-nowrap"].concat(S?["ps-1"]:[]).join(" "),children:S&&i.jsxs(i.Fragment,{children:[i.jsx(g.Header,{children:"Modifiers"}),i.jsxs(g.ItemText,{children:[i.jsx(W.Check,{id:"lang",name:"lang",label:"Language",type:"checkbox",checked:O.includes("lang"),onChange:()=>Ae("lang")}),O.includes("lang")&&Oe()]},"lang"),br.filter(m=>m.id!=="lang").map(m=>i.jsx(g.ItemText,{children:i.jsx(W.Check,{id:m.id,name:m.id,label:m.label,type:"checkbox",checked:O.includes(m.id),onChange:()=>Ae(m.id)})},m.id))]})})]})})]}),Ne()]}),R&&i.jsx(vr,{className:"del-within-clause-btn position-absolute top-0 start-100 translate-middle",onClick:t})]})}function ds({show:r,query:e,queryType:t,resources:s,selectedResources:o,delay:f=1e3,onModalClose:c}){const{t:h}=Mr("querybuilder"),[u,p]=d.useState(e??""),[E,L]=d.useState(null);d.useEffect(()=>{p(e??""),L(null)},[e]);const R=$r(u,f),[_,x]=d.useState(!1),[C,w,Q]=Yr(null,f),$=Vr(s??[]).filter(v=>t==="fcs"?v.availableLayers!==null&&v.availableLayers.length>0:!0).filter(v=>t==="lex"?v.availableLexFields!==null&&v.availableLexFields.length>0:!0),O=o?$.filter(v=>o.includes(v.id)):$,U=d.useMemo(()=>t==="fcs"?or(u):t==="lex"?Cr(u):(console.warn("Unexpected queryType, so will not parse query!",t),null),[u,t]);U&&U.errors.length>0&&C!==U.errors[0]&&w(U.errors[0]),(!U||U.errors.length===0)&&C!==null&&Q(null);const[j,Z]=d.useState(0),[q,k]=d.useState(0),[S,z]=d.useState(void 0);if(s&&U){if(t==="fcs"){j!==O.length&&Z(O.length);const v=hi(U?.tree),B=di(O,v),ee=B.unsupported.length;ee!==q&&k(ee);const te=[...B.unsupportedByLayer.keys()],we=S?[...S.keys()]:[];(te.length!==we.length||!te.every($e=>we.includes($e)))&&z(B.unsupportedByLayer)}else if(t==="lex"){j!==O.length&&Z(O.length);const v=Di(U?.tree),B=Gi(O,v),ee=B.unsupported.length;ee!==q&&k(ee);const te=[...B.unsupportedByField.keys()],we=S?[...S.keys()]:[];(te.length!==we.length||!te.every($e=>we.includes($e)))&&z(B.unsupportedByField)}}U||q!==0&&(Z(s?.length??0),k(0),z(void 0));function Y(v){const B=S!==void 0?Array.from(S.values()).flat().map(te=>te.id):[],ee=O.filter(te=>!B.includes(te.id)).map(te=>te.id);c({query:u,validResources:ee,action:v})}function he(v){p(v)}function de(v){if(v.target.nodeName==="INPUT"){const B=v.target.selectionStart,ee=v.target.selectionEnd;L(B!==null&&ee!==null&&B!==ee?[B,ee]:B)}}function ae(v){p(v)}const[be,Ae]=d.useState(!1),[Ne,Oe]=d.useState(!1),[Ce,Le]=d.useState(!1),[m,y]=d.useState(!0),[T,I]=d.useState(!0),[K,ie]=d.useState(!0),[J,a]=d.useState(!1),[b,M]=d.useState(!0),[H,X]=d.useState(!1),[ne,ve]=d.useState(!0),[oe,Se]=d.useState(!0),[fe,gt]=d.useState(!0),[Tr,Ji]=d.useState(!1),[Ir,es]=d.useState(!0),[Or,ts]=d.useState(!1),[Qr,rs]=d.useState(!0);function Ur(){return i.jsxs(i.Fragment,{children:[!1,i.jsx(mi,{query:R,cursorPos:E??void 0,onChange:ae,resources:O,enableWithin:be,enableWrapGroup:Ne,enableWrapNegation:Ce,enableImplicitQuery:m,enableMultipleQuerySegments:T,enableQuantifiers:K,enableRegexpFlags:J,showBasicLayer:b,showAllAdvancedLayers:H,showCustomLayers:ne,showLayerQualifiers:oe,showResourceCountForLayer:fe})]})}function jr(){return i.jsxs(i.Fragment,{children:[!1,i.jsx($i,{query:R,cursorPos:E??void 0,onChange:ae,resources:O,enableRelationModifiers:Ir,forceSearchTermQuoting:Tr,showAllFields:Or,showResourceCountForField:Qr})]})}function kr(){return t==="fcs"?Ur():t==="lex"?jr():null}return i.jsxs(Te,{id:"query-builder-modal",show:r,onHide:()=>Y("close"),fullscreen:!0,centered:!0,children:[i.jsx(Te.Header,{className:"py-2",closeButton:!0,children:i.jsx(Te.Title,{children:h("title")})}),i.jsxs(Te.Body,{className:"px-0",children:[i.jsx(W,{className:"px-1 pb-3 border-bottom",onSubmit:v=>v.preventDefault(),children:i.jsx(Ve,{children:i.jsx(Br,{className:"d-sm-flex row-gap-2 justify-content-around",children:i.jsx(Dr,{children:i.jsxs(wt,{hasValidation:!0,children:[i.jsx(W.Control,{placeholder:h("queryInputPlaceholder"),"aria-label":h("queryInputAriaLabel"),className:"text-center query-builder-input",value:u,isInvalid:!!C,onBlur:()=>L(null),..._?{as:Kr,queryType:t,onChange:he,onCursorChange:(v,B)=>{L(v!==B&&v!==null&&B!==void 0?[v,B]:v)}}:{onChange:v=>{he(v.target.value),de(v)},onKeyUp:de,onClick:de}}),i.jsx(Gr,{id:"fcs-query-builder-input-enhanced-button",value:"enhance-query",type:"checkbox",checked:_,onChange:()=>x(v=>!v),variant:"outline-secondary","aria-label":h("search.searchInput.buttonEnhanceQueryAriaLabel",{ns:"app",context:_?"enabled":"disabled"}),className:"d-flex align-items-center",children:i.jsx("i",{dangerouslySetInnerHTML:{__html:Xr},"aria-hidden":"true"})}),i.jsx(W.Control.Feedback,{type:"invalid",children:C})]})})})})}),q>0&&i.jsx(Ve,{className:"px-3",children:i.jsxs(Pr,{variant:"warning",className:"mb-0 mt-3",dismissible:!0,children:[h("msgResourcesUnavailable",{count:q,total:j,context:j===q?"nothing":null}),S&&i.jsx("ul",{className:"mb-0",children:[...S.keys()].map(v=>i.jsx("li",{children:i.jsx(qr,{i18nKey:"msgNumUnsupportedResources",count:S.get(v)?.length,values:{name:v},ns:"querybuilder"})},v))})]})}),i.jsx(Ve,{className:"px-3 pt-3",children:kr()})]}),i.jsxs(Te.Footer,{className:"py-2",children:[i.jsx(Re,{variant:"secondary",onClick:()=>Y("abort"),children:h("buttonCancel")}),i.jsx(Re,{variant:"primary",onClick:()=>Y("confirm"),children:h("buttonUseQueryAndClose")})]})]})}Hr.loadNamespaces("querybuilder");export{ds as default};
