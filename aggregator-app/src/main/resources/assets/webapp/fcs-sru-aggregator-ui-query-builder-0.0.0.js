var Hr=Object.defineProperty;var Mr=(r,e,t)=>e in r?Hr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var n=(r,e,t)=>Mr(r,typeof e!="symbol"?e+"":e,t);import{r as f,j as i}from"./vendor/react-ext.js";import{F as j,B as Ae,D as w,M as Qe,C as ze,R as qr,a as Br,I as Pr,T as Gr,A as Dr}from"./vendor/bootstrap.js";import{u as Wr,C as Fr,h as $r}from"./fcs-sru-aggregator-ui-0.0.0.js";import{P as Ht,F as Mt,a as qt,b as Be,R as I,N as ue,A as vt,c as Pe,V as Ge,D as De,d as v,B as Vr,L as Bt,e as Pt,f as Xr,C as Gt,g as Dt,T as Wt}from"./vendor/antlr4.js";import"./vendor/react.js";/* empty css                            */import"./vendor/prism.js";function Kr(r,e){const[t,s]=f.useState(r),l=f.useRef(void 0),x=f.useCallback(p=>{clearTimeout(l.current),l.current=setTimeout(()=>{s(p)},e)},[s,e]);return[t,x,s]}const a=class a extends Ht{get grammarFileName(){return"FCSParser.g4"}get literalNames(){return a.literalNames}get symbolicNames(){return a.symbolicNames}get ruleNames(){return a.ruleNames}get serializedATN(){return a._serializedATN}createFailedPredicateException(e,t){return new Mt(this,e,t)}constructor(e){super(e),this.interpreter=new qt(this,a._ATN,a.decisionsToDFA,new Be)}query(){let e=new zr(this.context,this.state);this.enterRule(e,0,a.RULE_query);let t;try{this.enterOuterAlt(e,1),this.state=46,this.main_query(),this.state=49,this.errorHandler.sync(this),t=this.tokenStream.LA(1),t===18&&(this.state=47,this.match(a.WITHIN),this.state=48,this.within_part()),this.state=51,this.match(a.EOF)}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}main_query(){let e=new Ft(this.context,this.state);this.enterRule(e,2,a.RULE_main_query);try{switch(this.state=57,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,1,this.context)){case 1:this.enterOuterAlt(e,1),this.state=53,this.query_simple();break;case 2:this.enterOuterAlt(e,2),this.state=54,this.query_group();break;case 3:this.enterOuterAlt(e,3),this.state=55,this.query_sequence();break;case 4:this.enterOuterAlt(e,4),this.state=56,this.query_disjunction();break}}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}query_disjunction(){let e=new We(this.context,this.state);this.enterRule(e,4,a.RULE_query_disjunction);let t;try{this.enterOuterAlt(e,1);{switch(this.state=62,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,2,this.context)){case 1:this.state=59,this.query_simple();break;case 2:this.state=60,this.query_sequence();break;case 3:this.state=61,this.query_group();break}this.state=70,this.errorHandler.sync(this),t=this.tokenStream.LA(1);do{switch(this.state=64,this.match(a.OR),this.state=68,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,3,this.context)){case 1:this.state=65,this.query_simple();break;case 2:this.state=66,this.query_sequence();break;case 3:this.state=67,this.query_group();break}this.state=72,this.errorHandler.sync(this),t=this.tokenStream.LA(1)}while(t===5)}}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}query_sequence(){let e=new Ne(this.context,this.state);this.enterRule(e,6,a.RULE_query_sequence);let t;try{this.enterOuterAlt(e,1);{this.state=76,this.errorHandler.sync(this),t=this.tokenStream.LA(1);do{switch(this.state=76,this.errorHandler.sync(this),this.tokenStream.LA(1)){case a.L_SQUARE_BRACKET:case a.REGEXP:this.state=74,this.query_simple();break;case a.L_PAREN:this.state=75,this.query_group();break;default:throw new ue(this)}this.state=78,this.errorHandler.sync(this),t=this.tokenStream.LA(1)}while((t&-32)===0&&(1<<t&8388618)!==0)}}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}query_group(){let e=new Re(this.context,this.state);this.enterRule(e,8,a.RULE_query_group);let t;try{this.enterOuterAlt(e,1);{switch(this.state=80,this.match(a.L_PAREN),this.state=83,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,7,this.context)){case 1:this.state=81,this.query_disjunction();break;case 2:this.state=82,this.query_sequence();break}this.state=85,this.match(a.R_PAREN),this.state=87,this.errorHandler.sync(this),t=this.tokenStream.LA(1),(t&-32)===0&&(1<<t&14848)!==0&&(this.state=86,this.quantifier())}}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}query_simple(){let e=new me(this.context,this.state);this.enterRule(e,10,a.RULE_query_simple);let t;try{this.enterOuterAlt(e,1);{switch(this.state=91,this.errorHandler.sync(this),this.tokenStream.LA(1)){case a.REGEXP:this.state=89,this.query_implicit();break;case a.L_SQUARE_BRACKET:this.state=90,this.query_segment();break;default:throw new ue(this)}this.state=94,this.errorHandler.sync(this),t=this.tokenStream.LA(1),(t&-32)===0&&(1<<t&14848)!==0&&(this.state=93,this.quantifier())}}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}quantifier(){let e=new ot(this.context,this.state);this.enterRule(e,12,a.RULE_quantifier);let t;try{switch(this.enterOuterAlt(e,1),this.state=114,this.errorHandler.sync(this),this.tokenStream.LA(1)){case a.Q_ONE_OR_MORE:this.state=96,this.match(a.Q_ONE_OR_MORE);break;case a.Q_ZERO_OR_MORE:this.state=97,this.match(a.Q_ZERO_OR_MORE);break;case a.Q_ZERO_OR_ONE:this.state=98,this.match(a.Q_ZERO_OR_ONE);break;case a.L_CURLY_BRACKET:{switch(this.state=99,this.match(a.L_CURLY_BRACKET),this.state=111,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,13,this.context)){case 1:this.state=100,this.match(a.INTEGER);break;case 2:this.state=102,this.errorHandler.sync(this),t=this.tokenStream.LA(1),t===22&&(this.state=101,this.match(a.INTEGER)),this.state=104,this.match(a.Q_COMMA),this.state=105,this.match(a.INTEGER);break;case 3:this.state=106,this.match(a.INTEGER),this.state=107,this.match(a.Q_COMMA),this.state=109,this.errorHandler.sync(this),t=this.tokenStream.LA(1),t===22&&(this.state=108,this.match(a.INTEGER));break}this.state=113,this.match(a.R_CURLY_BRACKET)}break;default:throw new ue(this)}}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}query_implicit(){let e=new $t(this.context,this.state);this.enterRule(e,14,a.RULE_query_implicit);try{this.enterOuterAlt(e,1),this.state=116,this.regexp()}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}query_segment(){let e=new Vt(this.context,this.state);this.enterRule(e,16,a.RULE_query_segment);let t;try{this.enterOuterAlt(e,1),this.state=118,this.match(a.L_SQUARE_BRACKET),this.state=120,this.errorHandler.sync(this),t=this.tokenStream.LA(1),(t&-32)===0&&(1<<t&3932290)!==0&&(this.state=119,this.expression()),this.state=122,this.match(a.R_SQUARE_BRACKET)}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}within_part(){let e=new Xt(this.context,this.state);this.enterRule(e,18,a.RULE_within_part);try{this.enterOuterAlt(e,1),this.state=124,this.within_part_simple()}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}within_part_simple(){let e=new Kt(this.context,this.state);this.enterRule(e,20,a.RULE_within_part_simple);try{this.enterOuterAlt(e,1),this.state=126,this.match(a.SIMPLE_WITHIN_SCOPE)}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}expression(){let e=new zt(this.context,this.state);this.enterRule(e,22,a.RULE_expression);try{switch(this.state=133,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,16,this.context)){case 1:this.enterOuterAlt(e,1),this.state=128,this.expression_basic();break;case 2:this.enterOuterAlt(e,2),this.state=129,this.expression_not();break;case 3:this.enterOuterAlt(e,3),this.state=130,this.expression_group();break;case 4:this.enterOuterAlt(e,4),this.state=131,this.expression_or();break;case 5:this.enterOuterAlt(e,5),this.state=132,this.expression_and();break}}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}expression_or(){let e=new we(this.context,this.state);this.enterRule(e,24,a.RULE_expression_or);try{let t;this.enterOuterAlt(e,1);{switch(this.state=139,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,17,this.context)){case 1:this.state=135,this.expression_basic();break;case 2:this.state=136,this.expression_group();break;case 3:this.state=137,this.expression_not();break;case 4:this.state=138,this.expression_and();break}this.state=148,this.errorHandler.sync(this),t=1;do{switch(t){case 1:switch(this.state=141,this.match(a.OR),this.state=146,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,18,this.context)){case 1:this.state=142,this.expression_basic();break;case 2:this.state=143,this.expression_group();break;case 3:this.state=144,this.expression_not();break;case 4:this.state=145,this.expression_and();break}break;default:throw new ue(this)}this.state=150,this.errorHandler.sync(this),t=this.interpreter.adaptivePredict(this.tokenStream,19,this.context)}while(t!==2&&t!==vt.INVALID_ALT_NUMBER)}}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}expression_and(){let e=new de(this.context,this.state);this.enterRule(e,26,a.RULE_expression_and);try{let t;this.enterOuterAlt(e,1);{switch(this.state=155,this.errorHandler.sync(this),this.tokenStream.LA(1)){case a.WITHIN:case a.SIMPLE_WITHIN_SCOPE:case a.REGEXP_FLAGS:case a.IDENTIFIER:this.state=152,this.expression_basic();break;case a.L_PAREN:this.state=153,this.expression_group();break;case a.NOT:this.state=154,this.expression_not();break;default:throw new ue(this)}this.state=163,this.errorHandler.sync(this),t=1;do{switch(t){case 1:switch(this.state=157,this.match(a.AND),this.state=161,this.errorHandler.sync(this),this.tokenStream.LA(1)){case a.WITHIN:case a.SIMPLE_WITHIN_SCOPE:case a.REGEXP_FLAGS:case a.IDENTIFIER:this.state=158,this.expression_basic();break;case a.L_PAREN:this.state=159,this.expression_group();break;case a.NOT:this.state=160,this.expression_not();break;default:throw new ue(this)}break;default:throw new ue(this)}this.state=165,this.errorHandler.sync(this),t=this.interpreter.adaptivePredict(this.tokenStream,22,this.context)}while(t!==2&&t!==vt.INVALID_ALT_NUMBER)}}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}expression_group(){let e=new J(this.context,this.state);this.enterRule(e,28,a.RULE_expression_group);try{this.enterOuterAlt(e,1);{switch(this.state=167,this.match(a.L_PAREN),this.state=172,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,23,this.context)){case 1:this.state=168,this.expression_basic();break;case 2:this.state=169,this.expression_not();break;case 3:this.state=170,this.expression_or();break;case 4:this.state=171,this.expression_and();break}this.state=174,this.match(a.R_PAREN)}}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}expression_not(){let e=new Z(this.context,this.state);this.enterRule(e,30,a.RULE_expression_not);try{switch(this.enterOuterAlt(e,1),this.state=176,this.match(a.NOT),this.state=181,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,24,this.context)){case 1:this.state=177,this.expression_basic();break;case 2:this.state=178,this.expression_not();break;case 3:this.state=179,this.expression_or();break;case 4:this.state=180,this.expression_and();break}}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}expression_basic(){let e=new se(this.context,this.state);this.enterRule(e,32,a.RULE_expression_basic);let t;try{this.enterOuterAlt(e,1),this.state=183,this.attribute(),this.state=184,t=this.tokenStream.LA(1),t===15||t===16?(this.errorHandler.reportMatch(this),this.consume()):this.errorHandler.recoverInline(this),this.state=185,this.regexp()}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}attribute(){let e=new Yt(this.context,this.state);this.enterRule(e,34,a.RULE_attribute);try{this.enterOuterAlt(e,1);{switch(this.state=190,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,25,this.context)){case 1:this.state=187,this.qualifier(),this.state=188,this.match(a.COLON);break}this.state=192,this.identifier()}}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}qualifier(){let e=new Zt(this.context,this.state);this.enterRule(e,36,a.RULE_qualifier);let t;try{this.enterOuterAlt(e,1),this.state=194,t=this.tokenStream.LA(1),(t&-32)===0&&(1<<t&3932160)!==0?(this.errorHandler.reportMatch(this),this.consume()):this.errorHandler.recoverInline(this)}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}identifier(){let e=new Jt(this.context,this.state);this.enterRule(e,38,a.RULE_identifier);let t;try{this.enterOuterAlt(e,1),this.state=196,t=this.tokenStream.LA(1),(t&-32)===0&&(1<<t&3932160)!==0?(this.errorHandler.reportMatch(this),this.consume()):this.errorHandler.recoverInline(this)}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}regexp(){let e=new lt(this.context,this.state);this.enterRule(e,40,a.RULE_regexp);let t;try{this.enterOuterAlt(e,1),this.state=198,this.regexp_pattern(),this.state=201,this.errorHandler.sync(this),t=this.tokenStream.LA(1),t===8&&(this.state=199,this.match(a.FWD_SLASH),this.state=200,this.regexp_flag())}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}regexp_pattern(){let e=new er(this.context,this.state);this.enterRule(e,42,a.RULE_regexp_pattern);try{this.enterOuterAlt(e,1),this.state=203,this.match(a.REGEXP)}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}regexp_flag(){let e=new tr(this.context,this.state);this.enterRule(e,44,a.RULE_regexp_flag);try{this.enterOuterAlt(e,1),this.state=205,this.match(a.REGEXP_FLAGS)}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}static get _ATN(){return a.__ATN||(a.__ATN=new Pe().deserialize(a._serializedATN)),a.__ATN}get vocabulary(){return a.vocabulary}};n(a,"L_PAREN",1),n(a,"R_PAREN",2),n(a,"L_SQUARE_BRACKET",3),n(a,"R_SQUARE_BRACKET",4),n(a,"OR",5),n(a,"AND",6),n(a,"NOT",7),n(a,"FWD_SLASH",8),n(a,"L_CURLY_BRACKET",9),n(a,"R_CURLY_BRACKET",10),n(a,"Q_ONE_OR_MORE",11),n(a,"Q_ZERO_OR_MORE",12),n(a,"Q_ZERO_OR_ONE",13),n(a,"Q_COMMA",14),n(a,"OPERATOR_EQ",15),n(a,"OPERATOR_NE",16),n(a,"COLON",17),n(a,"WITHIN",18),n(a,"SIMPLE_WITHIN_SCOPE",19),n(a,"REGEXP_FLAGS",20),n(a,"IDENTIFIER",21),n(a,"INTEGER",22),n(a,"REGEXP",23),n(a,"QUOTED_STRING",24),n(a,"Space",25),n(a,"RULE_query",0),n(a,"RULE_main_query",1),n(a,"RULE_query_disjunction",2),n(a,"RULE_query_sequence",3),n(a,"RULE_query_group",4),n(a,"RULE_query_simple",5),n(a,"RULE_quantifier",6),n(a,"RULE_query_implicit",7),n(a,"RULE_query_segment",8),n(a,"RULE_within_part",9),n(a,"RULE_within_part_simple",10),n(a,"RULE_expression",11),n(a,"RULE_expression_or",12),n(a,"RULE_expression_and",13),n(a,"RULE_expression_group",14),n(a,"RULE_expression_not",15),n(a,"RULE_expression_basic",16),n(a,"RULE_attribute",17),n(a,"RULE_qualifier",18),n(a,"RULE_identifier",19),n(a,"RULE_regexp",20),n(a,"RULE_regexp_pattern",21),n(a,"RULE_regexp_flag",22),n(a,"literalNames",[null,"'('","')'","'['","']'","'|'","'&'","'!'","'/'","'{'","'}'","'+'","'*'","'?'","','","'='","'!='","':'","'within'"]),n(a,"symbolicNames",[null,"L_PAREN","R_PAREN","L_SQUARE_BRACKET","R_SQUARE_BRACKET","OR","AND","NOT","FWD_SLASH","L_CURLY_BRACKET","R_CURLY_BRACKET","Q_ONE_OR_MORE","Q_ZERO_OR_MORE","Q_ZERO_OR_ONE","Q_COMMA","OPERATOR_EQ","OPERATOR_NE","COLON","WITHIN","SIMPLE_WITHIN_SCOPE","REGEXP_FLAGS","IDENTIFIER","INTEGER","REGEXP","QUOTED_STRING","Space"]),n(a,"ruleNames",["query","main_query","query_disjunction","query_sequence","query_group","query_simple","quantifier","query_implicit","query_segment","within_part","within_part_simple","expression","expression_or","expression_and","expression_group","expression_not","expression_basic","attribute","qualifier","identifier","regexp","regexp_pattern","regexp_flag"]),n(a,"_serializedATN",[4,1,25,208,2,0,7,0,2,1,7,1,2,2,7,2,2,3,7,3,2,4,7,4,2,5,7,5,2,6,7,6,2,7,7,7,2,8,7,8,2,9,7,9,2,10,7,10,2,11,7,11,2,12,7,12,2,13,7,13,2,14,7,14,2,15,7,15,2,16,7,16,2,17,7,17,2,18,7,18,2,19,7,19,2,20,7,20,2,21,7,21,2,22,7,22,1,0,1,0,1,0,3,0,50,8,0,1,0,1,0,1,1,1,1,1,1,1,1,3,1,58,8,1,1,2,1,2,1,2,3,2,63,8,2,1,2,1,2,1,2,1,2,3,2,69,8,2,4,2,71,8,2,11,2,12,2,72,1,3,1,3,4,3,77,8,3,11,3,12,3,78,1,4,1,4,1,4,3,4,84,8,4,1,4,1,4,3,4,88,8,4,1,5,1,5,3,5,92,8,5,1,5,3,5,95,8,5,1,6,1,6,1,6,1,6,1,6,1,6,3,6,103,8,6,1,6,1,6,1,6,1,6,1,6,3,6,110,8,6,3,6,112,8,6,1,6,3,6,115,8,6,1,7,1,7,1,8,1,8,3,8,121,8,8,1,8,1,8,1,9,1,9,1,10,1,10,1,11,1,11,1,11,1,11,1,11,3,11,134,8,11,1,12,1,12,1,12,1,12,3,12,140,8,12,1,12,1,12,1,12,1,12,1,12,3,12,147,8,12,4,12,149,8,12,11,12,12,12,150,1,13,1,13,1,13,3,13,156,8,13,1,13,1,13,1,13,1,13,3,13,162,8,13,4,13,164,8,13,11,13,12,13,165,1,14,1,14,1,14,1,14,1,14,3,14,173,8,14,1,14,1,14,1,15,1,15,1,15,1,15,1,15,3,15,182,8,15,1,16,1,16,1,16,1,16,1,17,1,17,1,17,3,17,191,8,17,1,17,1,17,1,18,1,18,1,19,1,19,1,20,1,20,1,20,3,20,202,8,20,1,21,1,21,1,22,1,22,1,22,0,0,23,0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,0,2,1,0,15,16,1,0,18,21,231,0,46,1,0,0,0,2,57,1,0,0,0,4,62,1,0,0,0,6,76,1,0,0,0,8,80,1,0,0,0,10,91,1,0,0,0,12,114,1,0,0,0,14,116,1,0,0,0,16,118,1,0,0,0,18,124,1,0,0,0,20,126,1,0,0,0,22,133,1,0,0,0,24,139,1,0,0,0,26,155,1,0,0,0,28,167,1,0,0,0,30,176,1,0,0,0,32,183,1,0,0,0,34,190,1,0,0,0,36,194,1,0,0,0,38,196,1,0,0,0,40,198,1,0,0,0,42,203,1,0,0,0,44,205,1,0,0,0,46,49,3,2,1,0,47,48,5,18,0,0,48,50,3,18,9,0,49,47,1,0,0,0,49,50,1,0,0,0,50,51,1,0,0,0,51,52,5,0,0,1,52,1,1,0,0,0,53,58,3,10,5,0,54,58,3,8,4,0,55,58,3,6,3,0,56,58,3,4,2,0,57,53,1,0,0,0,57,54,1,0,0,0,57,55,1,0,0,0,57,56,1,0,0,0,58,3,1,0,0,0,59,63,3,10,5,0,60,63,3,6,3,0,61,63,3,8,4,0,62,59,1,0,0,0,62,60,1,0,0,0,62,61,1,0,0,0,63,70,1,0,0,0,64,68,5,5,0,0,65,69,3,10,5,0,66,69,3,6,3,0,67,69,3,8,4,0,68,65,1,0,0,0,68,66,1,0,0,0,68,67,1,0,0,0,69,71,1,0,0,0,70,64,1,0,0,0,71,72,1,0,0,0,72,70,1,0,0,0,72,73,1,0,0,0,73,5,1,0,0,0,74,77,3,10,5,0,75,77,3,8,4,0,76,74,1,0,0,0,76,75,1,0,0,0,77,78,1,0,0,0,78,76,1,0,0,0,78,79,1,0,0,0,79,7,1,0,0,0,80,83,5,1,0,0,81,84,3,4,2,0,82,84,3,6,3,0,83,81,1,0,0,0,83,82,1,0,0,0,84,85,1,0,0,0,85,87,5,2,0,0,86,88,3,12,6,0,87,86,1,0,0,0,87,88,1,0,0,0,88,9,1,0,0,0,89,92,3,14,7,0,90,92,3,16,8,0,91,89,1,0,0,0,91,90,1,0,0,0,92,94,1,0,0,0,93,95,3,12,6,0,94,93,1,0,0,0,94,95,1,0,0,0,95,11,1,0,0,0,96,115,5,11,0,0,97,115,5,12,0,0,98,115,5,13,0,0,99,111,5,9,0,0,100,112,5,22,0,0,101,103,5,22,0,0,102,101,1,0,0,0,102,103,1,0,0,0,103,104,1,0,0,0,104,105,5,14,0,0,105,112,5,22,0,0,106,107,5,22,0,0,107,109,5,14,0,0,108,110,5,22,0,0,109,108,1,0,0,0,109,110,1,0,0,0,110,112,1,0,0,0,111,100,1,0,0,0,111,102,1,0,0,0,111,106,1,0,0,0,112,113,1,0,0,0,113,115,5,10,0,0,114,96,1,0,0,0,114,97,1,0,0,0,114,98,1,0,0,0,114,99,1,0,0,0,115,13,1,0,0,0,116,117,3,40,20,0,117,15,1,0,0,0,118,120,5,3,0,0,119,121,3,22,11,0,120,119,1,0,0,0,120,121,1,0,0,0,121,122,1,0,0,0,122,123,5,4,0,0,123,17,1,0,0,0,124,125,3,20,10,0,125,19,1,0,0,0,126,127,5,19,0,0,127,21,1,0,0,0,128,134,3,32,16,0,129,134,3,30,15,0,130,134,3,28,14,0,131,134,3,24,12,0,132,134,3,26,13,0,133,128,1,0,0,0,133,129,1,0,0,0,133,130,1,0,0,0,133,131,1,0,0,0,133,132,1,0,0,0,134,23,1,0,0,0,135,140,3,32,16,0,136,140,3,28,14,0,137,140,3,30,15,0,138,140,3,26,13,0,139,135,1,0,0,0,139,136,1,0,0,0,139,137,1,0,0,0,139,138,1,0,0,0,140,148,1,0,0,0,141,146,5,5,0,0,142,147,3,32,16,0,143,147,3,28,14,0,144,147,3,30,15,0,145,147,3,26,13,0,146,142,1,0,0,0,146,143,1,0,0,0,146,144,1,0,0,0,146,145,1,0,0,0,147,149,1,0,0,0,148,141,1,0,0,0,149,150,1,0,0,0,150,148,1,0,0,0,150,151,1,0,0,0,151,25,1,0,0,0,152,156,3,32,16,0,153,156,3,28,14,0,154,156,3,30,15,0,155,152,1,0,0,0,155,153,1,0,0,0,155,154,1,0,0,0,156,163,1,0,0,0,157,161,5,6,0,0,158,162,3,32,16,0,159,162,3,28,14,0,160,162,3,30,15,0,161,158,1,0,0,0,161,159,1,0,0,0,161,160,1,0,0,0,162,164,1,0,0,0,163,157,1,0,0,0,164,165,1,0,0,0,165,163,1,0,0,0,165,166,1,0,0,0,166,27,1,0,0,0,167,172,5,1,0,0,168,173,3,32,16,0,169,173,3,30,15,0,170,173,3,24,12,0,171,173,3,26,13,0,172,168,1,0,0,0,172,169,1,0,0,0,172,170,1,0,0,0,172,171,1,0,0,0,173,174,1,0,0,0,174,175,5,2,0,0,175,29,1,0,0,0,176,181,5,7,0,0,177,182,3,32,16,0,178,182,3,30,15,0,179,182,3,24,12,0,180,182,3,26,13,0,181,177,1,0,0,0,181,178,1,0,0,0,181,179,1,0,0,0,181,180,1,0,0,0,182,31,1,0,0,0,183,184,3,34,17,0,184,185,7,0,0,0,185,186,3,40,20,0,186,33,1,0,0,0,187,188,3,36,18,0,188,189,5,17,0,0,189,191,1,0,0,0,190,187,1,0,0,0,190,191,1,0,0,0,191,192,1,0,0,0,192,193,3,38,19,0,193,35,1,0,0,0,194,195,7,1,0,0,195,37,1,0,0,0,196,197,7,1,0,0,197,39,1,0,0,0,198,201,3,42,21,0,199,200,5,8,0,0,200,202,3,44,22,0,201,199,1,0,0,0,201,202,1,0,0,0,202,41,1,0,0,0,203,204,5,23,0,0,204,43,1,0,0,0,205,206,5,20,0,0,206,45,1,0,0,0,27,49,57,62,68,72,76,78,83,87,91,94,102,109,111,114,120,133,139,146,150,155,161,165,172,181,190,201]),n(a,"__ATN"),n(a,"vocabulary",new Ge(a.literalNames,a.symbolicNames,[])),n(a,"decisionsToDFA",a._ATN.decisionToState.map((e,t)=>new De(e,t)));let _=a,zr=class extends v{constructor(e,t){super(e,t)}main_query(){return this.getRuleContext(0,Ft)}EOF(){return this.getToken(_.EOF,0)}WITHIN(){return this.getToken(_.WITHIN,0)}within_part(){return this.getRuleContext(0,Xt)}get ruleIndex(){return _.RULE_query}enterRule(e){e.enterQuery&&e.enterQuery(this)}exitRule(e){e.exitQuery&&e.exitQuery(this)}accept(e){return e.visitQuery?e.visitQuery(this):e.visitChildren(this)}};class Ft extends v{constructor(e,t){super(e,t)}query_simple(){return this.getRuleContext(0,me)}query_group(){return this.getRuleContext(0,Re)}query_sequence(){return this.getRuleContext(0,Ne)}query_disjunction(){return this.getRuleContext(0,We)}get ruleIndex(){return _.RULE_main_query}enterRule(e){e.enterMain_query&&e.enterMain_query(this)}exitRule(e){e.exitMain_query&&e.exitMain_query(this)}accept(e){return e.visitMain_query?e.visitMain_query(this):e.visitChildren(this)}}class We extends v{constructor(e,t){super(e,t)}query_simple(e){return e===void 0?this.getRuleContexts(me):this.getRuleContext(e,me)}query_sequence(e){return e===void 0?this.getRuleContexts(Ne):this.getRuleContext(e,Ne)}query_group(e){return e===void 0?this.getRuleContexts(Re):this.getRuleContext(e,Re)}OR(e){return e===void 0?this.getTokens(_.OR):this.getToken(_.OR,e)}get ruleIndex(){return _.RULE_query_disjunction}enterRule(e){e.enterQuery_disjunction&&e.enterQuery_disjunction(this)}exitRule(e){e.exitQuery_disjunction&&e.exitQuery_disjunction(this)}accept(e){return e.visitQuery_disjunction?e.visitQuery_disjunction(this):e.visitChildren(this)}}class Ne extends v{constructor(e,t){super(e,t)}query_simple(e){return e===void 0?this.getRuleContexts(me):this.getRuleContext(e,me)}query_group(e){return e===void 0?this.getRuleContexts(Re):this.getRuleContext(e,Re)}get ruleIndex(){return _.RULE_query_sequence}enterRule(e){e.enterQuery_sequence&&e.enterQuery_sequence(this)}exitRule(e){e.exitQuery_sequence&&e.exitQuery_sequence(this)}accept(e){return e.visitQuery_sequence?e.visitQuery_sequence(this):e.visitChildren(this)}}class Re extends v{constructor(e,t){super(e,t)}L_PAREN(){return this.getToken(_.L_PAREN,0)}R_PAREN(){return this.getToken(_.R_PAREN,0)}query_disjunction(){return this.getRuleContext(0,We)}query_sequence(){return this.getRuleContext(0,Ne)}quantifier(){return this.getRuleContext(0,ot)}get ruleIndex(){return _.RULE_query_group}enterRule(e){e.enterQuery_group&&e.enterQuery_group(this)}exitRule(e){e.exitQuery_group&&e.exitQuery_group(this)}accept(e){return e.visitQuery_group?e.visitQuery_group(this):e.visitChildren(this)}}class me extends v{constructor(e,t){super(e,t)}query_implicit(){return this.getRuleContext(0,$t)}query_segment(){return this.getRuleContext(0,Vt)}quantifier(){return this.getRuleContext(0,ot)}get ruleIndex(){return _.RULE_query_simple}enterRule(e){e.enterQuery_simple&&e.enterQuery_simple(this)}exitRule(e){e.exitQuery_simple&&e.exitQuery_simple(this)}accept(e){return e.visitQuery_simple?e.visitQuery_simple(this):e.visitChildren(this)}}class ot extends v{constructor(e,t){super(e,t)}Q_ONE_OR_MORE(){return this.getToken(_.Q_ONE_OR_MORE,0)}Q_ZERO_OR_MORE(){return this.getToken(_.Q_ZERO_OR_MORE,0)}Q_ZERO_OR_ONE(){return this.getToken(_.Q_ZERO_OR_ONE,0)}L_CURLY_BRACKET(){return this.getToken(_.L_CURLY_BRACKET,0)}R_CURLY_BRACKET(){return this.getToken(_.R_CURLY_BRACKET,0)}INTEGER(e){return e===void 0?this.getTokens(_.INTEGER):this.getToken(_.INTEGER,e)}Q_COMMA(){return this.getToken(_.Q_COMMA,0)}get ruleIndex(){return _.RULE_quantifier}enterRule(e){e.enterQuantifier&&e.enterQuantifier(this)}exitRule(e){e.exitQuantifier&&e.exitQuantifier(this)}accept(e){return e.visitQuantifier?e.visitQuantifier(this):e.visitChildren(this)}}class $t extends v{constructor(e,t){super(e,t)}regexp(){return this.getRuleContext(0,lt)}get ruleIndex(){return _.RULE_query_implicit}enterRule(e){e.enterQuery_implicit&&e.enterQuery_implicit(this)}exitRule(e){e.exitQuery_implicit&&e.exitQuery_implicit(this)}accept(e){return e.visitQuery_implicit?e.visitQuery_implicit(this):e.visitChildren(this)}}class Vt extends v{constructor(e,t){super(e,t)}L_SQUARE_BRACKET(){return this.getToken(_.L_SQUARE_BRACKET,0)}R_SQUARE_BRACKET(){return this.getToken(_.R_SQUARE_BRACKET,0)}expression(){return this.getRuleContext(0,zt)}get ruleIndex(){return _.RULE_query_segment}enterRule(e){e.enterQuery_segment&&e.enterQuery_segment(this)}exitRule(e){e.exitQuery_segment&&e.exitQuery_segment(this)}accept(e){return e.visitQuery_segment?e.visitQuery_segment(this):e.visitChildren(this)}}class Xt extends v{constructor(e,t){super(e,t)}within_part_simple(){return this.getRuleContext(0,Kt)}get ruleIndex(){return _.RULE_within_part}enterRule(e){e.enterWithin_part&&e.enterWithin_part(this)}exitRule(e){e.exitWithin_part&&e.exitWithin_part(this)}accept(e){return e.visitWithin_part?e.visitWithin_part(this):e.visitChildren(this)}}class Kt extends v{constructor(e,t){super(e,t)}SIMPLE_WITHIN_SCOPE(){return this.getToken(_.SIMPLE_WITHIN_SCOPE,0)}get ruleIndex(){return _.RULE_within_part_simple}enterRule(e){e.enterWithin_part_simple&&e.enterWithin_part_simple(this)}exitRule(e){e.exitWithin_part_simple&&e.exitWithin_part_simple(this)}accept(e){return e.visitWithin_part_simple?e.visitWithin_part_simple(this):e.visitChildren(this)}}class zt extends v{constructor(e,t){super(e,t)}expression_basic(){return this.getRuleContext(0,se)}expression_not(){return this.getRuleContext(0,Z)}expression_group(){return this.getRuleContext(0,J)}expression_or(){return this.getRuleContext(0,we)}expression_and(){return this.getRuleContext(0,de)}get ruleIndex(){return _.RULE_expression}enterRule(e){e.enterExpression&&e.enterExpression(this)}exitRule(e){e.exitExpression&&e.exitExpression(this)}accept(e){return e.visitExpression?e.visitExpression(this):e.visitChildren(this)}}class we extends v{constructor(e,t){super(e,t)}expression_basic(e){return e===void 0?this.getRuleContexts(se):this.getRuleContext(e,se)}expression_group(e){return e===void 0?this.getRuleContexts(J):this.getRuleContext(e,J)}expression_not(e){return e===void 0?this.getRuleContexts(Z):this.getRuleContext(e,Z)}expression_and(e){return e===void 0?this.getRuleContexts(de):this.getRuleContext(e,de)}OR(e){return e===void 0?this.getTokens(_.OR):this.getToken(_.OR,e)}get ruleIndex(){return _.RULE_expression_or}enterRule(e){e.enterExpression_or&&e.enterExpression_or(this)}exitRule(e){e.exitExpression_or&&e.exitExpression_or(this)}accept(e){return e.visitExpression_or?e.visitExpression_or(this):e.visitChildren(this)}}class de extends v{constructor(e,t){super(e,t)}expression_basic(e){return e===void 0?this.getRuleContexts(se):this.getRuleContext(e,se)}expression_group(e){return e===void 0?this.getRuleContexts(J):this.getRuleContext(e,J)}expression_not(e){return e===void 0?this.getRuleContexts(Z):this.getRuleContext(e,Z)}AND(e){return e===void 0?this.getTokens(_.AND):this.getToken(_.AND,e)}get ruleIndex(){return _.RULE_expression_and}enterRule(e){e.enterExpression_and&&e.enterExpression_and(this)}exitRule(e){e.exitExpression_and&&e.exitExpression_and(this)}accept(e){return e.visitExpression_and?e.visitExpression_and(this):e.visitChildren(this)}}class J extends v{constructor(e,t){super(e,t)}L_PAREN(){return this.getToken(_.L_PAREN,0)}R_PAREN(){return this.getToken(_.R_PAREN,0)}expression_basic(){return this.getRuleContext(0,se)}expression_not(){return this.getRuleContext(0,Z)}expression_or(){return this.getRuleContext(0,we)}expression_and(){return this.getRuleContext(0,de)}get ruleIndex(){return _.RULE_expression_group}enterRule(e){e.enterExpression_group&&e.enterExpression_group(this)}exitRule(e){e.exitExpression_group&&e.exitExpression_group(this)}accept(e){return e.visitExpression_group?e.visitExpression_group(this):e.visitChildren(this)}}class Z extends v{constructor(e,t){super(e,t)}NOT(){return this.getToken(_.NOT,0)}expression_basic(){return this.getRuleContext(0,se)}expression_not(){return this.getRuleContext(0,Z)}expression_or(){return this.getRuleContext(0,we)}expression_and(){return this.getRuleContext(0,de)}get ruleIndex(){return _.RULE_expression_not}enterRule(e){e.enterExpression_not&&e.enterExpression_not(this)}exitRule(e){e.exitExpression_not&&e.exitExpression_not(this)}accept(e){return e.visitExpression_not?e.visitExpression_not(this):e.visitChildren(this)}}class se extends v{constructor(e,t){super(e,t)}attribute(){return this.getRuleContext(0,Yt)}regexp(){return this.getRuleContext(0,lt)}OPERATOR_EQ(){return this.getToken(_.OPERATOR_EQ,0)}OPERATOR_NE(){return this.getToken(_.OPERATOR_NE,0)}get ruleIndex(){return _.RULE_expression_basic}enterRule(e){e.enterExpression_basic&&e.enterExpression_basic(this)}exitRule(e){e.exitExpression_basic&&e.exitExpression_basic(this)}accept(e){return e.visitExpression_basic?e.visitExpression_basic(this):e.visitChildren(this)}}class Yt extends v{constructor(e,t){super(e,t)}identifier(){return this.getRuleContext(0,Jt)}qualifier(){return this.getRuleContext(0,Zt)}COLON(){return this.getToken(_.COLON,0)}get ruleIndex(){return _.RULE_attribute}enterRule(e){e.enterAttribute&&e.enterAttribute(this)}exitRule(e){e.exitAttribute&&e.exitAttribute(this)}accept(e){return e.visitAttribute?e.visitAttribute(this):e.visitChildren(this)}}class Zt extends v{constructor(e,t){super(e,t)}IDENTIFIER(){return this.getToken(_.IDENTIFIER,0)}WITHIN(){return this.getToken(_.WITHIN,0)}SIMPLE_WITHIN_SCOPE(){return this.getToken(_.SIMPLE_WITHIN_SCOPE,0)}REGEXP_FLAGS(){return this.getToken(_.REGEXP_FLAGS,0)}get ruleIndex(){return _.RULE_qualifier}enterRule(e){e.enterQualifier&&e.enterQualifier(this)}exitRule(e){e.exitQualifier&&e.exitQualifier(this)}accept(e){return e.visitQualifier?e.visitQualifier(this):e.visitChildren(this)}}class Jt extends v{constructor(e,t){super(e,t)}IDENTIFIER(){return this.getToken(_.IDENTIFIER,0)}WITHIN(){return this.getToken(_.WITHIN,0)}SIMPLE_WITHIN_SCOPE(){return this.getToken(_.SIMPLE_WITHIN_SCOPE,0)}REGEXP_FLAGS(){return this.getToken(_.REGEXP_FLAGS,0)}get ruleIndex(){return _.RULE_identifier}enterRule(e){e.enterIdentifier&&e.enterIdentifier(this)}exitRule(e){e.exitIdentifier&&e.exitIdentifier(this)}accept(e){return e.visitIdentifier?e.visitIdentifier(this):e.visitChildren(this)}}class lt extends v{constructor(e,t){super(e,t)}regexp_pattern(){return this.getRuleContext(0,er)}FWD_SLASH(){return this.getToken(_.FWD_SLASH,0)}regexp_flag(){return this.getRuleContext(0,tr)}get ruleIndex(){return _.RULE_regexp}enterRule(e){e.enterRegexp&&e.enterRegexp(this)}exitRule(e){e.exitRegexp&&e.exitRegexp(this)}accept(e){return e.visitRegexp?e.visitRegexp(this):e.visitChildren(this)}}class er extends v{constructor(e,t){super(e,t)}REGEXP(){return this.getToken(_.REGEXP,0)}get ruleIndex(){return _.RULE_regexp_pattern}enterRule(e){e.enterRegexp_pattern&&e.enterRegexp_pattern(this)}exitRule(e){e.exitRegexp_pattern&&e.exitRegexp_pattern(this)}accept(e){return e.visitRegexp_pattern?e.visitRegexp_pattern(this):e.visitChildren(this)}}class tr extends v{constructor(e,t){super(e,t)}REGEXP_FLAGS(){return this.getToken(_.REGEXP_FLAGS,0)}get ruleIndex(){return _.RULE_regexp_flag}enterRule(e){e.enterRegexp_flag&&e.enterRegexp_flag(this)}exitRule(e){e.exitRegexp_flag&&e.exitRegexp_flag(this)}accept(e){return e.visitRegexp_flag?e.visitRegexp_flag(this):e.visitChildren(this)}}class rr extends Vr{constructor(){super(...arguments);n(this,"errors",[])}syntaxError(t,s,l,x,p,d){this.errors.push(`Syntax error: ${p} at position ${x}`)}}function je(r,e){if(!r||e===void 0)return!1;const t=Array.isArray(e)?e[0]:e,s=Array.isArray(e)?e[1]:e;if(r instanceof v&&r.start!==null&&r.stop!==null){const l=r.start.start,x=r.stop.stop+1;if(l<t&&t<x||l<s&&s<x||t===s&&(l===s||s===x)||t<=l&&x<=s)return!0}return!1}const ir=[{id:"text",label:"textual representation"},{id:"lemma",label:"lemmatization of tokens"},{id:"pos",label:"part-of-speech UD v2.0 tagset"},{id:"orth",label:"orthographic transcription"},{id:"norm",label:"orthographic normalization"},{id:"phonetic",label:"phonetic transcription SAMPA"}],St=Object.fromEntries(ir.map(r=>[r.id,r])),Yr=[{id:"pos",operators:["is","is-not"],options:[{value:"ADJ",label:"Adjective"},{value:"ADV",label:"Adverb"},{value:"INTJ",label:"Interjection"},{value:"NOUN",label:"Noun"},{value:"PROPN",label:"Proper noun"},{value:"VERB",label:"Verb"},{value:"ADP",label:"Adposition"},{value:"AUX",label:"Auxiliary"},{value:"CCONJ",label:"Coordinating conjunction"},{value:"DET",label:"Determiner"},{value:"NUM",label:"Numeral"},{value:"PART",label:"Particle"},{value:"PRON",label:"Pronoun"},{value:"SCONJ",label:"Subordinating conjunction"},{value:"PUNCT",label:"Punctuation"},{value:"SYM",label:"Symbol"},{value:"X",label:"Other"}]}],Tt=Object.fromEntries(Yr.map(r=>[r.id,r])),sr=[{id:"is",label:"is",operator:"=",valueAfter:null,valueBefore:null,escape:!0},{id:"is-not",label:"is not",operator:"!=",valueAfter:null,valueBefore:null,escape:!0},{id:"contains",label:"contains",operator:"=",valueAfter:".*",valueBefore:".*",escape:!0},{id:"starts-with",label:"starts with",operator:"=",valueAfter:".*",valueBefore:null,escape:!0},{id:"ends-with",label:"ends with",operator:"=",valueAfter:null,valueBefore:".*",escape:!0},{id:"regex",label:"regex",operator:"=",valueAfter:null,valueBefore:null,escape:!1},{id:"not-regex",label:"not regex",operator:"!=",valueAfter:null,valueBefore:null,escape:!1}],Ye=Object.fromEntries(sr.map(r=>[r.id,r])),Zr="?",ce='text = ""',Jr=["sentence","s","utterance","u","paragraph","p","turn","t","text","session"],nr=[{id:"*",label:"Zero or More",type:"symbol",new:"*"},{id:"+",label:"One or More",type:"symbol",new:"+"},{id:"?",label:"Zero or One",type:"symbol",new:"?"},{id:"n-n",label:"Exactly N",type:"range",new:"{1}"},{id:"n-m",label:"N to M",type:"range",new:"{0,1}"},{id:"n-",label:"At least N",type:"range",new:"{0,}"},{id:"-m",label:"At most M",type:"range",new:"{,1}"}],ei=Object.fromEntries(nr.map(r=>[r.id,r])),ar=[{id:"token",label:"Normal Token",new:`[ ${ce} ]`},{id:"unspecific-token",label:"Unspecific Token",new:"[]"},{id:"string",label:"Plain String",new:'""'}],Ze=Object.fromEntries(ar.map(r=>[r.id,r])),or=[{id:"basic",label:"Expression",new:`${ce}`},{id:"or",label:"OR",new:`${ce} | ${ce}`},{id:"and",label:"AND",new:`${ce} & ${ce}`}],Ue=Object.fromEntries(or.map(r=>[r.id,r])),lr=[{id:"or",label:"OR",newBefore:`${ce} |`,newAfter:`| ${ce}`},{id:"and",label:"AND",newBefore:`${ce} &`,newAfter:`& ${ce}`}],ti=Object.fromEntries(lr.map(r=>[r.id,r])),cr=[{id:"group",label:"Group",newBefore:"(",newAfter:")"},{id:"not",label:"Negation",newBefore:"!",newAfter:null}],It=Object.fromEntries(cr.map(r=>[r.id,r])),ct=f.createContext(void 0);ct.displayName="FCSParserLexerContext";function ri({parser:r,lexer:e,cursorPos:t,children:s}){const l={parser:r,lexer:e,cursorPos:t};return i.jsx(ct.Provider,{value:l,children:s})}function ur(){const r=f.useContext(ct);if(!r)throw new Error('No parser and lexer "data" set, use FCSParserLexerProvider to set');return r}const ut=f.createContext(void 0);ut.displayName="FCSQueryBuilderConfigContext";function ii({enableWithin:r=!0,enableWrapGroup:e=!0,enableWrapNegation:t=!0,enableImplicitQuery:s=!0,enableMultipleQuerySegments:l=!0,enableQuantifiers:x=!0,enableRegexpFlags:p=!0,showBasicLayer:d=!0,showAllAdvancedLayers:c=!0,showCustomLayers:R=!0,showLayerQualifiers:y=!0,showResourceCountForLayer:Q=!0,children:b}){const m={enableWithin:r,enableWrapGroup:e,enableWrapNegation:t,enableImplicitQuery:s,enableMultipleQuerySegments:l,enableQuantifiers:x,enableRegexpFlags:p,showBasicLayer:d,showAllAdvancedLayers:c,showCustomLayers:R,showLayerQualifiers:y,showResourceCountForLayer:Q};return i.jsx(ut.Provider,{value:m,children:b})}function Le(){const r=f.useContext(ut);if(!r)throw new Error('No flags "data" set, use FCSQueryBuilderConfigProvider to set');return r}const ht=f.createContext(void 0);ht.displayName="FCSQueryUpdaterContext";function si({rewriter:r,children:e}){const t={rewriter:r};return i.jsx(ht.Provider,{value:t,children:e})}function ve(){const r=f.useContext(ht);if(!r)throw new Error('No rewriter "data" set, use FCSQueryUpdaterProvider to set');return r}const dt=f.createContext(void 0);dt.displayName="FCSResourceLayerInfoContext";function ni({resources:r,layerInfo:e,children:t}){const s={resources:r,layerInfo:e};return i.jsx(dt.Provider,{value:s,children:t})}function ai(){const r=f.useContext(dt);if(!r)throw new Error('No resources and layer info "data" set, use FCSResourceLayerInfoProvider to set');return r}const N=class N extends Bt{constructor(e){super(e),this.interpreter=new Pt(this,N._ATN,N.decisionsToDFA,new Be)}get grammarFileName(){return"FCSLexer.g4"}get literalNames(){return N.literalNames}get symbolicNames(){return N.symbolicNames}get ruleNames(){return N.ruleNames}get serializedATN(){return N._serializedATN}get channelNames(){return N.channelNames}get modeNames(){return N.modeNames}static get _ATN(){return N.__ATN||(N.__ATN=new Pe().deserialize(N._serializedATN)),N.__ATN}get vocabulary(){return N.vocabulary}};n(N,"L_PAREN",1),n(N,"R_PAREN",2),n(N,"L_SQUARE_BRACKET",3),n(N,"R_SQUARE_BRACKET",4),n(N,"OR",5),n(N,"AND",6),n(N,"NOT",7),n(N,"FWD_SLASH",8),n(N,"L_CURLY_BRACKET",9),n(N,"R_CURLY_BRACKET",10),n(N,"Q_ONE_OR_MORE",11),n(N,"Q_ZERO_OR_MORE",12),n(N,"Q_ZERO_OR_ONE",13),n(N,"Q_COMMA",14),n(N,"OPERATOR_EQ",15),n(N,"OPERATOR_NE",16),n(N,"COLON",17),n(N,"WITHIN",18),n(N,"SIMPLE_WITHIN_SCOPE",19),n(N,"REGEXP_FLAGS",20),n(N,"IDENTIFIER",21),n(N,"INTEGER",22),n(N,"REGEXP",23),n(N,"QUOTED_STRING",24),n(N,"Space",25),n(N,"channelNames",["DEFAULT_TOKEN_CHANNEL","HIDDEN"]),n(N,"literalNames",[null,"'('","')'","'['","']'","'|'","'&'","'!'","'/'","'{'","'}'","'+'","'*'","'?'","','","'='","'!='","':'","'within'"]),n(N,"symbolicNames",[null,"L_PAREN","R_PAREN","L_SQUARE_BRACKET","R_SQUARE_BRACKET","OR","AND","NOT","FWD_SLASH","L_CURLY_BRACKET","R_CURLY_BRACKET","Q_ONE_OR_MORE","Q_ZERO_OR_MORE","Q_ZERO_OR_ONE","Q_COMMA","OPERATOR_EQ","OPERATOR_NE","COLON","WITHIN","SIMPLE_WITHIN_SCOPE","REGEXP_FLAGS","IDENTIFIER","INTEGER","REGEXP","QUOTED_STRING","Space"]),n(N,"modeNames",["DEFAULT_MODE"]),n(N,"ruleNames",["L_PAREN","R_PAREN","L_SQUARE_BRACKET","R_SQUARE_BRACKET","OR","AND","NOT","FWD_SLASH","L_CURLY_BRACKET","R_CURLY_BRACKET","Q_ONE_OR_MORE","Q_ZERO_OR_MORE","Q_ZERO_OR_ONE","Q_COMMA","OPERATOR_EQ","OPERATOR_NE","COLON","WITHIN","SIMPLE_WITHIN_SCOPE","REGEXP_FLAGS","IDENTIFIER_FIRST_CHAR","IDENTIFIER_LAST_CHAR","IDENTIFIER_CHAR","IDENTIFIER","INTEGER","REGEXP","QUOTED_STRING","CHAR","WS","ESCAPED_CHAR","HEX","Space"]),n(N,"_serializedATN",[4,0,25,238,6,-1,2,0,7,0,2,1,7,1,2,2,7,2,2,3,7,3,2,4,7,4,2,5,7,5,2,6,7,6,2,7,7,7,2,8,7,8,2,9,7,9,2,10,7,10,2,11,7,11,2,12,7,12,2,13,7,13,2,14,7,14,2,15,7,15,2,16,7,16,2,17,7,17,2,18,7,18,2,19,7,19,2,20,7,20,2,21,7,21,2,22,7,22,2,23,7,23,2,24,7,24,2,25,7,25,2,26,7,26,2,27,7,27,2,28,7,28,2,29,7,29,2,30,7,30,2,31,7,31,1,0,1,0,1,1,1,1,1,2,1,2,1,3,1,3,1,4,1,4,1,5,1,5,1,6,1,6,1,7,1,7,1,8,1,8,1,9,1,9,1,10,1,10,1,11,1,11,1,12,1,12,1,13,1,13,1,14,1,14,1,15,1,15,1,15,1,16,1,16,1,17,1,17,1,17,1,17,1,17,1,17,1,17,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,3,18,153,8,18,1,19,4,19,156,8,19,11,19,12,19,157,1,20,1,20,1,21,1,21,1,22,1,22,1,23,1,23,5,23,168,8,23,10,23,12,23,171,9,23,1,23,3,23,174,8,23,1,24,4,24,177,8,24,11,24,12,24,178,1,25,1,25,1,26,1,26,1,26,5,26,186,8,26,10,26,12,26,189,9,26,1,26,1,26,1,26,1,26,5,26,195,8,26,10,26,12,26,198,9,26,1,26,3,26,201,8,26,1,27,1,27,3,27,205,8,27,1,28,1,28,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,1,29,3,29,231,8,29,1,30,1,30,1,31,1,31,1,31,1,31,0,0,32,1,1,3,2,5,3,7,4,9,5,11,6,13,7,15,8,17,9,19,10,21,11,23,12,25,13,27,14,29,15,31,16,33,17,35,18,37,19,39,20,41,0,43,0,45,0,47,21,49,22,51,23,53,24,55,0,57,0,59,0,61,0,63,25,1,0,10,5,0,67,67,73,73,99,100,105,105,108,108,2,0,65,90,97,122,3,0,48,57,65,90,97,122,4,0,45,45,48,57,65,90,97,122,1,0,48,57,2,0,39,39,92,92,2,0,34,34,92,92,10,0,9,13,32,32,133,133,160,160,5760,5760,8192,8202,8232,8233,8239,8239,8287,8287,12288,12288,9,0,34,34,36,36,39,43,46,46,63,63,91,94,110,110,116,116,123,125,3,0,48,57,65,70,97,102,252,0,1,1,0,0,0,0,3,1,0,0,0,0,5,1,0,0,0,0,7,1,0,0,0,0,9,1,0,0,0,0,11,1,0,0,0,0,13,1,0,0,0,0,15,1,0,0,0,0,17,1,0,0,0,0,19,1,0,0,0,0,21,1,0,0,0,0,23,1,0,0,0,0,25,1,0,0,0,0,27,1,0,0,0,0,29,1,0,0,0,0,31,1,0,0,0,0,33,1,0,0,0,0,35,1,0,0,0,0,37,1,0,0,0,0,39,1,0,0,0,0,47,1,0,0,0,0,49,1,0,0,0,0,51,1,0,0,0,0,53,1,0,0,0,0,63,1,0,0,0,1,65,1,0,0,0,3,67,1,0,0,0,5,69,1,0,0,0,7,71,1,0,0,0,9,73,1,0,0,0,11,75,1,0,0,0,13,77,1,0,0,0,15,79,1,0,0,0,17,81,1,0,0,0,19,83,1,0,0,0,21,85,1,0,0,0,23,87,1,0,0,0,25,89,1,0,0,0,27,91,1,0,0,0,29,93,1,0,0,0,31,95,1,0,0,0,33,98,1,0,0,0,35,100,1,0,0,0,37,152,1,0,0,0,39,155,1,0,0,0,41,159,1,0,0,0,43,161,1,0,0,0,45,163,1,0,0,0,47,165,1,0,0,0,49,176,1,0,0,0,51,180,1,0,0,0,53,200,1,0,0,0,55,204,1,0,0,0,57,206,1,0,0,0,59,208,1,0,0,0,61,232,1,0,0,0,63,234,1,0,0,0,65,66,5,40,0,0,66,2,1,0,0,0,67,68,5,41,0,0,68,4,1,0,0,0,69,70,5,91,0,0,70,6,1,0,0,0,71,72,5,93,0,0,72,8,1,0,0,0,73,74,5,124,0,0,74,10,1,0,0,0,75,76,5,38,0,0,76,12,1,0,0,0,77,78,5,33,0,0,78,14,1,0,0,0,79,80,5,47,0,0,80,16,1,0,0,0,81,82,5,123,0,0,82,18,1,0,0,0,83,84,5,125,0,0,84,20,1,0,0,0,85,86,5,43,0,0,86,22,1,0,0,0,87,88,5,42,0,0,88,24,1,0,0,0,89,90,5,63,0,0,90,26,1,0,0,0,91,92,5,44,0,0,92,28,1,0,0,0,93,94,5,61,0,0,94,30,1,0,0,0,95,96,5,33,0,0,96,97,5,61,0,0,97,32,1,0,0,0,98,99,5,58,0,0,99,34,1,0,0,0,100,101,5,119,0,0,101,102,5,105,0,0,102,103,5,116,0,0,103,104,5,104,0,0,104,105,5,105,0,0,105,106,5,110,0,0,106,36,1,0,0,0,107,108,5,115,0,0,108,109,5,101,0,0,109,110,5,110,0,0,110,111,5,116,0,0,111,112,5,101,0,0,112,113,5,110,0,0,113,114,5,99,0,0,114,153,5,101,0,0,115,153,5,115,0,0,116,117,5,117,0,0,117,118,5,116,0,0,118,119,5,116,0,0,119,120,5,101,0,0,120,121,5,114,0,0,121,122,5,97,0,0,122,123,5,110,0,0,123,124,5,99,0,0,124,153,5,101,0,0,125,153,5,117,0,0,126,127,5,112,0,0,127,128,5,97,0,0,128,129,5,114,0,0,129,130,5,97,0,0,130,131,5,103,0,0,131,132,5,114,0,0,132,133,5,97,0,0,133,134,5,112,0,0,134,153,5,104,0,0,135,153,5,112,0,0,136,137,5,116,0,0,137,138,5,117,0,0,138,139,5,114,0,0,139,153,5,110,0,0,140,153,5,116,0,0,141,142,5,116,0,0,142,143,5,101,0,0,143,144,5,120,0,0,144,153,5,116,0,0,145,146,5,115,0,0,146,147,5,101,0,0,147,148,5,115,0,0,148,149,5,115,0,0,149,150,5,105,0,0,150,151,5,111,0,0,151,153,5,110,0,0,152,107,1,0,0,0,152,115,1,0,0,0,152,116,1,0,0,0,152,125,1,0,0,0,152,126,1,0,0,0,152,135,1,0,0,0,152,136,1,0,0,0,152,140,1,0,0,0,152,141,1,0,0,0,152,145,1,0,0,0,153,38,1,0,0,0,154,156,7,0,0,0,155,154,1,0,0,0,156,157,1,0,0,0,157,155,1,0,0,0,157,158,1,0,0,0,158,40,1,0,0,0,159,160,7,1,0,0,160,42,1,0,0,0,161,162,7,2,0,0,162,44,1,0,0,0,163,164,7,3,0,0,164,46,1,0,0,0,165,173,3,41,20,0,166,168,3,45,22,0,167,166,1,0,0,0,168,171,1,0,0,0,169,167,1,0,0,0,169,170,1,0,0,0,170,172,1,0,0,0,171,169,1,0,0,0,172,174,3,43,21,0,173,169,1,0,0,0,173,174,1,0,0,0,174,48,1,0,0,0,175,177,7,4,0,0,176,175,1,0,0,0,177,178,1,0,0,0,178,176,1,0,0,0,178,179,1,0,0,0,179,50,1,0,0,0,180,181,3,53,26,0,181,52,1,0,0,0,182,187,5,39,0,0,183,186,3,59,29,0,184,186,8,5,0,0,185,183,1,0,0,0,185,184,1,0,0,0,186,189,1,0,0,0,187,185,1,0,0,0,187,188,1,0,0,0,188,190,1,0,0,0,189,187,1,0,0,0,190,201,5,39,0,0,191,196,5,34,0,0,192,195,3,59,29,0,193,195,8,6,0,0,194,192,1,0,0,0,194,193,1,0,0,0,195,198,1,0,0,0,196,194,1,0,0,0,196,197,1,0,0,0,197,199,1,0,0,0,198,196,1,0,0,0,199,201,5,34,0,0,200,182,1,0,0,0,200,191,1,0,0,0,201,54,1,0,0,0,202,205,3,59,29,0,203,205,8,7,0,0,204,202,1,0,0,0,204,203,1,0,0,0,205,56,1,0,0,0,206,207,7,7,0,0,207,58,1,0,0,0,208,230,5,92,0,0,209,231,7,8,0,0,210,211,5,120,0,0,211,212,3,61,30,0,212,213,3,61,30,0,213,231,1,0,0,0,214,215,5,117,0,0,215,216,3,61,30,0,216,217,3,61,30,0,217,218,3,61,30,0,218,219,3,61,30,0,219,231,1,0,0,0,220,221,5,85,0,0,221,222,3,61,30,0,222,223,3,61,30,0,223,224,3,61,30,0,224,225,3,61,30,0,225,226,3,61,30,0,226,227,3,61,30,0,227,228,3,61,30,0,228,229,3,61,30,0,229,231,1,0,0,0,230,209,1,0,0,0,230,210,1,0,0,0,230,214,1,0,0,0,230,220,1,0,0,0,231,60,1,0,0,0,232,233,7,9,0,0,233,62,1,0,0,0,234,235,3,57,28,0,235,236,1,0,0,0,236,237,6,31,0,0,237,64,1,0,0,0,13,0,152,157,169,173,178,185,187,194,196,200,204,230,1,0,1,0]),n(N,"__ATN"),n(N,"vocabulary",new Ge(N.literalNames,N.symbolicNames,[])),n(N,"decisionsToDFA",N._ATN.decisionToState.map((e,t)=>new De(e,t)));let Je=N;class oi extends Xr{constructor(){super(...arguments);n(this,"visitQuery");n(this,"visitMain_query");n(this,"visitQuery_disjunction");n(this,"visitQuery_sequence");n(this,"visitQuery_group");n(this,"visitQuery_simple");n(this,"visitQuantifier");n(this,"visitQuery_implicit");n(this,"visitQuery_segment");n(this,"visitWithin_part");n(this,"visitWithin_part_simple");n(this,"visitExpression");n(this,"visitExpression_or");n(this,"visitExpression_and");n(this,"visitExpression_group");n(this,"visitExpression_not");n(this,"visitExpression_basic");n(this,"visitAttribute");n(this,"visitQualifier");n(this,"visitIdentifier");n(this,"visitRegexp");n(this,"visitRegexp_pattern");n(this,"visitRegexp_flag")}}function hr(r){if(!r||!r.trim())return null;const e=Gt.fromString(r),t=new Je(e),s=new Dt(t),l=new Wt(s),x=new _(s),p=new rr;return t.removeErrorListeners(),t.addErrorListener(p),x.removeErrorListeners(),x.addErrorListener(p),{tree:x.query(),lexer:t,parser:x,rewriter:l,errors:p.errors}}class li extends oi{constructor(){super(...arguments);n(this,"layers",[]);n(this,"visitAttribute",t=>{this.layers.push(t.getText())})}}function ci(r){const e=new li;r&&e.visit(r);const t=e.layers;return[...new Set(t)]}function ui(r,e){const t=e.filter(c=>c!=="word").filter(c=>c!=="text");if(t.length===0||r.length===0)return{supported:r,unsupported:[],unsupportedByLayer:new Map};const s=t.map(c=>c.split(":").toReversed()),l=r.map(c=>{const R=[];return s.forEach(([y,Q])=>{var b,m;Q?(m=c.availableLayers)!=null&&m.find(h=>h.layerType===y&&h.qualifier===Q)||R.push(`${Q}:${y}`):(b=c.availableLayers)!=null&&b.find(h=>h.layerType===y)||R.push(y)}),[c,R]}),x=l.filter(([,c])=>c.length===0).map(([c])=>c),p=l.filter(([,c])=>c.length!==0),d=p.map(([c,R])=>R.map(y=>[y,c])).flat(1).reduce((c,[R,y])=>(c.has(R)||c.set(R,[]),c.get(R).push(y),c),new Map);return{supported:x,unsupported:p,unsupportedByLayer:d}}const hi=/([\^$\\.*+?()[\]{}|/])/g,di=/\\([\^$\\.*+?()[\]{}|/])/g,fi=/(^|[^\\])([\^$.*+?()[\]{}|/])/g,dr=/(^|[^\\])((?:\\{2})*['"])/g,fr=/(^|[^\\])\\((?:\\{2})*['"])/g;function Ct(r){if(!r)return r;let e=r;return e=e.replace(hi,"\\$1"),e=e.replace(dr,"$1\\$2"),e}function xi(r){if(!r)return r;let e=r;return e=e.replace(fr,"$1$2"),e=e.replace(di,"$1"),e}function pi(r){return r?r.replace(fi,"\\$1$2")!==r:!1}function et(r){return r&&r.replaceAll("\\","\\\\").replace(dr,"$1\\$2")}function xr(r){return r&&r.replace(fr,"$1$2").replaceAll("\\\\","\\")}const Ri=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-braces" viewBox="0 0 16 16">
  <path d="M2.114 8.063V7.9c1.005-.102 1.497-.615 1.497-1.6V4.503c0-1.094.39-1.538 1.354-1.538h.273V2h-.376C3.25 2 2.49 2.759 2.49 4.352v1.524c0 1.094-.376 1.456-1.49 1.456v1.299c1.114 0 1.49.362 1.49 1.456v1.524c0 1.593.759 2.352 2.372 2.352h.376v-.964h-.273c-.964 0-1.354-.444-1.354-1.538V9.663c0-.984-.492-1.497-1.497-1.6M13.886 7.9v.163c-1.005.103-1.497.616-1.497 1.6v1.798c0 1.094-.39 1.538-1.354 1.538h-.273v.964h.376c1.613 0 2.372-.759 2.372-2.352v-1.524c0-1.094.376-1.456 1.49-1.456V7.332c-1.114 0-1.49-.362-1.49-1.456V4.352C13.51 2.759 12.75 2 11.138 2h-.376v.964h.273c.964 0 1.354.444 1.354 1.538V6.3c0 .984.492 1.497 1.497 1.6"/>
</svg>`,Fe=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-circle" viewBox="0 0 16 16">
  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
  <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"/>
</svg>`,mi=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-repeat" viewBox="0 0 16 16">
  <path d="M11 5.466V4H5a4 4 0 0 0-3.584 5.777.5.5 0 1 1-.896.446A5 5 0 0 1 5 3h6V1.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192m3.81.086a.5.5 0 0 1 .67.225A5 5 0 0 1 11 13H5v1.466a.25.25 0 0 1-.41.192l-2.36-1.966a.25.25 0 0 1 0-.384l2.36-1.966a.25.25 0 0 1 .41.192V12h6a4 4 0 0 0 3.585-5.777.5.5 0 0 1 .225-.67Z"/>
</svg>`,pr=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle" viewBox="0 0 16 16">
  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
  <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"/>
</svg>`;function Ei({query:r,cursorPos:e,resources:t,onChange:s,...l}){const[x,p]=f.useState(r??"");f.useEffect(()=>p(r??""),[r]);const d=f.useMemo(()=>{const b=(t==null?void 0:t.filter(m=>{var h;return(((h=m.availableDataViews)==null?void 0:h.find(L=>L.mimeType==="application/x-clarin-fcs-adv+xml"))!==void 0||m.searchCapabilitiesResolved.includes("ADVANCED_SEARCH"))&&m.availableLayers!==null&&m.availableLayers.length>0}))??[];if(t&&t.length!==b.length){const m=t.filter(h=>!b.includes(h));console.warn("Filter out resource(s) that do(es) not correctly declare ADV query support",m)}return b},[t]),c=f.useMemo(()=>d.map(b=>{const m=new Map;return b.availableLayers.forEach(h=>{m.has(h.layerType)||m.set(h.layerType,{resultIDs:[],qualifiers:[]});const L=m.get(h.layerType);L.resultIDs.push(h.resultId),h.qualifier!==null&&L.qualifiers.push(h.qualifier)}),[...m.entries()].map(([h,L])=>({layerType:h,resource:b,layerIDs:L}))}).reduce((b,m)=>(m.forEach(({layerType:h,resource:L,layerIDs:O})=>{b.has(h)||b.set(h,{resources:[],qualifiers:new Map});const B=b.get(h);B.resources.push({resource:L,layerIDs:O}),O.qualifiers.length>0&&O.qualifiers.forEach(U=>{B.qualifiers.has(U)||B.qualifiers.set(U,[]),B.qualifiers.get(U).push(L)})}),b),new Map),[d]),R=f.useMemo(()=>hr(x),[x]);function y(){if(R){const{rewriter:b}=R,m=b.getText();p(m),s==null||s(m)}else console.warn("No parsed query! Unable to handle change request",R)}function Q(b){const m=Ze[b].new;p(m),s==null||s(m)}return i.jsx("div",{id:"query-builder",className:"fcs-query d-flex justify-content-center",children:i.jsx(ii,{enableWithin:l.enableWithin??!1,enableWrapGroup:l.enableWrapGroup??!1,enableWrapNegation:l.enableWrapNegation??!1,enableImplicitQuery:l.enableImplicitQuery??!1,enableMultipleQuerySegments:l.enableMultipleQuerySegments??!0,enableQuantifiers:l.enableQuantifiers??!0,enableRegexpFlags:l.enableRegexpFlags??!1,showBasicLayer:l.showBasicLayer??!0,showAllAdvancedLayers:l.showAllAdvancedLayers??!1,showCustomLayers:l.showCustomLayers??!0,showLayerQualifiers:l.showLayerQualifiers??!0,showResourceCountForLayer:l.showResourceCountForLayer??!0,children:i.jsx(ni,{resources:d,layerInfo:c,children:R?i.jsx(ri,{parser:R.parser,lexer:R.lexer,cursorPos:e,children:i.jsx(si,{rewriter:R.rewriter,children:i.jsx(bi,{tree:R.tree,onChange:y})})}):i.jsx(tt,{onClick:Q})})})})}function Rr(r,e=!0){if(r instanceof We){if(e)throw Error("Unsupported syntax: Query-Disjunction");return[]}if(r instanceof Re){if(e)throw Error("Unsupported syntax: Query-Group");return[]}if(r instanceof me)return[r];if(r instanceof Ne)return r.children.map(t=>Rr(t,e)).flat(1);if(e)throw Error(`Invalid ParseTree for tokens ${r.getSourceInterval().toString()}: ${r.getText()}`);return[]}function He(r,e){e.delete(r.start,r.stop);const t=r.parent;if(t instanceof de||t instanceof we){if(t.children.length===1){He(t,e);return}const s=t.children.findIndex(l=>l===r);if(s===0){const l=t.getChild(s+1);e.delete(l.symbol)}else{const l=t.getChild(s-1);e.delete(l.symbol)}if(t.children.length===3){const l=t.parent,x=t.getChild(s+(s===0?2:-2));l instanceof J&&x instanceof J&&(e.delete(x.L_PAREN().symbol),e.delete(x.R_PAREN().symbol))}return}if(t instanceof J){He(t,e);return}if(t instanceof Z){He(t,e);return}console.warn("Unexpected other parent to remove?",{parentCtx:t,ctx:r})}function tt({onClick:r}){const{enableImplicitQuery:e}=Le();function t(s){s&&(r==null||r(s))}return i.jsx(i.Fragment,{children:i.jsxs(w,{className:"d-inline-block",onSelect:t,"aria-label":"Add query segment",children:[i.jsx(w.Toggle,{variant:"link",className:"add-query-segment-btn action-btn no-arrow",children:i.jsx("i",{dangerouslySetInnerHTML:{__html:Fe},"aria-hidden":"true"})}),i.jsx(w.Menu,{children:ar.filter(e?()=>!0:s=>s.id!=="string").map(s=>i.jsx(w.Item,{eventKey:s.id,children:s.label},s.id))})]})})}function rt({allowedIds:r,onClick:e}){function t(s){s&&(e==null||e(s))}return i.jsx(i.Fragment,{children:i.jsxs(w,{className:"d-inline-block",onSelect:t,"aria-label":"Add expression",children:[i.jsx(w.Toggle,{variant:"link",className:"add-expression-btn action-btn no-arrow",children:i.jsx("i",{dangerouslySetInnerHTML:{__html:Fe},"aria-hidden":"true"})}),i.jsx(w.Menu,{children:or.filter(r&&r.length>0?s=>r.includes(s.id):()=>!0).map(s=>i.jsx(w.Item,{eventKey:s.id,children:s.label},s.id))})]})})}function Ot({className:r,onClick:e}){function t(s){s&&(e==null||e(s))}return i.jsx(i.Fragment,{children:i.jsxs(w,{className:["d-inline-block"].concat(r??[]).join(" "),onSelect:t,"aria-label":"Change to expressions list",children:[i.jsx(w.Toggle,{variant:"link",className:"change-to-expression-list-btn action-btn no-arrow",children:i.jsx("i",{dangerouslySetInnerHTML:{__html:Fe},"aria-hidden":"true"})}),i.jsx(w.Menu,{children:lr.map(s=>i.jsx(w.Item,{eventKey:s.id,children:s.label},s.id))})]})})}function _i({allowedIds:r,className:e,onClick:t}){const{enableWrapGroup:s,enableWrapNegation:l}=Le();function x(p){p&&(t==null||t(p))}return s||l?i.jsx(i.Fragment,{children:i.jsxs(w,{className:["d-inline-block"].concat(e??[]).join(" "),onSelect:x,"aria-label":"Wrap expression",children:[i.jsx(w.Toggle,{variant:"link",className:"wrap-expression-btn action-btn rounded-circle p-1 no-arrow",children:i.jsx("i",{dangerouslySetInnerHTML:{__html:Ri},"aria-hidden":"true"})}),i.jsx(w.Menu,{children:cr.filter(r&&r.length>0?p=>r.includes(p.id):()=>!0).filter(s?()=>!0:p=>p.id!=="group").filter(l?()=>!0:p=>p.id!=="not").map(p=>i.jsx(w.Item,{eventKey:p.id,children:p.label},p.id))})]})}):null}function $e({className:r,onClick:e}){return i.jsx(Ae,{variant:"link",className:["del-btn action-btn rounded-circle p-1"].concat(r??[]).join(" "),onClick:e,children:i.jsx("i",{dangerouslySetInnerHTML:{__html:pr},"aria-hidden":"true"})})}function yi({className:r,onClick:e}){return i.jsx(Ae,{variant:"link",className:["add-quantifier-btn action-btn rounded-circle p-1"].concat(r??[]).join(" "),onClick:e,children:i.jsx("i",{dangerouslySetInnerHTML:{__html:mi},"aria-hidden":"true"})})}function bi({tree:r,onChange:e}){const{rewriter:t}=ve(),{enableWithin:s}=Le(),l=r.main_query(),x=l.getChild(0),p=Rr(x,!1),d=s?r.within_part():null,c=(d==null?void 0:d.getText())??"",[R,y]=f.useState(c);f.useEffect(()=>y(c),[c]);function Q(){var O;const h="sentence";y(h);const L=(O=l.stop)==null?void 0:O.tokenIndex;L!==void 0?(t.insertAfter(L,` within ${h}`),e==null||e()):console.warn("Unable to add within part. End token index not found!",{queryCtx:l})}function b(h){const L=h.target.value;if(y(L),d){const O=d.within_part_simple(),B=O==null?void 0:O.SIMPLE_WITHIN_SCOPE();B?(t.replaceSingle(B.symbol,L),e==null||e()):console.warn("Error trying to update within part. Token not found!",{withinCtx:d,withinPartCtx:O,token:B})}else console.warn("Error trying to update within part. Context not found!",{tree:r,withinCtx:d})}function m(){d?(y(""),t.delete(r.WITHIN().symbol,d.stop),e==null||e()):console.warn("Error trying to remove within part. Context not found!",{tree:r,withinCtx:d})}return i.jsxs("div",{className:"block query flex-grow-1 justify-content-center d-flex flex-wrap row-gap-2 column-gap-1 border rounded p-1",children:[i.jsx(gi,{children:p,onChange:e}),s&&(R?i.jsxs("div",{className:"block within-clause position-relative d-flex column-gap-2 align-items-center border rounded p-1",children:[i.jsx("code",{className:"keyword",children:"within"}),i.jsx(j.Select,{className:"w-auto",value:R,onChange:b,children:Jr.map(h=>i.jsx("option",{value:h,children:h},h))}),i.jsx($e,{className:"del-within-clause-btn position-absolute top-0 start-100 translate-middle",onClick:m})]}):i.jsx(Ae,{size:"sm",onClick:Q,style:{alignSelf:"center"},children:"Add within clause"}))]})}function gi({children:r,onChange:e}){const{rewriter:t}=ve(),{enableMultipleQuerySegments:s}=Le(),l=f.useCallback(p=>{const d=r&&r.length>0?r[0].start.tokenIndex:0,c=Ze[p].new;t.insertBefore(d,`${c} `),e==null||e()},[t,r,e]),x=f.useCallback((p,d)=>{const c=d.stop.tokenIndex,R=Ze[p].new;t.insertAfter(c,` ${R}`),e==null||e()},[t,e]);return i.jsxs("div",{className:"block query-simple-or-sequence border rounded py-1 px-2 d-flex flex-wrap row-gap-3 column-gap-2 align-items-center",children:[s&&i.jsx(tt,{onClick:l},"add-0"),r.map(p=>i.jsxs(f.Fragment,{children:[i.jsx(wi,{ctx:p,onChange:e}),s&&i.jsx(tt,{onClick:d=>x(d,p)})]},`query-${p.getSourceInterval().toString()}`))]})}function Ai({value:r,onChange:e}){const[t,s]=f.useState(r);return f.useEffect(()=>s(r),[r]),i.jsx(j.Control,{className:"d-inline",style:{width:"10ch"},value:t,onChange:l=>s(l.target.value),onBlur:()=>e==null?void 0:e(t)})}function ft({ctx:r,showChangeToExpressionListButton:e=!1,onChange:t}){const{rewriter:s}=ve(),{layerInfo:l}=ai(),{showBasicLayer:x,showAllAdvancedLayers:p,showCustomLayers:d,showLayerQualifiers:c,showResourceCountForLayer:R}=Le(),{cursorPos:y}=ur(),Q=je(r,y),b="word",m=Object.keys(St),h=[b,...m],L=d?[...l.keys()].filter(u=>!h.includes(u)).toSorted():[],O=l.has(b),B=[...l.keys()].filter(u=>Object.keys(St).includes(u)).length>0,U=L.length>0,W=r.attribute(),re=r.getChild(1),K=r.regexp().regexp_pattern().REGEXP(),[V,ie]=f.useState("text"),[z,P]=f.useState("is"),[H,ne]=f.useState(""),ae=f.useRef(z);f.useEffect(()=>{var Oe;const u=W.identifier(),E=W.qualifier(),q=E!==null?`${E.getText()}:${u.getText()}`:`${u.getText()}`,$=re.symbol.type===_.OPERATOR_EQ,D=K.symbol.text,X=D==null?void 0:D.slice(1,-1),oe=Ie(X??"",$);let te=oe.operator,le=Ee(oe.value,te);ae.current!==te&&["regex","not-regex"].includes(ae.current)&&(ae.current,te=ae.current);const pe=Tt[q];pe&&pe.options&&pe.options.length>0&&(!pe.options.map(Ke=>Ke.value).includes(le)||!le)&&(le=((Oe=pe.options[0])==null?void 0:Oe.value)??"",te="is"),ie(q??""),P(te),ne(le),ae.current=te},[W,re,K]);const fe=r.parent,Te=Object.keys(It).filter(fe instanceof J?u=>u!=="group":()=>!0).filter(fe instanceof Z?u=>u!=="group":()=>!0),he=Tt[V];function Ie(u,E){const q=u.startsWith(".*"),$=u.endsWith(".*"),D=q&&$?u.slice(2,-2):q?u.slice(2):$?u.slice(0,-2):u;return pi(D)?{operator:E?"regex":"not-regex",value:u}:E?q&&$?{operator:"contains",value:D}:q?{operator:"ends-with",value:u.slice(2)}:$?{operator:"starts-with",value:u.slice(0,-2)}:{operator:"is",value:u}:q||$?{operator:"not-regex",value:u}:{operator:"is-not",value:u}}function Ee(u,E){return["regex","not-regex"].includes(E)?xr(u):xi(u)}function Ce(u,E){return["regex","not-regex"].includes(E)?et(u):Ct(u)}function xe(u){const E=u;E&&E!==V&&(ie(E),s.replace(W.start,W.stop,E),t==null||t())}function _e(u){const E=u.target.value,q=z;P(E),ae.current=E;const $=["is-not","not-regex"].includes(E)?"!=":"=";s.replaceSingle(re.symbol,$);let D=H??"";const X=Ye[E],oe=Ye[q];if(!X){console.warn("Unexpected state, did not find known operator value!",{newOpInfo:X,oldOpInfo:oe,newOperator:E,oldOperator:q});return}D=Ce(D,E),s.replaceSingle(K.symbol,`"${X.valueBefore??""}${D}${X.valueAfter??""}"`),t==null||t()}function A(){const u=["regex","not-regex"].includes(z)?et(H):Ct(H),E=Ye[z];s.replaceSingle(K.symbol,`"${(E==null?void 0:E.valueBefore)??""}${u}${(E==null?void 0:E.valueAfter)??""}"`),t==null||t()}function S(u,E){const q=ti[u];E?s.insertBefore(r.start,`${q.newBefore} `):s.insertAfter(r.stop,` ${q.newAfter}`),t==null||t()}function k(u){const E=It[u];E.newBefore&&s.insertBefore(r.start,E.newBefore),E.newAfter&&s.insertAfter(r.stop,E.newAfter),t==null||t()}function M(){He(r,s),t==null||t()}function G(u,E=void 0){return E?i.jsxs(i.Fragment,{children:[i.jsx("strong",{children:u}),": ",E,F(u)]}):i.jsxs(i.Fragment,{children:[i.jsx("strong",{children:u}),F(u)]})}function F(u,E=void 0){var X,oe,te,le;if(!R)return null;const q=((X=l.get(u))==null?void 0:X.resources.length)??0,$=E?((le=(te=(oe=l.get(u))==null?void 0:oe.qualifiers)==null?void 0:te.get(E))==null?void 0:le.length)??0:void 0;if(E&&q===$)return null;const D=E?$:q;return i.jsxs(i.Fragment,{children:[i.jsx("br",{}),i.jsxs("small",{className:"text-body-secondary",children:["Supported by ",D," resources."]})]})}function ee(u){var $;if(!c)return null;const E=($=l.get(u))==null?void 0:$.qualifiers;return!E||E.size===0?null:[...E.keys()].map(D=>{const X=`${D}:${u}`;return i.jsx(w.Item,{eventKey:X,active:V===X,children:i.jsxs("div",{className:"ms-3",children:[i.jsx("strong",{children:D}),":",u,F(u,D)]})},X)})}function ye(){var u;return he&&((u=he.options)==null?void 0:u.length)>0?i.jsxs(w,{onSelect:E=>ne(E??""),onBlur:A,children:[i.jsx(w.Toggle,{className:"form-select",children:H}),i.jsx(w.Menu,{children:he.options.map(E=>i.jsx(w.Item,{eventKey:E.value,active:H===E.value,children:E.label},E.value))})]}):i.jsx(j.Control,{className:"d-inline",style:{width:"10ch"},value:H,onChange:E=>ne(E.target.value),onBlur:A})}return i.jsxs("div",{className:["block input-block basic-expression position-relative focus-ring border rounded py-3 ps-2 pe-3 my-2 ms-1 me-2"].concat([Q?"cursor-focus":""]).join(" "),children:[e&&i.jsx(Ot,{className:"position-absolute top-0 start-50 translate-middle rounded-circle p-1",onClick:u=>S(u,!0)}),i.jsxs("div",{className:"d-flex justify-content-center column-gap-2",children:[i.jsxs(w,{onSelect:xe,children:[i.jsx(w.Toggle,{className:"form-select",children:V}),i.jsx(w.Menu,{children:i.jsxs("div",{className:"d-flex",children:[i.jsxs("div",{className:[].concat(d&&U?["border-end pe-1"]:[]).join(" "),children:[x&&i.jsxs(i.Fragment,{children:[i.jsx(w.Header,{children:"Basic Search Layer"}),i.jsx(w.Item,{eventKey:b,active:V===b,children:G(b)}),i.jsx(w.Divider,{})]}),(x||d&&L.length>0)&&i.jsx(w.Header,{children:"Advanced Search Layers"}),ir.filter(p?()=>!0:u=>l.has(u.id)).map(u=>i.jsxs(f.Fragment,{children:[i.jsxs(w.Item,{eventKey:u.id,active:V===u.id,children:[i.jsx("strong",{children:u.id}),": ",u.label,F(u.id)]}),ee(u.id)]},u.id)),!x&&!p&&L.length===0&&i.jsxs(w.ItemText,{style:{width:"max-content"},children:[i.jsx("em",{className:"text-warning-emphasis",children:"No supported layers available?!"}),i.jsx("br",{}),i.jsx("em",{className:"text-secondary",children:"Maybe select a few more resources."})]})]}),i.jsx("div",{className:[].concat(x&&O||B?["ps-1"]:[]).join(" "),children:d&&L.length>0&&i.jsxs(i.Fragment,{children:[i.jsx(w.Header,{children:"Custom Layers"}),L.map(u=>i.jsxs(f.Fragment,{children:[i.jsxs(w.Item,{eventKey:u,active:V===u,children:[i.jsx("strong",{children:u}),F(u)]}),ee(u)]},u))]})})]})})]}),i.jsx(j.Select,{style:{width:"fit-content"},value:z,onChange:_e,children:sr.map(u=>i.jsx("option",{value:u.id,children:u.label},u.id))}),ye()]}),e&&i.jsx(Ot,{className:"position-absolute top-100 start-50 translate-middle rounded-circle p-1",onClick:u=>S(u,!1)}),i.jsxs("div",{className:"actions position-absolute top-0 d-flex",children:[i.jsx(_i,{allowedIds:Te,onClick:k}),i.jsx($e,{onClick:M})]})]})}function Ni({ctx:r,onChange:e}){const{rewriter:t}=ve(),s=r.Q_ZERO_OR_MORE()!==null,l=r.Q_ONE_OR_MORE()!==null,x=r.Q_ZERO_OR_ONE()!==null,p=!(s||l||x),d=r.getChildCount(),c=d>=4,R=p&&(d===3||r.Q_COMMA()===r.getChild(2))?r.getChild(1).symbol:null,y=p&&d>=4&&r.Q_COMMA()===r.getChild(d-3)?r.getChild(d-2).symbol:null,Q=R!==null?Number.parseInt(R.text):null,b=y!==null?Number.parseInt(y.text):null,m=p?Q!==null&&b!==null?"n-m":Q!==null?c?"n-":"n-n":b!==null?"-m":null:s?"*":x?"?":l?"+":null,[h,L]=f.useState(m??"?"),[O,B]=f.useState(Q),[U,W]=f.useState(b);f.useEffect(()=>{B(Q),W(b)},[Q,b]);const re=O!==null&&U!==null&&O>U||O!==null&&O<0||U!==null&&U<1;function K(P){const H=P.target.value;L(H);const ne=ei[H].new??"?";t.replace(r.start,r.stop,ne),e==null||e()}function V(P){const H=Number.parseInt(P.target.value);B(Number.isNaN(H)?null:H),R!==null&&!Number.isNaN(H)&&(t.replaceSingle(R,H.toString()),e==null||e())}function ie(P){const H=Number.parseInt(P.target.value);W(Number.isNaN(H)?null:H),y!==null&&!Number.isNaN(H)&&(t.replaceSingle(y,H.toString()),e==null||e())}function z(){t.delete(r.start,r.stop),e==null||e()}return i.jsxs("div",{className:["block input-block quantifier position-relative border rounded p-1 pt-3 px-1 m-1 me-2 mt-2"].concat(re?["invalid-range"]:[]).join(" "),children:[i.jsxs("div",{className:"d-flex flex-column align-items-center row-gap-1",children:[i.jsx(j.Select,{size:"sm",style:{width:"fit-content"},value:h,onChange:K,children:nr.map(P=>i.jsx("option",{value:P.id,children:P.label},P.id))}),i.jsx("div",{className:"d-flex align-items-baseline column-gap-1",children:["+","*","?"].includes(h)?i.jsx("code",{className:"keyword",children:h}):i.jsxs(i.Fragment,{children:[i.jsx("code",{className:"keyword",children:"{"}),i.jsx(j.Text,{children:"Repeat"}),["n-m","n-","n-n"].includes(h)&&i.jsx(j.Control,{size:"sm",style:{width:"8ch"},type:"number",min:h==="n-n"?1:0,max:h==="n-m"?U??void 0:void 0,value:O??0,onChange:V}),h==="n-m"&&i.jsx(j.Text,{children:"to"}),["n-m","-m"].includes(h)&&i.jsx(j.Control,{size:"sm",style:{width:"8ch"},type:"number",min:h==="n-m"&&O||1,value:U??O??1,onChange:ie}),i.jsx("code",{className:"keyword",children:"}"})]})})]}),i.jsx($e,{className:"del-quantifier-btn position-absolute top-0 start-100 translate-middle",onClick:z})]})}function wi({ctx:r,onChange:e}){const{rewriter:t}=ve(),{enableQuantifiers:s}=Le(),{cursorPos:l}=ur(),x=r.query_implicit(),p=r.query_segment(),d=r.quantifier(),c=x!==null,R=je(c?x:p,l);function y(){t.delete(r.start,r.stop),e==null||e()}function Q(){t.insertAfter(r.stop,` ${Zr}`),e==null||e()}function b(){if(x!==null){let m=function(B){t.replaceSingle(h.symbol,`"${et(B)}"`),e==null||e()};const h=x.regexp().regexp_pattern().REGEXP(),L=h.symbol.text,O=xr(L==null?void 0:L.slice(1,-1));return i.jsx(Ai,{value:O??"",onChange:m})}if(p!==null){const m=p.expression();if(!m){let h=function(L){const O=Ue[L].new;t.insertAfter(r.start,` ${O} `),e==null||e()};return i.jsx(rt,{onClick:L=>h(L)})}return i.jsx(Li,{ctx:m,onChange:e})}throw Error('Invalid parse tree. Expected "query-segment" context.')}return i.jsxs("div",{className:["block query-simple focus-ring border rounded p-1 pe-2 my-2 position-relative d-flex align-items-center"].concat(R?"cursor-focus":"").join(" "),children:[c?i.jsx("code",{className:"delims",children:'"'}):i.jsx("code",{className:"delims",children:"["}),b(),c?i.jsx("code",{className:"delims",children:'"'}):i.jsx("code",{className:"delims",children:"]"}),s&&d!==null&&i.jsx(Ni,{ctx:d,onChange:e}),i.jsx($e,{className:"del-query-segment-btn position-absolute top-0 start-100 translate-middle",onClick:y}),s&&d===null&&i.jsx(yi,{className:"position-absolute top-100 start-100 translate-middle",onClick:Q})]})}function Li({ctx:r,onChange:e}){const t=r.getChild(0);return t instanceof se?i.jsx(ft,{ctx:t,showChangeToExpressionListButton:!0,onChange:e}):t instanceof Z||t instanceof J?i.jsx(xt,{ctx:t,onChange:e}):i.jsx(pt,{ctx:t,onChange:e})}function xt({ctx:r,onChange:e}){const t=r instanceof Z,s=r instanceof J,l=r.getChild(1);return i.jsxs("div",{className:["block expression-wrap position-relative p-1 m-1 border rounded"].concat(t?["negation-expression d-flex align-items-center"]:[]).concat(s?["group-expression d-flex align-items-center"]:[]).join(" "),children:[t&&i.jsx("code",{className:"delims",children:"!"}),s&&i.jsx("code",{className:"delims",children:"("}),l instanceof se?i.jsx(ft,{ctx:l,showChangeToExpressionListButton:!t,onChange:e}):l instanceof Z||l instanceof J?i.jsx(xt,{ctx:l,onChange:e}):i.jsx(pt,{ctx:l,onChange:e}),s&&i.jsx("code",{className:"delims",children:")"})]})}function pt({ctx:r,onChange:e}){const{rewriter:t}=ve(),s=r instanceof de,l=r instanceof we,x=Object.keys(Ue).filter(s?y=>y!=="and":()=>!0).filter(l?y=>y!=="or":()=>!0),p=s?"&":"|";function d(y){const Q=r.children.length>0?r.children[0].start.tokenIndex:0,b=Ue[y].new,m=y==="basic"?b:`( ${b} )`;t.insertBefore(Q,`${m} ${p} `),e==null||e()}function c(y,Q){const b=Q.stop.tokenIndex,m=Ue[y].new,h=y==="basic"?m:`( ${m} )`;t.insertAfter(b,` ${p} ${h}`),e==null||e()}function R(y){return y instanceof se?i.jsx(ft,{ctx:y,showChangeToExpressionListButton:!1,onChange:e}):y instanceof Z||y instanceof J?i.jsx(xt,{ctx:y,onChange:e}):i.jsx(pt,{ctx:y,onChange:e})}return i.jsxs("div",{className:["block expression-list p-1 m-1 border rounded position-relative"].concat(l?["or-expression"]:[]).concat(s?["and-expression"]:[]).join(" "),children:[l&&i.jsx("code",{className:"delims position-absolute ps-1",children:"OR"}),s&&i.jsx("code",{className:"delims position-absolute ps-1",children:"AND"}),i.jsxs("div",{className:"d-flex flex-column align-items-center mt-1",children:[i.jsx(rt,{allowedIds:x,onClick:d}),r.children.filter((y,Q)=>Q%2===0).map(y=>i.jsxs(f.Fragment,{children:[R(y),i.jsx(rt,{allowedIds:x,onClick:Q=>c(Q,y)})]},`expression-${y.getSourceInterval().toString()}`))]})]})}const o=class o extends Ht{get grammarFileName(){return"LexParser.g4"}get literalNames(){return o.literalNames}get symbolicNames(){return o.symbolicNames}get ruleNames(){return o.ruleNames}get serializedATN(){return o._serializedATN}createFailedPredicateException(e,t){return new Mt(this,e,t)}constructor(e){super(e),this.interpreter=new qt(this,o._ATN,o.decisionsToDFA,new Be)}query(){let e=new vi(this.context,this.state);this.enterRule(e,0,o.RULE_query);try{this.enterOuterAlt(e,1),this.state=42,this.boolean_query(),this.state=43,this.match(o.EOF)}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}boolean_query(){let e=new Ve(this.context,this.state);this.enterRule(e,2,o.RULE_boolean_query);let t;try{for(this.enterOuterAlt(e,1),this.state=45,this.subquery(),this.state=51,this.errorHandler.sync(this),t=this.tokenStream.LA(1);(t&-32)===0&&(1<<t&14336)!==0;)this.state=46,this.boolean_modified(),this.state=47,this.subquery(),this.state=53,this.errorHandler.sync(this),t=this.tokenStream.LA(1)}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}subquery(){let e=new Me(this.context,this.state);this.enterRule(e,4,o.RULE_subquery);try{switch(this.state=59,this.errorHandler.sync(this),this.tokenStream.LA(1)){case o.L_PAREN:this.enterOuterAlt(e,1),this.state=54,this.match(o.L_PAREN),this.state=55,this.boolean_query(),this.state=56,this.match(o.R_PAREN);break;case o.QUOTED_STRING:case o.SIMPLE_STRING:this.enterOuterAlt(e,2),this.state=58,this.search_clause();break;default:throw new ue(this)}}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}search_clause(){let e=new mr(this.context,this.state);this.enterRule(e,6,o.RULE_search_clause);try{this.enterOuterAlt(e,1);{switch(this.state=64,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,2,this.context)){case 1:this.state=61,this.index(),this.state=62,this.relation_modified();break}this.state=66,this.search_term()}}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}search_term(){let e=new Er(this.context,this.state);this.enterRule(e,8,o.RULE_search_term);let t;try{this.enterOuterAlt(e,1),this.state=68,t=this.tokenStream.LA(1),t===15||t===16?(this.errorHandler.reportMatch(this),this.consume()):this.errorHandler.recoverInline(this)}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}index_modified(){let e=new Si(this.context,this.state);this.enterRule(e,10,o.RULE_index_modified);let t;try{this.enterOuterAlt(e,1),this.state=70,this.index(),this.state=72,this.errorHandler.sync(this),t=this.tokenStream.LA(1),t===10&&(this.state=71,this.modifier_list())}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}index(){let e=new Rt(this.context,this.state);this.enterRule(e,12,o.RULE_index);try{switch(this.state=76,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,4,this.context)){case 1:this.enterOuterAlt(e,1),this.state=74,this.simple_name();break;case 2:this.enterOuterAlt(e,2),this.state=75,this.prefix_name();break}}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}relation_modified(){let e=new _r(this.context,this.state);this.enterRule(e,14,o.RULE_relation_modified);let t;try{this.enterOuterAlt(e,1),this.state=78,this.relation(),this.state=80,this.errorHandler.sync(this),t=this.tokenStream.LA(1),t===10&&(this.state=79,this.modifier_list())}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}relation(){let e=new yr(this.context,this.state);this.enterRule(e,16,o.RULE_relation);try{switch(this.state=84,this.errorHandler.sync(this),this.tokenStream.LA(1)){case o.SIMPLE_STRING:this.enterOuterAlt(e,1),this.state=82,this.relation_name();break;case o.EQUAL:case o.GREATER:case o.LESSER:case o.GREATER_EQUAL:case o.LESSER_EQUAL:case o.NOT_EQUAL:case o.EQUAL_EQUAL:this.enterOuterAlt(e,2),this.state=83,this.relation_symbol();break;default:throw new ue(this)}}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}relation_name(){let e=new br(this.context,this.state);this.enterRule(e,18,o.RULE_relation_name);try{switch(this.state=88,this.errorHandler.sync(this),this.interpreter.adaptivePredict(this.tokenStream,7,this.context)){case 1:this.enterOuterAlt(e,1),this.state=86,this.simple_name();break;case 2:this.enterOuterAlt(e,2),this.state=87,this.prefix_name();break}}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}relation_symbol(){let e=new mt(this.context,this.state);this.enterRule(e,20,o.RULE_relation_symbol);let t;try{this.enterOuterAlt(e,1),this.state=90,t=this.tokenStream.LA(1),(t&-32)===0&&(1<<t&1016)!==0?(this.errorHandler.reportMatch(this),this.consume()):this.errorHandler.recoverInline(this)}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}boolean_modified(){let e=new qe(this.context,this.state);this.enterRule(e,22,o.RULE_boolean_modified);let t;try{this.enterOuterAlt(e,1),this.state=92,this.boolean_(),this.state=94,this.errorHandler.sync(this),t=this.tokenStream.LA(1),t===10&&(this.state=93,this.modifier_list())}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}boolean_(){let e=new gr(this.context,this.state);this.enterRule(e,24,o.RULE_boolean);let t;try{this.enterOuterAlt(e,1),this.state=96,t=this.tokenStream.LA(1),(t&-32)===0&&(1<<t&14336)!==0?(this.errorHandler.reportMatch(this),this.consume()):this.errorHandler.recoverInline(this)}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}modifier_list(){let e=new Xe(this.context,this.state);this.enterRule(e,26,o.RULE_modifier_list);let t;try{this.enterOuterAlt(e,1);{this.state=99,this.errorHandler.sync(this),t=this.tokenStream.LA(1);do this.state=98,this.modifier(),this.state=101,this.errorHandler.sync(this),t=this.tokenStream.LA(1);while(t===10)}}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}modifier(){let e=new it(this.context,this.state);this.enterRule(e,28,o.RULE_modifier);let t;try{this.enterOuterAlt(e,1),this.state=103,this.match(o.SLASH),this.state=104,this.modifier_name(),this.state=106,this.errorHandler.sync(this),t=this.tokenStream.LA(1),(t&-32)===0&&(1<<t&1016)!==0&&(this.state=105,this.modifier_relation())}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}modifier_name(){let e=new Ar(this.context,this.state);this.enterRule(e,30,o.RULE_modifier_name);try{this.enterOuterAlt(e,1),this.state=108,this.simple_name()}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}modifier_relation(){let e=new Nr(this.context,this.state);this.enterRule(e,32,o.RULE_modifier_relation);try{this.enterOuterAlt(e,1),this.state=110,this.relation_symbol(),this.state=111,this.modifier_value()}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}modifier_value(){let e=new wr(this.context,this.state);this.enterRule(e,34,o.RULE_modifier_value);let t;try{this.enterOuterAlt(e,1),this.state=113,t=this.tokenStream.LA(1),t===15||t===16?(this.errorHandler.reportMatch(this),this.consume()):this.errorHandler.recoverInline(this)}catch(s){if(s instanceof I)this.errorHandler.reportError(this,s),this.errorHandler.recover(this,s);else throw s}finally{this.exitRule()}return e}prefix_name(){let e=new Et(this.context,this.state);this.enterRule(e,36,o.RULE_prefix_name);try{this.enterOuterAlt(e,1),this.state=115,this.prefix(),this.state=116,this.match(o.DOT),this.state=117,this.simple_name()}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}prefix(){let e=new Lr(this.context,this.state);this.enterRule(e,38,o.RULE_prefix);try{this.enterOuterAlt(e,1),this.state=119,this.simple_name()}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}simple_name(){let e=new Se(this.context,this.state);this.enterRule(e,40,o.RULE_simple_name);try{this.enterOuterAlt(e,1),this.state=121,this.match(o.SIMPLE_STRING)}catch(t){if(t instanceof I)this.errorHandler.reportError(this,t),this.errorHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}static get _ATN(){return o.__ATN||(o.__ATN=new Pe().deserialize(o._serializedATN)),o.__ATN}get vocabulary(){return o.vocabulary}};n(o,"L_PAREN",1),n(o,"R_PAREN",2),n(o,"EQUAL",3),n(o,"GREATER",4),n(o,"LESSER",5),n(o,"GREATER_EQUAL",6),n(o,"LESSER_EQUAL",7),n(o,"NOT_EQUAL",8),n(o,"EQUAL_EQUAL",9),n(o,"SLASH",10),n(o,"AND",11),n(o,"OR",12),n(o,"NOT",13),n(o,"DOT",14),n(o,"QUOTED_STRING",15),n(o,"SIMPLE_STRING",16),n(o,"WS",17),n(o,"RULE_query",0),n(o,"RULE_boolean_query",1),n(o,"RULE_subquery",2),n(o,"RULE_search_clause",3),n(o,"RULE_search_term",4),n(o,"RULE_index_modified",5),n(o,"RULE_index",6),n(o,"RULE_relation_modified",7),n(o,"RULE_relation",8),n(o,"RULE_relation_name",9),n(o,"RULE_relation_symbol",10),n(o,"RULE_boolean_modified",11),n(o,"RULE_boolean",12),n(o,"RULE_modifier_list",13),n(o,"RULE_modifier",14),n(o,"RULE_modifier_name",15),n(o,"RULE_modifier_relation",16),n(o,"RULE_modifier_value",17),n(o,"RULE_prefix_name",18),n(o,"RULE_prefix",19),n(o,"RULE_simple_name",20),n(o,"literalNames",[null,"'('","')'","'='","'>'","'<'","'>='","'<='","'<>'","'=='","'/'",null,null,null,"'.'"]),n(o,"symbolicNames",[null,"L_PAREN","R_PAREN","EQUAL","GREATER","LESSER","GREATER_EQUAL","LESSER_EQUAL","NOT_EQUAL","EQUAL_EQUAL","SLASH","AND","OR","NOT","DOT","QUOTED_STRING","SIMPLE_STRING","WS"]),n(o,"ruleNames",["query","boolean_query","subquery","search_clause","search_term","index_modified","index","relation_modified","relation","relation_name","relation_symbol","boolean_modified","boolean","modifier_list","modifier","modifier_name","modifier_relation","modifier_value","prefix_name","prefix","simple_name"]),n(o,"_serializedATN",[4,1,17,124,2,0,7,0,2,1,7,1,2,2,7,2,2,3,7,3,2,4,7,4,2,5,7,5,2,6,7,6,2,7,7,7,2,8,7,8,2,9,7,9,2,10,7,10,2,11,7,11,2,12,7,12,2,13,7,13,2,14,7,14,2,15,7,15,2,16,7,16,2,17,7,17,2,18,7,18,2,19,7,19,2,20,7,20,1,0,1,0,1,0,1,1,1,1,1,1,1,1,5,1,50,8,1,10,1,12,1,53,9,1,1,2,1,2,1,2,1,2,1,2,3,2,60,8,2,1,3,1,3,1,3,3,3,65,8,3,1,3,1,3,1,4,1,4,1,5,1,5,3,5,73,8,5,1,6,1,6,3,6,77,8,6,1,7,1,7,3,7,81,8,7,1,8,1,8,3,8,85,8,8,1,9,1,9,3,9,89,8,9,1,10,1,10,1,11,1,11,3,11,95,8,11,1,12,1,12,1,13,4,13,100,8,13,11,13,12,13,101,1,14,1,14,1,14,3,14,107,8,14,1,15,1,15,1,16,1,16,1,16,1,17,1,17,1,18,1,18,1,18,1,18,1,19,1,19,1,20,1,20,1,20,0,0,21,0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,0,3,1,0,15,16,1,0,3,9,1,0,11,13,113,0,42,1,0,0,0,2,45,1,0,0,0,4,59,1,0,0,0,6,64,1,0,0,0,8,68,1,0,0,0,10,70,1,0,0,0,12,76,1,0,0,0,14,78,1,0,0,0,16,84,1,0,0,0,18,88,1,0,0,0,20,90,1,0,0,0,22,92,1,0,0,0,24,96,1,0,0,0,26,99,1,0,0,0,28,103,1,0,0,0,30,108,1,0,0,0,32,110,1,0,0,0,34,113,1,0,0,0,36,115,1,0,0,0,38,119,1,0,0,0,40,121,1,0,0,0,42,43,3,2,1,0,43,44,5,0,0,1,44,1,1,0,0,0,45,51,3,4,2,0,46,47,3,22,11,0,47,48,3,4,2,0,48,50,1,0,0,0,49,46,1,0,0,0,50,53,1,0,0,0,51,49,1,0,0,0,51,52,1,0,0,0,52,3,1,0,0,0,53,51,1,0,0,0,54,55,5,1,0,0,55,56,3,2,1,0,56,57,5,2,0,0,57,60,1,0,0,0,58,60,3,6,3,0,59,54,1,0,0,0,59,58,1,0,0,0,60,5,1,0,0,0,61,62,3,12,6,0,62,63,3,14,7,0,63,65,1,0,0,0,64,61,1,0,0,0,64,65,1,0,0,0,65,66,1,0,0,0,66,67,3,8,4,0,67,7,1,0,0,0,68,69,7,0,0,0,69,9,1,0,0,0,70,72,3,12,6,0,71,73,3,26,13,0,72,71,1,0,0,0,72,73,1,0,0,0,73,11,1,0,0,0,74,77,3,40,20,0,75,77,3,36,18,0,76,74,1,0,0,0,76,75,1,0,0,0,77,13,1,0,0,0,78,80,3,16,8,0,79,81,3,26,13,0,80,79,1,0,0,0,80,81,1,0,0,0,81,15,1,0,0,0,82,85,3,18,9,0,83,85,3,20,10,0,84,82,1,0,0,0,84,83,1,0,0,0,85,17,1,0,0,0,86,89,3,40,20,0,87,89,3,36,18,0,88,86,1,0,0,0,88,87,1,0,0,0,89,19,1,0,0,0,90,91,7,1,0,0,91,21,1,0,0,0,92,94,3,24,12,0,93,95,3,26,13,0,94,93,1,0,0,0,94,95,1,0,0,0,95,23,1,0,0,0,96,97,7,2,0,0,97,25,1,0,0,0,98,100,3,28,14,0,99,98,1,0,0,0,100,101,1,0,0,0,101,99,1,0,0,0,101,102,1,0,0,0,102,27,1,0,0,0,103,104,5,10,0,0,104,106,3,30,15,0,105,107,3,32,16,0,106,105,1,0,0,0,106,107,1,0,0,0,107,29,1,0,0,0,108,109,3,40,20,0,109,31,1,0,0,0,110,111,3,20,10,0,111,112,3,34,17,0,112,33,1,0,0,0,113,114,7,0,0,0,114,35,1,0,0,0,115,116,3,38,19,0,116,117,5,14,0,0,117,118,3,40,20,0,118,37,1,0,0,0,119,120,3,40,20,0,120,39,1,0,0,0,121,122,5,16,0,0,122,41,1,0,0,0,11,51,59,64,72,76,80,84,88,94,101,106]),n(o,"__ATN"),n(o,"vocabulary",new Ge(o.literalNames,o.symbolicNames,[])),n(o,"decisionsToDFA",o._ATN.decisionToState.map((e,t)=>new De(e,t)));let C=o;class vi extends v{constructor(e,t){super(e,t)}boolean_query(){return this.getRuleContext(0,Ve)}EOF(){return this.getToken(C.EOF,0)}get ruleIndex(){return C.RULE_query}enterRule(e){e.enterQuery&&e.enterQuery(this)}exitRule(e){e.exitQuery&&e.exitQuery(this)}accept(e){return e.visitQuery?e.visitQuery(this):e.visitChildren(this)}}class Ve extends v{constructor(e,t){super(e,t)}subquery(e){return e===void 0?this.getRuleContexts(Me):this.getRuleContext(e,Me)}boolean_modified(e){return e===void 0?this.getRuleContexts(qe):this.getRuleContext(e,qe)}get ruleIndex(){return C.RULE_boolean_query}enterRule(e){e.enterBoolean_query&&e.enterBoolean_query(this)}exitRule(e){e.exitBoolean_query&&e.exitBoolean_query(this)}accept(e){return e.visitBoolean_query?e.visitBoolean_query(this):e.visitChildren(this)}}class Me extends v{constructor(e,t){super(e,t)}L_PAREN(){return this.getToken(C.L_PAREN,0)}boolean_query(){return this.getRuleContext(0,Ve)}R_PAREN(){return this.getToken(C.R_PAREN,0)}search_clause(){return this.getRuleContext(0,mr)}get ruleIndex(){return C.RULE_subquery}enterRule(e){e.enterSubquery&&e.enterSubquery(this)}exitRule(e){e.exitSubquery&&e.exitSubquery(this)}accept(e){return e.visitSubquery?e.visitSubquery(this):e.visitChildren(this)}}class mr extends v{constructor(e,t){super(e,t)}search_term(){return this.getRuleContext(0,Er)}index(){return this.getRuleContext(0,Rt)}relation_modified(){return this.getRuleContext(0,_r)}get ruleIndex(){return C.RULE_search_clause}enterRule(e){e.enterSearch_clause&&e.enterSearch_clause(this)}exitRule(e){e.exitSearch_clause&&e.exitSearch_clause(this)}accept(e){return e.visitSearch_clause?e.visitSearch_clause(this):e.visitChildren(this)}}class Er extends v{constructor(e,t){super(e,t)}SIMPLE_STRING(){return this.getToken(C.SIMPLE_STRING,0)}QUOTED_STRING(){return this.getToken(C.QUOTED_STRING,0)}get ruleIndex(){return C.RULE_search_term}enterRule(e){e.enterSearch_term&&e.enterSearch_term(this)}exitRule(e){e.exitSearch_term&&e.exitSearch_term(this)}accept(e){return e.visitSearch_term?e.visitSearch_term(this):e.visitChildren(this)}}class Si extends v{constructor(e,t){super(e,t)}index(){return this.getRuleContext(0,Rt)}modifier_list(){return this.getRuleContext(0,Xe)}get ruleIndex(){return C.RULE_index_modified}enterRule(e){e.enterIndex_modified&&e.enterIndex_modified(this)}exitRule(e){e.exitIndex_modified&&e.exitIndex_modified(this)}accept(e){return e.visitIndex_modified?e.visitIndex_modified(this):e.visitChildren(this)}}class Rt extends v{constructor(e,t){super(e,t)}simple_name(){return this.getRuleContext(0,Se)}prefix_name(){return this.getRuleContext(0,Et)}get ruleIndex(){return C.RULE_index}enterRule(e){e.enterIndex&&e.enterIndex(this)}exitRule(e){e.exitIndex&&e.exitIndex(this)}accept(e){return e.visitIndex?e.visitIndex(this):e.visitChildren(this)}}class _r extends v{constructor(e,t){super(e,t)}relation(){return this.getRuleContext(0,yr)}modifier_list(){return this.getRuleContext(0,Xe)}get ruleIndex(){return C.RULE_relation_modified}enterRule(e){e.enterRelation_modified&&e.enterRelation_modified(this)}exitRule(e){e.exitRelation_modified&&e.exitRelation_modified(this)}accept(e){return e.visitRelation_modified?e.visitRelation_modified(this):e.visitChildren(this)}}class yr extends v{constructor(e,t){super(e,t)}relation_name(){return this.getRuleContext(0,br)}relation_symbol(){return this.getRuleContext(0,mt)}get ruleIndex(){return C.RULE_relation}enterRule(e){e.enterRelation&&e.enterRelation(this)}exitRule(e){e.exitRelation&&e.exitRelation(this)}accept(e){return e.visitRelation?e.visitRelation(this):e.visitChildren(this)}}class br extends v{constructor(e,t){super(e,t)}simple_name(){return this.getRuleContext(0,Se)}prefix_name(){return this.getRuleContext(0,Et)}get ruleIndex(){return C.RULE_relation_name}enterRule(e){e.enterRelation_name&&e.enterRelation_name(this)}exitRule(e){e.exitRelation_name&&e.exitRelation_name(this)}accept(e){return e.visitRelation_name?e.visitRelation_name(this):e.visitChildren(this)}}class mt extends v{constructor(e,t){super(e,t)}EQUAL(){return this.getToken(C.EQUAL,0)}GREATER(){return this.getToken(C.GREATER,0)}LESSER(){return this.getToken(C.LESSER,0)}GREATER_EQUAL(){return this.getToken(C.GREATER_EQUAL,0)}LESSER_EQUAL(){return this.getToken(C.LESSER_EQUAL,0)}NOT_EQUAL(){return this.getToken(C.NOT_EQUAL,0)}EQUAL_EQUAL(){return this.getToken(C.EQUAL_EQUAL,0)}get ruleIndex(){return C.RULE_relation_symbol}enterRule(e){e.enterRelation_symbol&&e.enterRelation_symbol(this)}exitRule(e){e.exitRelation_symbol&&e.exitRelation_symbol(this)}accept(e){return e.visitRelation_symbol?e.visitRelation_symbol(this):e.visitChildren(this)}}class qe extends v{constructor(e,t){super(e,t)}boolean(){return this.getRuleContext(0,gr)}modifier_list(){return this.getRuleContext(0,Xe)}get ruleIndex(){return C.RULE_boolean_modified}enterRule(e){e.enterBoolean_modified&&e.enterBoolean_modified(this)}exitRule(e){e.exitBoolean_modified&&e.exitBoolean_modified(this)}accept(e){return e.visitBoolean_modified?e.visitBoolean_modified(this):e.visitChildren(this)}}class gr extends v{constructor(e,t){super(e,t)}AND(){return this.getToken(C.AND,0)}OR(){return this.getToken(C.OR,0)}NOT(){return this.getToken(C.NOT,0)}get ruleIndex(){return C.RULE_boolean}enterRule(e){e.enterBoolean&&e.enterBoolean(this)}exitRule(e){e.exitBoolean&&e.exitBoolean(this)}accept(e){return e.visitBoolean?e.visitBoolean(this):e.visitChildren(this)}}class Xe extends v{constructor(e,t){super(e,t)}modifier(e){return e===void 0?this.getRuleContexts(it):this.getRuleContext(e,it)}get ruleIndex(){return C.RULE_modifier_list}enterRule(e){e.enterModifier_list&&e.enterModifier_list(this)}exitRule(e){e.exitModifier_list&&e.exitModifier_list(this)}accept(e){return e.visitModifier_list?e.visitModifier_list(this):e.visitChildren(this)}}class it extends v{constructor(e,t){super(e,t)}SLASH(){return this.getToken(C.SLASH,0)}modifier_name(){return this.getRuleContext(0,Ar)}modifier_relation(){return this.getRuleContext(0,Nr)}get ruleIndex(){return C.RULE_modifier}enterRule(e){e.enterModifier&&e.enterModifier(this)}exitRule(e){e.exitModifier&&e.exitModifier(this)}accept(e){return e.visitModifier?e.visitModifier(this):e.visitChildren(this)}}class Ar extends v{constructor(e,t){super(e,t)}simple_name(){return this.getRuleContext(0,Se)}get ruleIndex(){return C.RULE_modifier_name}enterRule(e){e.enterModifier_name&&e.enterModifier_name(this)}exitRule(e){e.exitModifier_name&&e.exitModifier_name(this)}accept(e){return e.visitModifier_name?e.visitModifier_name(this):e.visitChildren(this)}}class Nr extends v{constructor(e,t){super(e,t)}relation_symbol(){return this.getRuleContext(0,mt)}modifier_value(){return this.getRuleContext(0,wr)}get ruleIndex(){return C.RULE_modifier_relation}enterRule(e){e.enterModifier_relation&&e.enterModifier_relation(this)}exitRule(e){e.exitModifier_relation&&e.exitModifier_relation(this)}accept(e){return e.visitModifier_relation?e.visitModifier_relation(this):e.visitChildren(this)}}class wr extends v{constructor(e,t){super(e,t)}SIMPLE_STRING(){return this.getToken(C.SIMPLE_STRING,0)}QUOTED_STRING(){return this.getToken(C.QUOTED_STRING,0)}get ruleIndex(){return C.RULE_modifier_value}enterRule(e){e.enterModifier_value&&e.enterModifier_value(this)}exitRule(e){e.exitModifier_value&&e.exitModifier_value(this)}accept(e){return e.visitModifier_value?e.visitModifier_value(this):e.visitChildren(this)}}class Et extends v{constructor(e,t){super(e,t)}prefix(){return this.getRuleContext(0,Lr)}DOT(){return this.getToken(C.DOT,0)}simple_name(){return this.getRuleContext(0,Se)}get ruleIndex(){return C.RULE_prefix_name}enterRule(e){e.enterPrefix_name&&e.enterPrefix_name(this)}exitRule(e){e.exitPrefix_name&&e.exitPrefix_name(this)}accept(e){return e.visitPrefix_name?e.visitPrefix_name(this):e.visitChildren(this)}}class Lr extends v{constructor(e,t){super(e,t)}simple_name(){return this.getRuleContext(0,Se)}get ruleIndex(){return C.RULE_prefix}enterRule(e){e.enterPrefix&&e.enterPrefix(this)}exitRule(e){e.exitPrefix&&e.exitPrefix(this)}accept(e){return e.visitPrefix?e.visitPrefix(this):e.visitChildren(this)}}class Se extends v{constructor(e,t){super(e,t)}SIMPLE_STRING(){return this.getToken(C.SIMPLE_STRING,0)}get ruleIndex(){return C.RULE_simple_name}enterRule(e){e.enterSimple_name&&e.enterSimple_name(this)}exitRule(e){e.exitSimple_name&&e.exitSimple_name(this)}accept(e){return e.visitSimple_name?e.visitSimple_name(this):e.visitChildren(this)}}const Ti=[{id:"lang",label:"Entry language",virtual:!0},{id:"lemma",label:"Lemma form"},{id:"entryId",label:"Identifier of the current entry"},{id:"phonetic",label:"Phonetic form"},{id:"translation",label:"Translation"},{id:"transcription",label:"Transcription or transliteration"},{id:"definition",label:"Definition or description"},{id:"etymology",label:"Etymology information"},{id:"case",label:"Morphological Case"},{id:"number",label:"Morphological Number"},{id:"gender",label:"Morphological Gender"},{id:"pos",label:"Part-of-Speech"},{id:"baseform",label:"Baseform (or stem …)"},{id:"segmentation",label:"Composita segmentation, hyphenation"},{id:"sentiment",label:"Sentiment information",unstructured:!0},{id:"frequency",label:"Frequency information",unstructured:!0},{id:"antonym",label:"Antonym"},{id:"hyponym",label:"Hyponym"},{id:"hypernym",label:"Hypernym"},{id:"meronym",label:"Meronym"},{id:"holonym",label:"Holonym"},{id:"synonym",label:"Synonym"},{id:"related",label:"Unspecified relation"},{id:"ref",label:"A URI referencing a related resource"},{id:"senseRef",label:"ID of a sense definition"},{id:"citation",label:"Citation, quotation or example"}],Ii=Object.fromEntries(Ti.map(r=>[r.id,r])),Ci=[{id:"virtual",label:"Virtual fields",fields:["lang"]},{id:"core",label:"Basic fields",fields:["lemma","entryId","phonetic","translation","transcription"]},{id:"description",label:"Description fields",fields:["definition","etymology"]},{id:"grammar",label:"Grammar and morphology fields",fields:["case","number","gender","pos","baseform","segmentation"]},{id:"numeric",label:"Unstructured numeric fields",fields:["sentiment","frequency"]},{id:"relation",label:"Semantic relation fields",fields:["antonym","hyponym","hypernym","meronym","holonym","synonym","related"]},{id:"reference",label:"Reference fields",fields:["ref","senseRef"]},{id:"citation",label:"Citation and quotation fields",fields:["citation"]}],Oi=[{id:"=",label:"equal"},{id:"==",label:"exact equal"},{id:"is",label:"is a"}],Qt=[{id:"lang",label:"Language"},{id:"unmasked",label:"Unmasked"},{id:"ignoreCase",label:"Ignore Case"},{id:"respectCase",label:"Respect Case"},{id:"ignoreAccents",label:"Ignore Accents"},{id:"respectAccents",label:"Respect Accents"},{id:"honorWhitespace",label:"Honor Whitespace"},{id:"regexp",label:"Regular Expression"},{id:"partialMatch",label:"Partial Match"},{id:"fullMatch",label:"Full Match"}],jt=[["masked","unmasked","regexp"],["ignoreCase","respectCase"],["ignoreAccents","respectAccents"],["partialMatch","fullMatch"]],Qi=[{id:"and",label:"AND"},{id:"or",label:"OR"},{id:"not",label:"NOT"}],kt="=",ge='""',ke="or",vr=[{id:"search-clause",label:"Search Clause",new:`${ge}`,newBefore:`${ge} ${ke}`,newAfter:`${ke} ${ge}`},{id:"sub-query",label:"Subquery",new:`( ${ge} )`,newBefore:`( ${ge} ) ${ke}`,newAfter:`${ke} ( ${ge} )`}],st=Object.fromEntries(vr.map(r=>[r.id,r])),_t=f.createContext(void 0);_t.displayName="LexCQLParserLexerContext";function ji({parser:r,lexer:e,cursorPos:t,children:s}){const l={parser:r,lexer:e,cursorPos:t};return i.jsx(_t.Provider,{value:l,children:s})}function Sr(){const r=f.useContext(_t);if(!r)throw new Error('No parser and lexer "data" set, use LexCQLParserLexerProvider to set');return r}const yt=f.createContext(void 0);yt.displayName="LexCQLQueryBuilderConfigContext";function ki({enableRelationModifiers:r=!0,forceSearchTermQuoting:e=!1,showAllFields:t=!0,showResourceCountForField:s=!0,children:l}){const x={enableRelationModifiers:r,forceSearchTermQuoting:e,showAllFields:t,showResourceCountForField:s};return i.jsx(yt.Provider,{value:x,children:l})}function Ui(){const r=f.useContext(yt);if(!r)throw new Error('No flags "data" set, use LexCQLQueryBuilderConfigProvider to set');return r}const bt=f.createContext(void 0);bt.displayName="LexCQLQueryUpdaterContext";function Hi({rewriter:r,children:e}){const t={rewriter:r};return i.jsx(bt.Provider,{value:t,children:e})}function gt(){const r=f.useContext(bt);if(!r)throw new Error('No rewriter "data" set, use LexCQLQueryUpdaterProvider to set');return r}const At=f.createContext(void 0);At.displayName="LexCQLResourceFieldInfoContext";function Mi({resources:r,fieldInfo:e,children:t}){const s={resources:r,fieldInfo:e};return i.jsx(At.Provider,{value:s,children:t})}function qi(){const r=f.useContext(At);if(!r)throw new Error('No resources and field info "data" set, use LexCQLResourceFieldInfoProvider to set');return r}const T=class T extends Bt{constructor(e){super(e),this.interpreter=new Pt(this,T._ATN,T.decisionsToDFA,new Be)}get grammarFileName(){return"LexLexer.g4"}get literalNames(){return T.literalNames}get symbolicNames(){return T.symbolicNames}get ruleNames(){return T.ruleNames}get serializedATN(){return T._serializedATN}get channelNames(){return T.channelNames}get modeNames(){return T.modeNames}static get _ATN(){return T.__ATN||(T.__ATN=new Pe().deserialize(T._serializedATN)),T.__ATN}get vocabulary(){return T.vocabulary}};n(T,"L_PAREN",1),n(T,"R_PAREN",2),n(T,"EQUAL",3),n(T,"GREATER",4),n(T,"LESSER",5),n(T,"GREATER_EQUAL",6),n(T,"LESSER_EQUAL",7),n(T,"NOT_EQUAL",8),n(T,"EQUAL_EQUAL",9),n(T,"SLASH",10),n(T,"AND",11),n(T,"OR",12),n(T,"NOT",13),n(T,"DOT",14),n(T,"QUOTED_STRING",15),n(T,"SIMPLE_STRING",16),n(T,"WS",17),n(T,"channelNames",["DEFAULT_TOKEN_CHANNEL","HIDDEN"]),n(T,"literalNames",[null,"'('","')'","'='","'>'","'<'","'>='","'<='","'<>'","'=='","'/'",null,null,null,"'.'"]),n(T,"symbolicNames",[null,"L_PAREN","R_PAREN","EQUAL","GREATER","LESSER","GREATER_EQUAL","LESSER_EQUAL","NOT_EQUAL","EQUAL_EQUAL","SLASH","AND","OR","NOT","DOT","QUOTED_STRING","SIMPLE_STRING","WS"]),n(T,"modeNames",["DEFAULT_MODE"]),n(T,"ruleNames",["L_PAREN","R_PAREN","EQUAL","GREATER","LESSER","GREATER_EQUAL","LESSER_EQUAL","NOT_EQUAL","EQUAL_EQUAL","SLASH","AND","OR","NOT","DOT","QUOTED_STRING","SIMPLE_STRING","WS"]),n(T,"_serializedATN",[4,0,17,92,6,-1,2,0,7,0,2,1,7,1,2,2,7,2,2,3,7,3,2,4,7,4,2,5,7,5,2,6,7,6,2,7,7,7,2,8,7,8,2,9,7,9,2,10,7,10,2,11,7,11,2,12,7,12,2,13,7,13,2,14,7,14,2,15,7,15,2,16,7,16,1,0,1,0,1,1,1,1,1,2,1,2,1,3,1,3,1,4,1,4,1,5,1,5,1,5,1,6,1,6,1,6,1,7,1,7,1,7,1,8,1,8,1,8,1,9,1,9,1,10,1,10,1,10,1,10,1,11,1,11,1,11,1,12,1,12,1,12,1,12,1,13,1,13,1,14,1,14,1,14,1,14,5,14,77,8,14,10,14,12,14,80,9,14,1,14,1,14,1,15,4,15,85,8,15,11,15,12,15,86,1,16,1,16,1,16,1,16,0,0,17,1,1,3,2,5,3,7,4,9,5,11,6,13,7,15,8,17,9,19,10,21,11,23,12,25,13,27,14,29,15,31,16,33,17,1,0,9,2,0,65,65,97,97,2,0,78,78,110,110,2,0,68,68,100,100,2,0,79,79,111,111,2,0,82,82,114,114,2,0,84,84,116,116,2,0,34,34,92,92,8,0,9,10,13,13,32,32,34,34,40,41,47,47,60,62,92,92,3,0,9,10,13,13,32,32,94,0,1,1,0,0,0,0,3,1,0,0,0,0,5,1,0,0,0,0,7,1,0,0,0,0,9,1,0,0,0,0,11,1,0,0,0,0,13,1,0,0,0,0,15,1,0,0,0,0,17,1,0,0,0,0,19,1,0,0,0,0,21,1,0,0,0,0,23,1,0,0,0,0,25,1,0,0,0,0,27,1,0,0,0,0,29,1,0,0,0,0,31,1,0,0,0,0,33,1,0,0,0,1,35,1,0,0,0,3,37,1,0,0,0,5,39,1,0,0,0,7,41,1,0,0,0,9,43,1,0,0,0,11,45,1,0,0,0,13,48,1,0,0,0,15,51,1,0,0,0,17,54,1,0,0,0,19,57,1,0,0,0,21,59,1,0,0,0,23,63,1,0,0,0,25,66,1,0,0,0,27,70,1,0,0,0,29,72,1,0,0,0,31,84,1,0,0,0,33,88,1,0,0,0,35,36,5,40,0,0,36,2,1,0,0,0,37,38,5,41,0,0,38,4,1,0,0,0,39,40,5,61,0,0,40,6,1,0,0,0,41,42,5,62,0,0,42,8,1,0,0,0,43,44,5,60,0,0,44,10,1,0,0,0,45,46,5,62,0,0,46,47,5,61,0,0,47,12,1,0,0,0,48,49,5,60,0,0,49,50,5,61,0,0,50,14,1,0,0,0,51,52,5,60,0,0,52,53,5,62,0,0,53,16,1,0,0,0,54,55,5,61,0,0,55,56,5,61,0,0,56,18,1,0,0,0,57,58,5,47,0,0,58,20,1,0,0,0,59,60,7,0,0,0,60,61,7,1,0,0,61,62,7,2,0,0,62,22,1,0,0,0,63,64,7,3,0,0,64,65,7,4,0,0,65,24,1,0,0,0,66,67,7,1,0,0,67,68,7,3,0,0,68,69,7,5,0,0,69,26,1,0,0,0,70,71,5,46,0,0,71,28,1,0,0,0,72,78,5,34,0,0,73,74,5,92,0,0,74,77,7,6,0,0,75,77,8,6,0,0,76,73,1,0,0,0,76,75,1,0,0,0,77,80,1,0,0,0,78,76,1,0,0,0,78,79,1,0,0,0,79,81,1,0,0,0,80,78,1,0,0,0,81,82,5,34,0,0,82,30,1,0,0,0,83,85,8,7,0,0,84,83,1,0,0,0,85,86,1,0,0,0,86,84,1,0,0,0,86,87,1,0,0,0,87,32,1,0,0,0,88,89,7,8,0,0,89,90,1,0,0,0,90,91,6,16,0,0,91,34,1,0,0,0,4,0,76,78,86,1,0,1,0]),n(T,"__ATN"),n(T,"vocabulary",new Ge(T.literalNames,T.symbolicNames,[])),n(T,"decisionsToDFA",T._ATN.decisionToState.map((e,t)=>new De(e,t)));let nt=T;function Tr(r){if(!r||!r.trim())return null;const e=Gt.fromString(r),t=new nt(e),s=new Dt(t),l=new Wt(s),x=new C(s),p=new rr;return t.removeErrorListeners(),t.addErrorListener(p),x.removeErrorListeners(),x.addErrorListener(p),{tree:x.query(),lexer:t,parser:x,rewriter:l,errors:p.errors}}const Bi=/([<>()=\\" ])/g,Pi=/([\\"])/g,Gi=/(?:\\)([\\"])/g;function Di(r){if(!r)return"";if(r.startsWith('"')&&r.endsWith('"')){let e=r.slice(1,-1);return e=e.replace(Gi,"$1"),e}return r}function Ut(r,e=!1){return r?r.match(Bi)?`"${r.replace(Pi,"\\$1")}"`:e?`"${r}"`:r:'""'}function Wi({query:r,cursorPos:e,resources:t,onChange:s,...l}){const[x,p]=f.useState(r??"");f.useEffect(()=>p(r??""),[r]);const d=f.useMemo(()=>{const b=(t==null?void 0:t.filter(m=>{var h;return(((h=m.availableDataViews)==null?void 0:h.find(L=>L.mimeType==="application/x-clarin-fcs-lex+xml"))!==void 0||m.searchCapabilitiesResolved.includes("LEX_SEARCH"))&&m.availableLexFields!==null&&m.availableLexFields.length>0}))??[];if(t&&t.length!==b.length){const m=t.filter(h=>!b.includes(h));console.warn("Filter out resource(s) that do(es) not correctly declare LexCQL query support",m)}return b},[t]),c=f.useMemo(()=>d.map(b=>{const m=new Set;return b.availableLexFields.forEach(h=>{m.has(h.type)||m.add(h.type)}),[...m.values()].map(h=>({fieldType:h,resource:b}))}).reduce((b,m)=>(m.forEach(({fieldType:h,resource:L})=>{b.has(h)||b.set(h,[]),b.get(h).push(L)}),b),new Map),[d]),R=f.useMemo(()=>Tr(x),[x]);function y(){if(R){const{rewriter:b}=R,m=b.getText();p(m),s==null||s(m)}else console.warn("No parsed query! Unable to handle change request",R)}function Q(b){const m=st[b].new;p(m),s==null||s(m)}return i.jsx("div",{id:"query-builder",className:"lex-query d-flex justify-content-center",children:i.jsx(ki,{enableRelationModifiers:l.enableRelationModifiers??!0,forceSearchTermQuoting:l.forceSearchTermQuoting??!1,showAllFields:l.showAllFields??!1,showResourceCountForField:l.showResourceCountForField??!0,children:i.jsx(Mi,{resources:d,fieldInfo:c,children:R?i.jsx(ji,{parser:R.parser,lexer:R.lexer,cursorPos:e,children:i.jsx(Hi,{rewriter:R.rewriter,children:i.jsx(Fi,{tree:R.tree,onChange:y})})}):i.jsx(at,{onClick:Q})})})})}function Ir({className:r,onClick:e}){return i.jsx(Ae,{variant:"link",className:["del-btn action-btn rounded-circle p-1"].concat(r??[]).join(" "),onClick:e,children:i.jsx("i",{dangerouslySetInnerHTML:{__html:pr},"aria-hidden":"true"})})}function at({className:r,onClick:e}){function t(s){s&&(e==null||e(s))}return i.jsxs(w,{className:[""].concat(r??[]).join(" "),onSelect:t,"aria-label":"Add search clause",children:[i.jsx(w.Toggle,{variant:"link",className:"add-search-clause-btn action-btn no-arrow",children:i.jsx("i",{dangerouslySetInnerHTML:{__html:Fe},"aria-hidden":"true"})}),i.jsx(w.Menu,{children:vr.map(s=>i.jsx(w.Item,{eventKey:s.id,children:s.label},s.id))})]})}function Fi({tree:r,onChange:e}){const t=r.boolean_query();return i.jsx("div",{className:"query flex-grow-1 justify-content-center d-flex flex-wrap row-gap-2 column-gap-1 rounded",children:i.jsx(Cr,{ctx:t,onChange:e})})}function Cr({ctx:r,onChange:e}){const{rewriter:t}=gt(),s=r.getChildCount()>1;function l(d){if(r.getChildCount()===1){const c=r.subquery(0);if(!c||!c.start){console.warn("Invalid parse tree state. A subquery with associated token should exist!",{ctx:r,subqueryCtx:c,childIdx:d});return}t.delete(c.start,c.stop),e==null||e()}else if(d===0){const c=r.subquery(0),R=r.boolean_modified(0);if(!c||!R||!c.start||!R.stop){console.warn("Invalid parse tree state. A subquery and boolean_modified with associated tokens should exist!",{ctx:r,subqueryCtx:c,booleanModifiedCtx:R,childIdx:d});return}t.delete(c.start,R.stop),e==null||e()}else{const c=r.getChild(d),R=r.getChild(d-1);if(!c||!R||!c.stop||!R.start){console.warn("Invalid parse tree state. A subquery and boolean_modified with associated tokens should exist!",{ctx:r,subqueryCtx:c,booleanModifiedCtx:R,childIdx:d});return}t.delete(R.start,c.stop),e==null||e()}}function x(d){const c=r.start.tokenIndex,R=st[d].newBefore;t.insertBefore(c,`${R} `),e==null||e()}function p(d){const c=r.stop.tokenIndex,R=st[d].newAfter;t.insertAfter(c,` ${R}`),e==null||e()}return i.jsxs("div",{className:["boolean-query d-flex align-items-center row-gap-2 column-gap-1"].concat(s?"block justify-content-center flex-wrap border rounded p-1":"").join(" "),children:[i.jsx(at,{onClick:x}),r.children.map((d,c)=>{if(d instanceof Me)return i.jsx($i,{ctx:d,onChange:e,onDelete:()=>l(c)},c);if(d instanceof qe)return i.jsx(Vi,{ctx:d,onChange:e},c)}),i.jsx(at,{onClick:p})]})}function $i({ctx:r,onChange:e,onDelete:t}){var c,R;const s=r.boolean_query(),l=r.search_clause(),x=s!==null,p=l!==null,d=x&&!(((c=s.parent)==null?void 0:c.parent)instanceof Ve&&((R=s.parent)==null?void 0:R.parent.getChildCount())===1);return i.jsx("div",{className:["sub-query position-relative align-items-center justify-content-center d-flex"].concat(x?"block border rounded p-1":"").join(" "),children:x?i.jsxs(i.Fragment,{children:[i.jsx("code",{className:"delims",children:"("}),i.jsx(Cr,{ctx:s,onChange:e}),i.jsx("code",{className:"delims",children:")"}),d&&i.jsx(Ir,{className:"del-within-clause-btn position-absolute top-0 start-100 translate-middle",onClick:t})]}):p?i.jsx(Xi,{ctx:l,onChange:e,onDelete:t}):i.jsx("div",{className:"text-danger px-1",title:"Parse error. Expected search clause or a sub query!",children:"???"})})}function Vi({ctx:r,onChange:e}){var d;const{rewriter:t}=gt(),{cursorPos:s}=Sr(),l=je(r,s),x=(d=r.getChild(0))==null?void 0:d.getText().toLowerCase();function p(c){const R=c;if(!R||R===x)return;const y=r.boolean().getChild(0).symbol;if(!y){console.warn("Unexpected parse tree, expected terminal node as first child!",{ctx:r,boolean:r.boolean(),firstChild:r.boolean().getChild(0)});return}t.replaceSingle(y,R),e==null||e()}return i.jsx("div",{className:["boolean focus-ring rounded mx-1"].concat([l?"cursor-focus":""]).join(" "),children:i.jsxs(w,{onSelect:p,children:[i.jsx(w.Toggle,{className:"form-select",children:i.jsx("code",{className:"keyword",children:x})}),i.jsx(w.Menu,{children:Qi.map(c=>i.jsx(w.Item,{eventKey:c.id,children:c.label},c.id))})]})})}function Xi({ctx:r,onChange:e,onDelete:t}){var xe,_e;const{rewriter:s}=gt(),{cursorPos:l}=Sr(),{fieldInfo:x}=qi(),{forceSearchTermQuoting:p,enableRelationModifiers:d,showAllFields:c,showResourceCountForField:R}=Ui(),y=[...x.keys()],Q=je(r,l),b=((_e=(xe=r.parent)==null?void 0:xe.parent)==null?void 0:_e.getChildCount())!==1,m=r.index(),h=r.relation_modified(),L=r.search_term(),[O,B]=f.useState(null),[U,W]=f.useState(null),[re,K]=f.useState([]),[V,ie]=f.useState("");f.useEffect(()=>{const A=m==null?void 0:m.getText(),S=h==null?void 0:h.relation().getText(),k=L.QUOTED_STRING(),M=L.SIMPLE_STRING(),G=(k==null?void 0:k.symbol.text)??(M==null?void 0:M.symbol.text);B(A??null),W(S??null),K(ne(h)),ie(Di(G))},[m,h,L]);const z=d&&U!=="is";function P(A,S){const k=S.toLowerCase();return A.map(M=>M.toLowerCase()).includes(k)?A.filter(M=>M.toLowerCase()!==k):(jt.flat(1).map(M=>M.toLowerCase()).includes(k)&&jt.find(M=>{const G=M.map(F=>F.toLowerCase());if(G.includes(k)){const F=G.filter(ee=>ee!==k);return A=A.filter(ee=>!F.includes(ee.toLowerCase())),!0}}),[...A,S])}function H(A,S){var ye,u;if(!S){console.warn("Unexpected parse state. For updating relation modifiers, the relation context should exist!",{relationModifiers:A,relationModifiedCtx:S});return}const k=S.stop.tokenIndex,M=((ye=S.modifier_list())==null?void 0:ye.modifier())??[],G=A.map(E=>E.toLowerCase()),F=[];let ee=!1;for(const E of M){const q=((u=E.modifier_name().simple_name().SIMPLE_STRING().symbol.text)==null?void 0:u.toLowerCase())??"";G.includes(q)?F.push(q):(s.delete(E.start,E.stop),ee=!0)}for(const E of A)F.includes(E.toLowerCase())||(s.insertAfter(k,`/${E}`),ee=!0);ee&&(e==null||e())}function ne(A){var M;const k=(((M=A==null?void 0:A.modifier_list())==null?void 0:M.modifier())??[]).map(G=>{var F;return((F=G.modifier_name().simple_name().SIMPLE_STRING().symbol.text)==null?void 0:F.toLowerCase())??""}).filter(G=>G!=="lang");return Qt.map(G=>G.id).filter(G=>k.includes(G.toLowerCase()))}function ae(A){const S=A;if(S&&S!==O){if(B(S),m===null){W(kt);const k=`${S} ${kt} ${Ut(V,p||L.QUOTED_STRING()!==null)}`;s.replace(r.start,r.stop,k)}else s.replace(m.start,m.stop,S);e==null||e()}}function fe(A){const S=A;if(S&&S!==O){if(W(S),h!==null){const k=h.relation();if(s.replace(k.start,k.stop,S),S==="is"){const M=h.modifier_list();M&&s.delete(M.start,M.stop)}}e==null||e()}}function Te(){const A=Ut(V,p||L.QUOTED_STRING()!==null);s.replace(L.start,L.stop,A),e==null||e()}function he(A){const S=P(re,A);H(S,h),K(k=>P(k,A))}function Ie(){return i.jsx(j.Control,{className:"d-inline",style:{width:"10ch"},value:V,onChange:A=>ie(A.target.value),onBlur:Te})}function Ee(A,S=void 0){return i.jsxs(i.Fragment,{children:[i.jsx("strong",{children:A}),S&&`: ${S}`,Ce(A)]})}function Ce(A){var k;if(!R)return null;const S=((k=x.get(A))==null?void 0:k.length)??0;return i.jsxs(i.Fragment,{children:[i.jsx("br",{}),i.jsxs("small",{className:"text-body-secondary",children:["Supported by ",S," resources."]})]})}return i.jsxs("div",{className:["block input-block basic-expression position-relative focus-ring border rounded py-2 px-2"].concat([b?"me-2 mt-1":""]).concat([Q?"cursor-focus":""]).join(" "),children:[i.jsxs("div",{className:"d-flex justify-content-center column-gap-2",children:[i.jsxs(w,{onSelect:ae,children:[i.jsx(w.Toggle,{className:"form-select",children:O??i.jsx("em",{className:"text-muted",children:"(default)"})}),i.jsx(w.Menu,{children:Ci.map(A=>y.find(S=>A.fields.includes(S))||A.id==="virtual"||A.fields.includes(O)?i.jsxs(f.Fragment,{children:[(c||x.size>5)&&i.jsx(w.Header,{children:A.label}),A.fields.map(S=>{var k;return(c||y.includes(S)||A.id==="virtual"||S===O)&&i.jsx(w.Item,{eventKey:S,active:S===O,children:Ee(S,(k=Ii[S])==null?void 0:k.label)},S)})]},A.id):null)})]}),U&&i.jsxs(w,{onSelect:fe,children:[i.jsx(w.Toggle,{className:"form-select",children:U}),i.jsx(w.Menu,{children:i.jsxs("div",{className:"d-flex",children:[i.jsxs("div",{className:["flex-grow-1"].concat(z?["border-end pe-1"]:[]).join(" "),children:[z&&i.jsx(w.Header,{children:"Relations"}),Oi.map(A=>i.jsx(w.Item,{eventKey:A.id,active:A.id===O,children:A.label},A.id))]}),i.jsx("div",{className:["text-nowrap"].concat(z?["ps-1"]:[]).join(" "),children:z&&i.jsxs(i.Fragment,{children:[i.jsx(w.Header,{children:"Modifiers"}),Qt.filter(A=>A.id!=="lang").map(A=>i.jsx(w.ItemText,{children:i.jsx(j.Check,{id:A.id,name:A.id,label:A.label,type:"checkbox",checked:re.includes(A.id),onChange:()=>he(A.id)})},A.id))]})})]})})]}),Ie()]}),b&&i.jsx(Ir,{className:"del-within-clause-btn position-absolute top-0 start-100 translate-middle",onClick:t})]})}function ss({show:r,query:e,queryType:t,resources:s,selectedResources:l,delay:x=1e3,onModalClose:p}){const[d,c]=f.useState(e??""),[R,y]=f.useState(null);f.useEffect(()=>{c(e??""),y(null)},[e]);const Q=Wr(d,x),[b,m]=f.useState(!1),[h,L,O]=Kr(null,x),B=s?l?s.filter(g=>l.includes(g.id)):s:void 0,U=f.useMemo(()=>t==="fcs"?hr(d):t==="lex"?Tr(d):(console.warn("Unexpected queryType, so will not parse query!",t),null),[d,t]);U&&U.errors.length>0&&h!==U.errors[0]&&L(U.errors[0]),(!U||U.errors.length===0)&&h!==null&&O(null);const[W,re]=f.useState(0),[K,V]=f.useState(void 0);if(s&&U){const g=ci(U==null?void 0:U.tree),Y=ui(s,g),be=Y.unsupported.length;be!==W&&re(be);const wt=[...Y.unsupportedByLayer.keys()],Lt=K?[...K.keys()]:[];(wt.length!==Lt.length||!wt.every(Ur=>Lt.includes(Ur)))&&V(Y.unsupportedByLayer)}U||W!==0&&(re(0),V(void 0));function ie(g){p({query:d,validResources:l??[],action:g})}function z(g){c(g)}function P(g){if(g.target.nodeName==="INPUT"){const Y=g.target.selectionStart,be=g.target.selectionEnd;y(Y!==null&&be!==null&&Y!==be?[Y,be]:Y)}}function H(g){c(g)}const[ne,ae]=f.useState(!1),[fe,Te]=f.useState(!1),[he,Ie]=f.useState(!1),[Ee,Ce]=f.useState(!1),[xe,_e]=f.useState(!0),[A,S]=f.useState(!1),[k,M]=f.useState(!1),[G,F]=f.useState(!1),[ee,ye]=f.useState(!1),[u,E]=f.useState(!0),[q,$]=f.useState(!0),[D,X]=f.useState(!0),[oe,te]=f.useState(!1),[le,pe]=f.useState(!0),[Oe,Ke]=f.useState(!1),[Nt,Or]=f.useState(!0);function Qr(){return i.jsxs(i.Fragment,{children:[i.jsxs(j,{className:"my-2 p-2 border rounded",style:{textIndent:"3.6rem hanging"},children:[i.jsx(j.Text,{className:"me-3",style:{verticalAlign:"text-bottom"},children:"Enable"}),i.jsx(j.Check,{inline:!0,label:"Within",type:"checkbox",name:"enableWithin",id:"enableWithin",checked:ne,onChange:()=>ae(g=>!g)}),i.jsx(j.Check,{inline:!0,label:"Expression Grouping",type:"checkbox",name:"enableWrapGroup",id:"enableWrapGroup",checked:fe,onChange:()=>Te(g=>!g)}),i.jsx(j.Check,{inline:!0,label:"Expression Negation",type:"checkbox",name:"enableWrapNegation",id:"enableWrapNegation",checked:he,onChange:()=>Ie(g=>!g)}),i.jsx(j.Check,{inline:!0,label:"Implicit Query",type:"checkbox",name:"enableImplicitQuery",id:"enableImplicitQuery",checked:Ee,onChange:()=>Ce(g=>!g)}),i.jsx(j.Check,{inline:!0,label:"Multiple Query Segments",type:"checkbox",name:"enableMultipleQuerySegments",id:"enableMultipleQuerySegments",checked:xe,onChange:()=>_e(g=>!g),disabled:!0}),i.jsx(j.Check,{inline:!0,label:"Quantifiers",type:"checkbox",name:"enableQuantifiers",id:"enableQuantifiers",checked:A,onChange:()=>S(g=>!g)}),i.jsx(j.Check,{inline:!0,label:"Regex Flags",type:"checkbox",name:"enableRegexpFlags",id:"enableRegexpFlags",checked:k,onChange:()=>M(g=>!g),disabled:!0}),i.jsx(j.Check,{inline:!0,label:"BASIC Layer",type:"checkbox",name:"showBasicLayer",id:"showBasicLayer",checked:G,onChange:()=>F(g=>!g)}),i.jsx(j.Check,{inline:!0,label:"All Advanced Layers",type:"checkbox",name:"showAllAdvancedLayers",id:"showAllAdvancedLayers",checked:ee,onChange:()=>ye(g=>!g)}),i.jsx(j.Check,{inline:!0,label:"Custom Layers",type:"checkbox",name:"showCustomLayers",id:"showCustomLayers",checked:u,onChange:()=>E(g=>!g)}),i.jsx(j.Check,{inline:!0,label:"Layer Qualifiers",type:"checkbox",name:"showLayerQualifiers",id:"showLayerQualifiers",checked:q,onChange:()=>$(g=>!g)}),i.jsx(j.Check,{inline:!0,label:"Resource Count for Layer",type:"checkbox",name:"showResourceCountForLayer",id:"showResourceCountForLayer",checked:D,onChange:()=>X(g=>!g)})]}),i.jsx(Ei,{query:Q,cursorPos:R??void 0,onChange:H,resources:B,enableWithin:ne,enableWrapGroup:fe,enableWrapNegation:he,enableImplicitQuery:Ee,enableMultipleQuerySegments:xe,enableQuantifiers:A,enableRegexpFlags:k,showBasicLayer:G,showAllAdvancedLayers:ee,showCustomLayers:u,showLayerQualifiers:q,showResourceCountForLayer:D})]})}function jr(){return i.jsxs(i.Fragment,{children:[i.jsxs(j,{className:"my-2 p-2 border rounded",style:{textIndent:"3.6rem hanging"},children:[i.jsx(j.Text,{className:"me-3",style:{verticalAlign:"text-bottom"},children:"Enable"}),i.jsx(j.Check,{inline:!0,label:"Forced Search Term Quoting",type:"checkbox",name:"forceSearchTermQuoting",id:"forceSearchTermQuoting",checked:oe,onChange:()=>te(g=>!g)}),i.jsx(j.Check,{inline:!0,label:"Relation Modifiers",type:"checkbox",name:"enableRelationModifiers",id:"enableRelationModifiers",checked:le,onChange:()=>pe(g=>!g)}),i.jsx(j.Check,{inline:!0,label:"All Fields",type:"checkbox",name:"showAllFields",id:"showAllFields",checked:Oe,onChange:()=>Ke(g=>!g)}),i.jsx(j.Check,{inline:!0,label:"Resource Count for Field",type:"checkbox",name:"showResourceCountForField",id:"showResourceCountForField",checked:Nt,onChange:()=>Or(g=>!g)})]}),i.jsx(Wi,{query:Q,cursorPos:R??void 0,onChange:H,resources:B,enableRelationModifiers:le,forceSearchTermQuoting:oe,showAllFields:Oe,showResourceCountForField:Nt})]})}function kr(){return t==="fcs"?Qr():t==="lex"?jr():null}return i.jsxs(Qe,{id:"query-builder-modal",show:r,onHide:()=>ie("close"),fullscreen:!0,centered:!0,children:[i.jsx(Qe.Header,{className:"py-2",closeButton:!0,children:i.jsx(Qe.Title,{children:"Query Builder"})}),i.jsxs(Qe.Body,{className:"px-0",children:[i.jsx(j,{className:"px-1 pb-3 border-bottom",onSubmit:g=>g.preventDefault(),children:i.jsx(ze,{children:i.jsx(qr,{className:"d-sm-flex row-gap-2 justify-content-around",children:i.jsx(Br,{children:i.jsxs(Pr,{hasValidation:!0,children:[i.jsx(j.Control,{placeholder:'"Elephant"',"aria-label":"query builder input",className:"text-center query-builder-input",value:d,isInvalid:!!h,onBlur:()=>y(null),...b?{as:Fr,queryType:t,onChange:z,onCursorChange:(g,Y)=>{y(g!==Y&&g!==null&&Y!==void 0?[g,Y]:g)}}:{onChange:g=>{z(g.target.value),P(g)},onKeyUp:P,onClick:P}}),i.jsx(Gr,{id:"fcs-query-builder-input-enhanced-button",value:"enhance-query",type:"checkbox",checked:b,onChange:()=>m(g=>!g),variant:"outline-secondary","aria-label":"Enable enhanced visual input support",className:"d-flex align-items-center",children:i.jsx("i",{dangerouslySetInnerHTML:{__html:$r},"aria-hidden":"true"})}),i.jsx(j.Control.Feedback,{type:"invalid",children:h})]})})})})}),W>0&&i.jsx(ze,{className:"px-3",children:i.jsxs(Dr,{variant:"warning",className:"mb-0 mt-3",dismissible:!0,children:["For this query, ",W," of ",s==null?void 0:s.length," resources will not be available! Certain layers are not supported by some resources.",K&&i.jsx("ul",{className:"mb-0",children:[...K.keys()].map(g=>{var Y;return i.jsxs("li",{children:[i.jsx("strong",{children:g}),": ",(Y=K.get(g))==null?void 0:Y.length," ","unsupported resources"]})})})]})}),i.jsx(ze,{className:"px-3 pt-3",children:kr()})]}),i.jsxs(Qe.Footer,{className:"py-2",children:[i.jsx(Ae,{variant:"secondary",onClick:()=>ie("abort"),children:"Cancel"}),i.jsx(Ae,{variant:"primary",onClick:()=>ie("confirm"),children:"Use Query"})]})]})}export{ss as default};
//# sourceMappingURL=fcs-sru-aggregator-ui-query-builder-0.0.0.js.map
